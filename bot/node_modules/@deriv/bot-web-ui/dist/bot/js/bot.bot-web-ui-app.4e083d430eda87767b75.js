(self.webpackChunk_deriv_bot_web_ui=self.webpackChunk_deriv_bot_web_ui||[]).push([[558],{7328:(e,t,o)=>{var i={"./dalembert.xml":[9022,406],"./martingale.xml":[1732,101],"./oscars_grind.xml":[6373,113]};function n(e){if(!o.o(i,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],n=t[0];return o.e(t[1]).then((()=>o(n)))}n.keys=()=>Object.keys(i),n.id=7328,e.exports=n},6585:(e,t,o)=>{"use strict";o.r(t),o.d(t,{ActiveSymbols:()=>ao.Z,ApiHelpers:()=>d.Z,ContractsFor:()=>lo.Z,DBot:()=>bt,NetworkMonitor:()=>so,ServerTime:()=>uo,TradingTimes:()=>po.Z,after_purchase:()=>kt,balance:()=>vt,before_purchase:()=>Et,check_direction:()=>Bt,config:()=>l.v,console:()=>Tt,contract_check_result:()=>St,controls_flow_statements:()=>Ot,controls_for:()=>Ct,controls_forEach:()=>wt,controls_if:()=>At,controls_whileUntil:()=>It,createError:()=>P,during_purchase:()=>Rt,epoch:()=>Dt,error_types:()=>s.Di,getContractTypeName:()=>yo,getSavedWorkspaces:()=>u.WN,get_ohlc:()=>Nt,help_content_config:()=>vo,help_content_types:()=>go,importExternal:()=>mo,is_candle_black:()=>xt,last_digit:()=>Pt,load:()=>n.zD,log_types:()=>s.F$,logic_operation:()=>zt,math_arithmetic:()=>Lt,math_constrain:()=>Mt,math_single:()=>Ft,message_types:()=>s.LF,notify_telegram:()=>Ut,observer:()=>p.P,ohlc:()=>jt,ohlc_values:()=>Vt,ohlc_values_in_list:()=>Jt,onWorkspaceResize:()=>ho.N0,procedures_ifreturn:()=>Ht,read_details:()=>$t,read_ohlc:()=>Gt,read_ohlc_obj:()=>Wt,removeExistingWorkspace:()=>u.lY,runGroupedEvents:()=>n.UR,runIrreversibleEvents:()=>n.$9,save:()=>n.a1,saveWorkspaceToRecent:()=>u.l5,save_types:()=>c.R,scrollWorkspace:()=>n.yW,sell_at_market:()=>Yt,sell_price:()=>qt,sma_statement:()=>Kt,text_print:()=>Xt,text_prompt_ext:()=>Zt,tick_analysis:()=>Qt,timeSince:()=>_o,todatetime:()=>eo,totimestamp:()=>to,trackAndEmitError:()=>z,trade_again:()=>oo,trade_definition:()=>io,trade_definition_tradeoptions:()=>no,unrecoverable_errors:()=>s.Jr,updateWorkspaceName:()=>n.Hh,variables_set:()=>ro});var i=o(8429),n=(o(5730),o(6132));const r='<xml xmlns="http://www.w3.org/1999/xhtml" collection="false">\n  <variables></variables>\n  <block type="trade_definition" x="0" y="0">\n    <statement name="TRADE_OPTIONS">\n      <block type="trade_definition_market" deletable="false" movable="false">\n        <field name="MARKET_LIST"></field>\n        <field name="SUBMARKET_LIST"></field>\n        <field name="SYMBOL_LIST"></field>\n        <next>\n          <block type="trade_definition_tradetype" deletable="false" movable="false">\n            <field name="TRADETYPECAT_LIST"></field>\n            <field name="TRADETYPE_LIST"></field>\n            <next>\n              <block type="trade_definition_contracttype" deletable="false" movable="false">\n                <field name="TYPE_LIST"></field>\n                <next>\n                  <block type="trade_definition_candleinterval" deletable="false" movable="false">\n                    <field name="CANDLEINTERVAL_LIST">60</field>\n                    <next>\n                      <block type="trade_definition_restartbuysell" deletable="false" movable="false">\n                        <field name="TIME_MACHINE_ENABLED">FALSE</field>\n                        <next>\n                          <block type="trade_definition_restartonerror" deletable="false" movable="false">\n                            <field name="RESTARTONERROR">TRUE</field>\n                          </block>\n                        </next>\n                      </block>\n                    </next>\n                  </block>\n                </next>\n              </block>\n            </next>\n          </block>\n        </next>\n      </block>\n    </statement>\n    <statement name="SUBMARKET">\n      <block type="trade_definition_tradeoptions">\n        <mutation has_first_barrier="false" has_second_barrier="false" has_prediction="false"></mutation>\n        <field name="DURATIONTYPE_LIST"></field>\n        <field name="CURRENCY_LIST">USD</field>\n        <value name="DURATION">\n          <shadow type="math_number_positive">\n            <field name="NUM">5</field>\n          </shadow>\n        </value>\n        <value name="AMOUNT">\n          <shadow type="math_number_positive">\n            <field name="NUM">1</field>\n          </shadow>\n        </value>\n        <field name="AMOUNT_LIMITS"></field>\n      </block>\n    </statement>\n  </block>\n  <block type="during_purchase" x="770" y="0">\n    <statement name="DURING_PURCHASE_STACK">\n      <block type="controls_if">\n        <value name="IF0">\n          <block type="check_sell"></block>\n        </value>\n      </block>\n    </statement>\n  </block>\n  <block type="after_purchase" x="770" y="248">\n    <statement name="AFTERPURCHASE_STACK">\n      <block type="trade_again"></block>\n    </statement>\n  </block>\n  <block type="before_purchase" x="0" y="576">\n    <statement name="BEFOREPURCHASE_STACK">\n      <block type="purchase">\n        <field name="PURCHASE_LIST"></field>\n      </block>\n    </statement>\n  </block>\n</xml>';var a=o(282),l=o(9789),s=o(7103),c=o(7929),u=o(2626),p=o(8421),d=o(9633),y=o(3140),m=o(4601),h=o.n(m),_=o(6670),g=o(2052);const f=e=>p.P.emit("contract.status",e),b=e=>p.P.emit("bot.info",e),k=(e,t)=>p.P.emit("ui.log.success",{log_type:e,extra:t}),v=e=>p.P.emit("ui.log.error",e),E=(e,t)=>Number(e.toFixed(t).slice(-1)[0]),B=(e,t,o,n)=>new Promise(((r,a)=>{const l=e();l?l.then(r).catch((e=>{((e,t=[])=>!!e.error&&((e=>{var t,o,n;"InputValidationFailed"===(null===(t=e.error)||void 0===t?void 0:t.code)&&(null!==(o=e.error.details)&&void 0!==o&&o.duration&&(e.error.message=(0,i.localize)("Duration must be a positive integer")),null!==(n=e.error.details)&&void 0!==n&&n.amount&&(e.error.message=(0,i.localize)("Amount must be a positive number.")))})(e),!t.concat(["CallError","WrongResponse","GetProposalFailure","RateLimit","DisconnectError","MarketIsClosed"]).includes(e.error.code)))(e,o)?a(e):t(e.error.code,(()=>new Promise((t=>{const o=()=>{var e;return null!==(e=p.P.getState("global_timeouts"))&&void 0!==e?e:[]},r=setTimeout((()=>{const e=o();delete e[r],p.P.setState(e),t()}),((e,t)=>{const o=Math.min(2.5*t,15);return"RateLimit"===e.error.code?v((0,i.localize)("You are rate limited for: {{ message_type }}, retrying in {{ delay }}s (ID: {{ request }})",{message_type:e.msg_type,delay:o,request:e.echo_req.req_id})):"DisconnectError"===e.error.code?v((0,i.localize)("You are disconnected, retrying in {{ delay }}s",{delay:o})):"MarketIsClosed"===e.error.code?v((0,i.localize)("This market is presently closed.")):v((0,i.localize)("Request failed for: {{ message_type }}, retrying in {{ delay }}s",{message_type:e.msg_type||(0,i.localize)("unknown"),delay:o})),1e3*o})(e,n)),a=o(),l=(0,y.findValueByKeyRecursively)(e,"msg_type");a[r]={is_cancellable:["buy"].includes(l),msg_type:l},p.P.setState({global_timeouts:a})}))))})):r()})),T=(e,t)=>{let o=1;return new Promise(((i,n)=>{const r=(e,t)=>{o++,t().then(a)},a=()=>{B(e,r,t,o).then(i).catch(n)};a()}))},S=()=>""+(new Date).getTime()*Math.random();function O(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function C(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?O(Object(o),!0).forEach((function(t){w(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):O(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function w(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const A=e=>({open:+e.open,high:+e.high,low:+e.low,close:+e.close,epoch:+(e.open_time||e.epoch)}),I=e=>e?"candles":"ticks";class R{constructor(e){this.api=e,this.ticks=new _.Map,this.candles=new _.Map,this.tickListeners=new _.Map,this.ohlcListeners=new _.Map,this.subscriptions=new _.Map,this.ticks_history_promise=null,this.active_symbols_promise=null,this.candles_promise=null,this.observe()}requestPipSizes(){return this.pipSizes?Promise.resolve(this.pipSizes):(this.active_symbols_promise||(this.active_symbols_promise=new Promise((e=>{this.api.send({active_symbols:"brief"}).then((t=>{const{active_symbols:o}=t;this.pipSizes=o.reduce(((e,t)=>e.set(t.symbol,+(+t.pip).toExponential().substring(3))),new _.Map).toObject(),e(this.pipSizes)}))}))),this.active_symbols_promise)}request(e){const{symbol:t,granularity:o}=e,i=I(o);return"ticks"===i&&this.ticks.has(t)?Promise.resolve(this.ticks.get(t)):"candles"===i&&this.candles.hasIn([t,Number(o)])?Promise.resolve(this.candles.getIn([t,Number(o)])):this.requestStream(C(C({},e),{},{style:i}))}monitor(e){const{symbol:t,granularity:o,callback:i}=e,n=I(o),r=S();return this.request(e).catch((e=>{p.P.emit("Error",e)})),"ticks"===n?this.tickListeners=this.tickListeners.setIn([t,r],i):this.ohlcListeners=this.ohlcListeners.setIn([t,Number(o),r],i),r}stopMonitor(e){const{symbol:t,granularity:o,key:i}=e,n=I(o);"ticks"===n&&this.tickListeners.hasIn([t,i])&&(this.tickListeners=this.tickListeners.deleteIn([t,i])),"candles"===n&&this.ohlcListeners.hasIn([t,Number(o),i])&&(this.ohlcListeners=this.ohlcListeners.deleteIn([t,Number(o),i])),this.unsubscribeIfEmptyListeners(e)}unsubscribeIfEmptyListeners(e){const{symbol:t,granularity:o}=e;let i=!1;const n=this.tickListeners.get(t);n&&!n.size&&(this.tickListeners=this.tickListeners.delete(t),this.ticks=this.ticks.delete(t),i=!0);const r=this.ohlcListeners.getIn([t,Number(o)]);r&&!r.size&&(this.ohlcListeners=this.ohlcListeners.deleteIn([t,Number(o)]),this.candles=this.candles.deleteIn([t,Number(o)]),i=!0),i&&this.unsubscribeAllAndSubscribeListeners(t)}unsubscribeAllAndSubscribeListeners(e){const t=this.subscriptions.getIn(["ohlc",e]),o=this.subscriptions.getIn(["tick",e]),i=[...t?Array.from(t.values()):[],...o||[]];Promise.all(i.map((e=>T((()=>this.api.forget(e)))))),this.subscriptions=new _.Map}updateTicksAndCallListeners(e,t){if(this.ticks.get(e)===t)return;this.ticks=this.ticks.set(e,t);const o=this.tickListeners.get(e);o&&o.forEach((t=>t(this.ticks.get(e))))}updateCandlesAndCallListeners(e,t){if(this.ticks.getIn(e)===t)return;this.candles=this.candles.setIn(e,t);const o=this.ohlcListeners.getIn(e);o&&o.forEach((t=>t(this.candles.getIn(e))))}observe(){this.api.onMessage().subscribe((({data:e})=>{if("tick"===e.msg_type){const{tick:i}=e,{symbol:n,id:r}=i;this.ticks.has(n)&&(this.subscriptions=this.subscriptions.setIn(["tick",n],r),this.updateTicksAndCallListeners(n,(t=this.ticks.get(n),o=(e=>({epoch:+e.epoch,quote:+e.quote}))(i),(0,g.CT)(t).epoch>=o.epoch?t:[...t.slice(1),o])))}var t,o;if("ohlc"===e.msg_type){const{ohlc:t}=e,{symbol:o,granularity:i,id:n}=t;if(this.candles.hasIn([o,Number(i)])){this.subscriptions=this.subscriptions.setIn(["ohlc",o,Number(i)],n);const e=[o,Number(i)];this.updateCandlesAndCallListeners(e,((e,t)=>{const o=(0,g.CT)(e);return o.open===t.open&&o.high===t.high&&o.low===t.low&&o.close===t.close&&o.epoch===t.epoch||o.epoch>t.epoch?e:[...o.epoch===t.epoch?e.slice(0,-1):e.slice(1),t]})(this.candles.getIn(e),A(t)))}}}))}requestStream(e){const{style:t}=e,o=JSON.stringify(e);return"ticks"===t?(this.ticks_history_promise&&this.ticks_history_promise.stringified_options===o||(this.ticks_history_promise={promise:this.requestPipSizes().then((()=>this.requestTicks(e))),stringified_options:o}),this.ticks_history_promise.promise):"candles"===t?(this.candles_promise&&this.candles_promise.stringified_options===o||(this.candles_promise={promise:this.requestPipSizes().then((()=>this.requestTicks(e))),stringified_options:o}),this.candles_promise.promise):[]}requestTicks(e){const{symbol:t,granularity:o,style:i}=e,n={ticks_history:t,subscribe:1,end:"latest",count:1e3,granularity:o?Number(o):void 0,style:i};return new Promise(((e,r)=>{T((()=>this.api.send(n))).then((n=>{if("ticks"===i){const o=(0,g.Yp)(n.history);this.updateTicksAndCallListeners(t,o),e(o)}else{const i=(e=>e.map((e=>A(e))))(n.candles);this.updateCandlesAndCallListeners([t,Number(o)],i),e(i)}})).catch(r)}))}}var D=o(5974),N=o.n(D);const x=e=>class extends e{getTicksInterface(){return{getLastTick:(...e)=>this.tradeEngine.getLastTick(...e),getLastDigit:(...e)=>this.tradeEngine.getLastDigit(...e),getTicks:(...e)=>this.tradeEngine.getTicks(...e),checkDirection:(...e)=>this.tradeEngine.checkDirection(...e),getOhlcFromEnd:(...e)=>this.tradeEngine.getOhlcFromEnd(...e),getOhlc:(...e)=>this.tradeEngine.getOhlc(...e),getLastDigitList:(...e)=>this.tradeEngine.getLastDigitList(...e)}}},P=(e,t)=>{const o=new Error(t);return o.name=e,o.code=e,o},z=(e,t={})=>{p.P.emit("ui.log.error",e),window.trackJs&&trackJs.track(`${e} - Error: ${JSON.stringify(t)}`)},L=e=>Number.isFinite(e)&&e>0,M=e=>L(e)&&Number.isInteger(e),F=e=>e instanceof Object&&["open","high","low","close"].every((t=>L(e[t])))&&M(e.epoch),U=e=>{if(!F(e))throw P("CandleExpected",(0,i.localize)("Given candle is not valid"));return e};var j=function(e,t){return e.map((function(e){return t?e[t]:e}))},V=function(e,t,o){return j(e.slice(t>e.length?0:e.length-t,e.length),o)},J=function(e){return e.reduce((function(e,t){return e+t}))/e.length},H=function(e,t){var o=t.periods,i=t.field;if(e.length<o)throw new Error("Periods longer than data length");return function(e){return e.reduce((function(e,t){return e+t}))}(V(e,o,i))/o},$=function(e,t){var o=t.periods,i=t.pipSize,n=void 0===i?2:i;return(0,y.sequence)(e.length-o+1).map((function(i,r){return+H(e.slice(r,r+o),t).toFixed(n)}))},G=function(e,t){var o=t.periods,i=void 0===o?20:o,n=t.field,r=t.stdDevUp,a=void 0===r?2:r,l=t.stdDevDown,s=void 0===l?2:l,c=t.pipSize,u=void 0===c?2:c,p=V(e,i,n),d=H(p,{periods:i}),y=function(e){var t=J(e),o=e.map((function(e){return Math.pow(e-t,2)})),i=J(o);return Math.sqrt(i)}(p),m=d+y*a,h=d-y*s;return[+d.toFixed(u),+m.toFixed(u),+h.toFixed(u)]},W=function(e,t){var o=t.periods;return(0,y.sequence)(e.length-o+1).map((function(i,n){return G(e.slice(n,n+o),t)}))},Y=function(e,t,o){var i=t.periods,n=t.field,r=t.pipSize,a=void 0===r?2:r,l=2/(i+1),s=j(e,n);if(o)return(s[0]-o)*l+o;if(e.length<i)throw new Error("Periods longer than data length");var c=J(j(e.slice(0,i),n));return+s.slice(i).reduce((function(e,t){return(t-e)*l+e}),c).toFixed(a)},q=function(e,t){var o=t.periods,i=Y(e.slice(0,o),t);return e.slice(o-1).map((function(e,o){return o?i=Y([e],t,i):i}))};function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,i=new Array(t);o<t;o++)i[o]=e[o];return i}var X=function(e,t){var o=[];return o.length=t-e.length,o.fill(0),[].concat(o,function(e){return function(e){if(Array.isArray(e))return K(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return K(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?K(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e))},Z=function(e,t){var o=t.field,i=t.fastEmaPeriod,n=void 0===i?12:i,r=t.slowEmaPeriod,a=void 0===r?26:r,l=t.signalEmaPeriod,s=void 0===l?9:l,c=t.pipSize,u=void 0===c?2:c,p=j(e,o),d=p.length,y=X(q(p,{periods:n,pipSize:20,field:o}),d),m=X(q(p,{periods:a,pipSize:20,field:o}),d),h=X(m.map((function(e,t){return+(y[t]-e).toFixed(u)})),d),_=X(q(h.slice(a-1),{periods:s,pipSize:20,field:o}),d);return h.map((function(e,t){return[+(e-_[t]).toFixed(u),e,+_[t].toFixed(u)]})).slice(a+s-2)},Q=function(e,t){return t>e?t-e:0},ee=function(e,t){return t<e?e-t:0},te=function(e,t,o){var i;return e.reduce((function(e,o,n){1===n&&(i=e);var r=t(i,o);return i=o,r+(1===n?0:e)}))/o},oe=function(e,t,o,i){var n;return 1===e.length?i:e.reduce((function(e,r,a){1===a&&(n=e);var l=t(n,r);return n=r,((1===a?i:e)*(o-1)+l)/o}))},ie=function(e,t,o){var i=t.periods,n=t.field;if(e.length<i)throw new Error("Periods longer than data length");if(e.length===i)return 0;var r,a,l,s=j(e.slice(0,i+1),n);o&&"gain"in o?(r=j(e.slice(-2),n),a=o.gain,l=o.loss):(r=j(e.slice(i,e.length),n),a=te(s,Q,i),l=te(s,ee,i));var c=oe(r,Q,i,a),u=oe(r,ee,i,l);return o&&(o.gain=c,o.loss=u),0===c?0:0===u?100:100-100/(1+c/u)},ne=function(e,t){var o=t.periods,i=t.pipSize,n=void 0===i?2:i,r={};return(0,y.sequence)(e.length-o).map((function(i,a){return+ie(e.slice(0,a+o+1),t,r).toFixed(n)}))};function re(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function ae(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const le=e=>class extends e{getIndicatorsInterface(){return{sma:(e,t)=>this.decorate(H,e,{periods:t}),smaa:(e,t)=>this.decorate($,e,{periods:t}),ema:(e,t)=>this.decorate(Y,e,{periods:t}),emaa:(e,t)=>this.decorate(q,e,{periods:t}),rsi:(e,t)=>this.decorate(ie,e,{periods:t}),rsia:(e,t)=>this.decorate(ne,e,{periods:t}),bb:(e,t,o)=>this.decorate(G,e,t)[o],bba:(e,t,o)=>this.decorate(W,e,t).map((e=>e[o])),macda:(e,t,o)=>this.decorate(Z,e,t).map((e=>e[o]))}}decorate(e,t,o,...i){return e(t,function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?re(Object(o),!0).forEach((function(t){ae(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):re(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({pipSize:this.tradeEngine.getPipSize()},o),...i)}},se=e=>class extends e{getMiscInterface(){return{notify:e=>p.P.emit("ui.log.notify",e),console:({type:e,message:t})=>console[e](t),notifyTelegram:(e,t,o)=>{const n=()=>{return e=(0,i.localize)("The Telegram notification could not be sent"),p.P.emit("ui.log.notify",{className:"warn",message:e,sound:l.v.lists.NOTIFICATION_SOUND[0][1]});var e};fetch(`https://api.telegram.org/bot${e}/sendMessage`,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:t,text:o})}).then((e=>{e.ok||n()})).catch(n)},getTotalRuns:()=>this.tradeEngine.getTotalRuns(),getBalance:e=>this.tradeEngine.getBalance(e),getTotalProfit:e=>this.tradeEngine.getTotalProfit(e,this.tradeEngine.tradeOptions.currency)}}};function ce(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function ue(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(o),!0).forEach((function(t){pe(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ce(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function pe(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const de=e=>class extends(le(se((e=>class extends e{getCandleInterface(){return{isCandleBlack:e=>U(e)&&e.close<e.open,candleValues:(e,t)=>(e=>{if(!(e instanceof Array&&e.every((e=>F(e)))))throw P("CandleListExpected",(0,i.localize)("Given candle list is not valid"));return e})(e).map((e=>e[t])),candleField:(e,t)=>U(e)[t]}}})(e)))){getToolsInterface(){return ue(ue(ue(ue({dateTimeStringToTimestamp:e=>{const t=(0,i.localize)("Invalid date/time: {{ datetime_string }}",{datetime_string:e});if("string"!=typeof e)return t;const o=e.replace(/[^0-9.:-\s]/g,"").replace(/\s+/g," ").trim().split(" "),n=/^[12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])$/;let r;if(r=o.length>=2?n.test(o[0])&&/^(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9])(:([0-5][0-9])?)?$/.test(o[1])?`${o[0]}T${o[1]}`:null:1===o.length&&n.test(o[0])?o[0]:null,r){const e=new Date(r);if(e instanceof Date&&!isNaN(e))return e.getTime()/1e3}return t},getTime:()=>parseInt((new Date).getTime()/1e3)},this.getCandleInterface()),this.getMiscInterface()),this.getIndicatorsInterface()),{},{highlightBlock:e=>{const t=Blockly.derivWorkspace.getBlockById(e);t&&t.highlightExecutedBlock(t)}})}};var ye=o(5300),me=o(3292);let he="";const _e=e=>class extends e{observeBalance(){this.api.onMessage().subscribe((({data:e})=>{if("balance"===e.msg_type){const{balance:{balance:t,currency:o}}=e;he=(0,y.getFormattedText)(t,o),b({accountID:this.accountInfo.loginid,balance:he})}}))}getBalance(e){const{scope:t}=this.store.getState(),{client:o}=a.Z.instance,i=o&&o.balance||0;let n=i;return"BEFORE_PURCHASE"===t&&(n=Number(i)-this.tradeOptions.amount),he=(0,y.getFormattedText)(n,o.currency,!1),"STR"===e?he:i}},ge="BEFORE_PURCHASE",fe="DURING_PURCHASE",be="PROPOSALS_READY",ke="CLEAR_PROPOSALS",ve="PURCHASE_SUCCESSFUL",Ee="OPEN_CONTRACT",Be="SELL",Te="START",Se="STOP",Oe="NEW_TICK";function Ce(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function we(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(o),!0).forEach((function(t){Ae(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ce(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Ae(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const Ie=({dispatch:e,getState:t,data:o,scope:i})=>{const{scope:n}=t();n===i&&e(o)},Re=e=>{const{getState:t}=e,{proposalsReady:o}=t();o&&(e=>{Ie(we(we({},e),{},{scope:ge}))})(e)};function De(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function Ne(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const xe=e=>class extends e{observeOpenContract(){this.api.onMessage().subscribe((({data:e})=>{if("proposal_open_contract"===e.msg_type){const o=e.proposal_open_contract;if(!o&&!this.expectedContractId(null==o?void 0:o.contract_id))return;this.setContractFlags(o),this.data.contract=o,t=function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?De(Object(o),!0).forEach((function(t){Ne(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):De(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({accountID:this.accountInfo.loginid},o),p.P.emit("bot.contract",t),this.isSold?(this.contractId="",clearTimeout(this.transaction_recovery_timeout),this.updateTotals(o),f({id:"contract.sold",data:o.transaction_ids.sell,contract:o}),this.afterPromise&&this.afterPromise(),this.store.dispatch(((e,t)=>Ie({dispatch:e,getState:t,data:{type:Be},scope:fe})))):this.store.dispatch(((e,t)=>{const{scope:o}=t();o===fe&&e({type:Ee}),Re({dispatch:e,getState:t,data:{type:Ee}})}))}var t}))}waitForAfter(){return new Promise((e=>{this.afterPromise=e}))}subscribeToOpenContract(e=this.contractId){this.contractId=e,T((()=>this.api.send({proposal_open_contract:1,contract_id:e,subscribe:1}))).then((e=>{this.openContractId=e.proposal_open_contract.id})).catch((t=>{"AlreadySubscribed"!==t.error.code&&T((()=>this.api.send({proposal_open_contract:1,contract_id:e,subscribe:1}))).then((e=>this.openContractId=e.proposal_open_contract.id))}))}setContractFlags(e){const{is_expired:t,is_valid_to_sell:o,is_sold:i,entry_tick:n}=e;this.isSold=Boolean(i),this.isSellAvailable=!this.isSold&&Boolean(o),this.isExpired=Boolean(t),this.hasEntryTick=Boolean(n)}expectedContractId(e){return this.contractId&&e===this.contractId}getSellPrice(){const{bid_price:e,buy_price:t,currency:o}=this.data.contract;return(0,y.getRoundedNumber)(Number(e)-Number(t),o)}};function Pe(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function ze(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(o),!0).forEach((function(t){Le(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Pe(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Le(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const Me=e=>class extends e{makeProposals(e){this.isNewTradeOption(e)&&(this.regeneratePurchaseReference(),this.trade_option=e,this.proposal_templates=((e,t)=>e.contractTypes.map((o=>{const i={proposal:1,duration_unit:e.duration_unit,basis:e.basis,currency:e.currency,symbol:e.symbol,duration:e.duration,amount:e.amount,contract_type:o,passthrough:{contract_type:o,purchase_reference:t}};return void 0!==e.prediction&&(i.selected_tick=e.prediction),["TICKLOW","TICKHIGH"].includes(o)||void 0===e.prediction?void 0!==e.barrierOffset&&(i.barrier=e.barrierOffset):i.barrier=e.prediction,void 0!==e.secondBarrierOffset&&(i.barrier2=e.secondBarrierOffset),i})))(e,this.getPurchaseReference()),this.renewProposalsOnPurchase())}selectProposal(e){const{proposals:t}=this.data;if(0===t.length)throw Error((0,i.localize)("Proposals are not ready"));const o=t.find((t=>{if(t.contract_type===e&&t.purchase_reference===this.getPurchaseReference()){if(t.error)throw t.error;return t}return!1}));if(!o)throw new Error((0,i.localize)("Selected proposal does not exist"));return{id:o.id,askPrice:o.ask_price}}renewProposalsOnPurchase(){this.unsubscribeProposals().then((()=>this.requestProposals()))}clearProposals(){this.data.proposals=[],this.store.dispatch({type:ke})}requestProposals(){let e=!1;Promise.all(this.proposal_templates.map((t=>{T((()=>this.api.send(t))).catch((t=>"ContractBuyValidationError"===t.error.code?(this.data.proposals.push(ze(ze(ze({},t.error.echo_req),t.echo_req.passthrough),{},{error:t})),null):(e||(e=!0,this.$scope.observer.emit("Error",t.error)),null)))})))}observeProposals(){this.api.onMessage().subscribe((e=>{if("proposal"===e.data.msg_type){const{passthrough:t,proposal:o}=e.data;o&&-1===this.data.proposals.findIndex((e=>e.id===o.id))&&!this.data.forget_proposal_ids.includes(o.id)&&(this.data.proposals.push(ze(ze({},o),t)),this.checkProposalReady())}}))}unsubscribeProposals(){const{proposals:e}=this.data,t=e=>this.data.forget_proposal_ids=this.data.forget_proposal_ids.filter((t=>t!==e));return this.clearProposals(),Promise.all(e.map((e=>(this.data.forget_proposal_ids.includes(e.id)||this.data.forget_proposal_ids.push(e.id),e.error?(t(e.id),Promise.resolve()):T((()=>this.api.forget(e.id))).then((()=>{t(e.id)}))))))}checkProposalReady(){const{proposals:e}=this.data;e.length>0&&this.proposal_templates.every((t=>-1!==e.findIndex((e=>e.purchase_reference===t.passthrough.purchase_reference&&e.contract_type===t.contract_type))))&&this.startPromise.then((()=>this.store.dispatch({type:be})))}isNewTradeOption(e){return this.trade_option?["amount","barrierOffset","basis","duration","duration_unit","prediction","secondBarrierOffset","symbol"].some((t=>this.trade_option[t]!==e[t])):(this.trade_option=e,!0)}};let Fe,Ue=0;const je=e=>class extends e{constructor(...e){super(...e),this.getPurchaseReference=()=>Fe,this.regeneratePurchaseReference=()=>{Fe=S()}}purchase(e){if(this.store.getState().scope!==ge)return Promise.resolve();const{id:t,askPrice:o}=this.selectProposal(e),i=t=>{this.data.proposals=this.data.proposals.filter((e=>e.id!==t.echo_req.buy));const{buy:o}=t;f({id:"contract.purchase_received",data:o.transaction_id,buy:o}),this.subscribeToOpenContract(o.contract_id),this.store.dispatch(((e,t)=>Re({dispatch:e,getState:t,data:{type:ve}}))),this.renewProposalsOnPurchase(),Ue=0,k(s.F$.PURCHASE,{longcode:o.longcode,transaction_id:o.transaction_id}),b({accountID:this.accountInfo.loginid,totalRuns:this.updateAndReturnTotalRuns(),transaction_ids:{buy:o.transaction_id},contract_type:e,buy_price:o.buy_price})},n=()=>this.api.send({buy:t,price:o});return this.isSold=!1,f({id:"contract.purchase_sent",data:o}),this.options.timeMachineEnabled?B(n,((e,t)=>{"DisconnectError"!==e?this.renewProposalsOnPurchase():this.clearProposals();const o=this.store.subscribe((()=>{const{scope:e,proposalsReady:i}=this.store.getState();e===ge&&i&&(t().then((()=>this.observer.emit("REVERT","before"))),o())}))}),["PriceMoved","InvalidContractProposal"],Ue++).then(i):T(n).then(i)}};function Ve(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function Je(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(o),!0).forEach((function(t){He(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ve(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function He(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const $e=e=>class extends e{isSellAtMarketAvailable(){return this.contractId&&!this.isSold&&this.isSellAvailable&&!this.isExpired}sellAtMarket(){if(p.P.emit("bot.sell"),this.store.getState().scope!==fe)return Promise.resolve();if(!this.isSellAtMarketAvailable())return k(s.F$.NOT_OFFERED),Promise.resolve();let e=1;return new Promise((t=>{const o=o=>{if(e=1,o){const{sold_for:e}=o.sell;k(s.F$.SELL,{sold_for:e})}f("purchase.sold"),this.waitForAfter(),t()},i=this.contractId,n=()=>T((()=>this.api.send({sell:i,price:0}))).then((e=>{T((()=>this.api.send({proposal_open_contract:1,contract_id:i}))).then((()=>e))})).catch((e=>{const t=e.error;if("InvalidOfferings"===t.code)return Promise.resolve();const o={name:t.code,message:t.message,msg_type:e.msg_type,error:Je({},t.error)};return"RateLimit"===t.code?Promise.reject(o):T((()=>this.api.send({proposal_open_contract:1,contract_id:i}))).then((e=>{const{proposal_open_contract:t}=e;return"sold"!==t.status?Promise.reject(o):Promise.resolve({sell:{sold_for:t.sell_price}})}))})),r=["NoOpenPosition","InvalidSellContractProposal","UnrecognisedRequest"];return this.options.timeMachineEnabled?B(n,((e,t)=>t().then((()=>this.observer.emit("REVERT","during")))),r,e++).then((e=>o(e))):T(n,r).then((e=>o(e)))}))}};function Ge(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function We(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(o),!0).forEach((function(t){Ye(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Ge(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Ye(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const qe={scope:Se,proposalsReady:!1},Ke=(e=qe,t)=>{switch(t.type){case Te:return{scope:ge,proposalsReady:e.proposalsReady};case be:return We(We({},e),{},{proposalsReady:!0});case ke:return We(We({},e),{},{proposalsReady:!1});case ve:return{scope:fe,openContract:!1,proposalsReady:e.proposalsReady};case Ee:return{scope:fe,openContract:!0,proposalsReady:e.proposalsReady};case Be:return{scope:Se,proposalsReady:e.proposalsReady};case Oe:return We(We({},e),{},{newTick:t.payload});default:return e}};let Xe;const Ze=e=>class extends e{watchTicks(e){if(e&&this.symbol!==e){const{ticksService:t}=this.$scope;t.stopMonitor({symbol:e,key:Xe});const o=e=>{this.checkProposalReady();const t=e.slice(-1)[0],{epoch:o}=t;this.store.dispatch({type:Oe,payload:o})},i=t.monitor({symbol:e,callback:o});this.symbol=e,Xe=i}}getTicks(e=!1){return new Promise((t=>{this.$scope.ticksService.request({symbol:this.symbol}).then((o=>{const i=this.getPipSize(),n=o.map((t=>e?t.quote.toFixed(i):t.quote));t(n)}))}))}getLastTick(e,t=!1){return new Promise((o=>this.$scope.ticksService.request({symbol:this.symbol}).then((i=>{let n=e?(0,g.CT)(i):(0,g.CT)(i).quote;t&&!e&&(n=n.toFixed(this.getPipSize())),o(n)})).catch((e=>{"MarketIsClosed"===e.code&&(p.P.emit("Error",e),o(e.code))}))))}getLastDigit(){return new Promise((e=>this.getLastTick().then((t=>e(E(t,this.getPipSize()))))))}getLastDigitList(){return new Promise((e=>this.getTicks().then((t=>e(t.map((e=>E(e,this.getPipSize()))))))))}checkDirection(e){return new Promise((t=>this.$scope.ticksService.request({symbol:this.symbol}).then((o=>t((e=>{const{length:t}=e,[o,i]=e.slice(-2);let n="";return t>=2&&(n=o.quote<i.quote?"rise":n,n=o.quote>i.quote?"fall":n),n})(o)===e)))))}getOhlc(e){const{granularity:t=this.options.candleInterval||60,field:o}=e||{};return new Promise((e=>this.$scope.ticksService.request({symbol:this.symbol,granularity:t}).then((t=>e(o?t.map((e=>e[o])):t)))))}getOhlcFromEnd(e){const{index:t=1}=e||{},o=((e,t)=>{if(!M(e))throw P("PositiveIntegerExpected",t);return e})(Number(t),(0,i.localize)("Index must be a positive integer"));return new Promise((t=>this.getOhlc(e).then((e=>t(e.slice(-o)[0])))))}getPipSize(){return this.$scope.ticksService.pipSizes[this.symbol]}};function Qe(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function et(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(o),!0).forEach((function(t){tt(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Qe(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function tt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const ot={totalProfit:0,totalWins:0,totalLosses:0,totalStake:0,totalPayout:0,totalRuns:0},it={},nt=e=>class extends e{constructor(){super(),this.sessionRuns=0,this.sessionProfit=0,p.P.register("statistics.clear",this.clearStatistics.bind(this))}clearStatistics(){if(this.sessionRuns=0,this.sessionProfit=0,!this.accountInfo)return;const{loginid:e}=this.accountInfo;it[e]=et({},ot)}updateTotals(e){const{sell_price:t,buy_price:o,currency:i}=e,n=(0,y.getRoundedNumber)(Number(t)-Number(o),i),r=n>0,a=this.getAccountStat();a.totalWins+=r?1:0,a.totalLosses+=r?0:1,this.sessionProfit=(0,y.getRoundedNumber)(Number(this.sessionProfit)+Number(n),i),a.totalProfit=(0,y.getRoundedNumber)(Number(a.totalProfit)+Number(n),i),a.totalStake=(0,y.getRoundedNumber)(Number(a.totalStake)+Number(o),i),a.totalPayout=(0,y.getRoundedNumber)(Number(a.totalPayout)+Number(t),i),b({profit:n,contract:e,accountID:this.accountInfo.loginid,totalProfit:a.totalProfit,totalWins:a.totalWins,totalLosses:a.totalLosses,totalStake:a.totalStake,totalPayout:a.totalPayout}),k(r?s.F$.PROFIT:s.F$.LOST,{currency:i,profit:n})}updateAndReturnTotalRuns(){return this.sessionRuns++,++this.getAccountStat().totalRuns}getTotalRuns(){return this.getAccountStat().totalRuns}getTotalProfit(e,t){const o=this.getAccountStat();return e&&0!==o.totalProfit?(0,y.getRoundedNumber)(+o.totalProfit,t):+o.totalProfit}checkLimits(e){if(!e.limitations)return;const{limitations:{maxLoss:t,maxTrades:o}}=e;if(t&&o){if(this.sessionRuns>=o)throw P("CustomLimitsReached",(0,i.localize)("Maximum number of trades reached"));if(this.sessionProfit<=-t)throw P("CustomLimitsReached",(0,i.localize)("Maximum loss amount reached"))}}getAccountStat(){const{loginid:e}=this.accountInfo;return e in it||(it[e]=et({},ot)),it[e]}};function rt(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function at(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?rt(Object(o),!0).forEach((function(t){lt(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):rt(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function lt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}let st;const ct=({store:e,stopScope:t,passScope:o,passFlag:i})=>e.getState().scope===t?Promise.resolve(!1):new Promise((n=>{const r=e.subscribe((()=>{const a=e.getState();a.newTick!==st&&(st=a.newTick,a.scope===o&&a[i]&&(r(),n(!0)),a.scope===t&&(r(),n(!1)))}))}));class ut extends(_e(je($e(xe(Me(Ze(nt(class{})))))))){constructor(e){super(),this.api=e.api,this.observer=e.observer,this.$scope=e,this.observe(),this.data={contract:{},proposals:[],forget_proposal_ids:[]},this.store=(0,ye.MT)(Ke,(0,ye.md)(me.Z))}init(...e){const[t,o]=(e=>{const[t,o]=e;if(!t)throw P("LoginError",(0,i.localize)("Please login"));return(e=>{const{symbol:t,contractTypes:o}=e;if(!t)throw P("OptionError",(0,i.localize)("Underlying market is not selected"));if(!o[0])throw P("OptionError",(0,i.localize)("Contract type is not selected"))})(o),e})(e),{symbol:n}=o;this.initArgs=e,this.options=o,this.startPromise=this.loginAndGetBalance(t),this.watchTicks(n)}start(e){if(!this.options)throw P("NotInitialized",(0,i.localize)("Bot.init is not called"));p.P.emit("bot.running"),this.tradeOptions=e,this.store.dispatch(((e,t)=>Ie({dispatch:e,getState:t,data:{type:Te},scope:Se}))),this.checkLimits(e),this.makeProposals(at(at({},this.options),e)),this.checkProposalReady()}loginAndGetBalance(e){return this.token===e?Promise.resolve():(T((()=>this.api.authorize(e))).catch((e=>{this.$scope.observer.emit("Error",e)})),new Promise((t=>{this.api.onMessage().subscribe((({data:o})=>{"transaction"===o.msg_type&&"sell"===o.transaction.action&&(this.transaction_recovery_timeout=setTimeout((()=>{const{contract:e}=this.data,t=e.contract_id===o.transaction.contract_id,i="open"===e.status;t&&i&&T((()=>{this.api.send({proposal_open_contract:1,contract_id:e.contract_id})}),["PriceMoved"])}),1500)),"authorize"===o.msg_type&&(this.accountInfo=o,this.token=e,document?T((()=>this.api.send({balance:1,subscribe:1}))).then((e=>{this.balance=Number(e.balance.balance),t()})):t(),T((()=>this.api.send({transaction:1,subscribe:1}))))}))})))}observe(){this.observeOpenContract(),this.observeBalance(),this.observeProposals()}watch(e){return"before"===e?(t=this.store,ct({store:t,stopScope:fe,passScope:ge,passFlag:"proposalsReady"})):(e=>ct({store:e,stopScope:Se,passScope:fe,passFlag:"openContract"}))(this.store);var t}}function pt(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function dt(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(o),!0).forEach((function(t){yt(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):pt(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function yt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class mt extends(de(x(class{}))){constructor(e){super(),this.tradeEngine=new ut(e),this.api=e.api,this.observer=e.observer,this.$scope=e}getInterface(e="Global"){return"Bot"===e?dt(dt({},this.getBotInterface()),this.getToolsInterface()):{watch:(...e)=>this.tradeEngine.watch(...e),sleep:(...e)=>this.sleep(...e),alert:(...e)=>alert(...e),prompt:(...e)=>prompt(...e),console:{log(...e){console.log((new Date).toLocaleTimeString(),...e)}}}}getBotInterface(){const e=e=>(e=>{const{sell_price:t,buy_price:o,currency:i}=e,n=(0,y.getRoundedNumber)(t-o,i),r=n<0?"loss":"win";return[e.transaction_ids.buy,+e.buy_price,+e.sell_price,n,e.contract_type,(0,y.formatTime)(parseInt(`${e.entry_tick_time}000`),"HH:mm:ss"),+e.entry_tick,(0,y.formatTime)(parseInt(`${e.exit_tick_time}000`),"HH:mm:ss"),+e.exit_tick,+(e.barrier?e.barrier:0),r]})(this.tradeEngine.data.contract)[e];return{init:(...e)=>this.tradeEngine.init(...e),start:(...e)=>this.tradeEngine.start(...e),stop:(...e)=>this.tradeEngine.stop(...e),purchase:e=>this.tradeEngine.purchase(e),getAskPrice:e=>Number(this.getProposal(e).ask_price),getPayout:e=>Number(this.getProposal(e).payout),getPurchaseReference:()=>this.tradeEngine.getPurchaseReference(),isSellAvailable:()=>this.tradeEngine.isSellAtMarketAvailable(),sellAtMarket:()=>this.tradeEngine.sellAtMarket(),getSellPrice:()=>this.getSellPrice(),isResult:t=>e(10)===t,isTradeAgain:e=>p.P.emit("bot.trade_again",e),readDetails:t=>e(t-1)}}sleep(e=1){return new Promise((t=>setTimeout((()=>{t(),setTimeout((()=>this.observer.emit("CONTINUE")),0)}),1e3*e)),(()=>{}))}getProposal(e){return this.tradeEngine.data.proposals.find((t=>t.contract_type===e&&t.purchase_reference===this.tradeEngine.getPurchaseReference()))}getSellPrice(){return this.tradeEngine.getSellPrice()}}h().prototype.takeStateSnapshot=function(){return(0,y.cloneThorough)(this.stateStack,void 0,void 0,void 0,!0)},h().prototype.restoreStateSnapshot=function(e){this.stateStack=(0,y.cloneThorough)(e,void 0,void 0,void 0,!0),this.global=this.stateStack[0].scope.object||this.stateStack[0].scope,this.initFunc_(this,this.global)};const ht=e=>e&&e.tradeEngine.options,_t=(e,t="")=>!s.Jr.includes(t)&&ht(e)&&e.tradeEngine.options.shouldRestartOnError;class gt{constructor(){this.init()}init(){this.$scope=(()=>{const e=new p.Z,t=(()=>{const e=`wss://${(0,y.getSocketURL)()}/websockets/v3?app_id=${(0,y.getAppId)()}&l=${(0,i.getLanguage)()}&brand=${y.website_name.toLowerCase()}`,t=new WebSocket(e);return new(N())({connection:t})})();return{observer:e,api:t,ticksService:new R(t)}})(),this.bot=new mt(this.$scope),this.stopped=!1,this.$scope.observer.register("REVERT",(e=>this.revert("before"===e?this.beforeState:this.duringState)))}run(e){const t=(e,t)=>{const o=this.bot.getInterface("Bot"),i=this.bot.getTicksInterface(),{alert:n,prompt:r,sleep:a,console:l}=this.bot.getInterface();e.setProperty(t,"console",e.nativeToPseudo(l)),e.setProperty(t,"alert",e.nativeToPseudo(n)),e.setProperty(t,"prompt",e.nativeToPseudo(r)),e.setProperty(t,"getPurchaseReference",e.nativeToPseudo(o.getPurchaseReference));const s=e.nativeToPseudo(o);Object.entries(i).forEach((([t,o])=>e.setProperty(s,t,this.createAsync(e,o)))),e.setProperty(s,"start",e.nativeToPseudo(((...t)=>{const{start:i}=o;_t(this.bot)&&(this.startState=e.takeStateSnapshot()),i(...t)}))),e.setProperty(s,"purchase",this.createAsync(e,o.purchase)),e.setProperty(s,"sellAtMarket",this.createAsync(e,o.sellAtMarket)),e.setProperty(t,"Bot",s),e.setProperty(t,"watch",this.createAsync(e,(e=>{const{watch:t}=this.bot.getInterface();if(o=this.bot,ht(o)&&o.tradeEngine.options.timeMachineEnabled){const t=this.interpreter.takeStateSnapshot();"before"===e?this.beforeState=t:this.duringState=t}var o;return t(e)}))),e.setProperty(t,"sleep",this.createAsync(e,a))};return new Promise(((o,i)=>{const n=e=>{if(this.stopped)return;if("InvalidToken"===e.code)return void p.P.emit("client.invalid_token");if(((e,t="")=>!(!["SellNotAvailableCustom","ContractCreationFailure"].includes(t)||!ht(e)))(this.bot,null==e?void 0:e.code))return p.P.emit("ui.log.error",e.message),void p.P.emit("bot.click_stop");if(this.is_error_triggered=!0,!_t(this.bot,e.code)||(t=this.bot,!ht(t)||!t.tradeEngine.tradeOptions))return void i(e);var t;p.P.emit("Error",e);const{initArgs:o,tradeOptions:r}=this.bot.tradeEngine;this.terminateSession(),this.init(),this.$scope.observer.register("Error",n),this.bot.tradeEngine.init(...o),this.bot.tradeEngine.start(r),this.revert(this.startState)};this.$scope.observer.register("Error",n),this.interpreter=new(h())(e,t),this.onFinish=o,this.loop()}))}loop(){!this.stopped&&this.interpreter.run()||this.onFinish(this.interpreter.pseudoToNative(this.interpreter.value))}revert(e){this.interpreter.restoreStateSnapshot(e),this.interpreter.paused_=!1,this.loop()}terminateSession(){const{connection:e}=this.$scope.api;0===e.readyState?e.addEventListener("open",(()=>e.close())):1===e.readyState&&e.close(),this.stopped=!0,this.is_error_triggered=!1,p.P.emit("bot.stop")}stop(){var e;const t=null!==(e=p.P.getState("global_timeouts"))&&void 0!==e?e:[],o=Object.keys(t).every((e=>t[e].is_cancellable));!this.bot.tradeEngine.contractId&&o?(t.forEach((e=>clearTimeout(t[e]))),this.terminateSession()):!1!==this.bot.tradeEngine.isSold||this.is_error_triggered?this.terminateSession():p.P.register("contract.status",(e=>{"contract.sold"===e.id&&this.terminateSession()}))}createAsync(e,t){const o=(...o)=>{const i=o.pop(),n=o.slice().reverse(),r=n.findIndex((e=>void 0!==e)),a=r<0?[]:n.slice(r).reverse();t(...a.map((t=>e.pseudoToNative(t)))).then((t=>{i(e.nativeToPseudo(t)),this.loop()})).catch((e=>{this.$scope.observer.emit("Error",e.error||e)}))};return Object.defineProperty(o,"length",{value:101}),e.createAsyncFunction(o)}hasStarted(){return!this.stopped}}class ft{constructor(){this.interpreter=null,this.workspace=null,this.before_run_funcs=[]}async initWorkspace(e,t,i,s){const p=await(0,u.WN)();return new Promise(((y,m)=>{o.p=e,d.Z.setInstance(i),a.Z.setInstance(t);const h=window.innerWidth;try{let e=.8;const{handleFileChange:t}=a.Z.instance;h<1640&&(e=s?.7:document.getElementById("scratch_div").offsetWidth/h/1.5);const i=document.getElementById("scratch_div");this.workspace=Blockly.inject(i,{grid:{spacing:40,length:11,colour:"#f3f3f3"},media:`${o.p}media/`,trashcan:!s,zoom:{wheel:!0,startScale:e},scrollbars:!0}),this.workspace.cached_xml={main:r},this.workspace.save_workspace_interval=setInterval((async()=>{await(0,u.l5)(Blockly.Xml.workspaceToDom(this.workspace),c.R.UNSAVED)}),1e4),this.workspace.addChangeListener(this.valueInputLimitationsListener.bind(this)),this.workspace.addChangeListener((e=>(0,n.P_)(this.workspace,e))),this.workspace.addChangeListener((e=>this.workspace.dispatchBlockEventEffects(e))),Blockly.derivWorkspace=this.workspace,this.addBeforeRunFunction(this.unselectBlocks.bind(this)),this.addBeforeRunFunction(this.disableStrayBlocks.bind(this)),this.addBeforeRunFunction(this.checkForErroredBlocks.bind(this)),this.addBeforeRunFunction(this.checkForRequiredBlocks.bind(this)),this.workspace.current_strategy_id=Blockly.utils.genUid(),Blockly.derivWorkspace.strategy_to_load=r;let d=l.v.default_file_name;if(p&&p.length){const e=p[0];Blockly.derivWorkspace.strategy_to_load=e.xml,d=e.name,Blockly.derivWorkspace.current_strategy_id=e.id}const m=`dbot-load${Date.now()}`;Blockly.Events.setGroup(m),Blockly.Xml.domToWorkspace(Blockly.Xml.textToDom(Blockly.derivWorkspace.strategy_to_load),this.workspace);const{save_modal:_}=a.Z.instance;_.updateBotName(d),this.workspace.cleanUp(),this.workspace.clearUndo(),window.dispatchEvent(new Event("resize")),window.addEventListener("dragover",ft.handleDragOver),window.addEventListener("drop",(e=>ft.handleDropOver(e,t))),i.parentNode.style.overflow="hidden",y()}catch(e){throw m(e),e}}))}addBeforeRunFunction(e){this.before_run_funcs.push(e)}shouldRunBot(){return this.before_run_funcs.every((e=>!!e()))}runBot(){try{const e=this.generateCode();null!==this.interpreter&&(this.interpreter=null),this.interpreter=new gt,this.interpreter.run(e).catch((e=>{p.P.emit("Error",e),this.stopBot()}))}catch(e){p.P.emit("Error",e),this.interpreter&&this.stopBot()}}generateCode(e={}){return`\n            var BinaryBotPrivateInit;\n            var BinaryBotPrivateStart;\n            var BinaryBotPrivateBeforePurchase; \n            var BinaryBotPrivateDuringPurchase;\n            var BinaryBotPrivateAfterPurchase;\n            var BinaryBotPrivateLastTickTime;\n            var BinaryBotPrivateTickAnalysisList = [];\n            var BinaryBotPrivateHasCalledTradeOptions = false;\n            function BinaryBotPrivateRun(f, arg) {\n                if (f) return f(arg);\n                return false;\n            }\n            function BinaryBotPrivateTickAnalysis() {\n                var currentTickTime = Bot.getLastTick(true);\n                while (currentTickTime === 'MarketIsClosed') {\n                    sleep(5);\n                    currentTickTime = Bot.getLastTick(true);\n                }\n                currentTickTime = currentTickTime.epoch;\n                if (currentTickTime === BinaryBotPrivateLastTickTime) {\n                    return;\n                }\n                BinaryBotPrivateLastTickTime = currentTickTime;\n                for (var BinaryBotPrivateI = 0; BinaryBotPrivateI < BinaryBotPrivateTickAnalysisList.length; BinaryBotPrivateI++) {\n                    BinaryBotPrivateRun(BinaryBotPrivateTickAnalysisList[BinaryBotPrivateI]);\n                }\n            }\n            var BinaryBotPrivateLimitations = ${JSON.stringify(e)};\n            ${Blockly.JavaScript.workspaceToCode(this.workspace)}\n            BinaryBotPrivateRun(BinaryBotPrivateInit);\n            while (true) {\n                BinaryBotPrivateTickAnalysis();\n                BinaryBotPrivateRun(BinaryBotPrivateStart);\n                if (!BinaryBotPrivateHasCalledTradeOptions) {\n                    sleep(1);\n                    continue;\n                }\n                while (watch('before')) {\n                    BinaryBotPrivateTickAnalysis();\n                    BinaryBotPrivateRun(BinaryBotPrivateBeforePurchase);\n                }\n                while (watch('during')) {\n                    BinaryBotPrivateTickAnalysis();\n                    BinaryBotPrivateRun(BinaryBotPrivateDuringPurchase);\n                }\n                BinaryBotPrivateTickAnalysis();\n                if (!BinaryBotPrivateRun(BinaryBotPrivateAfterPurchase)) {\n                    break;\n                }\n            }`}stopBot(){this.interpreter&&this.interpreter.stop()}terminateBot(){this.interpreter&&(this.interpreter.terminateSession(),this.interpreter=null)}unselectBlocks(){return Blockly.selected&&Blockly.selected.unselect(),!0}disableStrayBlocks(){return this.workspace.getTopBlocks().forEach((e=>{e.isMainBlock()||e.isIndependentBlock()||e.setDisabled(!0)})),!0}checkForErroredBlocks(){this.valueInputLimitationsListener({},!0);const e=this.workspace.getAllBlocks(!0).filter((e=>e.is_error_highlighted&&!e.disabled)).filter(((e,t,o)=>t===o.findIndex((t=>t.error_message===e.error_message))));return!e.length||(this.workspace.centerOnBlock(e[0].id),e.forEach((e=>{p.P.emit("ui.log.error",e.error_message)})),!1)}centerAndHighlightBlock(e,t=!1){const o=this.workspace.getBlockById(e);o&&(this.workspace.getAllBlocks().forEach((e=>e.setErrorHighlighted(!1))),t&&o.blink(),o.setErrorHighlighted(!0),this.workspace.centerOnBlock(o.id))}unHighlightAllBlocks(){var e;null===(e=this.workspace)||void 0===e||e.getAllBlocks().forEach((e=>e.setErrorHighlighted(!1)))}checkForRequiredBlocks(){let e;return(0,n.tp)(this.workspace)||(e=new Error((0,i.localize)("One or more mandatory blocks are missing from your workspace. Please add the required block(s) and then try again."))),(0,n.nf)(this.workspace)||(e=new Error((0,i.localize)("One or more mandatory blocks are disabled in your workspace. Please enable the required block(s) and then try again."))),!e||(p.P.emit("Error",e),!1)}valueInputLimitationsListener(e,t=!1){(t||this.workspace&&!this.workspace.isDragging())&&(Blockly.JavaScript.init(this.workspace),t&&Blockly.hideChaff(!1),this.workspace.getAllBlocks(!0).forEach((o=>{if(t||e.type===Blockly.Events.END_DRAG||e.type===Blockly.Events.BLOCK_DELETE||e.type===Blockly.Events.BLOCK_CREATE||e.type===Blockly.Events.UI&&("click"===e.element||"selected"===e.element)||(i=o,e.type===Blockly.Events.BLOCK_CHANGE&&e.blockId===i.id)||(t=>e.type===Blockly.Events.BLOCK_CHANGE&&t.inputList.some((t=>{if(t.connection){const o=t.connection.targetBlock();return o&&e.blockId===o.id}return!1})))(o)||(t=>{if(e.type===Blockly.Events.BLOCK_CHANGE&&"disabled"===e.element){let o=t.getParent();for(;null!==o;){if(o.id===e.blockId)return!0;o=o.getParent()}}return!1})(o)){if(o.disabled){const e=t=>{t.forEach((t=>{t.setErrorHighlighted(!1),e(t.getChildren())}))};return void e([o])}if(!o.getRequiredValueInputs)return;const e=o.getRequiredValueInputs(),i=Object.keys(e).some((t=>{const i=Blockly.selected===o,n=o.disabled||o.getInheritedDisabled();if(i||n)return!1;if(o.isCollapsed()&&o.hasErrorHighlightedDescendant())return!0;const r=o.getInput(t);if(r||o.domToMutation){if(r.connection){const i=Blockly.JavaScript.ORDER_ATOMIC,n=Blockly.JavaScript.valueToCode(o,t,i),r=e[t];return"function"==typeof r?!!r(n):!n}}else console.warn("Detected a non-existent required input.",{input_name:t,type:o.type});return!0}));if(i&&o.removeSelect(),o.setErrorHighlighted(i,o.error_message||void 0),t&&(o.is_error_highlighted||o.hasErrorHighlightedDescendant())){let e=o;for(;e;)e.setCollapsed(!1),e=e.getParent()}}var i})))}static handleDragOver(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}static handleDropOver(e,t){const o=document.getElementById("scratch_div"),i=document.getElementById("load-strategy__local-dropzone-area");o.contains(e.target)?t(e):i&&i.contains(e.target)?t(e,!1):(e.stopPropagation(),e.preventDefault(),e.dataTransfer.effectAllowed="none",e.dataTransfer.dropEffect="none")}}const bt=new ft,kt={text:[(0,i.localize)("This block is mandatory. Here is where you can decide if your bot should continue trading. Only one copy of this block is allowed."),(0,i.localize)("This block is commonly used to adjust the parameters of your next trade and to implement stop loss/take profit logic.")]},vt={text:[(0,i.localize)("This block returns current account balance."),(0,i.localize)('The only input parameter determines how block output is going to be formatted. In case if the input parameter is "string" then the account currency will be added.'),(0,i.localize)("Example output of the below example will be:"),(0,i.localize)('1. for "string": 1325.68 USD'),(0,i.localize)('2. for "number": 1325.68')]},Et={text:[(0,i.localize)("This block is mandatory. Only one copy of this block is allowed. It is added to the canvas by default when you open DBot."),(0,i.localize)("After defining trade parameters and trade options, you may want to instruct your bot to purchase contracts when specific conditions are met. To do that you can use conditional blocks and indicators blocks to help your bot to make decisions.")]},Bt={text:[(0,i.localize)('This block is used to determine if the market price moves in the selected direction or not. It gives you a value of "True" or "False".'),(0,i.localize)("Examples:"),(0,i.localize)('1. If the selected direction is "Rise", and the previous tick value is less than the current tick value, the output will be "True". Otherwise, the output will be an empty string.'),(0,i.localize)('2. If the selected direction is "Fall", and the previous tick value is more than the current tick value, the output will be "True". Otherwise, the output will be an empty string.')]},Tt={text:[(0,i.localize)("This block displays messages in the developer’s console with an input that can be either a string of text, a number, boolean, or an array of data."),(0,i.localize)("There are 4 message types:"),(0,i.localize)("1. 'Log' displays a regular message."),(0,i.localize)("2. 'Warn' displays a message in yellow to highlight something that needs attention."),(0,i.localize)("3. 'Error' displays a message in red to highlight something that needs to be resolved immediately."),(0,i.localize)("4. 'Table' takes an array of data, such as a list of candles, and displays it in a table format.")]},St={text:[(0,i.localize)('You can check the result of the last trade with this block. It can only be placed within the "Restart trading conditions" root block.'),(0,i.localize)('If "Win" is selected, it will return "True" if your last trade was successful. Otherwise, it will return an empty string.'),(0,i.localize)('If "Loss" is selected, it will return "True" if your last trade was unsuccessful. Otherwise, it will return an empty string.'),(0,i.localize)("Example:")]},Ot={text:[(0,i.localize)("This block is used to either terminate or continue a loop, and can be placed anywhere within a loop block."),(0,i.localize)("Examples:"),(0,i.localize)('1. In the below example the loop is terminated in case "x" is "False" even though only one iteration is complete'),(0,i.localize)('2. In the below example the loop jumps to the next iteration without executing below block in case if "x" is "False"')]},Ct={text:[(0,i.localize)('This block uses the variable "i" to control the iterations. With each iteration, the value of "i" is determined by the items in a given list.'),(0,i.localize)("Example:"),(0,i.localize)('"i" starts with the value of 1, and it will be increased by 2 at every iteration. The loop will repeat until "i" reaches the value of 12, and then the loop is terminated.'),(0,i.localize)('You can use "i" inside the loop, for example to access list items')]},wt={text:[(0,i.localize)('This block uses the variable "i" to control the iterations. With each iteration, the value of "i" is determined by the items in a given list.'),(0,i.localize)("Example:"),(0,i.localize)('In this example, the loop will repeat three times, as that is the number of items in the given list. During each iteration, the variable "i" will be assigned a value from the list. '),(0,i.localize)('Please note that changing the value of "i" won\'t change the value of the original item in the list')]},At={text:[(0,i.localize)("This block evaluates a statement and will perform an action only when the statement is true."),(0,i.localize)("Click the plus icon to extend the functionality of this block."),(0,i.localize)('You can also use "Compare" and "Logic operation" blocks to make test variables.')]},It={text:[(0,i.localize)("This block repeats instructions as long as a given condition is true."),(0,i.localize)("Examples:"),(0,i.localize)("1. In the example below, the instructions are repeated as long as the value of x is less than or equal to 10. Once the value of x exceeds 10, the loop is terminated."),(0,i.localize)("2. In this example, the instructions are repeated as long as the value of x is greater than or equal to 10. Once the value of x drops below 10, the loop is terminated.")]},Rt={text:[(0,i.localize)("Here is where you can decide to sell your contract before it expires. Only one copy of this block is allowed."),(0,i.localize)("Example:")]},Dt={text:[(0,i.localize)('"Seconds Since Epoch" block returns the number of seconds since January 1st, 1970.'),(0,i.localize)("Example:"),(0,i.localize)("1551661986 seconds since Jan 01 1970 (UTC) translates to 03/04/2019 @ 1:13am (UTC)."),(0,i.localize)("You might need it when you want to repeat an actions after certain amount of time."),(0,i.localize)("The example below restarts trading after 30 or more seconds after 1 minute candle was started.")]},Nt={text:[(0,i.localize)("This block gives you a specific candle from within the selected time interval."),(0,i.localize)('In this example, the open price of a candle is assigned to the variable "candle_open_price".'),(0,i.localize)("In the above example it is assumed that variable candle_open_price is processed somewhere within other blocks.")]},xt={text:[(0,i.localize)('This block returns "True" if the last candle is black. It can be placed anywhere on the canvas except within the Trade parameters root block.'),(0,i.localize)('The term "candle" refers to each bar on the candlestick chart. Each candle represents four market prices for the selected time interval:'),(0,i.localize)("Each candlestick on the chart represents 4 market prices for the selected time interval:"),(0,i.localize)("- Open price: the opening price"),(0,i.localize)("- High price: the highest price"),(0,i.localize)("- Low price: the lowest price"),(0,i.localize)("- Close price: the closing price"),(0,i.localize)("A black (or red) candle indicates that the open price is higher than the close price. This represents a downward movement of the market price."),(0,i.localize)("A white (or green) candle indicates that the open price is lower than the close price. This represents an upward movement of the market price."),(0,i.localize)("The time interval for each candle can be set from one minute to one day.")]},Pt={text:[(0,i.localize)("This block gives you the last digit of the latest tick value of the selected market. If the latest tick value is 1410.90, this block will return 0. It’s useful for digit-based contracts such as Even/Odd, Matches/Differs, or Higher/Lower.")]},zt={text:[(0,i.localize)('This block performs the "AND" or the "OR" logic operation with the given values.'),(0,i.localize)('In case if the "AND" operation is selected, the block returns "True" only if both given values are "True"'),(0,i.localize)('In case if the "OR" operation is selected, the block returns "True" in case if one or both given values are "True"')]},Lt={text:[(0,i.localize)("This block performs arithmetic operations between two numbers."),(0,i.localize)("Available operations:"),(0,i.localize)("- Addition"),(0,i.localize)("- Subtraction"),(0,i.localize)("- Multiplication"),(0,i.localize)("- Division"),(0,i.localize)("- Raise the first number to the power of the second number")]},Mt={text:[(0,i.localize)("This block constrains a given number within a set range."),(0,i.localize)("In case if the given number is less than the lower boundary of the range, the block returns the lower boundary value. Similarly, if the given number is greater than the higher boundary, the block will return the higher boundary value. In case if the given value is between boundaries, the block will return the given value unchanged."),(0,i.localize)("In the below example the block returns the value of 10 as the given value (5) is less than the lower boundary (10)")]},Ft={text:[(0,i.localize)("This block performs the following operations to a given number"),(0,i.localize)("Available operations are:"),(0,i.localize)("- Square root"),(0,i.localize)("- Absolute"),(0,i.localize)("- Negation"),(0,i.localize)("- Natural log"),(0,i.localize)("- Euler’s number (2.71) to the power of a given number"),(0,i.localize)("- 10 to the power of a given number")]},Ut={text:[(0,i.localize)("This block sends a message to a Telegram channel. You will need to create your own Telegram bot to use this block."),(0,i.localize)("Here’s how:"),(0,i.localize)("1. Create a Telegram bot and get your Telegram API token. Read more on how to create bots in Telegram here: https://core.telegram.org/bots#6-botfather"),(0,i.localize)("2. Start a chat with your newly created Telegram bot and make sure to send it some messages before proceeding to the next step. (e.g. Hello Bot!)"),(0,i.localize)("3. Get the chat ID using the Telegram REST API (read more: https://core.telegram.org/bots/api#getupdates)"),(0,i.localize)("- Visit the following URL, make sure to replace <access_token> with the Telegram API token you created in Step 1: https://api.telegram.org/bot<access_token>/getUpdates"),(0,i.localize)("- Find the chat ID property in the response, and copy the value of the id property"),(0,i.localize)("4. Come back to DBot and add the Notify Telegram block to the workspace. Paste the Telegram API token and chat ID into the block fields accordingly.")]},jt={text:[(0,i.localize)("This block gives you a list of candles within a selected time interval."),(0,i.localize)('In this example, this block is used with another block to get the open prices from a list of candles. The open prices are then assigned to the variable called "cl".')]},Vt={text:[(0,i.localize)("This block gives you the selected candle value from a list of candles within the selected time interval. You can choose from open price, close price, high price, low price, and open time."),(0,i.localize)('In this example, the open prices from a list of candles are assigned to a variable called "candle_list".')]},Jt={text:[(0,i.localize)("This block gives you the selected candle value from a list of candles. You can choose from open price, close price, high price, low price, and open time."),(0,i.localize)("This block requires a list of candles as an input parameter."),(0,i.localize)('In this example, the open prices from a list of candles are assigned to a variable called "cl".')]},Ht={text:[(0,i.localize)("Used within a function block, this block returns a value when a specific condition is true."),(0,i.localize)("Example:")]},$t={text:[(0,i.localize)("This block gives you information about your last contract."),(0,i.localize)("You can choose to see one of the following:"),(0,i.localize)("- Deal reference ID: the reference ID of the contract"),(0,i.localize)("- Purchase price: the purchase price (stake) of the contract"),(0,i.localize)("- Payout: the payout of the contract"),(0,i.localize)("- Profit: the profit you’ve earned"),(0,i.localize)("- Contract type: the name of the contract type such as Rise, Fall, Touch, No Touch, etс."),(0,i.localize)("- Entry time: the starting time of the contract"),(0,i.localize)("- Entry value: the value of the first tick of the contract"),(0,i.localize)("- Exit time: the contract expiration time"),(0,i.localize)("- Exit value: the value of the last tick of the contract"),(0,i.localize)("- Barrier: the barrier value of the contract (applicable to barrier-based trade types such as stays in/out, touch/no touch, etc.)"),(0,i.localize)('- Result: the result of the last contract: "win" or "loss"')]},Gt={text:[(0,i.localize)("This block gives you the specified candle value for a selected time interval. You can choose which value you want:"),(0,i.localize)("- Open: the opening price"),(0,i.localize)("- High: the highest price"),(0,i.localize)("- Low: the lowest price"),(0,i.localize)("- Close: the closing price"),(0,i.localize)("- Open time: the opening time stamp"),(0,i.localize)('In the example below, the opening price is selected, which is then assigned to a variable called "op".')]},Wt={text:[(0,i.localize)("This block gives you the selected candle value such as open price, close price, high price, low price, and open time. It requires a candle as an input parameter."),(0,i.localize)('In the example below, the open price is assigned to the variable "op".')]},Yt={text:[(0,i.localize)("Use this block to sell your contract at the market price. Selling your contract is optional. You may choose to sell if the market trend is unfavourable."),(0,i.localize)("Example:")]},qt={text:[(0,i.localize)('This block gives you the potential profit or loss if you decide to sell your contract. It can only be used within the "Sell conditions" root block.'),(0,i.localize)("In the example below, the contract will only be sold if the potential profit or loss is more than the stake.")]},Kt={text:[(0,i.localize)("SMA adds the market price in a list of ticks or candles for a number of time periods, and divides the sum by that number of time periods."),(0,i.localize)("The formula for SMA is:"),(0,i.localize)("where n is the number of periods."),"",(0,i.localize)("What SMA tells you"),(0,i.localize)("SMA serves as an indicator of the trend. If the SMA points up then the market price is increasing and vice versa. The larger the period number, the smoother SMA line is."),(0,i.localize)("In this example, each point of the SMA line is an arithmetic average of close prices for the last 10 days."),(0,i.localize)("In this example, each point of the SMA line is an arithmetic average of close prices for the last 50 days."),"",(0,i.localize)("How to use the SMA block"),(0,i.localize)("Input list accepts a list of ticks or candles, while period is the specified time period."),(0,i.localize)("Example:"),(0,i.localize)("This will display the SMA for the specified period, using a candle list."),(0,i.localize)("SMA places equal weight to the entire distribution of values."),(0,i.localize)("This is the same as the above example, using a tick list."),(0,i.localize)("You may compare SMA values calculated on every bot run to identify the market trend direction. Alternatively, you may also use a variation of the SMA block, the Simple Moving Average Array block. "),(0,i.localize)("This block returns the entire SMA line, containing a list of all values for a given period."),(0,i.localize)("If a period of 10 is entered, the Simple Moving Average Array block will return a list of SMA values calculated based on period of 10."),(0,i.localize)("The below image illustrates how Simple Moving Average Array block works:")]},Xt={text:[(0,i.localize)('This block displays a dialog box with a customised message. When the dialog box is displayed, your strategy is paused and will only resume after you click "OK".')]},Zt={text:[(0,i.localize)('This block displays a dialog box that uses a customised message to prompt for an input. The input can be either a string of text or a number and can be assigned to a variable. When the dialog box is displayed, your strategy is paused and will only resume after you enter a response and click "OK".')]},Qt={text:[(0,i.localize)("Any blocks placed within this block will be executed at every tick. If the default candle interval is set to 1 minute in the Trade Parameters root block, the instructions in this block will be executed once every minute. Place this block outside of any root block.")]},eo={text:[(0,i.localize)("This block converts the number of seconds since the Unix Epoch to a date and time format such as 2019-08-01 00:00:00."),(0,i.localize)("Example:"),(0,i.localize)("In this example, the date and time will be displayed in a green notification box.")]},to={text:[(0,i.localize)("This block converts the date and time to the number of seconds since the Unix Epoch (1970-01-01 00:00:00)."),(0,i.localize)("Example:"),(0,i.localize)("In this example, a Rise contract will be purchased at midnight on 1 August 2019.")]},oo={text:[(0,i.localize)("This block will transfer the control back to the Purchase conditions block, enabling you to purchase another contract without manually stopping and restarting your bot."),(0,i.localize)("Example:")]},io={text:[(0,i.localize)("This block is mandatory. It's added to your strategy by default when you create new strategy. You can not add more than one copy of this block to the canvas."),(0,i.localize)("1. Market"),(0,i.localize)("Select your desired market and asset type. For example, Forex > Major pairs > AUD/JPY"),(0,i.localize)("2. Trade Type"),(0,i.localize)("Select your desired trade type. For example, Up/Down > Rise/Fall"),(0,i.localize)("3. Contract Type"),(0,i.localize)("Choose what type of contract you want to trade. For example, for the Rise/Fall trade type you can choose one of three options: Rise, Fall, or Both. Selected option will determine available options for the Purchase block."),(0,i.localize)("4. Default Candle Interval"),(0,i.localize)("Sets the default time interval for blocks that read list of candles."),(0,i.localize)("5. Restart buy/sell on error"),(0,i.localize)("Restarts the bot when an error is encountered."),(0,i.localize)("6. Restart last trade on error"),(0,i.localize)("Repeats the previous trade when an error is encountered."),(0,i.localize)("7. Run Once at Start"),(0,i.localize)("Place blocks here to perform tasks once when your bot starts running."),(0,i.localize)("8. Trade Options"),(0,i.localize)("The desired duration, stake, prediction, and/or barrier(s) for the contract is defined here.")]},no={text:[(0,i.localize)("This block is used to define trade options within the Trade parameters root block. Some options are only applicable for certain trade types. Parameters such as duration and stake are common among most trade types. Prediction is used for trade types such as Digits, while barrier offsets are for trade types that involve barriers such as Touch/No Touch, Ends In/Out, etc."),(0,i.localize)("Example:")]},ro={text:[(0,i.localize)("This block assigns a given value to a variable, creating the variable if it doesn't already exist."),(0,i.localize)("A variable is among the most important and powerful components in creating a bot. It is a way to store information, either as text or numbers. The information stored as a variable can be used and changed according to the given instructions. Variables can be given any name, but usually they are given useful, symbolic names so that it is easier to call them during the execution of instructions."),(0,i.localize)("Creating a variable"),(0,i.localize)("1. From the block library, enter a name for the new variable and click Create."),(0,i.localize)("2. The new variable will appear as a block under Set variable.")]};var ao=o(5401),lo=o(1408);class so{constructor(e,t){this.api=e,this.parentElement=t,this.addEvents()}addEvents(){"onLine"in navigator?(window.addEventListener("online",(()=>this.setStatus())),window.addEventListener("offline",(()=>this.setStatus()))):(navigator.onLine=!0,setInterval((()=>this.setStatus()),1e4)),this.setStatus()}setStatus(){navigator.onLine?(this.parentElement.html("<span class='connecting'></span>"),this.api.send({ping:"1"}).then((()=>{this.parentElement.html("<span class='online'></span>")}))):this.parentElement.html("<span class='offline'></span>")}}var co=o(6715);const uo=(()=>{let e=!1;const t=new co.Z;let o;return{init:i=>{e||(o=i,t.resolve(o.server_time),e=!0)},get:()=>e&&o.server_time?o.server_time.clone():void 0,timePromise:()=>e?Promise.resolve(o.server_time):t.promise}})();var po=o(4227);const yo=e=>{const{opposites:t}=l.v;let o=(0,i.localize)("Unknown");return Object.keys(t).forEach((i=>{t[i].forEach((t=>{const n=Object.entries(t)[0];if(n[0]===e.contract_type){if(["CALL","PUT"].includes(n[0])){const t=e.shortcode.split("_").slice(-2)[0],o=/^S0P$/.test(t);if(i!==(o?"CALLPUT":"HIGHERLOWER"))return}o=n[1]}}))})),o},mo=e=>new Promise(((t,o)=>{const i=document.createElement("script");i.src=e,i.async=!0,i.onload=()=>t(window.external_global_component),i.onerror=o,document.body.appendChild(i)}));var ho=o(2620);const _o=e=>{const t=new Date,o=(t.getTime()-e)/1e3;if(o<60)return(0,i.localize)("{{secondPast}}s ago",{secondPast:parseInt(o)});if(o<3600)return(0,i.localize)("{{minutePast}}m ago",{minutePast:parseInt(o/60)});if(o<=86400)return(0,i.localize)("{{hourPast}}h ago",{hourPast:parseInt(o/3600)});const n=new Date(e);return`${n.getDate()} ${n.toDateString().match(/ [a-zA-Z]*/)[0].replace(" ","")}${n.getFullYear()===t.getFullYear()?"":" "}${n.getFullYear()}`},go={TEXT:"text",VIDEO:"video",IMAGE:"image",BLOCK:"block"},{TEXT:fo,IMAGE:bo,BLOCK:ko}=go,vo=e=>(o.p=e,{procedures_ifreturn:[{type:fo},{type:ko},{type:fo},{type:bo,width:"100%",url:`${o.p}media/if-return.png`}],math_arithmetic:[{type:fo},{type:ko},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo}],math_single:[{type:fo},{type:ko},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo}],math_constrain:[{type:fo},{type:ko},{type:fo},{type:fo},{type:bo,width:"60%",url:`${o.p}media/constrain.png`}],text_print:[{type:fo},{type:ko},{type:fo}],text_prompt_ext:[{type:fo},{type:ko},{type:fo}],tick_analysis:[{type:fo},{type:ko}],read_details:[{type:fo},{type:ko},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo}],last_digit:[{type:fo},{type:ko}],read_ohlc:[{type:fo},{type:ko},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:bo,width:"100%",url:`${o.p}media/in_candle_list_read.png`}],read_ohlc_obj:[{type:fo},{type:ko},{type:fo},{type:fo},{type:bo,width:"100%",url:`${o.p}media/read_candle_value.png`}],check_direction:[{type:fo},{type:ko},{type:fo},{type:fo},{type:fo}],get_ohlc:[{type:fo},{type:ko},{type:fo},{type:bo,width:"100%",url:`${o.p}media/get_candle.png`},{type:fo}],ohlc:[{type:fo},{type:ko},{type:fo},{type:bo,width:"100%",url:`${o.p}media/candle_list_1.png`}],ohlc_values:[{type:fo},{type:ko},{type:fo},{type:bo,url:`${o.p}media/candle_list.png`}],is_candle_black:[{type:fo},{type:ko},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:bo,width:"100%",url:`${o.p}media/is_candle_black.jpeg`},{type:fo},{type:bo,width:"100%",url:`${o.p}media/is_candle_black_1.jpeg`},{type:fo}],ohlc_values_in_list:[{type:fo},{type:ko},{type:fo},{type:fo},{type:bo,width:"100%",url:`${o.p}media/candle_list_1.png`}],variables_gets:[{type:fo},{type:ko},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo}],variables_set:[{type:fo},{type:ko},{type:fo},{type:fo},{type:fo},{type:bo,width:"100%",url:`${o.p}media/create_variable.jpg`},{type:fo},{type:bo,width:"100%",url:`${o.p}media/set_variable.png`}],epoch:[{type:fo},{type:ko},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:bo,width:"100%",url:`${o.p}media/epoch.png`}],todatetime:[{type:fo},{type:ko},{type:fo},{type:bo,width:"100%",url:`${o.p}media/todatetime.png`},{type:fo}],totimestamp:[{type:fo},{type:ko},{type:fo},{type:bo,width:"100%",url:`${o.p}media/totimestamp.png`},{type:fo}],notify_telegram:[{type:fo},{type:ko},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:bo,url:`${o.p}media/notify_telegram.png`}],console:[{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo}],balance:[{type:fo},{type:ko},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo}],sma_statement:[{type:fo},{type:ko},{type:fo},{type:bo,width:"60%",url:`${o.p}media/sma_formula.png`},{type:fo},{type:fo},{type:fo},{type:fo},{type:bo,width:"100%",url:`${o.p}media/sma_chart_1.png`},{type:fo},{type:bo,width:"100%",url:`${o.p}media/sma_chart_2.png`},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:bo,width:"100%",url:`${o.p}media/sma_block_example.png`},{type:fo},{type:fo},{type:bo,width:"70%",url:`${o.p}media/sma_block_example_1.png`},{type:fo},{type:fo},{type:bo,width:"100%",url:`${o.p}media/sma_array.png`},{type:fo},{type:fo},{type:fo},{type:bo,width:"100%",url:`${o.p}media/sma_array_explanation.jpeg`}],trade_definition:[{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:fo},{type:ko}],trade_definition_tradeoptions:[{type:fo},{type:ko}],before_purchase:[{type:fo},{type:ko},{type:fo}],during_purchase:[{type:fo},{type:ko},{type:fo},{type:bo,width:"70%",url:`${o.p}media/sell_available.png`}],sell_at_market:[{type:fo},{type:ko},{type:fo},{type:bo,width:"70%",url:`${o.p}media/sell_available.png`}],after_purchase:[{type:fo},{type:ko},{type:fo}],trade_again:[{type:fo},{type:ko},{type:fo},{type:bo,width:"70%",url:`${o.p}media/trade_again.png`}],contract_check_result:[{type:fo},{type:ko},{type:fo},{type:fo},{type:bo,width:"70%",url:`${o.p}media/check_result.png`}],sell_price:[{type:fo},{type:ko},{type:fo},{type:bo,width:"70%",url:`${o.p}media/sell_pl.png`}],controls_if:[{type:fo},{type:ko},{type:fo},{type:bo,width:"70%",url:`${o.p}media/controls_if.png`},{type:fo},{type:bo,width:"40%",url:`${o.p}media/compare_logic.png`}],logic_operation:[{type:fo},{type:ko},{type:fo},{type:fo},{type:bo,width:"40%",url:`${o.p}media/logic.png`}],controls_whileUntil:[{type:fo},{type:ko},{type:fo},{type:fo},{type:bo,width:"80%",url:`${o.p}media/repeat_while.png`},{type:fo},{type:bo,width:"80%",url:`${o.p}media/repeat_until.png`}],controls_for:[{type:fo},{type:ko},{type:fo},{type:bo,width:"80%",url:`${o.p}media/controls_for.png`},{type:fo},{type:fo}],controls_forEach:[{type:fo},{type:ko},{type:fo},{type:bo,width:"80%",url:`${o.p}media/controls_forEach.png`},{type:fo},{type:fo},{type:fo}],controls_flow_statements:[{type:fo},{type:ko},{type:fo},{type:fo},{type:bo,width:"80%",url:`${o.p}media/break_out.png`},{type:fo},{type:bo,width:"80%",url:`${o.p}media/continue.png`}]})},9789:(e,t,o)=>{"use strict";o.d(t,{v:()=>r});var i=o(8429);const n=["BTC","ETH","LTC","BCH","UST"],r={lists:{PAYOUTTYPE:[[(0,i.localize)("Stake"),"stake"]],CRYPTO_CURRENCIES:n,DETAILS:[[(0,i.localize)("deal reference id"),"1"],[(0,i.localize)("purchase price"),"2"],[(0,i.localize)("payout"),"3"],[(0,i.localize)("profit"),"4"],[(0,i.localize)("contract type"),"5"],[(0,i.localize)("entry spot time"),"6"],[(0,i.localize)("entry spot price"),"7"],[(0,i.localize)("exit spot time"),"8"],[(0,i.localize)("exit spot price"),"9"],[(0,i.localize)("barrier"),"10"],[(0,i.localize)("result"),"11"]],CHECK_RESULT:[[(0,i.localize)("Win"),"win"],[(0,i.localize)("Loss"),"loss"]],CHECK_DIRECTION:[[(0,i.localize)("Rise"),"rise"],[(0,i.localize)("Fall"),"fall"],[(0,i.localize)("No Change"),""]],BALANCE_TYPE:[[(0,i.localize)("string"),"STR"],[(0,i.localize)("number"),"NUM"]],NOTIFICATION_TYPE:[[(0,i.localize)("green"),"success"],[(0,i.localize)("blue"),"info"],[(0,i.localize)("yellow"),"warn"],[(0,i.localize)("red"),"error"]],NOTIFICATION_SOUND:[[(0,i.localize)("Silent"),"silent"],[(0,i.localize)("Announcement"),"announcement"],[(0,i.localize)("Earned money"),"earned-money"],[(0,i.localize)("Job done"),"job-done"],[(0,i.localize)("Error"),"error"],[(0,i.localize)("Severe error"),"severe-error"]],CURRENCY:["USD","EUR","GBP","AUD",...n]},opposites:{CALLPUT:[{CALL:(0,i.localize)("Rise")},{PUT:(0,i.localize)("Fall")}],CALLPUTEQUAL:[{CALLE:(0,i.localize)("Rise Equals")},{PUTE:(0,i.localize)("Fall Equals")}],HIGHERLOWER:[{CALL:(0,i.localize)("Higher")},{PUT:(0,i.localize)("Lower")}],TOUCHNOTOUCH:[{ONETOUCH:(0,i.localize)("Touch")},{NOTOUCH:(0,i.localize)("No Touch")}],ENDSINOUT:[{EXPIRYRANGE:(0,i.localize)("Ends Between")},{EXPIRYMISS:(0,i.localize)("Ends Outside")}],STAYSINOUT:[{RANGE:(0,i.localize)("Stays Between")},{UPORDOWN:(0,i.localize)("Goes Outside")}],ASIANS:[{ASIANU:(0,i.localize)("Asian Up")},{ASIAND:(0,i.localize)("Asian Down")}],MATCHESDIFFERS:[{DIGITMATCH:(0,i.localize)("Matches")},{DIGITDIFF:(0,i.localize)("Differs")}],EVENODD:[{DIGITEVEN:(0,i.localize)("Even")},{DIGITODD:(0,i.localize)("Odd")}],OVERUNDER:[{DIGITOVER:(0,i.localize)("Over")},{DIGITUNDER:(0,i.localize)("Under")}],HIGHLOWTICKS:[{TICKHIGH:(0,i.localize)("High Tick")},{TICKLOW:(0,i.localize)("Low Tick")}],RESET:[{RESETCALL:(0,i.localize)("Reset Call")},{RESETPUT:(0,i.localize)("Reset Put")}],RUNS:[{RUNHIGH:(0,i.localize)("Only Ups")},{RUNLOW:(0,i.localize)("Only Downs")}],CALLPUTSPREAD:[{CALLSPREAD:(0,i.localize)("Call Spread")},{PUTSPREAD:(0,i.localize)("Put Spread")}]},BARRIER_TYPES:[["Offset +","+"],["Offset -","-"]],ohlcFields:[[(0,i.localize)("Open"),"open"],[(0,i.localize)("High"),"high"],[(0,i.localize)("Low"),"low"],[(0,i.localize)("Close"),"close"],[(0,i.localize)("Open Time"),"epoch"]],candleIntervals:[[(0,i.localize)("Default"),"default"],[(0,i.localize)("1 minute"),"60"],[(0,i.localize)("2 minutes"),"120"],[(0,i.localize)("3 minutes"),"180"],[(0,i.localize)("5 minutes"),"300"],[(0,i.localize)("10 minutes"),"600"],[(0,i.localize)("15 minutes"),"900"],[(0,i.localize)("30 minutes"),"1800"],[(0,i.localize)("1 hour"),"3600"],[(0,i.localize)("2 hours"),"7200"],[(0,i.localize)("4 hours"),"14400"],[(0,i.localize)("8 hours"),"28800"],[(0,i.localize)("1 day"),"86400"]],mainBlocks:["trade_definition","before_purchase","during_purchase","after_purchase"],mandatoryMainBlocks:["trade_definition","purchase","before_purchase"],procedureDefinitionBlocks:["procedures_defnoreturn","procedures_defreturn"],single_instance_blocks:["trade_definition","before_purchase","during_purchase","after_purchase"],TRADE_TYPE_TO_CONTRACT_CATEGORY_MAPPING:{callput:["callput","higherlower"],asian:["asians"],digits:["matchesdiffers","evenodd","overunder"]},TRADE_TYPE_CATEGORIES:{callput:["callput","callputequal","higherlower"],touchnotouch:["touchnotouch"],inout:["endsinout","staysinout"],asian:["asians"],digits:["matchesdiffers","evenodd","overunder"],reset:["reset"],callputspread:["callputspread"],highlowticks:["highlowticks"],runs:["runs"]},TRADE_TYPE_CATEGORY_NAMES:{callput:(0,i.localize)("Up/Down"),touchnotouch:(0,i.localize)("Touch/No Touch"),inout:(0,i.localize)("In/Out"),asian:(0,i.localize)("Asians"),digits:(0,i.localize)("Digits"),reset:(0,i.localize)("Reset Call/Reset Put"),callputspread:(0,i.localize)("Call Spread/Put Spread"),highlowticks:(0,i.localize)("High/Low Ticks"),runs:(0,i.localize)("Only Ups/Only Downs")},BARRIER_CATEGORIES:{euro_atm:["callput","callputequal"],euro_non_atm:["endsinout","higherlower","callputspread"],american:["staysinout","touchnotouch","highlowticks","runs"],non_financial:["digits","overunder","evenodd","matchesdiffers"],asian:["asians"],reset:["reset"],lookback:["lookback"]},DEFAULT_DURATION_DROPDOWN_OPTIONS:[[(0,i.localize)("Ticks"),"t"],[(0,i.localize)("Seconds"),"s"],[(0,i.localize)("Minutes"),"m"],[(0,i.localize)("Hours"),"h"],[(0,i.localize)("Days"),"d"]],BARRIER_LABELS:[(0,i.localize)("High barrier"),(0,i.localize)("Low barrier")],ABSOLUTE_BARRIER_DROPDOWN_OPTION:[[(0,i.localize)("Absolute"),"absolute"]],NOT_AVAILABLE_DROPDOWN_OPTIONS:[[(0,i.localize)("Not available"),"na"]],NOT_AVAILABLE_DURATIONS:[{display:(0,i.localize)("Not available"),unit:"na",min:0}],BARRIER_TRADE_TYPES:["higherlower","touchnotouch","endsinout","staysinout","callputspread"],PREDICTION_TRADE_TYPES:["matchesdiffers","overunder","highlowticks"],DIGIT_CATEGORIES:["digits","highlowticks"],INDEPEDENT_BLOCKS:["block_holder","tick_analysis","loader","procedures_defreturn","procedures_defnoreturn"],bbResult:[[(0,i.localize)("upper"),"1"],[(0,i.localize)("middle"),"0"],[(0,i.localize)("lower"),"2"]],macdFields:[[(0,i.localize)("Histogram"),"0"],[(0,i.localize)("MACD"),"1"],[(0,i.localize)("Signal"),"2"]],gd:{cid:"828416594271-b4bhia944ecegn3j327oeb4l8o803bts.apps.googleusercontent.com",aid:"derivbot-248506",api:"AIzaSyA52MX2l8p75-w7nvab7fU6Lk6KwLqnyEI"},workspaces:{flyoutWorkspacesStartScale:.7,mainWorkspaceStartScale:.9,previewWorkspaceStartScale:.6},strategies:{martingale:{index:0,label:(0,i.localize)("Martingale"),description:(0,i.localize)("The Martingale Strategy is a classic trading technique that has been used for more than a hundred years, popularised by the French mathematician Paul Pierre Levy in the 18th century.")},dalembert:{index:1,label:(0,i.localize)("D'Alembert"),description:(0,i.localize)("The concept of the D’Alembert Strategy is said to be similar to the Martingale Strategy where you will increase your contract size after a loss. With the D’Alembert Strategy, you will also decrease your contract size after a successful trade.")},oscars_grind:{index:2,label:(0,i.localize)("Oscar's Grind"),description:(0,i.localize)("The Oscar's Grind Strategy is a low-risk positive progression strategy that first appeared in 1965. By using this strategy, the size of your contract will increase after successful trades, but remains unchanged after unsuccessful trades.")}},default_file_name:(0,i.localize)("Untitled Bot")}},7103:(e,t,o)=>{"use strict";o.d(t,{Jr:()=>i,LF:()=>n,Di:()=>r,F$:()=>a});const i=["InsufficientBalance","CustomLimitsReached","OfferingsValidationError","InvalidCurrency","ContractBuyValidationError","NotDefaultCurrency","PleaseAuthenticate","FinancialAssessmentRequired","PositiveIntegerExpected","OptionError","IncorrectPayoutDecimals","IncorrectStakeDecimals","NoMFProfessionalClient","AuthorizationRequired","InvalidToken","DailyLossLimitExceeded","InputValidationFailed"],n=Object.freeze({ERROR:"error",NOTIFY:"notify",SUCCESS:"success"}),r=Object.freeze({RECOVERABLE_ERRORS:"recoverable_errors",UNRECOVERABLE_ERRORS:"unrecoverable_errors"}),a=Object.freeze({LOAD_BLOCK:"load_block",PURCHASE:"purchase",SELL:"sell",NOT_OFFERED:"not_offered",PROFIT:"profit",LOST:"lost",WELCOME_BACK:"welcome_back"})},7929:(e,t,o)=>{"use strict";o.d(t,{R:()=>i});const i=Object.freeze({UNSAVED:"unsaved",LOCAL:"local",GOOGLE_DRIVE:"google drive"})},5730:(e,t,o)=>{const{goog:i,Blockly:n}=o(1723);n.JavaScript=o(9697),window.goog=i,window.Blockly=n,o(4294),o(5134),o(4730)},3751:(e,t,o)=>{"use strict";o.d(t,{N$:()=>i,xY:()=>n,e_:()=>r,dp:()=>a,DV:()=>l,M8:()=>s,dK:()=>c,fK:()=>u});const i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAAGXcA1uAAAAAXNSR0IArs4c6QAAAK9JREFUSA3tVUkOgCAMROP/f4PfU4iOaWQKLYmBg71AOksXTAyhGkeKKuECjTSDUwcFxVdNawNgQ10omJNKROqiJbMJsKJZgKgEouuESRYVFVxO35JTnxGDvk9aWQ5GCXfSPbRbsLHysr0lBeMESaKE3hkmbKk230SY9Ulky5rG/SVJU8udPrMU5s7w9bEugUlN886MWiJN86/o2dywFQ17g10b+dlJefH9X0t9X+YETM6gfmoeI+MAAAAASUVORK5CYII=",n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAWBJREFUOI2dk81KQmEQhp/5zgHRjhtz0apMXBUSdAcVLWrnxhswsHARSLcRhYm00CvIRbugrCtIaJHtIqlFQUsPBeY50yINM7WfZzV8M+/MOzCfMED8wE2q0Q0VVgSJASjaNEJNoHy7Fb7ur5dekChooGO7ewJZwAw27uIBh6Gok2+kpf3ZIFHQgG+7JwpLI4RfULiYiDprjbS0DYBvu/u/FXenLr88u7sAEj9wk2rp1TDb1VQQXyF9/Dp0HctnwajRjWFiAF9BRxuxOpZmJF5qNRTmfmt/gGujMD0qW00FOUoFxzWYsRnjcnHK+smBGoGHn6rGcG8Qzv6v11MjUObjwr5Rf/K4fByaAvA8IxUBmC21ikDub8Mp3OXC2wYgFHXyCOd/kNcitrMD3QNqpKUdmnTWUYqMWKdnG6UQsZz1elbeoO839kgUW/MdSzOisgrEus9N0FPPSOV+M3zTX/8O8E9xAaZDaSsAAAAASUVORK5CYII=",r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAAEgBckRAAAAAXNSR0IArs4c6QAAAvlJREFUaAXtmU1u00AUxxPEGoluKMcgJ8gCARsW9CZ0ReEU5BwFiYpWqtgYiQuQFSygJ2CRLV2E39+ZZ42dGc84XxIwT3p9X//34VfbsZPRaGNaQkpGPNu4yGESGfHUOtnYte0b6G8NdABJu7NoG4KXmi1GwUTACwtYomzp5r9ripP3/KB8zj7q4P4t0z9o9PfJowM0NhD6D9NN+sFm1xb05Rjybe171nKkDBLqfw6yt1Oqjjo3F4XArbli1dfmT7YpgOQGWPanLgjfFXyn6x9sU+QMfhdKxL/1OfSAGreh4vIR643H8pQ4hydRQCAAPv9owJ7AF1YH/bKr+z7FsPMbdBP8ZNNNOuwE+6v0bPILpJLAXsAvUrgSLxsoG4hsgAtoDDe3CoPhW7uFW8yXOffzcxK++ElOfxzwDXcxafAmhvscfjO8opdBgSfwjedqVPxaXbB5A0op5P+GH8ZwqXgwj6RtaO1kiDYJBiJOJop+HuScRZGyLfcUq2p5nJHVgAnrQzepXF/HnMIVnEckt84Os02qSkdfYN/Pq75KnpPQPFVYMZOBBq2B/EaxFVWApga0x2WT8vu64UIyq0EoMdfXeuC3JFZxhP7L7ByZe0Q5tQqmbKBsoGygbOCv2wAfHU/1SQp9Sw0P5nuNJCeFPUicYY7hW8fHqaYOr4dR5UQfSFN1dhJnAD1a/4RF2RsFq8d10Q0ce+LYyYy9RWiulw/R615gIEiOvuASpb/IDeRv7aLxq7r9FgOQbwvY7g2s72ho0vurgjuIfYmPfbMNijGhvsoSnQxKHABW7brDcvkhN23IBVS5otPc4hvgrHa1QW5/CpvR26loHkKuQuuvc/L7+BDO4sT0tiZ6ZL6dSgrr/VGkd54WrdzpYUM4FVJNF1u0CieM7g90CfjoM4Dn8BTu3v6u8LW2jZ3rA1rXlKz0Zy/Ehk7dlma7bkDdmav9cte1m3o0mLgmweugAW6gUHfuau/n/LeZaHLtGu1DXFufIssGygb+kw38ARimnBqQbBHiAAAAAElFTkSuQmCC",a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAAEgBckRAAAAAXNSR0IArs4c6QAAA45JREFUaAXtWDFrFUEQzoU0QhpjFVRs/Cc2Sf6AxD4BQSF/QBFtbPwDYici2ImFIqaVlBEEK7FICBaxCFEQRM/v29vZzO7O3dv3uGCEXdg3M998M7O7d7e37+bmZmpt2y4xEPLITABHazpOC0wLwt5wtVKHDGBeFJEg7og+okTaVY5hUgslSQwGFJhb2tZ6mARI3XQ77x/YbzQR9mlMTpc4u3rDoWEFomXtGe5+0zSXg28oCL69IT8r/kwJYocLF0p1yi2ITwl2YiL6+MTq5iQZiUNvtO24GaAywLc+5FfUqp7tFdCXUeulo0bMMfoy+WY8QdUcMU0O/xfPuZ/6fOJtyZH56chABcC94oMXFWyqOlffs2YFXge4hi3gu05gEU3Mj24ZklvDtkUCfgHdfMiBu+cXMnos3QbGZHDsQVyyEs+CYaYh9yzxNaauQF2BWVaATzL6WG01GwMzE4TgfhSdGzKyAUi8z5HvzEKA5Ez08TOkA34jGInCeDT5H2EX6Di9O+k17+d2nW1kwDjz0JL6Pa85xfKRS5BP0T8oV6aSWwYqFoPQHiqoVyUxc5pgwgLnM3loFxNXZJIQATRMULHgf+5596AfKlemmrkIou2gZxfQJ6b/Lfov9CdZVgDAN9B5fLFnANy9TyH7ijyD72pPch5ZeIu7uynjwOGqQrDI1H+zJJ6Jtb6gK2mH1jVnSFcx+0O86qsrUFegrkBdgboC/9MKZK91vPBG/ac88mLEnxmt5Hxjs2kfTDnHTH3M0HlKdNTioYxtXfM7KB6X9gddiJA8OHHgPESx8UCVXbEQaCjg30bnMf+c4TYh1kCX702szTFwLK6ZQRoUIiSPllwNHjOLBw7uFfQf6GxH6LtO635u6lpDOuicCGtzDO6YCxndGWY8SWymswBE6F2XoG0PIN3EIVfQ36G/KkhhUhDrmunUYDFRByU6cvBsL+0Qyh30iV8QkzSRKcki0DKKiVZwgiHXPDrv4W8+74uEUmz6+Ml3RjGxpzTiP/ocL4UC+5HHvgo2rfTx5ROQAC+5K5hfsNOBgLeAzgH/RtftNYzzKd+yweOuIzuRzlE+AUmMaH6QkK3U/Owi3FQi7gH6+xQfssHnzsPGmu5zDfkOwc9QrPNZRGCyD0/9YWpiwYSAWrJlRlfcGhdDo//dPtca5GMGeFuLxR5cc8bSuQ3rXPwvv6mBqtcVqCtQV+Dfr8BfZ6VurZP8obgAAAAASUVORK5CYII=",l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAAEgBckRAAAAAXNSR0IArs4c6QAAAa5JREFUaAXtV1tywzAIdDq5Rg/Ui/SGzYl8j1brzqYYidHDYWw60g/iIWABKc6yGOsG+XdaSr/uFLe0dkZkNC25Wt6U7zq7C05zJMH9FofBd0IymZIKR4qYWAyh95LfbCgAxYLwd/e3h+yJm0YQWiurk2V4cXkzaALO5owKAJV7E7gsr9zzQBaBiirVXaV3KYeTbtDVyNOgUIFU9q+CeFj0bBs9sL/k5fhJnSXHOakbnzxmUKH3kl5m0JK1ZQ/fxQBHncqk3Uskg217mX2mHBC4I3APMAB6HglfgXQPXvqaZgXBRTu4PqTT+M+1+00uPtfW+94rRy/cEbgHKJYIY8pRGykLz/7jEkmIslwt8mSzSrtsbznMDBsF7lM0A1Q74V6iagbTYFZgVsC7Ani7sbzjjPrPPhu1o4skv6YPj3edG/jDAOQXjQxgAe+1p0/rXPhfgvAAih+9bJukVgtfNSq9/plb+A6EB9A8QmePCkdG0/AdCA+geYR068hbo0W9pr326Tz+p35qP+SbAVjPHB2dRcOP0ARw1ugwbvgOtFziR0J72T807MSkswKDFfgBlTxsE+QpCHoAAAAASUVORK5CYII=",s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAQAAABIkb+zAAAC+0lEQVR4Ae2bA4xeURCFp7bdoGvjv3OC2m1Q24xW0cZJ3caqzdhJ3Vi1bdu2po1T3v95Nvu+E/N+z5hDMf4RExMTE4N0HmkqsZS34RAu4iG+8kd+hEs4xNuw1FTySKSTRvIbYyLW4xbEHr7JG8z47CakBVOMlXgHcRZ+w6tRSNGCOmY874e4D+83E1CHoqCwBWbzI4gPuY85hS0oVGrwDDyD+JgnZibVoHDgXByCBJBDnBvG8kfiPSSgvOfBFCg1sRASbHhRYIdSSn3eDgk+vD2lPvlPfks+AgknfCS/pd8XzTRchYSYq4Vp5B/ogNuQkHPbdPTv4LkMiSCXclr5curiOCSinMivS17hZZAIs5S8YfpDIs5Ack9OKzyJWoAfozW5BVsgCrKF3GG6QHQk0ZVcUBsXIe5Dv+FJ4aKLlx6UQtQICEodb3++qUmAb1BtcgJPh2gSgGAaOQEX1QlcouQxPSHqBMT0dH791yDg/H5Q1Ig/qhT4UNSIksGMgqgUEDPK+fOnKgFeRsmAM1oFcCap9y+IWgFJ4mXf9NMsYPqRDZRpFkCZXWCJaoElZIP3aBbgPWQDp50v0D2OBU+TDb6pWYBv2gWeqxZ4bhf4rlrgm13gk2qBT2QDTzUL4CnZ4BuaBfhGNbiM6r6R7SYbWFrVHyUqNAtwOdnAQM0CiQFkI7uJZoH8xmSHT2kV4FOUDFiqVQBLq8dnlaJG+KBRgD8WNaLkwGaVApsoWbiHSoEe1eDzuuIfHDzd6S+me6oE7lNtcgZXaBLgchczoZp+s1Jtck6iK0RHTJdqOWrwE7Tmx5CI8wStyT0YGLWA6V+lB554mR8jZ8ciEzjmywRpTitcUj30Z8d0VD52aSeREvbgayIlHj3+83TmbaEsf1tK/eCaG4uUj9/bSQzDO9UFCDucy/sC2fb7ODe8EtB0/0tA4dew5uivYdlfeibyAW9FOJ6EOpFXEXk1v1VeRbR/0zYTHJdBNZLI/KOO+4kf4RIfDqKOGxMTExMT8wNOZdb6YlKT2wAAAABJRU5ErkJggg==",c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAQAAABIkb+zAAAC+0lEQVR4Ae2bA4xeURCFp7bdoGvjv3OC2m1Q24xW0cZJ3caqzdhJ3Vi1bdu2po1T3v95Nvu+E/N+z5hDMf4RExMTE4N0HmkqsZS34RAu4iG+8kd+hEs4xNuw1FTySKSTRvIbYyLW4xbEHr7JG8z47CakBVOMlXgHcRZ+w6tRSNGCOmY874e4D+83E1CHoqCwBWbzI4gPuY85hS0oVGrwDDyD+JgnZibVoHDgXByCBJBDnBvG8kfiPSSgvOfBFCg1sRASbHhRYIdSSn3eDgk+vD2lPvlPfks+AgknfCS/pd8XzTRchYSYq4Vp5B/ogNuQkHPbdPTv4LkMiSCXclr5curiOCSinMivS17hZZAIs5S8YfpDIs5Ack9OKzyJWoAfozW5BVsgCrKF3GG6QHQk0ZVcUBsXIe5Dv+FJ4aKLlx6UQtQICEodb3++qUmAb1BtcgJPh2gSgGAaOQEX1QlcouQxPSHqBMT0dH791yDg/H5Q1Ig/qhT4UNSIksGMgqgUEDPK+fOnKgFeRsmAM1oFcCap9y+IWgFJ4mXf9NMsYPqRDZRpFkCZXWCJaoElZIP3aBbgPWQDp50v0D2OBU+TDb6pWYBv2gWeqxZ4bhf4rlrgm13gk2qBT2QDTzUL4CnZ4BuaBfhGNbiM6r6R7SYbWFrVHyUqNAtwOdnAQM0CiQFkI7uJZoH8xmSHT2kV4FOUDFiqVQBLq8dnlaJG+KBRgD8WNaLkwGaVApsoWbiHSoEe1eDzuuIfHDzd6S+me6oE7lNtcgZXaBLgchczoZp+s1Jtck6iK0RHTJdqOWrwE7Tmx5CI8wStyT0YGLWA6V+lB554mR8jZ8ciEzjmywRpTitcUj30Z8d0VD52aSeREvbgayIlHj3+83TmbaEsf1tK/eCaG4uUj9/bSQzDO9UFCDucy/sC2fb7ODe8EtB0/0tA4dew5uivYdlfeibyAW9FOJ6EOpFXEXk1v1VeRbR/0zYTHJdBNZLI/KOO+4kf4RIfDqKOGxMTExMT8wNOZdb6YlKT2wAAAABJRU5ErkJggg==",u="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAQAAABIkb+zAAAC6ElEQVR4Ae2bA6weURCFp7bd4NnaOyeo3Qa1zaiKXpzUbazajJ3UjVXbtm1rGqO6u/sv5uXf74t91nfvHEpISEhISAgO5PAwU4nlvANHcBmP8Z0/8xNcwRHegeWmkochhzRS0hDjsBF3IHb5Nm8yYwoakRZMBVbjA8Sb/I7XooziBbXMGD4I8S8fNGNRi+KgrBnm8hNIAD7EvLJmFCnVeCpeQAL0mZlG1SgauAhHICF4hIsofHgYPkJC8iMPoFCpjsWQcOUloV1KmXV5JyR8eWdmXQqekuZ8DBKNfKykOQVLWTauQyL0elk2BQfa4S4kYu+a9sFdPFchMXilsEUgty5OQmLyVEltShVeAYnR5ZQapg8kZvuRfwpb4FncAfgpWpJfsA2iwG3kD9MRokOnE/mgJi5DlHjZx6IHMyCKnOH5+PNtTQH4FtUkL/AUiDInkxdwWV2AK+Qe0w2iT9NN//M/mPdBeQP+rDLAp/IG5AYzHKJTM1z796dFXkFuwDmIUs+5Wn9B9OpisW96aw5gepMNzIQodqY9wDLVAZaRDd6nOQDvIxs4C3EjBYzLCGfJBt/WHIBv2wO8VB3gpT3AT9UBftgDfFEd4AvZwHPNAfCcbPAtzQH4Vho8RnW/yPaSDSyv6p8SszUH4FlkA/00B3D6ko2CRqoXNA3JDp+B6JTPkAXtt/Hy9PitUt4AnyD65M/lDcgd2KoywBZyC3dVGaBrGvxeV7zBwVO8bjE9UBXgIdUkb/Bs7d9AFlBL0zYr1STvOJ20BDAd03PUgAgt+SkkZp9Zhj20rw5Mnyo98MQrghg5OxFbgBOBTJAWtsAV7UN/Fkx7/WOXFpzMqAdfncxk9Pgvw987IOHLOzLrhtfcWKJ//N6CMxgftBcgLHARHwjl2B/gouhKQFOCLwFFX8Oap7+GZV/0jONDqRXheDxqxV5F5LX8XnkV0f5P24xVXAZ1j5P3Rx33Cz/BFT4aRh03ISEhISHhF9FSCRjypNzcAAAAAElFTkSuQmCC"},5134:(e,t,o)=>{"use strict";o.r(t);var i=o(8429),n=o(3751);Blockly.Blocks.procedures_defnoreturn={init(){this.arguments=[],this.argument_var_models=[],this.jsonInit(this.definition()),this.getField("NAME").setValidator(Blockly.Procedures.rename);const e=new Blockly.FieldImage(n.dK,24,24,"+",(()=>this.onAddClick()));this.appendDummyInput("ADD_ICON").appendField(e),this.setStatements(!0)},definition:()=>({message0:(0,i.localize)("function {{ function_name }} {{ function_params }}",{function_name:"%1",function_params:"%2"}),args0:[{type:"field_input",name:"NAME",text:""},{type:"field_label",name:"PARAMS",text:""}],colour:Blockly.Colours.Special2.colour,colourSecondary:Blockly.Colours.Special2.colourSecondary,colourTertiary:Blockly.Colours.Special2.colourTertiary,tooltip:(0,i.localize)("Function with no return value"),category:Blockly.Categories.Functions}),meta:()=>({display_name:(0,i.localize)("Function"),description:(0,i.localize)("This block creates a function, which is a group of instructions that can be executed at any time. Place other blocks in here to perform any kind of action that you need in your strategy. When all the instructions in a function have been carried out, your bot will continue with the remaining blocks in your strategy. Click the “do something” field to give it a name of your choice. Click the plus icon to send a value (as a named variable) to your function.")}),onchange(e){const t=[Blockly.Events.BLOCK_DELETE,Blockly.Events.BLOCK_CREATE,Blockly.Events.BLOCK_CHANGE];this.workspace&&!this.workspace.isFlyout&&t.includes(e.type)&&e.type===Blockly.Events.BLOCK_CHANGE&&e.blockId===this.id&&"NAME"===e.name&&this.getProcedureCallers().forEach((t=>{t.setFieldValue(e.newValue,"NAME")}))},onAddClick(){this.workspace.options.readOnly||this.isInFlyout||setTimeout((()=>{const e=(0,i.localize)("Specify a parameter name:");Blockly.prompt(e,"",(e=>{if(e){const t=Blockly.Variables.getOrCreateVariablePackage(this.workspace,null,e,"");t&&(this.arguments.push(e),this.argument_var_models.push(t),this.getField("PARAMS").setText(`${(0,i.localize)("with: ")} ${this.arguments.join(", ")}`),this.getProcedureCallers().forEach((e=>{e.setProcedureParameters(this.arguments),e.initSvg(),e.render(!1)})))}}))}),200)},setStatements(e){this.hasStatements!==e&&(e?(this.appendStatementInput("STACK").appendField(""),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements=e)},updateParams(){let e="";this.arguments.length&&(e=`${(0,i.localize)("with:")} ${this.arguments.join(", ")}`),Blockly.Events.disable();try{this.setFieldValue(e,"PARAMS")}finally{Blockly.Events.enable()}},mutationToDom(e){const t=document.createElement("mutation");return e&&t.setAttribute("name",this.getFieldValue("NAME")),this.argument_var_models.forEach(((o,i)=>{const n=document.createElement("arg");n.setAttribute("name",o.name),n.setAttribute("varid",o.getId()),e&&this.paramIds&&n.setAttribute("paramId",this.paramIds[i]),t.appendChild(n)})),this.hasStatements||t.setAttribute("statements","false"),t},domToMutation(e){this.arguments=[],this.argument_var_models=[],e.childNodes.forEach((e=>{if("arg"===e.nodeName.toLowerCase()){const t=e.getAttribute("name"),o=e.getAttribute("varid")||e.getAttribute("varId"),i=Blockly.Variables.getOrCreateVariablePackage(this.workspace,o,t,"");this.arguments.push(t),null!==i?this.argument_var_models.push(i):console.log(`Failed to create a variable with name ${t}, ignoring.`)}})),this.updateParams(),this.setStatements("false"!==e.getAttribute("statements"))},getProcedureDef(){return[this.getFieldValue("NAME"),this.arguments,!1]},getProcedureCallers(){return this.workspace.getAllBlocks(!1).filter((e=>e.type===this.callType&&e.data===this.id))},getVars(){return this.arguments},getVarModels(){return this.argument_var_models},customContextMenu(e){if(this.isInFlyout)return;const t={enabled:!0},o=this.getFieldValue("NAME");t.text=(0,i.localize)('Create "%1"').replace("%1",o);const n=document.createElement("mutation");n.setAttribute("name",o),this.arguments.forEach((e=>{const t=document.createElement("arg");t.setAttribute("name",e),n.appendChild(t)}));const r=document.createElement("block");r.setAttribute("type",this.callType),r.appendChild(n),t.callback=Blockly.ContextMenu.callbackFactory(this,r),e.push(t),this.isCollapsed()||this.argument_var_models.forEach((t=>{const o={enabled:!0};o.text=(0,i.localize)('Create "get %1"').replace("%1",t.name);const n=Blockly.Variables.generateVariableFieldDom(t),r=document.createElement("block");r.setAttribute("type","variables_get"),r.appendChild(n),o.callback=Blockly.ContextMenu.callbackFactory(this,r),e.push(o)}))},callType:"procedures_callnoreturn"},Blockly.JavaScript.procedures_defnoreturn=e=>{const t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE);let o=Blockly.JavaScript.statementToCode(e,"STACK");if(Blockly.JavaScript.STATEMENT_PREFIX){const t=e.id.replace(/\$/g,"$$$$");o=Blockly.JavaScript.prefixLines(Blockly.JavaScript.STATEMENT_PREFIX.replace(/%1/g,`'${t}'`),Blockly.JavaScript.INDENT)+o}Blockly.JavaScript.INFINITE_LOOP_TRAP&&(o=Blockly.JavaScript.INFINITE_LOOP_TRAP.replace(/%1/g,`'${e.id}'`)+o);let i=Blockly.JavaScript.valueToCode(e,"RETURN",Blockly.JavaScript.ORDER_NONE)||"";i&&(i=`${Blockly.JavaScript.INDENT}return ${i};\n`);const n=e.arguments.map((e=>Blockly.JavaScript.variableDB_.getName(e,Blockly.Variables.NAME_TYPE))),r=Blockly.JavaScript.scrub_(e,`\n    function ${t}(${n.join(", ")}) {\n        ${o}\n        ${i}\n    }\n`);return Blockly.JavaScript.definitions_[`%${t}`]=r,null},Blockly.Blocks.procedures_defreturn={init(){this.arguments=[],this.argument_var_models=[],this.jsonInit(this.definition()),this.getField("NAME").setValidator(Blockly.Procedures.rename);const e=new Blockly.FieldImage(n.M8,24,24,"+",(()=>this.onAddClick()));this.appendDummyInput("ADD_ICON").appendField(e),this.moveInputBefore("ADD_ICON","RETURN"),this.setStatements(!0)},definition:()=>({message0:(0,i.localize)("function {{ function_name }} {{ function_params }} {{ dummy }}",{function_name:"%1",function_params:"%2",dummy:"%3"}),message1:"return %1",args0:[{type:"field_input",name:"NAME",text:""},{type:"field_label",name:"PARAMS",text:""},{type:"input_dummy"}],args1:[{type:"input_value",name:"RETURN",check:null,align:Blockly.ALIGN_RIGHT}],colour:Blockly.Colours.Special2.colour,colourSecondary:Blockly.Colours.Special2.colourSecondary,colourTertiary:Blockly.Colours.Special2.colourTertiary,tooltip:(0,i.localize)("Function that returns a value"),category:Blockly.Categories.Functions}),meta:()=>({display_name:(0,i.localize)("Function that returns a value"),description:(0,i.localize)("This block is similar to the one above, except that this returns a value. The returned value can be assigned to a variable of your choice.")}),onAddClick:Blockly.Blocks.procedures_defnoreturn.onAddClick,onchange:Blockly.Blocks.procedures_defnoreturn.onchange,setStatements:Blockly.Blocks.procedures_defnoreturn.setStatements,updateParams:Blockly.Blocks.procedures_defnoreturn.updateParams,mutationToDom:Blockly.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:Blockly.Blocks.procedures_defnoreturn.domToMutation,getProcedureDef(){return[this.getFieldValue("NAME"),this.arguments,!0]},getProcedureCallers:Blockly.Blocks.procedures_defnoreturn.getProcedureCallers,getVars:Blockly.Blocks.procedures_defnoreturn.getVars,getVarModels:Blockly.Blocks.procedures_defnoreturn.getVarModels,renameVarById:Blockly.Blocks.procedures_defnoreturn.renameVarById,displayRenamedVar:Blockly.Blocks.procedures_defnoreturn.displayRenamedVar,customContextMenu:Blockly.Blocks.procedures_defnoreturn.customContextMenu,callType:"procedures_callreturn",registerWorkspaceListener:Blockly.Blocks.procedures_defnoreturn.registerWorkspaceListener},Blockly.JavaScript.procedures_defreturn=Blockly.JavaScript.procedures_defnoreturn,Blockly.Blocks.procedures_callnoreturn={init(){this.arguments=[],this.argument_var_models=[],this.previousDisabledState=!1,this.jsonInit(this.definition())},definition(){return{message0:"%1 %2",args0:[{type:"field_label",name:"NAME",text:this.id},{type:"input_dummy",name:"TOPROW"}],colour:Blockly.Colours.Special2.colour,colourSecondary:Blockly.Colours.Special2.colourSecondary,colourTertiary:Blockly.Colours.Special2.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Custom function"),category:Blockly.Categories.Functions}},meta:()=>({display_name:(0,i.localize)("Custom function"),description:""}),onchange(e){if(this.workspace&&!this.workspace.isFlyout&&e.recordUndo)if(e.type===Blockly.Events.BLOCK_CREATE&&-1!==e.ids.indexOf(this.id)){const t=this.getProcedureCall();let o=Blockly.Procedures.getDefinition(t,this.workspace);if(!o||o.type===this.defType&&JSON.stringify(o.arguments)===JSON.stringify(this.arguments)||(o=null),o)return void(this.data=o.id);Blockly.Events.setGroup(e.group);const i=document.createElement("xml"),n=document.createElement("block");n.setAttribute("type",this.defType);const r=this.getRelativeToSurfaceXY(),a=r.x+Blockly.SNAP_RADIUS*(this.RTL?-1:1),l=r.y+2*Blockly.SNAP_RADIUS;n.setAttribute("x",a),n.setAttribute("y",l);const s=this.mutationToDom();n.appendChild(s);const c=document.createElement("field");c.setAttribute("name","NAME"),c.appendChild(document.createTextNode(this.getProcedureCall())),n.appendChild(c),i.appendChild(n),Blockly.Xml.domToWorkspace(i,this.workspace),Blockly.Events.setGroup(!1);const u=Blockly.Procedures.getDefinition(t,this.workspace);this.data=u.id}else if(e.type===Blockly.Events.BLOCK_DELETE){const t=this.getProcedureCall();Blockly.Procedures.getDefinition(t,this.workspace)||(Blockly.Events.setGroup(e.group),this.dispose(!0,!1),Blockly.Events.setGroup(!1))}else if(e.type===Blockly.Events.BLOCK_CHANGE&&"disabled"===e.element){const t=this.getProcedureCall(),o=Blockly.Procedures.getDefinition(t,this.workspace);if(o&&o.id===e.blockId){const t=Blockly.Events.getGroup();t&&console.log("Saw an existing group while responding to a definition change"),Blockly.Events.setGroup(e.group),e.newValue?(this.previousDisabledState=this.disabled,this.setDisabled(!0)):this.setDisabled(this.previousDisabledState),Blockly.Events.setGroup(t)}}},getProcedureDefinition(e){return this.workspace.getTopBlocks(!1).find((t=>{if(t.getProcedureDef){const o=t.getProcedureDef();return o&&Blockly.Names.equals(o[0],e)}return!1}))},getProcedureCall(){return this.getFieldValue("NAME")},renameProcedure(e,t){Blockly.Names.equals(e,this.getProcedureCall())&&this.setFieldValue(t,"NAME")},setProcedureParameters(e){this.arguments=[].concat(e),this.argument_var_models=this.arguments.map((e=>Blockly.Variables.getOrCreateVariablePackage(this.workspace,null,e,""))),this.updateShape()},updateShape(){this.arguments.forEach(((e,t)=>{let o=this.getField(`ARGNAME${t}`);if(o){Blockly.Events.disable();try{o.setValue(e)}finally{Blockly.Events.enable()}}else o=new Blockly.FieldLabel(e),this.appendValueInput(`ARG${t}`).appendField(o,`ARGNAME${t}`).init()}));let e=this.arguments.length;for(;this.getInput(`ARG${e}`);)this.removeInput(`ARG${e}`),e++;const t=this.getInput("TOPROW");t&&(this.arguments.length?this.getField("WITH")||(t.appendField((0,i.localize)("with:"),"WITH"),t.init()):this.getField("WITH")&&t.removeField("WITH"))},mutationToDom(){const e=document.createElement("mutation");return e.setAttribute("name",this.getProcedureCall()),this.arguments.forEach((t=>{const o=document.createElement("arg");o.setAttribute("name",t),e.appendChild(o)})),e},domToMutation(e){const t=e.getAttribute("name");this.renameProcedure(this.getProcedureCall(),t);const o=[],i=[];e.childNodes.forEach((e=>{"arg"===e.nodeName.toLowerCase()&&(o.push(e.getAttribute("name")),i.push(e.getAttribute("paramId")))})),this.setProcedureParameters(o,i)},getVarModels(){return this.argument_var_models},customContextMenu(e){const t=this.getProcedureCall(),{workspace:o}=this,n={enabled:!0};n.text=(0,i.localize)("Highlight function definition"),n.callback=()=>{const e=this.getProcedureDefinition(t);e&&(o.centerOnBlock(e.id),e.select())},e.push(n)},defType:"procedures_defnoreturn"},Blockly.JavaScript.procedures_callnoreturn=e=>`${Blockly.JavaScript.variableDB_.getName(e.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE)}(${e.arguments.map(((t,o)=>Blockly.JavaScript.valueToCode(e,`ARG${o}`,Blockly.JavaScript.ORDER_COMMA)||"null")).join(", ")});\n`,Blockly.Blocks.procedures_callreturn={init(){this.arguments=[],this.previousDisabledState=!1,this.jsonInit(this.definition())},definition(){return{message0:"%1 %2",args0:[{type:"field_label",name:"NAME",text:this.id},{type:"input_dummy",name:"TOPROW"}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Special2.colour,colourSecondary:Blockly.Colours.Special2.colourSecondary,colourTertiary:Blockly.Colours.Special2.colourTertiary,tooltip:(0,i.localize)("Custom function"),category:Blockly.Categories.Functions}},meta:()=>({display_name:(0,i.localize)("Custom function"),description:""}),onchange:Blockly.Blocks.procedures_callnoreturn.onchange,getProcedureDefinition:Blockly.Blocks.procedures_callnoreturn.getProcedureDefinition,getProcedureCall:Blockly.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:Blockly.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters:Blockly.Blocks.procedures_callnoreturn.setProcedureParameters,updateShape:Blockly.Blocks.procedures_callnoreturn.updateShape,mutationToDom:Blockly.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:Blockly.Blocks.procedures_callnoreturn.domToMutation,getVarModels:Blockly.Blocks.procedures_callnoreturn.getVarModels,customContextMenu:Blockly.Blocks.procedures_callnoreturn.customContextMenu,defType:"procedures_defreturn"},Blockly.JavaScript.procedures_callreturn=e=>[`${Blockly.JavaScript.variableDB_.getName(e.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE)}(${e.arguments.map(((t,o)=>Blockly.JavaScript.valueToCode(e,`ARG${o}`,Blockly.JavaScript.ORDER_COMMA)||"null")).join(", ")})`,Blockly.JavaScript.ORDER_FUNCTION_CALL],Blockly.Blocks.procedures_ifreturn={init(){this.hasReturnValue=!0,this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("if {{ condition }} return {{ value }}",{condition:"%1",value:"%2"}),args0:[{type:"input_value",name:"CONDITION"},{type:"input_value",name:"VALUE"}],colour:Blockly.Colours.Special2.colour,colourSecondary:Blockly.Colours.Special2.colourSecondary,colourTertiary:Blockly.Colours.Special2.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Prematurely returns a value within a function"),category:Blockly.Categories.Functions}),meta:()=>({display_name:(0,i.localize)("Conditional return"),description:(0,i.localize)("This block returns a value when a condition is true. Use this block within either of the function blocks above.")}),mutationToDom(){const e=document.createElement("mutation");return e.setAttribute("value",Number(this.hasReturnValue)),e},domToMutation(e){const t=e.getAttribute("value");this.hasReturnValue="1"===t,this.hasReturnValue||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField((0,i.localize)("return")),this.initSvg(),this.render())},onchange(){if(!this.workspace.isDragging||this.workspace.isDragging())return;let e=!1,t=this;do{if(-1!==this.FUNCTION_TYPES.indexOf(t.type)){e=!0;break}t=t.getSurroundParent()}while(t);if(e){const e=()=>{this.initSvg(),this.render()};"procedures_defnoreturn"===t.type&&this.hasReturnValue?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField((0,i.localize)("return")),e(),this.hasReturnValue=!1):"procedures_defreturn"!==t.type||this.hasReturnValue||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField((0,i.localize)("return")),e(),this.hasReturnValue=!0),this.isInFlyout||this.setDisabled(!1)}else this.isInFlyout||this.getInheritedDisabled()||this.setDisabled(!0)},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},Blockly.JavaScript.procedures_ifreturn=e=>{const t=Blockly.JavaScript.valueToCode(e,"CONDITION",Blockly.JavaScript.ORDER_NONE)||"false";let o;return o=e.hasReturnValue?`return ${Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_NONE)||"null"};\n`:"return;\n",`\n    if (${t}) {\n        ${o}\n    }\n`};var r=o(6132);Blockly.Blocks.lists_create_with={protected_statements:["STACK"],allowed_children:["lists_statement"],init(){const e=new Blockly.FieldImage(n.M8,25,25,"",this.onIconClick.bind(this));this.jsonInit(this.definition()),this.appendDummyInput("ADD_ICON").appendField(e),this.moveInputBefore("ADD_ICON","STACK")},definition:()=>({message0:(0,i.localize)("set {{ variable }} to create list with",{variable:"%1"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:(0,i.localize)("list")}],args1:[{type:"input_statement",name:"STACK"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("This block creates a list with strings and numbers."),category:Blockly.Categories.List}),meta:()=>({display_name:(0,i.localize)("Create list"),description:(0,i.localize)("This block creates a list with strings and numbers.")}),onIconClick(){this.workspace.options.readOnly||this.isInFlyout||(0,r.UR)(!1,(()=>{const e=this.workspace.newBlock("lists_statement");e.required_parent_id=this.id,e.setMovable(!1),e.initSvg(),e.render(),this.getLastConnectionInStatement("STACK").connect(e.previousConnection)}))},onchange(e){!this.workspace||this.isInFlyout||this.workspace.isDragging()||e.type!==Blockly.Events.END_DRAG||this.getBlocksInStatement("STACK").forEach((e=>{this.allowed_children.includes(e.type)||(0,r.$9)((()=>{e.unplug(!1)}))}))}},Blockly.JavaScript.lists_create_with=e=>`${Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE)} = [${e.getBlocksInStatement("STACK").map((e=>{const t=Blockly.JavaScript[e.type](e);return Array.isArray(t)?t[0]:t})).join(", ")}];\n`,Blockly.Blocks.lists_repeat={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("create list with item {{ input_item }} repeated {{ number }} times",{input_item:"%1",number:"%2"}),args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM"}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Creates a list by repeating a given item"),category:Blockly.Categories.List}),meta:()=>({display_name:(0,i.localize)("Repeat an item"),description:(0,i.localize)("Creates a list with a given item repeated for a specific number of times.")}),getRequiredValueInputs:()=>({ITEM:r.cM,NUM:r.cM})},Blockly.JavaScript.lists_repeat=e=>[`${Blockly.JavaScript.provideFunction_("listsRepeat",[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(value, n) {\n            var array = [];\n            for (var i = 0; i < n; i++) {\n                array[i] = value;\n            }\n            return array;\n        }`])}(${Blockly.JavaScript.valueToCode(e,"ITEM",Blockly.JavaScript.ORDER_COMMA)||"null"}, ${Blockly.JavaScript.valueToCode(e,"NUM",Blockly.JavaScript.ORDER_COMMA)||"0"})`,Blockly.JavaScript.ORDER_FUNCTION_CALL],Blockly.Blocks.lists_length={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("length of {{ input_list }}",{input_list:"%1"}),args0:[{type:"input_value",name:"VALUE"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block gives you the total number of items in a given list."),category:Blockly.Categories.List}),meta:()=>({display_name:(0,i.localize)("List Length"),description:(0,i.localize)("This block gives you the total number of items in a given list.")}),getRequiredValueInputs:()=>({VALUE:null})},Blockly.JavaScript.lists_length=e=>[`${Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"[]"}.length`,Blockly.JavaScript.ORDER_MEMBER],Blockly.Blocks.lists_isEmpty={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("list {{ input_list }} is empty",{input_list:"%1"}),args0:[{type:"input_value",name:"VALUE",check:["Array"]}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Checks if a given list is empty"),category:Blockly.Categories.List}),meta:()=>({display_name:(0,i.localize)("Is list empty?"),description:(0,i.localize)("This block checks if a given list is empty. It returns “True” if the list is empty, “False” if otherwise.")}),getRequiredValueInputs:()=>({VALUE:null})},Blockly.JavaScript.lists_isEmpty=e=>{const t=Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"[]";return[-1!==e.workspace.getAllVariables().findIndex((e=>e.name===t))?`!${t} || !${t}.length`:`!${t}.length`,Blockly.JavaScript.ORDER_LOGICAL_NOT]},Blockly.Blocks.lists_indexOf={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("in list {{ input_list }} find {{ first_or_last }} occurence of item {{ input_value }}",{input_list:"%1",first_or_last:"%2",input_value:"%3"}),args0:[{type:"input_value",name:"VALUE"},{type:"field_dropdown",name:"END",options:[[(0,i.localize)("first"),"FIRST"],[(0,i.localize)("last"),"LAST"]]},{type:"input_value",name:"FIND"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block gives you the position of an item in a given list."),category:Blockly.Categories.List}),meta:()=>({display_name:(0,i.localize)("List item position"),description:(0,i.localize)("This block gives you the position of an item in a given list.")}),getRequiredValueInputs:()=>({VALUE:null,FIND:null})},Blockly.JavaScript.lists_indexOf=e=>{const t="FIRST"===e.getFieldValue("END")?"indexOf":"lastIndexOf",o=Blockly.JavaScript.valueToCode(e,"FIND",Blockly.JavaScript.ORDER_NONE)||"''",i=`${Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"''"}.${t}(${o})`;return e.workspace.options.oneBasedIndex?[`${i} + 1`,Blockly.JavaScript.ORDER_ADDITION]:[i,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.lists_getIndex={init(){this.MODE_OPTIONS=[[(0,i.localize)("get"),"GET"],[(0,i.localize)("get and remove"),"GET_REMOVE"],[(0,i.localize)("remove"),"REMOVE"]],this.WHERE_OPTIONS=[["#","FROM_START"],[(0,i.localize)("# from end"),"FROM_END"],[(0,i.localize)("first"),"FIRST"],[(0,i.localize)("last"),"LAST"],[(0,i.localize)("random"),"RANDOM"]];const e=new Blockly.FieldDropdown(this.MODE_OPTIONS,(e=>{const t="REMOVE"===e;this.updateStatement(t)}));this.appendValueInput("VALUE").setCheck("Array").appendField((0,i.localize)("in list")),this.appendDummyInput().appendField(e,"MODE"),this.appendDummyInput("AT"),this.setColourFromRawValues_(Blockly.Colours.Base.colour,Blockly.Colours.Base.colourSecondary,Blockly.Colours.Base.colourTertiary),this.setTooltip("This block gives you the value of a specific item in a list, given the position of the item. It can also remove the item from the list."),this.setOutput(!0,null),this.setOutputShape(Blockly.OUTPUT_SHAPE_ROUND),this.updateAt(!0)},meta:()=>({display_name:(0,i.localize)("Get list item"),description:(0,i.localize)("This block gives you the value of a specific item in a list, given the position of the item. It can also remove the item from the list."),category:Blockly.Categories.List}),mutationToDom(){const e=document.createElement("mutation"),t=!this.outputConnection,o=this.getInput("AT").type===Blockly.INPUT_VALUE;return e.setAttribute("statement",t),e.setAttribute("at",o),e},domToMutation(e){const t="true"===e.getAttribute("statement");this.updateStatement(t);const o="false"!==e.getAttribute("at");this.updateAt(o)},updateStatement(e){e!==!this.outputConnection&&(this.unplug(!0,!0),this.setOutput(!e),this.setPreviousStatement(e),this.setNextStatement(e),this.initSvg(),this.render(!1))},updateAt(e){this.removeInput("AT",!0),e?this.appendValueInput("AT").setCheck("Number"):this.appendDummyInput("AT");const t=new Blockly.FieldDropdown(this.WHERE_OPTIONS,(t=>{const o=["FROM_START","FROM_END"].includes(t);if(o!==e)return this.updateAt(o),this.setFieldValue(t,"WHERE"),null}));this.getInput("AT").appendField(t,"WHERE"),this.initSvg(),this.render(!1)}},Blockly.JavaScript.lists_getIndex=e=>{const t=e.getFieldValue("MODE")||"GET",o=e.getFieldValue("WHERE")||"FIRST",i="RANDOM"===o?Blockly.JavaScript.ORDER_COMMA:Blockly.JavaScript.ORDER_MEMBER,n=Blockly.JavaScript.valueToCode(e,"VALUE",i)||"[]";let r,a;if("FIRST"===o){if("GET"===t)r=`${n}[0]`,a=Blockly.JavaScript.ORDER_MEMBER;else if("GET_REMOVE"===t)r=`${n}.shift()`,a=Blockly.JavaScript.ORDER_MEMBER;else if("REMOVE"===t)return`${n}.shift();\n`}else if("LAST"===o){if("GET"===t)r=`${n}.slice(-1)[0]`,a=Blockly.JavaScript.ORDER_MEMBER;else if("GET_REMOVE"===t)r=`${n}.pop()`,a=Blockly.JavaScript.ORDER_MEMBER;else if("REMOVE"===t)return`${n}.pop();\n`}else if("FROM_START"===o){const o=Blockly.JavaScript.getAdjusted(e,"AT");if("GET"===t)r=`${n}[${o}]`,a=Blockly.JavaScript.ORDER_MEMBER;else if("GET_REMOVE"===t)r=`${n}.splice(${o}, 1)[0]`,a=Blockly.JavaScript.ORDER_FUNCTION_CALL;else if("REMOVE"===t)return`${n}.splice(${o}, 1);\n`}else if("FROM_END"===o){const o=Blockly.JavaScript.getAdjusted(e,"AT",1,!0);if("GET"===t)r=`${n}.slice(${o})[0]`,a=Blockly.JavaScript.ORDER_FUNCTION_CALL;else if("GET_REMOVE"===t)r=`${n}.splice(${o}, 1)[0]`,a=Blockly.JavaScript.ORDER_FUNCTION_CALL;else if("REMOVE"===t)return`${n}.splice(${o}, 1);\n`}else if("RANDOM"===o)if(r=`${Blockly.JavaScript.provideFunction_("listsGetRandomItem",[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(list, remove) {\n                var x = Math.floor(Math.random() * list.length);\n                if (remove) {\n                    return list.splice(x, 1)[0];\n                } else {\n                    return list[x];\n                }\n            }`])}(${n}, ${"GET"!==t})`,"GET"===t||"GET_REMOVE"===t)a=Blockly.JavaScript.ORDER_FUNCTION_CALL;else if("REMOVE"===t)return`${r};\n`;return[r,a]},Blockly.Blocks.lists_setIndex={init(){this.MODE_OPTIONS=[[(0,i.localize)("set"),"SET"],[(0,i.localize)("insert at"),"INSERT"]],this.WHERE_OPTIONS=[[(0,i.localize)("#"),"FROM_START"],[(0,i.localize)("# from end"),"FROM_END"],[(0,i.localize)("first"),"FIRST"],[(0,i.localize)("last"),"LAST"],[(0,i.localize)("random"),"RANDOM"]],this.appendValueInput("LIST").setCheck("Array").appendField((0,i.localize)("in list")),this.appendDummyInput().appendField(new Blockly.FieldDropdown(this.MODE_OPTIONS),"MODE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField((0,i.localize)("as")),this.setColourFromRawValues_(Blockly.Colours.Base.colour,Blockly.Colours.Base.colourSecondary,Blockly.Colours.Base.colourTertiary),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip((0,i.localize)("This block replaces a specific item in a list with another given item. It can also insert the new item in the list at a specific position.")),this.updateAt(!0)},meta:()=>({display_name:(0,i.localize)("Set list item"),description:(0,i.localize)("This block replaces a specific item in a list with another given item. It can also insert the new item in the list at a specific position."),category:Blockly.Categories.List}),mutationToDom(){const e=document.createElement("mutation"),t=this.getInput("AT").type===Blockly.INPUT_VALUE;return e.setAttribute("at",t),e},domToMutation(e){const t="false"!==e.getAttribute("at");this.updateAt(t)},updateAt(e){this.removeInput("AT",!0),e?this.appendValueInput("AT").setCheck("Number"):this.appendDummyInput("AT");const t=new Blockly.FieldDropdown(this.WHERE_OPTIONS,(t=>{const o=["FROM_START","FROM_END"].includes(t);if(o!==e)return this.updateAt(o),this.setFieldValue(t,"WHERE"),null}));this.moveInputBefore("AT","TO"),this.getInput("AT").appendField(t,"WHERE"),this.initSvg(),this.render(!1)}},Blockly.JavaScript.lists_setIndex=e=>{const t=e.getFieldValue("MODE")||"SET",o=e.getFieldValue("WHERE")||"FIRST",i=Blockly.JavaScript.valueToCode(e,"TO",Blockly.JavaScript.ORDER_ASSIGNMENT)||"null";let n=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_MEMBER)||"[]";const r=()=>{if(n.match(/^\w+$/))return"";const e=Blockly.JavaScript.variableDB_.getDistinctName("tmpList",Blockly.Variables.NAME_TYPE),t=`var ${e} = ${n};\n`;return n=e,t};let a;if("FIRST"===o)"SET"===t?a=`${n}[0] = ${i};\n`:"INSERT"===t&&(a=`${n}.unshift(${i});\n`);else if("LAST"===o)"SET"===t?(a=r(),a+=`${n}[${n}.length - 1] = ${i};\n`):"INSERT"===t&&(a=`${n}.push(${i});\n`);else if("FROM_START"===o){const o=Blockly.JavaScript.getAdjusted(e,"AT");"SET"===t?a=`${n}[${o}] = ${i};\n`:"INSERT"===t&&(a=`${n}.splice(${o}, 0, ${i});\n`)}else if("FROM_END"===o){const o=Blockly.JavaScript.getAdjusted(e,"AT",1,!1,Blockly.JavaScript.ORDER_SUBTRACTION);a=r(),"SET"===t?a=`${n}[${n}.length - ${o}] = ${i};\n`:"INSERT"===t&&(a=`${n}.splice(${n}.length - ${o}, 0, ${i});\n`)}else if("RANDOM"===o){a=r();const e=Blockly.JavaScript.variableDB_.getDistinctName("tmpX",Blockly.Variables.NAME_TYPE);a+=`var ${e} = Math.floor(Math.random() * ${n}.length);\n`,"SET"===t?a+=`${n}[${e}] = ${i};\n`:"INSERT"===t&&(a+=`${n}.splice(${e}, 0, ${i});\n`)}return a},Blockly.Blocks.lists_getSublist={init(){this.WHERE_OPTIONS_1=[[(0,i.localize)("get sub-list from #"),"FROM_START"],[(0,i.localize)("get sub-list from # from end"),"FROM_END"],[(0,i.localize)("get sub-list from first"),"FIRST"]],this.WHERE_OPTIONS_2=[[(0,i.localize)("#"),"FROM_START"],[(0,i.localize)("# from end"),"FROM_END"],[(0,i.localize)("last"),"LAST"]],this.appendValueInput("LIST").appendField((0,i.localize)("in list")),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),this.setColourFromRawValues_(Blockly.Colours.Base.colour,Blockly.Colours.Base.colourSecondary,Blockly.Colours.Base.colourTertiary),this.setOutput(!0,null),this.setOutputShape(Blockly.OUTPUT_SHAPE_ROUND),this.setTooltip((0,i.localize)("This block creates a list of items from an existing list, using specific item positions.")),this.updateAt(1,!0),this.updateAt(2,!0)},meta:()=>({display_name:(0,i.localize)("Get sub-list"),description:(0,i.localize)("This block creates a list of items from an existing list, using specific item positions."),category:Blockly.Categories.List}),mutationToDom(){const e=document.createElement("mutation"),t=this.getInput("AT1").type===Blockly.INPUT_VALUE,o=this.getInput("AT2").type===Blockly.INPUT_VALUE;return e.setAttribute("at1",t),e.setAttribute("at2",o),e},domToMutation(e){const t="true"===e.getAttribute("at1"),o="true"===e.getAttribute("at2");this.updateAt(1,t),this.updateAt(2,o)},updateAt(e,t){this.removeInput(`AT${e}`),t?this.appendValueInput(`AT${e}`).setCheck("Number"):this.appendDummyInput(`AT${e}`);const o=new Blockly.FieldDropdown(this[`WHERE_OPTIONS_${e}`],(o=>{const i=["FROM_START","FROM_END"].includes(o);if(i!==t)return this.updateAt(e,i),this.setFieldValue(o,`WHERE${e}`),null}));this.getInput(`AT${e}`).appendField(o,`WHERE${e}`),1===e&&this.moveInputBefore("AT1","AT2"),this.initSvg(),this.render(!1)}},Blockly.JavaScript.lists_getSublist=e=>{const t=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_MEMBER)||"[]",o=e.getFieldValue("WHERE1"),i=e.getFieldValue("WHERE2");let n,r,a;if("FIRST"===o&&"LAST"===i)a=`${t}.slice(0)`;else if(t.match(/^\w+$/)||"FROM_END"!==o&&"FROM_START"===i)"FROM_START"===o?n=Blockly.JavaScript.getAdjusted(e,"AT1"):"FROM_END"===o?(n=Blockly.JavaScript.getAdjusted(e,"AT1",1,!1,Blockly.JavaScript.ORDER_SUBTRACTION),n=`${t}.length - ${n}`):"FIRST"===o&&(n="0"),"FROM_START"===i?r=Blockly.JavaScript.getAdjusted(e,"AT2",1):"FROM_END"===i?(r=Blockly.JavaScript.getAdjusted(e,"AT2",0,!1,Blockly.JavaScript.ORDER_SUBTRACTION),r=`${t}.length - ${r}`):"LAST"===i&&(r=`${t}.length`),a=`${t}.slice(${n}, ${r})`;else{n=Blockly.JavaScript.getAdjusted(e,"AT1"),r=Blockly.JavaScript.getAdjusted(e,"AT2");const l={FROM_START:"FromStart",FROM_END:"FromEnd",FIRST:"First",LAST:"Last"},s=(e,t,o)=>"FIRST"===t?"0":"FROM_END"===t?`${e}.length - 1 - ${o}`:"LAST"===t?`${e}.length - 1`:`${o}`,c="FROM_END"===o||"FROM_START"===o,u="FROM_END"===i||"FROM_START"===i;a=`${Blockly.JavaScript.provideFunction_(`subsequence${l[o]}${l[i]}`,[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(\n                    sequence${c?", at1":""}${u?", at2":""}\n                ) {\n                    var start = ${s("sequence",o,"at1")};\n                    var end = ${s("sequence",i,"at2")} + 1;\n\n                    return sequence.slice(start, end);\n                }`])}(${t}${c?`, ${n}`:""}${u?`, ${r}`:""})`}return[a,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.lists_split={init(){const e=new Blockly.FieldDropdown([[(0,i.localize)("make list from text"),"SPLIT"],[(0,i.localize)("make text from list"),"JOIN"]],(e=>this.updateType(e)));this.appendValueInput("INPUT").setCheck("String").appendField(e,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField("","SPACE1").appendField((0,i.localize)("with delimiter"),"DELIM_LABEL"),this.appendDummyInput().appendField("","SPACE2"),this.setOutput(!0,"Array"),this.setOutputShape(Blockly.OUTPUT_SHAPE_ROUND),this.setColourFromRawValues_(Blockly.Colours.Base.colour,Blockly.Colours.Base.colourSecondary,Blockly.Colours.Base.colourTertiary),this.setTooltip((0,i.localize)("This block creates a list from a given string of text, splitting it with the given delimiter. It can also join items in a list into a string of text."))},meta:()=>({display_name:(0,i.localize)("Create list from text"),description:(0,i.localize)("This block creates a list from a given string of text, splitting it with the given delimiter. It can also join items in a list into a string of text."),category:Blockly.Categories.List}),mutationToDom(){const e=document.createElement("mutation");return e.setAttribute("mode",this.getFieldValue("MODE")),e},domToMutation(e){this.updateType(e.getAttribute("mode"))},updateType(e){const t=this.getInput("DELIM"),o=this.getField("SPACE1");"SPLIT"===e?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String"),o||t.insertFieldAt(0,"","SPACE1")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck(null),o&&t.removeField("SPACE1")),this.initSvg(),this.render(!1)}},Blockly.JavaScript.lists_split=e=>{const t=Blockly.JavaScript.valueToCode(e,"INPUT",Blockly.JavaScript.ORDER_MEMBER),o=Blockly.JavaScript.valueToCode(e,"DELIM",Blockly.JavaScript.ORDER_NONE)||"''",i=e.getFieldValue("MODE");let n;return"SPLIT"===i?n=`${t||"''"}.split(${o})`:"JOIN"===i&&(n=`${t||"[]"}.join(${o})`),[n,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.lists_sort={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("sort {{ sort_type }} {{ sort_direction }} {{ input_list }}",{sort_type:"%1",sort_direction:"%2",input_list:"%3"}),args0:[{type:"field_dropdown",name:"TYPE",options:[[(0,i.localize)("numeric"),"NUMERIC"],[(0,i.localize)("alphabetic"),"TEXT"]]},{type:"field_dropdown",name:"DIRECTION",options:[[(0,i.localize)("ascending"),"1"],[(0,i.localize)("descending"),"-1"]]},{type:"input_value",name:"LIST"}],output:"Array",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Sorts the items in a given list"),category:Blockly.Categories.List}),meta:()=>({display_name:(0,i.localize)("Sort list"),description:(0,i.localize)("Sorts the items in a given list, by their numeric or alphabetical value, in either ascending or descending order.")}),getRequiredValueInputs:()=>({LIST:null})},Blockly.JavaScript.lists_sort=e=>{const t=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_FUNCTION_CALL)||"[]",o="1"===e.getFieldValue("DIRECTION")?1:-1,i=e.getFieldValue("TYPE");return[`${t}.sort().slice(0).sort(${Blockly.JavaScript.provideFunction_("listsGetSortCompare",[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(type, direction) {\n            var compareFuncs = {\n                NUMERIC: function(a, b) {\n                    return parseFloat(a) - parseFloat(b);\n                },\n                TEXT: function(a, b) {\n                    return a.toString() > b.toString() ? 1 : -1;\n                }\n            };\n\n            return function(a, b) {\n                return compareFuncs[type](a, b) * direction; \n            }\n        }`])}("${i}", ${o}))`,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.lists_statement={required_parent_type:"lists_create_with",init(){this.required_parent_id="";const e=new Blockly.FieldImage(n.fK,25,25,"",(()=>this.onIconClick()));this.jsonInit(this.definition()),this.appendDummyInput("REMOVE_ICON").appendField(e)},definition:()=>({message0:"%1",args0:[{type:"input_value",name:"VALUE"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,category:Blockly.Categories.List}),meta:()=>({display_name:(0,i.localize)("List Statement"),description:""}),onIconClick(){this.workspace.options.readOnly||this.isInFlyout||(0,r.UR)(!1,(()=>{this.unplug(!0),this.dispose()}))},onchange(e){if(this.workspace&&!this.isInFlyout&&!this.workspace.isDragging()&&e.type===Blockly.Events.END_DRAG){const e=this.getSurroundParent();if(e)if(this.required_parent_id||e.type!==this.required_parent_type){if(e.id!==this.required_parent_id){const e=this.workspace.getAllBlocks().find((e=>e.id===this.required_parent_id));if(e){const t=e.getLastConnectionInStatement("STACK");(0,r.$9)((()=>{t.connect(this.previousConnection)}))}else(0,r.$9)((()=>{this.dispose(!0)}))}}else this.required_parent_id=e.id;else(0,r.$9)((()=>{this.dispose()}))}}},Blockly.JavaScript.lists_statement=e=>[Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_ATOMIC)||"null",Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.controls_repeat_ext={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("repeat {{ number }} times",{number:"%1"}),args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:(0,i.localize)("do %1"),args1:[{type:"input_statement",name:"DO"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Repeats inside instructions specified number of times"),category:Blockly.Categories.Loop}),meta:()=>({display_name:(0,i.localize)("Repeat (2)"),description:(0,i.localize)("This block is similar to the block above, except that the number of times it repeats is determined by a given variable.")}),getRequiredValueInputs:()=>({TIMES:null})},Blockly.JavaScript.controls_repeat_ext=e=>{let t;t=e.getField("TIMES")?String(Number(e.getFieldValue("TIMES"))):Blockly.JavaScript.valueToCode(e,"TIMES",Blockly.JavaScript.ORDER_ATOMIC)||"0";const o=Blockly.JavaScript.statementToCode(e,"DO");let i="";const n=Blockly.JavaScript.variableDB_.getDistinctName("count",Blockly.Variables.NAME_TYPE);let r=t;return t.match(/^\w+$/)||Blockly.isNumber(t)||(r=Blockly.JavaScript.variableDB_.getDistinctName("repeat_end",Blockly.Variables.NAME_TYPE),i+=`var ${r} = ${t};\n`),i+=`\n    for (var ${n} = 0; ${n} < ${r}; ${n}++) {\n        ${o}\n    }\n`,i},Blockly.Blocks.controls_repeat={init(){this.jsonInit(this.definition())},definition:()=>({type:"controls_repeat",message0:(0,i.localize)("repeat {{ number }} times",{number:"%1"}),args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:(0,i.localize)("do %1"),args1:[{type:"input_statement",name:"DO"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Repeats inside instructions specified number of times"),category:Blockly.Categories.Loop}),meta:()=>({display_name:(0,i.localize)("Repeat (1)"),description:(0,i.localize)("This block repeats the instructions contained within for a specific number of times.")})},Blockly.JavaScript.controls_repeat=Blockly.JavaScript.controls_repeat_ext,Blockly.Blocks.controls_whileUntil={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("repeat {{ while_or_until }} {{ boolean }}",{while_or_until:"%1",boolean:"%2"}),args0:[{type:"field_dropdown",name:"MODE",options:[[(0,i.localize)("while"),"WHILE"],[(0,i.localize)("until"),"UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:(0,i.localize)("do %1"),args1:[{type:"input_statement",name:"DO"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("This block repeats instructions as long as a given condition is true"),category:Blockly.Categories.Loop}),meta:()=>({display_name:(0,i.localize)("Repeat While/Until"),description:(0,i.localize)("This block repeats instructions as long as a given condition is true.")}),getRequiredValueInputs:()=>({BOOL:null})},Blockly.JavaScript.controls_whileUntil=e=>{const t=Blockly.JavaScript.statementToCode(e,"DO"),o="UNTIL"===e.getFieldValue("MODE"),n=o?Blockly.JavaScript.ORDER_LOGICAL_NOT:Blockly.JavaScript.ORDER_NONE;let r=Blockly.JavaScript.valueToCode(e,"BOOL",n)||"false";o&&(r=`!${r}`);const a=Blockly.JavaScript.variableDB_.getDistinctName("maxLoops",Blockly.Variables.NAME_TYPE),l=Blockly.JavaScript.variableDB_.getDistinctName("currentLoop",Blockly.Variables.NAME_TYPE);return`\n        var ${a} = 10000;\n        var ${l} = 0;\n\n        while (${r}) {\n            if (${l} > ${a}) {\n                throw new Error("${(0,i.localize)("Infinite loop detected")}");\n            } else {\n                ${l}++;\n            }\n            \n            ${t}\n        }\n`},Blockly.Blocks.controls_for={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("count with {{ variable }} from {{ start_number }} to {{ end_number }} by {{ step_size }}",{variable:"%1",start_number:"%2",end_number:"%3",step_size:"%4"}),args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"},{type:"input_value",name:"BY",check:"Number"}],message1:(0,i.localize)("do %1"),args1:[{type:"input_statement",name:"DO"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("This block uses the variable “i” to control the iterations. With each iteration, the value of “i” is determined by the items in a given list."),category:Blockly.Categories.Loop}),meta:()=>({display_name:(0,i.localize)("Iterate (1)"),description:(0,i.localize)("This block uses the variable “i” to control the iterations. With each iteration, the value of “i” is determined by the items in a given list.")}),getRequiredValueInputs:()=>({FROM:null,TO:null,BY:null})},Blockly.JavaScript.controls_for=e=>{const t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),o=Blockly.JavaScript.valueToCode(e,"FROM",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",i=Blockly.JavaScript.valueToCode(e,"TO",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",n=Blockly.JavaScript.valueToCode(e,"BY",Blockly.JavaScript.ORDER_ASSIGNMENT)||"1";let r=Blockly.JavaScript.statementToCode(e,"DO");r=Blockly.JavaScript.addLoopTrap(r,e.id);let a="";if(Blockly.isNumber(o)&&Blockly.isNumber(i)&&Blockly.isNumber(n)){const e=parseFloat(o)<=parseFloat(i);a=`\n        for (${t} = ${o}; ${t} ${e?"<=":">="} ${i}; ${t} ${e?"+=":"-="} ${Math.abs(parseFloat(n))}) {\n            ${r}\n        }\n`}else{let e=o;o.match(/^\w+$/)||Blockly.isNumber(o)||(e=Blockly.JavaScript.variableDB_.getDistinctName(`${t}_start`,Blockly.Variables.NAME_TYPE),a=`var ${e} = ${o};\n`);let l=i;i.match(/^\w+$/)||Blockly.isNumber(i)||(l=Blockly.JavaScript.variableDB_.getDistinctName(`${t}_end`,Blockly.Variables.NAME_TYPE),a+=`var ${l} = ${i};\n`);const s=Blockly.JavaScript.variableDB_.getDistinctName(`${t}_inc`,Blockly.Variables.NAME_TYPE);a+=`\n        var ${s} = ${Blockly.isNumber(n)?Math.abs(n):`Math.abs(${n})`};\n        if (${e} > ${l}) {\n            ${s} = -${s};\n        }\n        for (\n           ${t} = ${e}; \n           ${s} >= 0 ? ${t} <= ${l} : ${t} >= ${l};\n           ${t} += ${s}\n        ) {\n            ${r};\n        }\n`}return a},Blockly.Blocks.controls_forEach={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("for each item {{ variable }} in list {{ input_list }}",{variable:"%1",input_list:"%2"}),args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:(0,i.localize)("do %1"),args1:[{type:"input_statement",name:"DO"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Iterates through a given list"),category:Blockly.Categories.Loop}),meta:()=>({display_name:(0,i.localize)("Iterate (2)"),description:(0,i.localize)('This block uses the variable "i" to control the iterations. With each iteration, the value of "i" is determined by the items in a given list.')}),getRequiredValueInputs:()=>({LIST:null})},Blockly.JavaScript.controls_forEach=e=>{const t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),o=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_ASSIGNMENT)||"[]";let i=Blockly.JavaScript.statementToCode(e,"DO");i=Blockly.JavaScript.addLoopTrap(i,e.id);let n="",r=o;o.match(/^\w+$/)||(r=Blockly.JavaScript.variableDB_.getDistinctName(`${t}_list`,Blockly.Variables.NAME_TYPE),n=`var ${r} = ${o};\n`);const a=Blockly.JavaScript.variableDB_.getDistinctName(`${t}_list`,Blockly.Variables.NAME_TYPE);return n+=`\n    for (var ${a} in ${r}) {\n        ${t} = ${r}[${a}];\n        ${i}\n    }\n`,n},Blockly.Blocks.controls_flow_statements={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("{{ break_or_continue }} of loop",{break_or_continue:"%1"}),args0:[{type:"field_dropdown",name:"FLOW",options:[[(0,i.localize)("break out"),"BREAK"],[(0,i.localize)("continue with next iteration"),"CONTINUE"]]}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("This block is used to either terminate or continue a loop, and can be placed anywhere within a loop block."),category:Blockly.Categories.Loop}),meta:()=>({display_name:(0,i.localize)("Break out/continue"),description:(0,i.localize)("This block is used to either terminate or continue a loop, and can be placed anywhere within a loop block.")})},Blockly.JavaScript.controls_flow_statements=e=>("BREAK"===e.getFieldValue("FLOW")?"break":"continue")+";\n",Blockly.Blocks.variables_get={init(){this.jsonInit(this.definition())},definition:()=>({type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:(0,i.localize)("item")}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Special2.colour,colourSecondary:Blockly.Colours.Special2.colourSecondary,colourTertiary:Blockly.Colours.Special2.colourTertiary,tooltip:(0,i.localize)("Gets variable value"),category:Blockly.Categories.Variables}),meta:()=>({display_name:(0,i.localize)("User-defined variable"),description:""}),onchange(e){if(e.type===Blockly.Events.VAR_RENAME){const t=this.workspace.getAllBlocks().filter((e=>"custom_functions"===e.category_)),o=e.oldName,n=e.newName;t.forEach((e=>{var t;if(null!==(t=e.arguments)&&void 0!==t&&t.length){const t=e.arguments.findIndex((e=>e===o));-1!==t&&(e.arguments[t]=n,e.getField("PARAMS")&&e.setFieldValue(`${(0,i.localize)("with: ")} ${e.arguments.join(", ")}`,"PARAMS"),e.getField("WITH")&&e.updateShape())}}))}}},Blockly.JavaScript.variables_get=e=>[Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.variables_set={init(){this.jsonInit(this.definition())},definition:()=>({type:"field_variable",message0:(0,i.localize)("set {{ variable }} to {{ value }}",{variable:"%1",value:"%2"}),args0:[{type:"field_variable",name:"VAR",variable:(0,i.localize)("item")},{type:"input_value",name:"VALUE"}],colour:Blockly.Colours.Special2.colour,colourSecondary:Blockly.Colours.Special2.colourSecondary,colourTertiary:Blockly.Colours.Special2.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Sets variable value"),category:Blockly.Categories.Variables}),meta:()=>({display_name:(0,i.localize)("Set variable"),description:(0,i.localize)("Assigns a given value to a variable")})},Blockly.JavaScript.variables_set=e=>{const t=Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0";return`${Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE)} = ${t};\n`},Blockly.Blocks.after_purchase={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1 %2 %3",message1:"%1",args0:[{type:"field_image",src:n.DV,width:25,height:25,alt:"F"},{type:"field_label",text:(0,i.localize)("4. Restart trading conditions"),class:"blocklyTextRootBlockHeader"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"AFTERPURCHASE_STACK",check:"TradeAgain"}],colour:Blockly.Colours.RootBlock.colour,colourSecondary:Blockly.Colours.RootBlock.colourSecondary,colourTertiary:Blockly.Colours.RootBlock.colourTertiary,tooltip:(0,i.localize)("Get the last trade information and result, then trade again."),category:Blockly.Categories.After_Purchase}),meta:()=>({display_name:(0,i.localize)("Restart trading conditions"),description:(0,i.localize)("Here is where you can decide if your bot should continue trading.")})},Blockly.JavaScript.after_purchase=e=>{const t=Blockly.JavaScript.statementToCode(e,"AFTERPURCHASE_STACK");return`\n    BinaryBotPrivateAfterPurchase = function BinaryBotPrivateAfterPurchase() {\n        Bot.highlightBlock('${e.id}');\n        ${t}\n        Bot.isTradeAgain(false);\n        return false;\n    };`};var a=o(9789);Blockly.Blocks.contract_check_result={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Result is {{ win_or_loss }}",{win_or_loss:"%1"}),args0:[{type:"field_dropdown",name:"CHECK_RESULT",options:a.v.lists.CHECK_RESULT}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("True if the result of the last trade matches the selection"),category:Blockly.Categories.After_Purchase}),meta:()=>({display_name:(0,i.localize)("Last trade result"),description:(0,i.localize)("You can check the result of the last trade with this block.")}),onchange(e){if(this.workspace&&!this.isInFlyout&&!this.workspace.isDragging()&&(e.type===Blockly.Events.BLOCK_CREATE||e.type===Blockly.Events.END_DRAG)){const e=this.getTopParent();e&&e.isMainBlock()&&"after_purchase"!==e.type&&this.setDisabled(!0)}}},Blockly.JavaScript.contract_check_result=e=>[`Bot.isResult('${e.getFieldValue("CHECK_RESULT")}')`,Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.read_details={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Contract Details: {{ contract_detail }}",{contract_detail:"%1"}),args0:[{type:"field_dropdown",name:"DETAIL_INDEX",options:a.v.lists.DETAILS}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Reads a selected property from contract details list"),category:Blockly.Categories.After_Purchase}),meta:()=>({display_name:(0,i.localize)("Contract details"),description:(0,i.localize)("This block gives you information about your last contract.")}),restricted_parents:["after_purchase"]},Blockly.JavaScript.read_details=e=>[`Bot.readDetails(${e.getFieldValue("DETAIL_INDEX")})`,Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.trade_again={init(){this.jsonInit(this.definition()),this.setNextStatement(!1)},definition:()=>({message0:(0,i.localize)("Trade again"),colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,previousStatement:null,tooltip:(0,i.localize)("These blocks transfer control to the Purchase conditions block."),category:Blockly.Categories.After_Purchase}),meta:()=>({display_name:(0,i.localize)("Trade again"),description:(0,i.localize)("This block will transfer the control back to the Purchase conditions block, enabling you to purchase another contract."),key_words:(0,i.localize)("restart")}),restricted_parents:["after_purchase"]},Blockly.JavaScript.trade_again=()=>"\n        Bot.isTradeAgain(true);\n\n        return true;\n\n    ",Blockly.Blocks.before_purchase={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1 %2 %3",message1:"%1",args0:[{type:"field_image",src:n.e_,width:25,height:25,alt:"P"},{type:"field_label",text:(0,i.localize)("2. Purchase conditions"),class:"blocklyTextRootBlockHeader"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"BEFOREPURCHASE_STACK",check:"Purchase"}],colour:Blockly.Colours.RootBlock.colour,colourSecondary:Blockly.Colours.RootBlock.colourSecondary,colourTertiary:Blockly.Colours.RootBlock.colourTertiary,tooltip:(0,i.localize)("Specify contract type and purchase conditions."),category:Blockly.Categories.Before_Purchase}),meta:()=>({display_name:(0,i.localize)("Purchase conditions"),description:(0,i.localize)("This block is mandatory. Only one copy of this block is allowed. You can place the Purchase block (see below) here as well as conditional blocks to define your purchase conditions.")})},Blockly.JavaScript.before_purchase=e=>{const t=Blockly.JavaScript.statementToCode(e,"BEFOREPURCHASE_STACK");return`BinaryBotPrivateBeforePurchase = function BinaryBotPrivateBeforePurchase() {\n        Bot.highlightBlock('${e.id}');\n        ${t}\n    };\n`};var l=o(1319);Blockly.Blocks.purchase={init(){this.jsonInit(this.definition()),this.setNextStatement(!1)},definition:()=>({message0:(0,i.localize)("Purchase {{ contract_type }}",{contract_type:"%1"}),args0:[{type:"field_dropdown",name:"PURCHASE_LIST",options:[["",""]]}],previousStatement:null,colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,tooltip:(0,i.localize)("This block purchases contract of a specified type."),category:Blockly.Categories.Before_Purchase}),meta:()=>({display_name:(0,i.localize)("Purchase"),description:(0,i.localize)("Use this block to purchase the specific contract you want. You may add multiple Purchase blocks together with conditional blocks to define your purchase conditions. This block can only be used within the Purchase conditions block."),key_words:(0,i.localize)("buy")}),onchange(e){!this.workspace||this.isInFlyout||this.workspace.isDragging()||(e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id)?this.populatePurchaseList(e):e.type===Blockly.Events.BLOCK_CHANGE?"TYPE_LIST"!==e.name&&"TRADETYPE_LIST"!==e.name||this.populatePurchaseList(e):e.type===Blockly.Events.END_DRAG&&e.blockId===this.id&&""===this.getField("PURCHASE_LIST").menuGenerator_[0][0]&&this.populatePurchaseList(e))},populatePurchaseList(e){const t=this.workspace.getTradeDefinitionBlock();if(t){const o=t.getChildByType("trade_definition_tradetype").getFieldValue("TRADETYPE_LIST"),i=t.getChildByType("trade_definition_contracttype").getFieldValue("TYPE_LIST"),n=this.getField("PURCHASE_LIST"),r=n.getValue(),a=(0,l.M)(i,o);n.updateOptions(a,{default_value:r,event_group:e.group,should_pretend_empty:!0})}},restricted_parents:["before_purchase"]},Blockly.JavaScript.purchase=e=>`Bot.purchase('${e.getFieldValue("PURCHASE_LIST")}');\n`,Blockly.Blocks.ask_price={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Ask Price {{ contract_type }}",{contract_type:"%1"}),args0:[{type:"field_dropdown",name:"PURCHASE_LIST",options:[["",""]]}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block returns the purchase price for the selected trade type."),category:Blockly.Categories.Before_Purchase}),meta:()=>({display_name:(0,i.localize)("Purchase price"),description:(0,i.localize)('This block returns the purchase price for the selected trade type. This block can be used only in the "Purchase conditions" root block.')}),onchange:Blockly.Blocks.purchase.onchange,populatePurchaseList:Blockly.Blocks.purchase.populatePurchaseList,enforceLimitations:Blockly.Blocks.purchase.enforceLimitations},Blockly.JavaScript.ask_price=e=>[`Bot.getAskPrice('${e.getFieldValue("PURCHASE_LIST")}')`,Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.payout={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Payout {{ contract_type }}",{contract_type:"%1"}),args0:[{type:"field_dropdown",name:"PURCHASE_LIST",options:[["",""]]}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block returns the potential payout for the selected trade type"),category:Blockly.Categories.Before_Purchase}),meta:()=>({display_name:(0,i.localize)("Potential payout"),description:(0,i.localize)('This block returns the potential payout for the selected trade type. This block can be used only in the "Purchase conditions" root block.')}),onchange:Blockly.Blocks.purchase.onchange,populatePurchaseList:Blockly.Blocks.purchase.populatePurchaseList,enforceLimitations:Blockly.Blocks.purchase.enforceLimitations},Blockly.JavaScript.payout=e=>[`Bot.getPayout('${e.getFieldValue("PURCHASE_LIST")}')`,Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.during_purchase={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1 %2 %3",message1:"%1",args0:[{type:"field_image",src:n.dp,width:25,height:25,alt:"S"},{type:"field_label",text:(0,i.localize)("3. Sell conditions"),class:"blocklyTextRootBlockHeader"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"DURING_PURCHASE_STACK",check:"SellAtMarket"}],colour:Blockly.Colours.RootBlock.colour,colourSecondary:Blockly.Colours.RootBlock.colourSecondary,colourTertiary:Blockly.Colours.RootBlock.colourTertiary,tooltip:(0,i.localize)("Sell your active contract if needed (optional)"),category:Blockly.Categories.During_Purchase}),meta:()=>({display_name:(0,i.localize)("Sell conditions"),description:(0,i.localize)("Here is where you can decide to sell your contract before it expires. Only one copy of this block is allowed.")})},Blockly.JavaScript.during_purchase=e=>{const t=Blockly.JavaScript.statementToCode(e,"DURING_PURCHASE_STACK");return`BinaryBotPrivateDuringPurchase = function BinaryBotPrivateDuringPurchase() {\n        Bot.highlightBlock('${e.id}');\n        ${t}\n    };\n`},Blockly.Blocks.sell_at_market={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Sell at market price"),colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Use this block to sell your contract at the market price."),category:Blockly.Categories.During_Purchase}),meta:()=>({display_name:(0,i.localize)("Sell at market price"),description:(0,i.localize)("Use this block to sell your contract at the market price.")}),restricted_parents:["during_purchase"]},Blockly.JavaScript.sell_at_market=()=>"Bot.sellAtMarket();\n",Blockly.Blocks.check_sell={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Sell is available"),output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("True if active contract can be sold before expiration at current market price"),category:Blockly.Categories.During_Purchase}),meta:()=>({display_name:(0,i.localize)("Can contract be sold?"),description:(0,i.localize)("This block helps you check if your contract can be sold. If your contract can be sold, it returns “True”. Otherwise, it returns an empty string.")}),restricted_parents:["during_purchase"]},Blockly.JavaScript.check_sell=()=>["Bot.isSellAvailable()",Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.sell_price={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Sell profit/loss"),output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns the profit/loss from selling at market price"),category:Blockly.Categories.During_Purchase}),meta:()=>({display_name:(0,i.localize)("Profit/loss from selling"),description:(0,i.localize)("This block gives you the potential profit or loss if you decide to sell your contract.")}),restricted_parents:["during_purchase"]},Blockly.JavaScript.sell_price=()=>["Bot.getSellPrice()",Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.bb_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period","std_dev_multiplier_up","std_dev_multiplier_down"],init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("set {{ variable }} to Bollinger Bands {{ band_type }} {{ dummy }}",{variable:"%1",band_type:"%2",dummy:"%3"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"bb"},{type:"field_dropdown",name:"BBRESULT_LIST",options:a.v.bbResult},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Calculates Bollinger Bands (BB) from a list with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}),meta:()=>({display_name:(0,i.localize)("Bollinger Bands (BB)"),description:(0,i.localize)("BB is a technical analysis indicator that’s commonly used by traders. The idea behind BB is that the market price stays within the upper and lower bands for 95% of the time. The bands are the standard deviations of the market price, while the line in the middle is a simple moving average line. If the price reaches either the upper or lower band, there’s a possibility of a trend reversal.")}),onchange(e){!this.workspace||this.isInFlyout||this.workspace.isDragging()||e.type!==Blockly.Events.END_DRAG||this.getBlocksInStatement("STATEMENT").forEach((e=>{this.required_child_blocks.includes(e.type)||(Blockly.Events.disable(),e.unplug(!1),Blockly.Events.enable())}))}},Blockly.JavaScript.bb_statement=e=>{const t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE),o=e.getFieldValue("BBRESULT_LIST");return`${t} = Bot.bb(${e.childValueToCode("input_list","INPUT_LIST")}, { \n        periods: ${e.childValueToCode("period","PERIOD")}, \n        stdDevUp: ${e.childValueToCode("std_dev_multiplier_up","UPMULTIPLIER")}, \n        stdDevDown: ${e.childValueToCode("std_dev_multiplier_down","DOWNMULTIPLIER")} \n    }, ${o});\n`},Blockly.Blocks.bba_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period","std_dev_multiplier_up","std_dev_multiplier_down"],init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("set {{ variable }} to Bollinger Bands Array {{ band_type }} {{ dummy }}",{variable:"%1",band_type:"%2",dummy:"%3"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"bba"},{type:"field_dropdown",name:"BBRESULT_LIST",options:a.v.bbResult},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Calculates Bollinger Bands (BB) list from a list with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}),meta:()=>({display_name:(0,i.localize)("Bollinger Bands Array (BBA)"),description:(0,i.localize)("Similar to BB. This block gives you a choice of returning the values of either the lower band, higher band, or the SMA line in the middle.")}),onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.bba_statement=e=>{const t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE),o=e.getFieldValue("BBRESULT_LIST");return`${t} = Bot.bba(${e.childValueToCode("input_list","INPUT_LIST")}, { \n        periods: ${e.childValueToCode("period","PERIOD")}, \n        stdDevUp: ${e.childValueToCode("std_dev_multiplier_up","UPMULTIPLIER")}, \n        stdDevDown: ${e.childValueToCode("std_dev_multiplier_down","DOWNMULTIPLIER")} \n    }, ${o});\n`},Blockly.Blocks.ema_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period"],init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("set {{ variable }} to Exponential Moving Average {{ dummy }}",{variable:"%1",dummy:"%2"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"ema"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Calculates Exponential Moving Average (EMA) from a list with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}),meta:()=>({display_name:(0,i.localize)("Exponential Moving Average (EMA)"),description:(0,i.localize)("EMA is a type of moving average that places more significance on the most recent data points. It’s also known as the exponentially weighted moving average. EMA is different from SMA in that it reacts more significantly to recent price changes.")}),onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.ema_statement=e=>`${Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE)} = Bot.ema(${e.childValueToCode("input_list","INPUT_LIST")}, ${e.childValueToCode("period","PERIOD")});\n`,Blockly.Blocks.emaa_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period"],init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("set {{ variable }} to Exponential Moving Average Array {{ dummy }}",{variable:"%1",dummy:"%2"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"emaa"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Calculates Exponential Moving Average (EMA) list from a list of values with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}),meta:()=>({display_name:(0,i.localize)("Exponential Moving Average Array (EMAA)"),description:(0,i.localize)("This block is similar to EMA, except that it gives you the entire EMA line based on the input list and the given period.")}),onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.emaa_statement=e=>`${Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE)} = Bot.emaa(${e.childValueToCode("input_list","INPUT_LIST")}, ${e.childValueToCode("period","PERIOD")});\n`,Blockly.Blocks.rsi_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period"],init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("set {{ variable }} to Relative Strength Index {{ dummy }}",{variable:"%1",dummy:"%2"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"rsi"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Relative Strength Index (RSI) from a list with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}),meta:()=>({display_name:(0,i.localize)("Relative Strength Index (RSI)"),description:(0,i.localize)("RSI is a technical analysis tool that helps you identify the market trend. It will give you a value from 0 to 100. An RSI value of 70 and above means that the asset is overbought and the current trend may reverse, while a value of 30 and below means that the asset is oversold.")}),onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.rsi_statement=e=>`${Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE)} = Bot.rsi(${e.childValueToCode("input_list","INPUT_LIST")}, ${e.childValueToCode("period","PERIOD")});\n`,Blockly.Blocks.rsia_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period"],init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("set {{ variable }} to Relative Strength Index Array {{ dummy }}",{variable:"%1",dummy:"%2"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"rsia"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Calculates Relative Strength Index (RSI) list from a list of values with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}),meta:()=>({display_name:(0,i.localize)("Relative Strength Index Array (RSIA)"),description:(0,i.localize)("Similar to RSI, this block gives you a list of values for each entry in the input list.")}),onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.rsia_statement=e=>`${Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE)} = Bot.rsia(${e.childValueToCode("input_list","INPUT_LIST")}, ${e.childValueToCode("period","PERIOD")});\n`,Blockly.Blocks.sma_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period"],init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("set {{ variable }} to Simple Moving Average {{ dummy }}",{variable:"%1",dummy:"%2"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"sma"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Calculates Simple Moving Average (SMA) from a list with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}),meta:()=>({display_name:(0,i.localize)("Simple Moving Average (SMA)"),description:(0,i.localize)("SMA is a frequently used indicator in technical analysis. It calculates the average market price over a specified period, and is usually used to identify market trend direction: up or down. For example, if the SMA is moving upwards, it means the market trend is up. ")}),onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.sma_statement=e=>`${Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE)} = Bot.sma(${e.childValueToCode("input_list","INPUT_LIST")}, ${e.childValueToCode("period","PERIOD")});\n`,Blockly.Blocks.smaa_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","period"],init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("set {{ variable }} to Simple Moving Average Array {{ dummy }}",{variable:"%1",dummy:"%2"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"smaa"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Calculates Simple Moving Average line from a list with a period"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}),meta:()=>({display_name:(0,i.localize)("Simple Moving Average Array (SMAA)"),description:(0,i.localize)("Similar to SMA, this block gives you the entire SMA line containing a list of all values for a given period.")}),onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.smaa_statement=e=>`${Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE)} = Bot.smaa(${e.childValueToCode("input_list","INPUT_LIST")}, ${e.childValueToCode("period","PERIOD")});\n`,Blockly.Blocks.macda_statement={protected_statements:["STATEMENT"],required_child_blocks:["input_list","fast_ema_period","slow_ema_period","signal_ema_period"],init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("set {{ variable }} to MACD Array {{ dropdown }} {{ dummy }}",{variable:"%1",dropdown:"%2",dummy:"%3"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:"macda"},{type:"field_dropdown",name:"MACDFIELDS_LIST",options:a.v.macdFields},{type:"input_dummy"}],args1:[{type:"input_statement",name:"STATEMENT",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Calculates Moving Average Convergence Divergence (MACD) from a list"),previousStatement:null,nextStatement:null,category:Blockly.Categories.Indicators}),meta:()=>({display_name:(0,i.localize)("Moving Average Convergence Divergence"),description:(0,i.localize)("MACD is calculated by subtracting the long-term EMA (26 periods) from the short-term EMA (12 periods). If the short-term EMA is greater or lower than the long-term EMA than there’s a possibility of a trend reversal.")}),onchange:Blockly.Blocks.bb_statement.onchange},Blockly.JavaScript.macda_statement=e=>{const t=Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE),o=e.getFieldValue("MACDFIELDS_LIST");return`${t} = Bot.macda(${e.childValueToCode("input_list","INPUT_LIST")}, { \n        fastEmaPeriod: ${e.childValueToCode("fast_ema_period","FAST_EMA_PERIOD")},\n        slowEmaPeriod: ${e.childValueToCode("slow_ema_period","SLOW_EMA_PERIOD")},\n        signalEmaPeriod: ${e.childValueToCode("signal_ema_period","SIGNAL_EMA_PERIOD")},\n    }, ${o});\n`},Blockly.Blocks.input_list={init(){this.jsonInit({message0:(0,i.localize)("Input List {{ input_list }}",{input_list:"%1"}),args0:[{type:"input_value",name:"INPUT_LIST",check:"Array"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange(e){if(!this.workspace||this.isInFlyout||this.workspace.isDragging())return;const t=()=>{const e=this.getSurroundParent();e&&!this.required_parent_id&&this.allowed_parents.includes(e.type)&&(this.required_parent_id=e.id)};if(e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id))t();else if(e.type===Blockly.Events.END_DRAG){t();const e=this.getSurroundParent(),o=!!e,i=!o||e.id!==this.required_parent_id;o&&!i||(0,r.$9)((()=>{this.unplug(!0);const e=this.workspace.getAllBlocks().find((e=>e.id===this.required_parent_id));e?e.getLastConnectionInStatement("STATEMENT").connect(this.previousConnection):this.dispose()}))}},allowed_parents:["bb_statement","bba_statement","ema_statement","emaa_statement","macda_statement","rsi_statement","rsia_statement","sma_statement","smaa_statement"],getRequiredValueInputs:()=>({INPUT_LIST:null})},Blockly.JavaScript.input_list=()=>{},Blockly.Blocks.period={init(){this.jsonInit({message0:(0,i.localize)("Period {{ input_period }}",{input_period:"%1"}),args0:[{type:"input_value",name:"PERIOD",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:Blockly.Blocks.input_list.onchange,allowed_parents:["bb_statement","bba_statement","ema_statement","emaa_statement","macda_statement","rsi_statement","rsia_statement","sma_statement","smaa_statement"],getRequiredValueInputs:()=>({PERIOD:null})},Blockly.JavaScript.period=()=>{},Blockly.Blocks.std_dev_multiplier_up={init(){this.jsonInit({message0:(0,i.localize)("Standard Deviation Up Multiplier {{ input_number }}",{input_number:"%1"}),args0:[{type:"input_value",name:"UPMULTIPLIER",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:Blockly.Blocks.input_list.onchange,allowed_parents:["bb_statement","bba_statement"],getRequiredValueInputs:()=>({UPMULTIPLIER:null})},Blockly.JavaScript.std_dev_multiplier_up=()=>{},Blockly.Blocks.std_dev_multiplier_down={init(){this.jsonInit({message0:(0,i.localize)("Standard Deviation Down Multiplier {{ input_number }}",{input_number:"%1"}),args0:[{type:"input_value",name:"DOWNMULTIPLIER",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:Blockly.Blocks.input_list.onchange,allowed_parents:["bb_statement","bba_statement"],getRequiredValueInputs:()=>({DOWNMULTIPLIER:null})},Blockly.JavaScript.std_dev_multiplier_down=()=>{},Blockly.Blocks.fast_ema_period={init(){this.jsonInit({message0:(0,i.localize)("Fast EMA Period {{ input_number }}",{input_number:"%1"}),args0:[{type:"input_value",name:"FAST_EMA_PERIOD",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:Blockly.Blocks.input_list.onchange,allowed_parents:["macda_statement"],getRequiredValueInputs:()=>({FAST_EMA_PERIOD:null})},Blockly.JavaScript.fast_ema_period=()=>{},Blockly.Blocks.slow_ema_period={init(){this.jsonInit({message0:(0,i.localize)("Slow EMA Period {{ input_number }}",{input_number:"%1"}),args0:[{type:"input_value",name:"SLOW_EMA_PERIOD",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:Blockly.Blocks.input_list.onchange,allowed_parents:["macda_statement"],getRequiredValueInputs:()=>({SLOW_EMA_PERIOD:null})},Blockly.JavaScript.slow_ema_period=()=>{},Blockly.Blocks.signal_ema_period={init(){this.jsonInit({message0:(0,i.localize)("Signal EMA Period {{ input_number }}",{input_number:"%1"}),args0:[{type:"input_value",name:"SIGNAL_EMA_PERIOD",check:null}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange:Blockly.Blocks.input_list.onchange,allowed_parents:["macda_statement"],getRequiredValueInputs:()=>({SIGNAL_EMA_PERIOD:null})},Blockly.JavaScript.signal_ema_period=()=>{},Blockly.Blocks.tick={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Last Tick"),output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns the value of the last tick"),category:Blockly.Categories.Tick_Analysis}),meta:()=>({display_name:(0,i.localize)("Last tick"),description:(0,i.localize)("This block gives you the value of the last tick.")})},Blockly.Blocks.tick_string={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Last Tick String"),output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns the value of the latest tick in string format"),category:Blockly.Categories.Tick_Analysis}),meta:()=>({display_name:(0,i.localize)("Tick value"),description:(0,i.localize)("Tick value Description")}),onchange:Blockly.Blocks.tick.onchange},Blockly.JavaScript.tick=()=>["Bot.getLastTick(false, false)",Blockly.JavaScript.ORDER_ATOMIC],Blockly.JavaScript.tick_string=()=>["Bot.getLastTick(false, true)",Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.ticks={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Ticks list"),output:"Array",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block gives you a list of the last 1000 tick values."),category:Blockly.Categories.Tick_Analysis}),meta:()=>({display_name:(0,i.localize)("Tick list"),description:(0,i.localize)("This block gives you a list of the last 1000 tick values.")})},Blockly.Blocks.ticks_string={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Ticks String List"),output:"Array",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns the list of tick values in string format"),category:Blockly.Categories.Tick_Analysis}),meta:()=>({display_name:(0,i.localize)("Tick List String"),description:(0,i.localize)("Tick List String Description")}),onchange:Blockly.Blocks.ticks.onchange},Blockly.JavaScript.ticks=()=>["Bot.getTicks(false)",Blockly.JavaScript.ORDER_ATOMIC],Blockly.JavaScript.ticks_string=()=>["Bot.getTicks(true)",Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.ohlc={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Candles List"),message1:(0,i.localize)("with interval: {{ candle_interval_type }}",{candle_interval_type:"%1"}),args1:[{type:"field_dropdown",name:"CANDLEINTERVAL_LIST",options:a.v.candleIntervals}],output:"Array",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block gives you a list of candles within a selected time interval."),category:Blockly.Categories.Tick_Analysis}),meta:()=>({display_name:(0,i.localize)("Get candle list"),description:(0,i.localize)("This block gives you a list of candles within a selected time interval.")})},Blockly.JavaScript.ohlc=e=>{const t=e.getFieldValue("CANDLEINTERVAL_LIST");return[`Bot.getOhlc({ granularity: ${"default"===t?"undefined":t} })`,Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.ohlc_values={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Make a List of {{ candle_property }} values in candles list with interval: {{ candle_interval_type }}",{candle_property:"%1",candle_interval_type:"%2"}),args0:[{type:"field_dropdown",name:"OHLCFIELD_LIST",options:a.v.ohlcFields},{type:"field_dropdown",name:"CANDLEINTERVAL_LIST",options:a.v.candleIntervals}],output:"Array",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns a list of specific values from a candle list according to selected time interval"),category:Blockly.Categories.Tick_Analysis}),meta:()=>({display_name:(0,i.localize)("Create a list of candle values (1)"),description:(0,i.localize)("This block gives you the selected candle value from a list of candles within the selected time interval.")})},Blockly.JavaScript.ohlc_values=e=>{const t=e.getFieldValue("CANDLEINTERVAL_LIST"),o="default"===t?"undefined":t;return[`Bot.getOhlc({ field: '${e.getFieldValue("OHLCFIELD_LIST")}', granularity: ${o} })`,Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.read_ohlc={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("In candles list read {{ candle_property }} # from end {{ input_number }}",{candle_property:"%1",input_number:"%2"}),message1:(0,i.localize)("with interval: %1"),args0:[{type:"field_dropdown",name:"OHLCFIELD_LIST",options:a.v.ohlcFields},{type:"input_value",name:"CANDLEINDEX",check:"Number"}],args1:[{type:"field_dropdown",name:"CANDLEINTERVAL_LIST",options:a.v.candleIntervals}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Read the selected candle value"),category:Blockly.Categories.Tick_Analysis}),meta:()=>({display_name:(0,i.localize)("Read candle value (1)"),description:(0,i.localize)("This block gives you the specified candle value for a selected time interval.")}),getRequiredValueInputs:()=>({CANDLEINDEX:null})},Blockly.JavaScript.read_ohlc=e=>{const t=e.getFieldValue("CANDLEINTERVAL_LIST"),o="default"===t?"undefined":t;return[`Bot.getOhlcFromEnd({ field: '${e.getFieldValue("OHLCFIELD_LIST")}', index: ${Blockly.JavaScript.valueToCode(e,"CANDLEINDEX",Blockly.JavaScript.ORDER_ATOMIC)||"1"}, granularity: ${o} })`,Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.get_ohlc={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("in candle list get # from end {{ input_number }}",{input_number:"%1"}),message1:(0,i.localize)("with interval: {{ candle_interval_type }}",{candle_interval_type:"%1"}),args0:[{type:"input_value",name:"CANDLEINDEX",check:"Number"}],args1:[{type:"field_dropdown",name:"CANDLEINTERVAL_LIST",options:a.v.candleIntervals}],output:"Candle",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block gives you a specific candle from within the selected time interval."),category:Blockly.Categories.Tick_Analysis}),meta:()=>({display_name:(0,i.localize)("Get candle"),description:(0,i.localize)("This block gives you a specific candle from within the selected time interval.")}),getRequiredValueInputs:()=>({CANDLEINDEX:null})},Blockly.JavaScript.get_ohlc=e=>{const t=e.getFieldValue("CANDLEINTERVAL_LIST"),o="default"===t?"undefined":t;return[`Bot.getOhlcFromEnd({ index: ${Blockly.JavaScript.valueToCode(e,"CANDLEINDEX",Blockly.JavaScript.ORDER_ATOMIC)||"1"}, granularity: ${o} })`,Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.check_direction={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Direction is {{ direction_type }}",{direction_type:"%1"}),args0:[{type:"field_dropdown",name:"CHECK_DIRECTION",options:a.v.lists.CHECK_DIRECTION}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("True if the market direction matches the selection"),category:Blockly.Categories.Tick_Analysis}),meta:()=>({display_name:(0,i.localize)("Market direction"),description:(0,i.localize)("This block is used to determine if the market price moves in the selected direction or not. It gives you a value of “True” or “False”.")})},Blockly.JavaScript.check_direction=e=>[`Bot.checkDirection('${e.getFieldValue("CHECK_DIRECTION")}')`,Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.tick_analysis={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1 %2 %3",args0:[{type:"field_label",text:(0,i.localize)("The content of this block is called on every tick"),class:"blocklyTextRootBlockHeader"},{type:"input_dummy"},{type:"input_statement",name:"TICKANALYSIS_STACK",check:null}],colour:Blockly.Colours.RootBlock.colour,colourSecondary:Blockly.Colours.RootBlock.colourSecondary,colourTertiary:Blockly.Colours.RootBlock.colourTertiary,tooltip:(0,i.localize)("You can use this block to analyze the ticks, regardless of your trades"),category:Blockly.Categories.Tick_Analysis}),meta:()=>({display_name:(0,i.localize)("Run on every tick"),description:(0,i.localize)("The content of this block is called on every tick. Place this block outside of any root block.")})},Blockly.JavaScript.tick_analysis=e=>`\n    BinaryBotPrivateTickAnalysisList.push(function BinaryBotPrivateTickAnalysis() {\n        ${Blockly.JavaScript.statementToCode(e,"TICKANALYSIS_STACK")||""}\n    });\n`,Blockly.Blocks.last_digit={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Last Digit"),output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns the last digit of the latest tick"),category:Blockly.Categories.Tick_Analysis}),meta:()=>({display_name:(0,i.localize)("Last Digit"),description:(0,i.localize)("This block gives you the last digit of the latest tick value.")})},Blockly.JavaScript.last_digit=()=>["Bot.getLastDigit()",Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.lastDigitList={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Last digits list"),output:"Array",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns the list of last digits of 1000 recent tick values"),category:Blockly.Categories.Tick_Analysis}),meta:()=>({display_name:(0,i.localize)("Last Digits List"),description:(0,i.localize)("This block gives you a list of the last digits of the last 1000 tick values.")})},Blockly.JavaScript.lastDigitList=()=>["Bot.getLastDigitList()",Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.is_candle_black={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Is candle {{ input_candle }} black?",{input_candle:"%1"}),args0:[{type:"input_value",name:"OHLCOBJ",check:"Candle"}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)('Returns "True" if the given candle is black'),category:Blockly.Categories.Candle}),meta:()=>({display_name:(0,i.localize)("Is candle black?"),description:(0,i.localize)("This block returns “True” if the last candle is black. It can be placed anywhere on the canvas except within the Trade parameters root block.")}),getRequiredValueInputs:()=>({OHLCOBJ:null})},Blockly.JavaScript.is_candle_black=e=>[`Bot.isCandleBlack(${Blockly.JavaScript.valueToCode(e,"OHLCOBJ",Blockly.JavaScript.ORDER_ATOMIC)||"{}"})`,Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.ohlc_values_in_list={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Make a list of {{ candle_property }} values from candles list {{ candle_list }}",{candle_property:"%1",candle_list:"%2"}),args0:[{type:"field_dropdown",name:"OHLCFIELD_LIST",options:a.v.ohlcFields},{type:"input_value",name:"OHLCLIST"}],output:"Array",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns a list of specific values from a given candle list"),category:Blockly.Categories.Candle}),meta:()=>({display_name:(0,i.localize)("Create a list of candle values (2)"),description:(0,i.localize)("This block gives you the selected candle value from a list of candles.")}),getRequiredValueInputs:()=>({OHLCLIST:null})},Blockly.JavaScript.ohlc_values_in_list=e=>{const t=e.getFieldValue("OHLCFIELD_LIST")||"open";return[`Bot.candleValues(${Blockly.JavaScript.valueToCode(e,"OHLCLIST",Blockly.JavaScript.ORDER_ATOMIC)||"[]"}, '${t}')`,Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.read_ohlc_obj={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Read {{ candle_property }} value in candle {{ input_candle }}",{candle_property:"%1",input_candle:"%2"}),args0:[{type:"field_dropdown",name:"OHLCFIELD_LIST",options:a.v.ohlcFields},{type:"input_value",name:"OHLCOBJ"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block gives you the selected candle value."),category:Blockly.Categories.Candle}),meta:()=>({display_name:(0,i.localize)("Read candle value (2)"),description:(0,i.localize)("This block gives you the selected candle value.")}),getRequiredValueInputs:()=>({OHLCOBJ:null})},Blockly.JavaScript.read_ohlc_obj=e=>{const t=e.getFieldValue("OHLCFIELD_LIST");return[`Bot.candleField(${Blockly.JavaScript.valueToCode(e,"OHLCOBJ",Blockly.JavaScript.ORDER_ATOMIC)||"{}"}, '${t}')`,Blockly.JavaScript.ORDER_ATOMIC]},Blockly.Blocks.balance={init(){this.jsonInit(this.definition()),this.getField("BALANCE_TYPE").setValidator((e=>{"STR"===e?this.setOutput(!0,"String"):"NUM"===e&&this.setOutput(!0,"Number"),this.initSvg(),this.render(!1)}))},definition:()=>({message0:(0,i.localize)("Balance: %1"),args0:[{type:"field_dropdown",name:"BALANCE_TYPE",options:a.v.lists.BALANCE_TYPE}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block returns account balance"),category:Blockly.Categories.Miscellaneous}),meta:()=>({display_name:(0,i.localize)("Account balance"),description:(0,i.localize)("This block gives you the balance of your account either as a number or a string of text.")})},Blockly.JavaScript.balance=e=>[`Bot.getBalance('${e.getFieldValue("BALANCE_TYPE")}')`,Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.barrier_offset={init(){this.jsonInit({message0:"%1",args0:[{type:"field_dropdown",name:"BARRIEROFFSET_IN",options:a.v.BARRIER_TYPES}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Adds a sign to a number to create a barrier offset. (deprecated)"),category:Blockly.Categories.Miscellaneous})}},Blockly.JavaScript.barrier_offset=()=>{},Blockly.Blocks.block_holder={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1 %2 %3",args0:[{type:"field_label",text:"Ignore",class:"blocklyTextRootBlockHeader"},{type:"input_dummy"},{type:"input_statement",name:"USELESS_STACK",check:null}],colour:Blockly.Colours.RootBlock.colour,colourSecondary:Blockly.Colours.RootBlock.colourSecondary,colourTertiary:Blockly.Colours.RootBlock.colourTertiary,tooltip:(0,i.localize)("Put your blocks in here to prevent them from being removed"),category:Blockly.Categories.Miscellaneous}),meta:()=>({display_name:(0,i.localize)("Ignore"),description:(0,i.localize)("Use this block if you want some instructions to be ignored when your bot runs. Instructions within this block won’t be executed.")})},Blockly.JavaScript.block_holder=()=>"";var s=o(8421),c=o(7103);Blockly.Blocks.loader={init(){this.blocks_added_by_me=[],this.current_url="",this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Load block from URL: {{ input_url }}",{input_url:"%1"}),args0:[{type:"field_input",name:"URL",text:"http://www.example.com/block.xml"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Loads blocks from URL"),category:Blockly.Categories.Miscellaneous}),meta:()=>({display_name:(0,i.localize)("Loads from URL"),description:(0,i.localize)("This block allows you to load blocks from a URL if you have them stored on a remote server, and they will be loaded only when your bot runs.")}),onchange(e){this.workspace&&!this.isInFlyout&&(e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id)?(this.current_url=this.getFieldValue("URL"),this.workspace.getAllBlocks().filter((e=>"loader"===e.type)).forEach((e=>{e.id!==this.id&&e.current_url===this.current_url&&this.setDisabled(!0)})),this.disabled||this.loadBlocksFromCurrentUrl()):e.type===Blockly.Events.BLOCK_CHANGE&&e.blockId===this.id&&e.newValue&&e.oldValue!==e.newValue&&(e.newValue===this.current_url?this.setDisabled(!1):this.isValidUrl(e.newValue)&&!this.isKnownUrl(e.newValue)?(this.setDisabled(!1),this.loadBlocksFromCurrentUrl()):this.setDisabled(!0)))},loadBlocksFromCurrentUrl(){this.current_url=this.getFieldValue("URL"),(0,r.$9)((()=>{this.blocks_added_by_me.forEach((e=>e.dispose()))})),(0,r.oG)(this).then((()=>{s.P.emit("ui.log.success",{log_type:c.F$.LOAD_BLOCK})})).catch((e=>{s.P.emit("ui.log.error",e),this.setDisabled(!0)}))},isKnownUrl(e){return this.workspace.getAllBlocks().filter((e=>"loader"===e.type)).some((t=>t.id!==this.id&&t.current_url===e))},isValidUrl:e=>String(e).match(/[^/]*\.[a-zA-Z]{3}$/)},Blockly.JavaScript.loader=()=>{},Blockly.Blocks.notify={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Notify {{ notification_type }} with sound: {{ notification_sound }} {{ input_message }}",{notification_type:"%1",notification_sound:"%2",input_message:"%3"}),args0:[{type:"field_dropdown",name:"NOTIFICATION_TYPE",options:a.v.lists.NOTIFICATION_TYPE},{type:"field_dropdown",name:"NOTIFICATION_SOUND",options:a.v.lists.NOTIFICATION_SOUND},{type:"input_value",name:"MESSAGE",check:null}],colour:Blockly.Colours.Special3.colour,colourSecondary:Blockly.Colours.Special3.colourSecondary,colourTertiary:Blockly.Colours.Special3.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Displays a notification and optionally play selected sound"),category:Blockly.Categories.Miscellaneous}),meta:()=>({display_name:(0,i.localize)("Notify"),description:(0,i.localize)("This block displays a message. You can specify the color of the message and choose from 6 different sound options.")}),getRequiredValueInputs:()=>({MESSAGE:r.cM})},Blockly.JavaScript.notify=e=>{const t=e.getFieldValue("NOTIFICATION_TYPE"),o=e.getFieldValue("NOTIFICATION_SOUND"),n=e.getInputTargetBlock("MESSAGE");let r=null;if("variables_get"===n.type){const e=n.getFieldValue("VAR");r=Blockly.derivWorkspace.getVariableById(e).name}return`Bot.notify({ className: 'journal__text--${t}', message: ${Blockly.JavaScript.valueToCode(e,"MESSAGE",Blockly.JavaScript.ORDER_ATOMIC)||`"${(0,i.localize)("<empty message>")}"`}, sound: '${o}', block_id: '${e.id}', variable_name: '${r}' });\n`},Blockly.Blocks.notify_telegram={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Notify Telegram {{ dummy }} Access Token: {{ input_access_token }} Chat ID: {{ input_chat_id }} Message: {{ input_message }}",{dummy:"%1",input_access_token:"%2",input_chat_id:"%3",input_message:"%4"}),args0:[{type:"input_dummy"},{type:"input_value",name:"TELEGRAM_ACCESS_TOKEN"},{type:"input_value",name:"TELEGRAM_CHAT_ID"},{type:"input_value",name:"TELEGRAM_MESSAGE"}],colour:Blockly.Colours.Special3.colour,colourSecondary:Blockly.Colours.Special3.colourSecondary,colourTertiary:Blockly.Colours.Special3.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Sends a message to Telegram"),category:Blockly.Categories.Miscellaneous}),meta:()=>({display_name:(0,i.localize)("Notify Telegram"),description:(0,i.localize)("This block sends a message to a Telegram channel.")}),getRequiredValueInputs:()=>({TELEGRAM_ACCESS_TOKEN:r.cM,TELEGRAM_CHAT_ID:r.cM,TELEGRAM_MESSAGE:r.cM})},Blockly.JavaScript.notify_telegram=e=>{const t=Blockly.JavaScript.valueToCode(e,"TELEGRAM_ACCESS_TOKEN",Blockly.JavaScript.ORDER_ATOMIC)||"",o=Blockly.JavaScript.valueToCode(e,"TELEGRAM_CHAT_ID",Blockly.JavaScript.ORDER_ATOMIC)||"",i=Blockly.JavaScript.valueToCode(e,"TELEGRAM_MESSAGE",Blockly.JavaScript.ORDER_ATOMIC)||"";return t&&o&&i?`Bot.notifyTelegram(${t}, ${o}, ${i});\n`:""},Blockly.Blocks.total_profit={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Total profit/loss"),output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns the total profit/loss"),category:Blockly.Categories.Miscellaneous}),meta:()=>({display_name:(0,i.localize)("Total profit/loss"),description:(0,i.localize)("This block gives you the total profit/loss of your trading strategy since your bot started running. You can reset this by clicking “Clear stats” on the Transaction Stats window, or by refreshing this page in your browser.")}),onchange(e){this.workspace&&!this.isInFlyout&&!this.workspace.isDragging()&&(e.type===Blockly.Events.END_DRAG||e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id))&&"INITIALIZATION"===this.getRootInputTargetBlock()&&this.unplug(!0)}},Blockly.Blocks.total_profit_string={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Total Profit String"),output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns the total profit in string format"),category:Blockly.Categories.Miscellaneous}),meta:()=>({display_name:(0,i.localize)("Total Profit String"),description:(0,i.localize)("Total Profit String Description")}),onchange:Blockly.Blocks.total_profit.onchange},Blockly.JavaScript.total_profit=()=>["Bot.getTotalProfit(false)",Blockly.JavaScript.ORDER_ATOMIC],Blockly.JavaScript.total_profit_string=()=>["Bot.getTotalProfit(true)",Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.total_runs={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Number of runs"),output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns the number of runs"),category:Blockly.Categories.Miscellaneous}),meta:()=>({display_name:(0,i.localize)("Number of runs"),description:(0,i.localize)("This block gives you the total number of times your bot has run. You can reset this by clicking “Clear stats” on the Transaction Stats window, or by refreshing this page in your browser.")}),onchange:Blockly.Blocks.total_profit.onchange},Blockly.JavaScript.total_runs=()=>["Bot.getTotalRuns()",Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.useless_block={init(){this.jsonInit({message0:"%1",args0:[{type:"field_label",text:(0,i.localize)("Conversion Helper Block"),class:"blocklyTextRootBlockHeader"}],colour:Blockly.Colours.RootBlock.colour,colourSecondary:Blockly.Colours.RootBlock.colourSecondary,colourTertiary:Blockly.Colours.RootBlock.colourTertiary,tooltip:(0,i.localize)("This block was required to correctly convert your old strategy."),category:Blockly.Categories.Miscellaneous,nextStatement:null,previousStatement:null})}},Blockly.JavaScript.useless_block=()=>{},Blockly.Blocks.console={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Console {{ message_type }} value: {{ input_message }}",{message_type:"%1",input_message:"%2"}),args0:[{type:"field_dropdown",name:"CONSOLE_TYPE",options:[[(0,i.localize)("Log"),"log"],[(0,i.localize)("Warn"),"warn"],[(0,i.localize)("Error"),"error"],[(0,i.localize)("Table"),"table"]]},{type:"input_value",name:"MESSAGE",check:null}],colour:Blockly.Colours.Special3.colour,colourSecondary:Blockly.Colours.Special3.colourSecondary,colourTertiary:Blockly.Colours.Special3.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Display messages in the developer’s console."),category:Blockly.Categories.Miscellaneous}),meta:()=>({display_name:(0,i.localize)("Console"),description:(0,i.localize)("This block displays messages in the developer's console with an input that can be either a string of text, a number, boolean, or an array of data.")}),getRequiredValueInputs:()=>({MESSAGE:r.cM})},Blockly.JavaScript.console=e=>`Bot.console({ type: '${e.getFieldValue("CONSOLE_TYPE")||"log"}', message: ${Blockly.JavaScript.valueToCode(e,"MESSAGE",Blockly.JavaScript.ORDER_ATOMIC)||`"${(0,i.localize)("<empty message>")}"`}});\n`,Blockly.Blocks.epoch={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Seconds Since Epoch"),output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns the number of seconds since January 1st, 1970"),category:Blockly.Categories.Time}),meta:()=>({display_name:(0,i.localize)("Second Since Epoch"),description:(0,i.localize)("This block returns the number of seconds since January 1st, 1970.")})},Blockly.JavaScript.epoch=()=>["Bot.getTime()",Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.timeout={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("{{ dummy }} {{ stack_input }} Run after {{ number }} second(s)",{dummy:"%1",stack_input:"%2",number:"%3"}),args0:[{type:"input_dummy"},{type:"input_statement",name:"TIMEOUTSTACK"},{type:"input_value",name:"SECONDS"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Run the blocks inside after a given number of seconds"),category:Blockly.Categories.Time}),meta:()=>({display_name:(0,i.localize)("Delayed run"),description:(0,i.localize)("This block delays execution for a given number of seconds. You can place any blocks within this block. The execution of other blocks in your strategy will be paused until the instructions in this block are carried out.")}),getRequiredValueInputs:()=>({SECONDS:null})},Blockly.JavaScript.timeout=e=>{const t=Blockly.JavaScript.statementToCode(e,"TIMEOUTSTACK");return`sleep(${Blockly.JavaScript.valueToCode(e,"SECONDS",Blockly.JavaScript.ORDER_ATOMIC)||"1"});\n${t}\n`},Blockly.Blocks.todatetime={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("To date/time {{ input_timestamp }} {{ dummy }}",{input_timestamp:"%1",dummy:"%2"}),args0:[{type:"input_value",name:"TIMESTAMP",check:"Number"},{type:"input_dummy"}],output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block converts the number of seconds since the Unix Epoch (1 January 1970) into a string of text representing the date and time."),category:Blockly.Categories.Time}),meta:()=>({display_name:(0,i.localize)("Convert to date/time"),description:(0,i.localize)("This block converts the number of seconds since the Unix Epoch (1 January 1970) into a string of text representing the date and time.")}),getRequiredValueInputs:()=>({TIMESTAMP:null})},Blockly.JavaScript.todatetime=e=>{const t=Blockly.JavaScript.valueToCode(e,"TIMESTAMP",Blockly.JavaScript.ORDER_ATOMIC),o=`${(0,i.localize)("Invalid timestamp")}:`;return[`${Blockly.JavaScript.provideFunction_("timestampToDateString",[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(timestamp) {\n            var datetime = new Date(timestamp * 1000);\n\n            if (!datetime.getTime()) {\n                return "${o} " + timestamp;\n            }\n\n            var getTwoDigitValue = function(input) {\n                return input < 10 ? '0' + input : input;\n            }\n\n            var year    = datetime.getFullYear();\n            var month   = getTwoDigitValue(datetime.getMonth() + 1);\n            var day     = getTwoDigitValue(datetime.getDate());\n            var hours   = getTwoDigitValue(datetime.getHours());\n            var minutes = getTwoDigitValue(datetime.getMinutes());\n            var seconds = getTwoDigitValue(datetime.getSeconds());\n\n            var formatGmtOffset = function() {\n                var gmt_offset_raw = datetime.getTimezoneOffset();\n                var sign           = gmt_offset_raw > 0 ? '-' : '+';\n                var gmt_offset     = Math.abs(gmt_offset_raw);\n                var hour           = Math.floor(gmt_offset / 60);\n                var minute         = gmt_offset - hour * 60;\n\n                return 'GMT' + sign + getTwoDigitValue(hour) + getTwoDigitValue(minute);\n            }\n\n            var date_string = year + '-' + month + '-' + day;\n            var time_string = hours + ':' + minutes + ':' + seconds;\n\n            return date_string + ' ' + time_string + ' ' + formatGmtOffset();\n        }`])}(${t})`,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.totimestamp={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("To timestamp {{ input_datetime }} {{ dummy }}",{input_datetime:"%1",dummy:"%2"}),args0:[{type:"input_value",name:"DATETIME"},{type:"input_dummy"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Converts a string representing a date/time string into seconds since Epoch. Example: 2019-01-01 21:03:45 GMT+0800 will be converted to 1546347825. Time and time zone offset are optional."),category:Blockly.Categories.Time}),meta:()=>({display_name:(0,i.localize)("Convert to timestamp"),description:(0,i.localize)("This block converts a string of text that represents the date and time into seconds since the Unix Epoch (1 January 1970). The time and time zone offset are optional. Example: 2019-01-01 21:03:45 GMT+0800 will be converted to 1546347825.")}),getRequiredValueInputs:()=>({DATETIME:r.cM})},Blockly.JavaScript.totimestamp=e=>[`Bot.dateTimeStringToTimestamp(${Blockly.JavaScript.valueToCode(e,"DATETIME",Blockly.JavaScript.ORDER_ATOMIC)})`,Blockly.JavaScript.ORDER_FUNCTION_CALL];var u=o(282);Blockly.Blocks.trade_definition={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1 %2 %3",message1:"%1",message2:"%1 %2 %3",message3:"%1",message4:"%1 %2 %3",message5:"%1",args0:[{type:"field_image",src:n.N$,width:25,height:25,alt:"T"},{type:"field_label",text:(0,i.localize)("1. Trade parameters"),class:"blocklyTextRootBlockHeader"},{type:"input_dummy"}],args1:[{type:"input_statement",name:"TRADE_OPTIONS"}],args2:[{type:"field_image",src:"",width:4,height:25},{type:"field_label",text:(0,i.localize)("Run once at start:"),class:"blocklyTextRootBlockHeader"},{type:"input_dummy"}],args3:[{type:"input_statement",name:"INITIALIZATION",check:null}],args4:[{type:"field_image",src:"",width:4,height:25},{type:"field_label",text:(0,i.localize)("Trade options:"),class:"blocklyTextRootBlockHeader"},{type:"input_dummy"}],args5:[{type:"input_statement",name:"SUBMARKET"}],colour:Blockly.Colours.RootBlock.colour,colourSecondary:Blockly.Colours.RootBlock.colourSecondary,colourTertiary:Blockly.Colours.RootBlock.colourTertiary,tooltip:(0,i.localize)("Here is where you define the parameters of your contract."),category:Blockly.Categories.Trade_Definition}),meta:()=>({display_name:(0,i.localize)("Trade parameters"),description:(0,i.localize)("Here is where you define the parameters of your contract."),key_words:(0,i.localize)("market, trade type, contract type")}),onchange(e){if(this.workspace&&!this.workspace.isDragging()&&!this.isInFlyout&&(e.type===Blockly.Events.BLOCK_CHANGE||e.type===Blockly.Events.END_DRAG)){const e=this.getBlocksInStatement("TRADE_OPTIONS");e.length>0?e.forEach((e=>{/^trade_definition_.+$/.test(e.type)||(0,r.$9)((()=>{e.unplug(!0)}))})):(0,r.$9)((()=>{this.dispose()}))}}},Blockly.JavaScript.trade_definition=e=>{const{client:t}=u.Z.instance;if(!t||!t.is_logged_in)throw new Error("Please login");const{loginid:o}=t,i=t.getToken(o),n=e.getChildByType("trade_definition_market"),r=e.getChildByType("trade_definition_tradetype"),l=e.getChildByType("trade_definition_contracttype"),s=e.getChildByType("trade_definition_candleinterval"),c=e.getChildByType("trade_definition_restartonerror"),p=e.getChildByType("trade_definition_restartbuysell"),d=n.getFieldValue("SYMBOL_LIST"),y=r.getFieldValue("TRADETYPE_LIST"),m=l.getFieldValue("TYPE_LIST"),h=s.getFieldValue("CANDLEINTERVAL_LIST"),_="FALSE"!==c.getFieldValue("RESTARTONERROR"),g="FALSE"!==p.getFieldValue("TIME_MACHINE_ENABLED"),{opposites:f}=a.v,b="both"===m?f[y.toUpperCase()].map((e=>Object.keys(e)[0])):[m],k=Blockly.JavaScript.statementToCode(e,"INITIALIZATION"),v=Blockly.JavaScript.statementToCode(e,"SUBMARKET");return`  \n    BinaryBotPrivateInit = function BinaryBotPrivateInit() {\n        Bot.init('${i}', {\n          symbol              : '${d}',\n          contractTypes       : ${JSON.stringify(b)},\n          candleInterval      : '${h||"FALSE"}',\n          shouldRestartOnError: ${_},\n          timeMachineEnabled  : ${g},\n        });\n        ${k.trim()}\n    };\n      BinaryBotPrivateStart = function BinaryBotPrivateStart() {\n        BinaryBotPrivateHasCalledTradeOptions = false;\n        Bot.highlightBlock('${e.id}');\n        ${v.trim()}\n      };\n`};var p=o(9633);Blockly.Blocks.trade_definition_market={init(){this.jsonInit({message0:(0,i.localize)("Market: {{ input_market }} > {{ input_submarket }} > {{ input_symbol }}",{input_market:"%1",input_submarket:"%2",input_symbol:"%3"}),args0:[{type:"field_dropdown",name:"MARKET_LIST",options:[["",""]]},{type:"field_dropdown",name:"SUBMARKET_LIST",options:[["",""]]},{type:"field_dropdown",name:"SYMBOL_LIST",options:[["",""]]}],colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange(e){const t=-1!==["BLOCK_CREATE","BLOCK_CHANGE","END_DRAG"].findIndex((t=>e.type===Blockly.Events[t]));if(!this.workspace||this.isInFlyout||this.workspace.isDragging()||!t)return;this.enforceLimitations();const{active_symbols:o}=p.Z.instance,i=this.getField("MARKET_LIST"),n=this.getField("SUBMARKET_LIST"),r=this.getField("SYMBOL_LIST"),a=i.getValue(),l=n.getValue(),s=r.getValue(),c=o.getMarketDropdownOptions().filter((e=>"cryptocurrency"!==e[1])),u="synthetic_index"===a?o.getSubmarketDropdownOptions(a).filter((e=>"jump_index"!==e[1])):o.getSubmarketDropdownOptions(a),d=()=>{i.updateOptions(c,{default_value:a,should_pretend_empty:!0,event_group:e.group})};e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id)?d():e.type===Blockly.Events.BLOCK_CHANGE&&e.blockId===this.id?"MARKET_LIST"===e.name?n.updateOptions(u,{default_value:l,should_pretend_empty:!0,event_group:e.group}):"SUBMARKET_LIST"===e.name&&r.updateOptions(o.getSymbolDropdownOptions(l),{default_value:s,should_pretend_empty:!0,event_group:e.group}):e.type===Blockly.Events.END_DRAG&&e.blockId===this.getRootBlock().id&&(i.isEmpty()||n.isEmpty()||r.isEmpty())&&d()},enforceLimitations(){(0,r.$9)((()=>{if(this.isDescendantOf("trade_definition"))this.disabled&&this.setDisabled(!1);else{this.unplug(!1);const e=this.workspace.getTopBlocks().find((e=>"trade_definition"===e.type));e?e.getLastConnectionInStatement("TRADE_OPTIONS").connect(this.previousConnection):this.dispose()}}))}},Blockly.JavaScript.trade_definition_market=()=>{},Blockly.Blocks.trade_definition_tradetype={init(){this.jsonInit({message0:(0,i.localize)("Trade Type: {{ trade_type_category }} > {{ trade_type }}",{trade_type_category:"%1",trade_type:"%2"}),args0:[{type:"field_dropdown",name:"TRADETYPECAT_LIST",options:[["",""]]},{type:"field_dropdown",name:"TRADETYPE_LIST",options:[["",""]]}],colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange(e){if(this.workspace&&!this.isInFlyout&&!this.workspace.isDragging()&&(this.enforceLimitations(),e.type===Blockly.Events.BLOCK_CHANGE&&("SYMBOL_LIST"===e.name||"TRADETYPECAT_LIST"===e.name))){const{contracts_for:t}=p.Z.instance,o=this.getTopParent().getChildByType("trade_definition_market"),i=o.getFieldValue("MARKET_LIST"),n=o.getFieldValue("SUBMARKET_LIST"),r=o.getFieldValue("SYMBOL_LIST"),a=this.getFieldValue("TRADETYPECAT_LIST"),l=this.getFieldValue("TRADETYPE_LIST");"SYMBOL_LIST"===e.name?t.getTradeTypeCategories(i,n,r).then((t=>{const o=this.getField("TRADETYPECAT_LIST");o&&o.updateOptions(t,{default_value:a,should_pretend_empty:!0,event_group:e.group})})):"TRADETYPECAT_LIST"===e.name&&e.blockId===this.id&&t.getTradeTypes(i,n,r,a).then((t=>{this.getField("TRADETYPE_LIST").updateOptions(t,{default_value:l,should_pretend_empty:!0,event_group:e.group})}))}},enforceLimitations:Blockly.Blocks.trade_definition_market.enforceLimitations},Blockly.JavaScript.trade_definition_tradetype=()=>{},Blockly.Blocks.trade_definition_contracttype={init(){this.jsonInit({message0:(0,i.localize)("Contract Type: {{ contract_type }}",{contract_type:"%1"}),args0:[{type:"field_dropdown",name:"TYPE_LIST",options:[["",""]]}],colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange(e){if(!this.workspace||this.isInFlyout||this.workspace.isDragging())return;this.enforceLimitations();const t=/^dbot-load/.test(e.group);if(Blockly.Events.BLOCK_CHANGE&&"TRADETYPE_LIST"===e.name){const o=e.newValue,n=this.getField("TYPE_LIST"),r=[],s=(0,l.M)("both",o);s.length>1&&r.push([(0,i.localize)("Both"),"both"]),r.push(...s),0===r.length&&r.push(...a.v.NOT_AVAILABLE_DROPDOWN_OPTIONS),n.updateOptions(r,{event_group:e.group,default_value:t?n.getValue():void 0})}},enforceLimitations:Blockly.Blocks.trade_definition_market.enforceLimitations},Blockly.JavaScript.trade_definition_contracttype=()=>"",Blockly.Blocks.trade_definition_candleinterval={init(){this.jsonInit({message0:(0,i.localize)("Default Candle Interval: {{ candle_interval_type }}",{candle_interval_type:"%1"}),args0:[{type:"field_dropdown",name:"CANDLEINTERVAL_LIST",options:a.v.candleIntervals.slice(1)}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange(){!this.workspace||this.isInFlyout||this.workspace.isDragging()||this.enforceLimitations()},enforceLimitations:Blockly.Blocks.trade_definition_market.enforceLimitations},Blockly.JavaScript.trade_definition_candleinterval=()=>{},Blockly.Blocks.trade_definition_restartbuysell={init(){this.jsonInit({message0:(0,i.localize)("Restart buy/sell on error (disable for better performance): {{ checkbox }}",{checkbox:"%1"}),args0:[{type:"field_image_checkbox",name:"TIME_MACHINE_ENABLED",checked:!1}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange(){!this.workspace||this.isInFlyout||this.workspace.isDragging()||this.enforceLimitations()},enforceLimitations:Blockly.Blocks.trade_definition_market.enforceLimitations,required_inputs:["TIME_MACHINE_ENABLED"]},Blockly.JavaScript.trade_definition_restartbuysell=()=>{},Blockly.Blocks.trade_definition_restartonerror={init(){this.jsonInit({message0:(0,i.localize)("Restart last trade on error (bot ignores the unsuccessful trade): {{ checkbox }}",{checkbox:"%1"}),args0:[{type:"field_image_checkbox",name:"RESTARTONERROR",checked:!0}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null}),this.setMovable(!1),this.setDeletable(!1)},onchange(){!this.workspace||this.isInFlyout||this.workspace.isDragging()||this.enforceLimitations()},enforceLimitations:Blockly.Blocks.trade_definition_market.enforceLimitations,required_inputs:["RESTARTONERROR"]},Blockly.JavaScript.trade_definition_restartonerror=()=>{};var d=o(3140);function y(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function m(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?y(Object(o),!0).forEach((function(t){h(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):y(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function h(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}Blockly.Blocks.trade_definition_tradeoptions={durations:[],init(){this.jsonInit(this.definition()),this.setNextStatement(!1)},definition(){const e="trade_definition_tradeoptions"===this.type;return{message0:(0,i.localize)("Duration: {{ duration_unit }} {{ duration_value }}",{duration_unit:"%1",duration_value:"%2"}),message1:`${e?(0,i.localize)("Stake"):(0,i.localize)("Payout")}: %1 %2 %3`,args0:[{type:"field_dropdown",name:"DURATIONTYPE_LIST",options:[["",""]]},{type:"input_value",name:"DURATION"}],args1:[{type:"field_label",name:"CURRENCY_LIST",text:(0,d.getCurrencyDisplayCode)(a.v.lists.CURRENCY[0])},{type:"input_value",name:"AMOUNT",check:"Number"},{type:"field_label",name:"AMOUNT_LIMITS",text:""}],colour:Blockly.Colours.Special1.colour,colourSecondary:Blockly.Colours.Special1.colourSecondary,colourTertiary:Blockly.Colours.Special1.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Define your trade options such as duration and stake."),category:Blockly.Categories.Trade_Definition}},meta:()=>({display_name:(0,i.localize)("Trade options"),description:(0,i.localize)("Define your trade options such as duration and stake. Some options are only applicable for certain trade types.")}),onchange(e){if(!this.workspace||this.workspace.isDragging()||this.isInFlyout)return;(e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id)||e.type===Blockly.Events.END_DRAG)&&(this.setCurrency(),this.updateAmountLimits());const t=this.workspace.getAllBlocks(!0).find((e=>"trade_definition"===e.type));if(!t)return;const o=t.getChildByType("trade_definition_market"),i=t.getChildByType("trade_definition_tradetype");if(!o||!i)return;this.selected_symbol=o.getFieldValue("SYMBOL_LIST"),this.selected_market=o.getFieldValue("MARKET_LIST"),this.selected_trade_type_category=i.getFieldValue("TRADETYPECAT_LIST"),this.selected_trade_type=i.getFieldValue("TRADETYPE_LIST"),this.selected_duration=this.getFieldValue("DURATIONTYPE_LIST"),this.selected_barrier_types=[this.getFieldValue("BARRIEROFFSETTYPE_LIST")||a.v.BARRIER_TYPES[0][1],this.getFieldValue("SECONDBARRIEROFFSETTYPE_LIST")||a.v.BARRIER_TYPES[1][1]];const n=/^dbot-load/.test(e.group);if(e.type===Blockly.Events.BLOCK_CREATE&&e.ids.includes(this.id))n?(this.updateBarrierInputs(!1,!1),this.updateDurationInput(!1,!1),this.updatePredictionInput(!1),this.updateAmountLimits()):(this.updateBarrierInputs(!0,!0),this.enforceSingleBarrierType("BARRIEROFFSETTYPE_LIST",!0),this.updateDurationInput(!0,!0),this.updatePredictionInput(!0));else if(e.type===Blockly.Events.BLOCK_CHANGE)if(n)"TRADETYPE_LIST"===e.name&&(this.updateBarrierInputs(!1,!1),this.enforceSingleBarrierType(!1),this.updateDurationInput(!1,!1),this.updatePredictionInput(!1));else if(e.blockId===this.id)switch(e.name){case"DURATIONTYPE_LIST":this.updateBarrierInputs(!0,!0),this.enforceSingleBarrierType("BARRIEROFFSETTYPE_LIST",!0),this.updateDurationInput(!1,!0);break;case"BARRIEROFFSETTYPE_LIST":case"SECONDBARRIEROFFSETTYPE_LIST":this.updateBarrierInputs(!1,!0),this.enforceSingleBarrierType(e.name,!1)}else"SYMBOL_LIST"!==e.name&&"TRADETYPE_LIST"!==e.name||(this.updateBarrierInputs(!0,!0),this.enforceSingleBarrierType(!0),this.updateDurationInput(!0,!0),this.updatePredictionInput(!0),this.updateAmountLimits());else if(e.type===Blockly.Events.END_DRAG&&e.blockId===this.id&&!this.selected_duration){const e=new Blockly.Events.Create(this);e.recordUndo=!1,Blockly.Events.fire(e)}},createPredictionInput(e){(0,r.$9)((()=>{if(0===e.length)this.removeInput("PREDICTION_LABEL",!0),this.removeInput("PREDICTION",!0);else if(!this.getInput("PREDICTION")){this.appendDummyInput("PREDICTION_LABEL").appendField((0,i.localize)("Prediction:"));const t=this.appendValueInput("PREDICTION"),o=this.workspace.newBlock("math_number_positive");o.setShadow(!0),o.setFieldValue(e[0],"NUM"),o.outputConnection.connect(t.connection),o.initSvg(),o.render(!0)}}))},createBarrierInputs(e){(0,r.$9)((()=>{const t=["BARRIEROFFSET","SECONDBARRIEROFFSET"];for(let o=0;o<e.values.length;o++){const n=1===e.values.length?(0,i.localize)("Barrier"):a.v.BARRIER_LABELS[o];let r=this.getInput(t[o]);if(r)r.fieldRow[0].setText(n);else{r=this.appendValueInput(t[o]).appendField(n,`${t[o]}_LABEL`).appendField(new Blockly.FieldDropdown(a.v.BARRIER_TYPES),`${t[o]}TYPE_LIST`);const i=this.workspace.newBlock("math_number_positive");i.setShadow(!0),i.setFieldValue(e.values[o],"NUM"),i.outputConnection.connect(r.connection),i.initSvg(),i.render(!0)}}for(let o=t.length;o>e.values.length;o--)this.removeInput(t[o-1],!0)}))},updateAmountLimits(){const{account_limits:e}=p.Z.instance,{currency:t,landing_company_shortcode:o}=u.Z.instance.client;e.getStakePayoutLimits(t,o,this.selected_market).then((e=>{if(!this.getField("AMOUNT_LIMITS"))return;this.amount_limits=e;const{max_payout:t,min_stake:o}=e;t&&o&&this.setFieldValue((0,i.localize)("(min: {{min_stake}} - max: {{max_payout}})",{min_stake:o,max_payout:t}),"AMOUNT_LIMITS")}))},updateDurationInput(e,t){const{contracts_for:o}=p.Z.instance;o.getDurations(this.selected_symbol,this.selected_trade_type).then((o=>{this.durations=o;const i=this.getField("DURATIONTYPE_LIST"),n=this.getInput("DURATION"),a=o.map((e=>[e.display,e.unit]));if(i&&i.updateOptions(a,{default_value:e?void 0:i.getValue()}),t&&n&&n.connection){const e=n.connection.targetBlock();if(e&&e.isShadow()){const t=o.find((e=>e.unit===this.selected_duration));t&&(0,r.$9)((()=>{e.setFieldValue(t.min,"NUM")}))}}}))},updateBarrierInputs(e,t){const{contracts_for:o}=p.Z.instance,{BARRIER_TYPES:i}=a.v;o.getBarriers(this.selected_symbol,this.selected_trade_type,this.selected_duration,this.selected_barrier_types).then((o=>{this.createBarrierInputs(o);const n=["BARRIEROFFSET","SECONDBARRIEROFFSET"];for(let l=0;l<o.values.length;l++){const s=this.getField(`${n[l]}TYPE_LIST`),{ABSOLUTE_BARRIER_DROPDOWN_OPTION:c}=a.v,u=e?i[l][1]:s.getValue();if("d"===this.selected_duration)s.updateOptions(c,{default_value:"absolute"});else if(o.allow_both_types||o.allow_absolute_type){const e=[].concat(i,c);s.updateOptions(e,{default_value:u})}else s.updateOptions(i,{default_value:u});const{connection:p}=this.getInput(n[l]);if(t&&p){const e=p.targetBlock();if(e&&e.isShadow()){const t=!1!==o.values[l]?o.values[l]:"";(0,r.$9)((()=>{e.setFieldValue(t,"NUM")}))}}}}))},updatePredictionInput(e){const{contracts_for:t}=p.Z.instance;t.getPredictionRange(this.selected_symbol,this.selected_trade_type).then((t=>{if(this.createPredictionInput(t),t.length>0){const o=this.getInput("PREDICTION"),{connection:i}=o;if(e&&i){const e=i.targetBlock();if(e&&e.isShadow()){const o=Math.max(1,t[0]);(0,r.$9)((()=>{e.setFieldValue(o,"NUM")}))}}}}))},enforceSingleBarrierType(e,t){const o=this.getFieldValue(e),i="BARRIEROFFSETTYPE_LIST"===e?"SECONDBARRIEROFFSETTYPE_LIST":"BARRIEROFFSETTYPE_LIST",n=this.getField(i),{BARRIER_TYPES:l}=a.v;if(n){const e=-1!==l.findIndex((e=>e[1]===o)),i=n.getValue();(0,r.$9)((()=>{if(e&&("absolute"===i||t)){const e=l.find((e=>e[1]!==o));n.setValue(e[1])}else"absolute"===o&&"absolute"!==i&&n.setValue("absolute")}))}},domToMutation(e){const t="true"===e.getAttribute("has_first_barrier"),o="true"===e.getAttribute("has_second_barrier"),i="true"===e.getAttribute("has_prediction");t&&o?this.createBarrierInputs({values:[1,-1]}):t?this.createBarrierInputs({values:[1]}):i&&this.createPredictionInput([1])},mutationToDom(){const e=document.createElement("mutation");return e.setAttribute("has_first_barrier",!!this.getInput("BARRIEROFFSET")),e.setAttribute("has_second_barrier",!!this.getInput("SECONDBARRIEROFFSET")),e.setAttribute("has_prediction",!!this.getInput("PREDICTION")),e},setCurrency(){const e=this.getField("CURRENCY_LIST"),{currency:t}=u.Z.instance.client;e.setText((0,d.getCurrencyDisplayCode)(t))},restricted_parents:["trade_definition"],getRequiredValueInputs(){return{AMOUNT:e=>{var t,o;const n=Number(e),r=null===(t=this.amount_limits)||void 0===t?void 0:t.max_payout,a=null===(o=this.amount_limits)||void 0===o?void 0:o.min_stake;return a&&n<a?(this.error_message=(0,i.localize)("Please enter a stake amount that's at least {{min_stake}}.",{min_stake:a}),n<a):r&&n>r?(this.error_message=(0,i.localize)("Please enter a payout amount that's lower than {{max_payout}}.",{max_payout:r}),n>r):(this.error_message=(0,i.localize)("Amount must be a positive number."),!isNaN(n)&&n<=0)},DURATION:e=>{const t=Number(e);if(isNaN(t)||!this.durations.length)return!1;const o=this.durations.find((e=>e.unit===this.selected_duration));if(o){const{min:e,max:n}=o,r=t>=e&&t<=n;return this.error_message=e===n?(0,i.localize)("Duration value is not allowed. To run the bot, please enter {{min}}.",{min:e}):(0,i.localize)("Duration value is not allowed. To run the bot, please enter a value between {{min}} to {{max}}.",{min:e,max:n}),!r}return!1}}}},Blockly.Blocks.trade_definition_tradeoptions_payout=Blockly.Blocks.trade_definition_tradeoptions,Blockly.JavaScript.trade_definition_tradeoptions=e=>{const t=Blockly.JavaScript.valueToCode(e,"AMOUNT",Blockly.JavaScript.ORDER_ATOMIC)||"0",{currency:o}=u.Z.instance.client,i=e.getFieldValue("DURATIONTYPE_LIST")||"0",n=Blockly.JavaScript.valueToCode(e,"DURATION",Blockly.JavaScript.ORDER_ATOMIC)||"0",r=`+(Number(${t}).toFixed(${(0,d.getDecimalPlaces)(o)}))`,a=(e,t)=>/^(\d+(\.\d+)?)$/.test(t)?"absolute"===e?`'${t}'`:`'${e}${t}'`:"absolute"===e?t:`'${e}' + ${t}`;let l,s,c;return e.getInput("PREDICTION")&&(l=Blockly.JavaScript.valueToCode(e,"PREDICTION",Blockly.JavaScript.ORDER_ATOMIC)||"-1"),e.getInput("BARRIEROFFSET")&&(s=a(e.getFieldValue("BARRIEROFFSETTYPE_LIST"),Blockly.JavaScript.valueToCode(e,"BARRIEROFFSET",Blockly.JavaScript.ORDER_ATOMIC)||"0")),e.getInput("SECONDBARRIEROFFSET")&&(c=a(e.getFieldValue("SECONDBARRIEROFFSETTYPE_LIST"),Blockly.JavaScript.valueToCode(e,"SECONDBARRIEROFFSET",Blockly.JavaScript.ORDER_ATOMIC)||"0")),`\n        Bot.start({\n            limitations        : BinaryBotPrivateLimitations,\n            duration           : ${n},\n            duration_unit      : '${i}',\n            currency           : '${o}',\n            amount             : ${r},\n            prediction         : ${l||"undefined"},\n            barrierOffset      : ${s||"undefined"},\n            secondBarrierOffset: ${c||"undefined"},\n            basis              : '${"trade_definition_tradeoptions"===e.type?"stake":"payout"}',\n        });\n        BinaryBotPrivateHasCalledTradeOptions = true;\n    `},Blockly.JavaScript.trade_definition_tradeoptions_payout=Blockly.JavaScript.trade_definition_tradeoptions,Blockly.Blocks.logic_compare={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["≠","NEQ"],["‏<","LT"],["‏≤","LTE"],["‏>","GT"],["‏≥","GTE"]]},{type:"input_value",name:"B"}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Compares two values"),category:Blockly.Categories.Logic}),meta:()=>({display_name:(0,i.localize)("Compare"),description:(0,i.localize)("This block compares two values and is used to build a conditional structure.")}),getRequiredValueInputs:()=>({A:null,B:null})},Blockly.JavaScript.logic_compare=e=>{const t={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[e.getFieldValue("OP")||"EQ"],o=["==","!="].includes(t)?Blockly.JavaScript.ORDER_EQUALITY:Blockly.JavaScript.ORDER_RELATIONAL;return[`${Blockly.JavaScript.valueToCode(e,"A",o)||"false"} ${t} ${Blockly.JavaScript.valueToCode(e,"B",o)||"false"}`,o]},Blockly.Blocks.controls_if={init(){this.value_connections=[null],this.statement_connections=[null],this.else_statement_connection=null,this.else_if_count=0,this.else_count=0,this.jsonInit(this.definition()),this.updateShape()},definition:()=>({message0:(0,i.localize)("if {{ condition }} then",{condition:"%1"}),message1:"%1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],args1:[{type:"input_statement",name:"DO0"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Conditional block"),category:Blockly.Categories.Logic}),meta:()=>({display_name:(0,i.localize)("Conditional block"),description:(0,i.localize)("This block evaluates a statement and will perform an action only when the statement is true.")}),mutationToDom(){const e=document.createElement("mutation");return this.else_if_count&&e.setAttribute("elseif",this.else_if_count),this.else_count&&e.setAttribute("else",1),e},domToMutation(e){this.else_if_count=parseInt(e.getAttribute("elseif"))||0,this.else_count=parseInt(e.getAttribute("else"))||0,this.rebuildShape()},rebuildShape(){var e,t;const o=[null],i=[null],n=(null===(e=this.getInput("ELSE"))||void 0===e||null===(t=e.connection)||void 0===t?void 0:t.targetConnection)||null;let r=1;for(;;){const e=this.getIfInputNames(r),t=this.getInput(e.IF);if(!t)break;const n=this.getInput(e.DO);o.push(t.connection.targetConnection),i.push(n.connection.targetConnection),r++}this.updateShape(),this.reconnectChildBlocks(o,i,n)},update(e){Blockly.Events.setGroup(!0);const t=this.mutationToDom(),o=t&&Blockly.Xml.domToText(t),i=this.rendered;this.rendered=!1,e&&e.call(this),this.updateShape(),this.rendered=i,this.initSvg();const n=Blockly.Events.getGroup(),r=this.mutationToDom(),a=r&&Blockly.Xml.domToText(r);if(o!==a){const e=new Blockly.Events.BlockChange(this,"mutation",null,o,a);Blockly.Events.fire(e),setTimeout((()=>{Blockly.Events.setGroup(n),this.bumpNeighbours_(),Blockly.Events.setGroup(!1)}),Blockly.BUMP_DELAY)}this.rendered&&this.render(),Blockly.Events.setGroup(!1)},updateShape(){this.getInput("ELSE")&&(this.removeInput("ELSE"),this.removeInput("ELSE_LABEL"),this.removeInput("DELETE_ELSE"));let e=1;for(;;){const t=this.getIfInputNames(e);if(!this.getInput(t.IF))break;this.removeInput(t.IF_LABEL),this.removeInput(t.IF),this.removeInput(t.THEN_LABEL),this.removeInput(t.DELETE_ICON),this.removeInput(t.DO),e++}this.getInput("MUTATOR")&&this.removeInput("MUTATOR");for(let e=1;e<=this.else_if_count;e++){const t=this.getIfInputNames(e),o=()=>this.modifyElseIf(!1,e);this.appendDummyInput(t.IF_LABEL).appendField((0,i.localize)("else if")),this.appendValueInput(t.IF).setCheck("Boolean"),this.appendDummyInput(t.THEN_LABEL).appendField((0,i.localize)("then")),this.appendDummyInput(t.DELETE_ICON).appendField(new Blockly.FieldImage(n.fK,24,24,"-",o)),this.appendStatementInput(t.DO)}if(this.else_count>0){const e=()=>this.modifyElse(!1);this.appendDummyInput("ELSE_LABEL").appendField((0,i.localize)("else")),this.appendDummyInput("DELETE_ELSE").appendField(new Blockly.FieldImage(n.fK,24,24,"-",e,!1)),this.appendStatementInput("ELSE")}this.appendDummyInput("MUTATOR").appendField(new Blockly.FieldImage(n.M8,24,24,"+",(()=>{0===this.else_count?this.modifyElse(!0):(this.else_if_count||(this.else_if_count=0),this.modifyElseIf(!0))}),!1)),this.initSvg(),this.render()},storeConnections(e=0){this.value_connections=[null],this.statement_connections=[null],this.else_statement_connection=null;for(let t=1;t<=this.else_if_count;t++)if(e!==t){const e=this.getIfInputNames(t);this.value_connections.push(this.getInput(e.IF).connection.targetConnection),this.statement_connections.push(this.getInput(e.DO).connection.targetConnection)}const t=this.getInput("ELSE");t&&(this.else_statement_connection=t.connection.targetConnection)},reconnectChildBlocks(e,t,o){const i=null!=e?e:this.value_connections,n=null!=t?t:this.statement_connections,r=null!=o?o:this.else_statement_connection;for(let e=1;e<=this.else_if_count;e++){const t=this.getIfInputNames(e),o=i[e],r=n[e];o&&this.getInput(t.IF)&&Blockly.Mutator.reconnect(o,this,t.IF),r&&this.getInput(t.DO)&&Blockly.Mutator.reconnect(r,this,t.DO)}r&&this.getInput("ELSE")&&Blockly.Mutator.reconnect(r,this,"ELSE")},modifyElse(e){this.storeConnections(),this.update((()=>{this.else_count+=e?1:-1})),this.reconnectChildBlocks()},modifyElseIf(e,t){this.storeConnections(t),this.update((()=>{this.else_if_count+=e?1:-1})),this.reconnectChildBlocks()},getRequiredValueInputs(){const e={};return this.inputList.filter((e=>/^IF[0-9]*?$/.test(e.name))).forEach((t=>e[t.name]=null)),e},getIfInputNames:e=>({IF_LABEL:`IF_LABEL${e}`,IF:`IF${e}`,THEN_LABEL:`THEN_LABEL${e}`,DELETE_ICON:`DELETE_ICON${e}`,DO:`DO${e}`})},Blockly.JavaScript.controls_if=e=>{let t=0,o="";do{o+=`\n        ${t>0?"else if":"if"} (${Blockly.JavaScript.valueToCode(e,`IF${t}`,Blockly.JavaScript.ORDER_NONE)||"false"}) {\n            ${Blockly.JavaScript.statementToCode(e,`DO${t}`)}\n        }`,t++}while(e.getInput(`IF${t}`));return e.getInput("ELSE")&&(o+=`\n        else {\n            ${Blockly.JavaScript.statementToCode(e,"ELSE")}\n        }`),`${o}\n`},Blockly.Blocks.logic_boolean={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[[(0,i.localize)("true"),"TRUE"],[(0,i.localize)("false"),"FALSE"]]}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns either True or False"),category:Blockly.Categories.Logic}),meta:()=>({display_name:(0,i.localize)("True-False"),description:(0,i.localize)("This is a single block that returns a boolean value, either true or false.")})},Blockly.JavaScript.logic_boolean=e=>["TRUE"===e.getFieldValue("BOOL")?"true":"false",Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.logic_operation={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[[(0,i.localize)("and"),"AND"],[(0,i.localize)("or"),"OR"]]},{type:"input_value",name:"B"}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Performs selected logic operation"),category:Blockly.Categories.Logic}),meta:()=>({display_name:(0,i.localize)("Logic operation"),description:(0,i.localize)('This block performs the "AND" or the "OR" logic operation.')}),getRequiredValueInputs:()=>({A:null,B:null})},Blockly.JavaScript.logic_operation=e=>{const t=e.getFieldValue("OP");let o,i;return"AND"===t?(o="&&",i=Blockly.JavaScript.ORDER_LOGICAL_AND):"OR"===t&&(o="||",i=Blockly.JavaScript.ORDER_LOGICAL_OR),[`${Blockly.JavaScript.valueToCode(e,"A",Blockly.JavaScript.ORDER_ATOMIC)||"false"} ${o} ${Blockly.JavaScript.valueToCode(e,"B",Blockly.JavaScript.ORDER_ATOMIC)||"false"}`,i]},Blockly.Blocks.logic_null={init(){this.jsonInit(this.definition())},definition:()=>({message0:"null",output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block assigns a null value to an item or statement."),category:Blockly.Categories.Logic}),meta:()=>({display_name:(0,i.localize)("Null"),description:(0,i.localize)("This block assigns a null value to an item or statement.")})},Blockly.JavaScript.logic_null=()=>["null",Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.logic_ternary={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("test {{ condition }}",{condition:"%1"}),message1:(0,i.localize)("if true {{ return_value }}",{return_value:"%1"}),message2:(0,i.localize)("if false {{ return_value }}",{return_value:"%1"}),args0:[{type:"input_value",name:"IF",check:"Boolean"}],args1:[{type:"input_value",name:"THEN"}],args2:[{type:"input_value",name:"ELSE"}],output:null,outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block tests if a given value is true or false and returns “True” or “False” accordingly."),category:Blockly.Categories.Logic}),meta:()=>({display_name:(0,i.localize)("Test value"),description:(0,i.localize)("This block tests if a given value is true or false and returns “True” or “False” accordingly.")}),getRequiredValueInputs:()=>({IF:null,THEN:null,ELSE:null})},Blockly.JavaScript.logic_ternary=e=>[`(${Blockly.JavaScript.valueToCode(e,"IF",Blockly.JavaScript.ORDER_CONDITIONAL)||"false"} ? ${Blockly.JavaScript.valueToCode(e,"THEN",Blockly.JavaScript.ORDER_CONDITIONAL)||"null"} : ${Blockly.JavaScript.valueToCode(e,"ELSE",Blockly.JavaScript.ORDER_CONDITIONAL)||"null"})`,Blockly.JavaScript.ORDER_CONDITIONAL],Blockly.Blocks.logic_negate={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("not {{ boolean }}",{boolean:"%1"}),args0:[{type:"input_value",name:"BOOL"}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Converts a given True or False to the opposite value"),category:Blockly.Categories.Logic}),meta:()=>({display_name:(0,i.localize)("Logic negation"),description:(0,i.localize)("This block converts the boolean value (true or false) to its opposite.")}),getRequiredValueInputs:()=>({BOOL:null})},Blockly.JavaScript.logic_negate=e=>{const t=Blockly.JavaScript.ORDER_LOGICAL_NOT;return[`!${Blockly.JavaScript.valueToCode(e,"BOOL",t)||"true"}`,t]},Blockly.Blocks.math_change={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("change {{ variable }} by {{ number }}",{variable:"%1",number:"%2"}),args0:[{type:"field_variable",name:"VAR",variable:(0,i.localize)("item")},{type:"input_value",name:"DELTA",check:"Number"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("This block adds the given number to the selected variable"),category:Blockly.Categories.Mathematical}),meta:()=>({display_name:(0,i.localize)("Change variable"),description:(0,i.localize)("This block adds the given number to the selected variable.")}),getRequiredValueInputs:()=>({DELTA:null})},Blockly.JavaScript.math_change=e=>{const t=e.getFieldValue("VAR"),o=Blockly.JavaScript.variableDB_.getName(t,Blockly.Variables.NAME_TYPE);return`${o} = (typeof ${o} === 'number' ? ${o} : 0) + ${Blockly.JavaScript.valueToCode(e,"DELTA",Blockly.JavaScript.ORDER_ADDITION)||"0"};`},Blockly.Blocks.math_constant={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["π","PI"],["ℇ","E"],["ϕ","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(½)","SQRT1_2"],["∞","INFINITY"]]}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block gives you the selected constant values."),category:Blockly.Categories.Mathematical}),meta:()=>({display_name:(0,i.localize)("Mathematical constants"),description:(0,i.localize)("This block gives you the selected constant values.")})},Blockly.JavaScript.math_constant=e=>{const t=e.getFieldValue("CONSTANT");let o,i;return"PI"===t?(o="Math.PI",i=Blockly.JavaScript.ORDER_MEMBER):"E"===t?(o="Math.E",i=Blockly.JavaScript.ORDER_MEMBER):"GOLDEN_RATIO"===t?(o="(1 + Math.sqrt(5)) / 2",i=Blockly.JavaScript.ORDER_DIVISION):"SQRT2"===t?(o="Math.SQRT2",i=Blockly.JavaScript.ORDER_MEMBER):"SQRT1_2"===t?(o="Math.SQRT1_2",i=Blockly.JavaScript.ORDER_MEMBER):"INFINITY"===t&&(o="Infinity",i=Blockly.JavaScript.ORDER_ATOMIC),[o,i]},Blockly.Blocks.math_constrain={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("constrain {{ number }} low {{ low_number }} high {{ high_number }}",{number:"%1",low_number:"%2",high_number:"%3"}),args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block constrains a given number so that it is within a set range."),category:Blockly.Categories.Mathematical}),meta:()=>({display_name:(0,i.localize)("Constrain within a range"),description:(0,i.localize)("This block constrains a given number so that it is within a set range.")}),getRequiredValueInputs:()=>({VALUE:null,LOW:null,HIGH:null})},Blockly.JavaScript.math_constrain=e=>[`Math.min(Math.max(${Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_COMMA)||"0"}, ${Blockly.JavaScript.valueToCode(e,"LOW",Blockly.JavaScript.ORDER_COMMA)||"0"}), ${Blockly.JavaScript.valueToCode(e,"HIGH",Blockly.JavaScript.ORDER_COMMA)||"0"})`,Blockly.JavaScript.ORDER_FUNCTION_CALL],Blockly.Blocks.math_modulo={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("remainder of {{ number1 }} ÷ {{ number2 }}",{number1:"%1",number2:"%2"}),args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns the remainder after a division"),category:Blockly.Categories.Mathematical}),meta:()=>({display_name:(0,i.localize)("Remainder after division"),description:(0,i.localize)(" Returns the remainder after the division of the given numbers.")}),getRequiredValueInputs:()=>({DIVIDEND:null,DIVISOR:null})},Blockly.JavaScript.math_modulo=e=>[`${Blockly.JavaScript.valueToCode(e,"DIVIDEND",Blockly.JavaScript.ORDER_MODULUS)||"0"} % ${Blockly.JavaScript.valueToCode(e,"DIVISOR",Blockly.JavaScript.ORDER_MODULUS)||"0"}`,Blockly.JavaScript.ORDER_MODULUS],Blockly.Blocks.math_number={init(){this.jsonInit(this.definition()),this.getField("NUM").setValidator((e=>this.numberValidator(e)))},definition:()=>({message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Please use `.` as a decimal separator for fractional numbers."),category:Blockly.Categories.Mathematical}),meta:()=>({display_name:(0,i.localize)("Number"),description:(0,i.localize)("Enter an integer or fractional number into this block. Please use `.` as a decimal separator for fractional numbers.")}),numberValidator(e){if(!(/^-?([0][.]|[0-9]+[.])?([0]|[1-9]){1,}$/.test(e)&&e<Number.MAX_SAFE_INTEGER))return null}},Blockly.JavaScript.math_number=e=>[e.getFieldValue("NUM"),Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.math_number_positive={init:Blockly.Blocks.math_number.init,definition:Blockly.Blocks.math_number.definition,meta:()=>({display_name:(0,i.localize)("Math Number Positive"),description:(0,i.localize)("Math Number Description")}),numberValidator(e){if(!(/^([0][.]|[0-9]+[.])?([0]|[1-9]){1,}$/.test(e)&&e<Number.MAX_SAFE_INTEGER))return null}},Blockly.JavaScript.math_number_positive=Blockly.JavaScript.math_number,Blockly.Blocks.math_number_property={init(){this.jsonInit(this.definition()),this.setOnChange((e=>{if("PROPERTY"===e.name){const e="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");this.updateShape(e)}}))},definition:()=>({message0:(0,i.localize)("{{ number }} is {{ type }}",{number:"%1",type:"%2"}),args0:[{type:"input_value",name:"NUMBER_TO_CHECK"},{type:"field_dropdown",name:"PROPERTY",options:[[(0,i.localize)("even"),"EVEN"],[(0,i.localize)("odd"),"ODD"],[(0,i.localize)("prime"),"PRIME"],[(0,i.localize)("whole"),"WHOLE"],[(0,i.localize)("positive"),"POSITIVE"],[(0,i.localize)("negative"),"NEGATIVE"],[(0,i.localize)("divisible by"),"DIVISIBLE_BY"]]}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,toolip:(0,i.localize)("This block tests a given number according to the selection"),category:Blockly.Categories.Mathematical}),meta:()=>({display_name:(0,i.localize)("Test a number"),description:(0,i.localize)("This block tests a given number according to the selection and it returns a value of “True” or “False”. Available options: Even, Odd, Prime, Whole, Positive, Negative, Divisible")}),domToMutation(e){const t="true"===e.getAttribute("divisor_input");this.updateShape(t)},mutationToDom(){const e=document.createElement("mutation"),t="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return e.setAttribute("divisor_input",t),e},updateShape(e){const t=this.getInput("DIVISOR");e?t||(this.appendValueInput("DIVISOR").setCheck("Number"),this.initSvg(),this.render(!1)):this.removeInput("DIVISOR")},getRequiredValueInputs:()=>({NUMBER_TO_CHECK:null})},Blockly.JavaScript.math_number_property=e=>{const t=Blockly.JavaScript.valueToCode(e,"NUMBER_TO_CHECK",Blockly.JavaScript.ORDER_MODULUS)||"0",o=e.getFieldValue("PROPERTY");let i;return"PRIME"===o?(i=`${Blockly.JavaScript.provideFunction_("mathIsPrime",[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(n) {\n                // https://en.wikipedia.org/wiki/Primality_test#Naive_methods\n                if (n == 2 || n == 3) {\n                    return true;\n                }\n\n                // False if n is NaN, negative, is 1, or not whole.\n                // And false if n is divisible by 2 or 3.\n                if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {\n                    return false;\n                }\n\n                // Check all the numbers of form 6k +/- 1, up to sqrt(n).\n                for (var x  = 6; x <= Math.sqrt(n) + 1; x += 6) {\n                    if (n % (x - 1) == 0 || n % (x + 1) == 0) {\n                        return false;\n                    }\n                }\n                return true;\n            }`])}(${t})`,[i,Blockly.JavaScript.ORDER_FUNCTION_CALL]):("EVEN"===o?i=`${t} % 2 === 0`:"ODD"===o?i=`${t} % 2 === 1`:"WHOLE"===o?i=`${t} % 1 === 0`:"POSITIVE"===o?i=`${t} > 0`:"NEGATIVE"===o?i=`${t} < 0`:"DIVISIBLE_BY"===o&&(i=`${t} % ${Blockly.JavaScript.valueToCode(e,"DIVISOR",Blockly.JavaScript.ORDER_MODULUS)||"0"} == 0`),[i,Blockly.JavaScript.ORDER_EQUALITY])},Blockly.Blocks.math_on_list={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("{{ calculation }} of list {{ input_list }}",{calculation:"%1",input_list:"%2"}),args0:[{type:"field_dropdown",name:"OP",options:[[(0,i.localize)("sum"),"SUM"],[(0,i.localize)("min"),"MIN"],[(0,i.localize)("max"),"MAX"],[(0,i.localize)("average"),"AVERAGE"],[(0,i.localize)("median"),"MEDIAN"],[(0,i.localize)("mode"),"MODE"],[(0,i.localize)("antimode"),"ANTIMODE"],[(0,i.localize)("standard deviation"),"STD_DEV"],[(0,i.localize)("random item"),"RANDOM"]]},{type:"input_value",name:"LIST"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Aggregate operations"),category:Blockly.Categories.Mathematical}),meta:()=>({display_name:(0,i.localize)("Aggregate operations"),description:(0,i.localize)("This block performs the following operations on a given list: sum, minimum, maximum, average, median, mode, antimode, standard deviation, random item.")}),getRequiredValueInputs:()=>({LIST:null})},Blockly.JavaScript.math_on_list=e=>{const t=e.getFieldValue("OP");let o,i;if("SUM"===t)i=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_MEMBER)||"[]",o=`(${i} || [0]).reduce(function(x, y) { return x + y; })`;else if("MIN"===t)i=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_COMMA)||"[]",o=`Math.min.apply(null, (${i} || [0]))`;else if("MAX"===t)i=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_COMMA)||"[]",o=`Math.max.apply(null, (${i} || [0]))`;else if("AVERAGE"===t){const t=Blockly.JavaScript.provideFunction_("mathMean",[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(myList) {\n                return myList.reduce(function(x, y) { \n                    return x + y; \n                }) / myList.length;\n            }`]);i=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",o=`${t}((${i} || [0]))`}else if("MEDIAN"===t){const t=Blockly.JavaScript.provideFunction_("mathMedian",[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(myList) {\n                var localList = myList.filter(function(x) { \n                    return typeof x == 'number'; \n                });\n                if (!localList.length) {\n                    return null;\n                }\n                localList.sort(function(a, b) { \n                    return b - a; \n                });\n                if (localList.length % 2 == 0) {\n                    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;\n                } else {\n                    return localList[(localList.length - 1) / 2];\n                }\n            }`]);i=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",o=`${t}((${i} || [0]))`}else if("MODE"===t){const t=Blockly.JavaScript.provideFunction_("mathModes",[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(values) {\n                var modes = [];\n                var counts = [];\n                var maxCount = 0;\n\n                for (var i = 0; i < values.length; i++) {\n                    var value = values[i];\n                    var found = false;\n                    var thisCount;\n\n                    for (var j = 0; j < counts.length; j++) {\n                        if (counts[j][0] === value) {\n                            thisCount = ++counts[j][1];\n                            found = true;\n                            break;\n                        }\n                    }\n\n                    if (!found) {\n                        counts.push([value, 1]);\n                        thisCount = 1;\n                    }\n                    maxCount = Math.max(thisCount, maxCount);\n                }\n                \n                for (var j = 0; j < counts.length; j++) {\n                    if (counts[j][1] == maxCount) {\n                        modes.push(counts[j][0]);\n                    }\n                }\n\n                return modes;\n            }`]);i=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",o=`${t}((${i} || [0]))`}else if("ANTIMODE"===t){const t=Blockly.JavaScript.provideFunction_("mathAntiMode",[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(values) {\n                var antiMode = [];\n                var counts = [];\n                var minCount = 1;\n                var countArray = [];\n    \n                for (var i = 0; i < values.length; i++) {\n                    var value = values[i];\n                    var found = false;\n                    var thisCount;\n\n                    for (var j = 0; j < counts.length; j++) {\n                        if (counts[j][0] === value) {\n                            thisCount = ++counts[j][1];\n                            found = true;\n                            break;\n                        }\t\n                    }\n                    \n                    if (!found) {\n                        counts.push([value, 1]);\n                        thisCount = 1;\n                    }\n                }\n\n                 minCount = Math.min.apply(null, counts.map(function(element) {\n                     return element[1];\n                 }));\n\n                 for (var j = 0; j < counts.length; j++) {\n                    if (counts[j][1] == minCount) {\n                        antiMode.push(counts[j][0]);\n                    }\n                }\n\n                return antiMode;\n            }`]);i=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",o=`${t}((${i} || [0]))`}else if("STD_DEV"===t){const t=Blockly.JavaScript.provideFunction_("mathStandardDeviation",[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(numbers) {\n                var n = numbers.length;\n                if (!n) {\n                    return null;\n                }\n\n                var mean = numbers.reduce(function(x, y) {\n                    return x + y;\n                }) / n;\n\n                var variance = 0;\n                for (var j = 0; j < n; j++) {\n                    variance += Math.pow(numbers[j] - mean, 2);\n                }\n                variance = variance / n;\n                return Math.sqrt(variance);\n            }`]);i=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",o=`${t}((${i} || [0]))`}else if("RANDOM"===t){const t=Blockly.JavaScript.provideFunction_("mathRandomList",[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(list) {\n                var x = Math.floor(Math.random() * list.length);\n                return list[x];\n            }`]);i=Blockly.JavaScript.valueToCode(e,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]",o=`${t}((${i} || [0]))`}return[o,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.math_random_float={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("random fraction"),output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block gives you a random fraction between 0.0 to 1.0"),category:Blockly.Categories.Mathematical}),meta:()=>({display_name:(0,i.localize)("Random fraction number"),description:(0,i.localize)("This block gives you a random fraction between 0.0 to 1.0.")})},Blockly.JavaScript.math_random_float=()=>["Math.random()",Blockly.JavaScript.ORDER_FUNCTION_CALL],Blockly.Blocks.math_random_int={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("random integer from {{ start_number }} to {{ end_number }}",{start_number:"%1",end_number:"%2"}),args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block gives you a random number from within a set range"),category:Blockly.Categories.Mathematical}),meta:()=>({display_name:(0,i.localize)("Random integer"),description:(0,i.localize)("This block gives you a random number from within a set range.")}),getRequiredValueInputs:()=>({FROM:null,TO:null})},Blockly.JavaScript.math_random_int=e=>{const t=Blockly.JavaScript.valueToCode(e,"FROM",Blockly.JavaScript.ORDER_COMMA)||"0",o=Blockly.JavaScript.valueToCode(e,"TO",Blockly.JavaScript.ORDER_COMMA)||"0";return[`${Blockly.JavaScript.provideFunction_("mathRandomInt",[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(a, b) {\n            if (a > b) {\n                // Swap a and b to ensure a is smaller.\n                var c = a;\n                a = b;\n                b = c;\n            }\n            return Math.floor(Math.random() * (b - a + 1) + a);\n        }`])}(${t}, ${o})`,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.math_round={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["round","ROUND"],["round up","ROUNDUP"],["round down","ROUNDDOWN"]]},{type:"input_value",name:"NUM"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Rounds a given number to an integer"),category:Blockly.Categories.Mathematical}),meta:()=>({display_name:(0,i.localize)("Rounding operation"),description:(0,i.localize)("This block rounds a given number according to the selection: round, round up, round down.")}),getRequiredValueInputs:()=>({NUM:null})},Blockly.JavaScript.math_round=e=>{const t=e.getFieldValue("OP"),o=Blockly.JavaScript.valueToCode(e,"NUM",Blockly.JavaScript.ORDER_ATOMIC)||"0";let i;return"ROUND"===t?i=`Math.round(${o})`:"ROUNDUP"===t?i=`Math.ceil(${o})`:"ROUNDDOWN"===t&&(i=`Math.floor(${o})`),[i,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.math_arithmetic={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["+","ADD"],["-","MINUS"],["*","MULTIPLY"],["/","DIVIDE"],["^","POWER"]]},{type:"input_value",name:"B",check:"Number"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("This block performs arithmetic operations between two numbers."),category:Blockly.Categories.Mathematical}),meta:()=>({display_name:(0,i.localize)("Arithmetical operations"),description:(0,i.localize)("This block performs arithmetic operations between two numbers.")}),getRequiredValueInputs:()=>({A:null,B:null})},Blockly.JavaScript.math_arithmetic=e=>{const t={ADD:["+",Blockly.JavaScript.ORDER_ADDITION],MINUS:["-",Blockly.JavaScript.ORDER_SUBTRACTION],MULTIPLY:["*",Blockly.JavaScript.ORDER_MULTIPLICATION],DIVIDE:["/",Blockly.JavaScript.ORDER_DIVISION],POWER:[null,Blockly.JavaScript.ORDER_COMMA]}[e.getFieldValue("OP")],o=t[0],i=t[1],n=Blockly.JavaScript.valueToCode(e,"A",i)||"0",r=Blockly.JavaScript.valueToCode(e,"B",i)||"0";let a;return o?(a=`${n} ${o} ${r}`,[a,i]):(a=`Math.pow(${n}, ${r})`,[a,Blockly.JavaScript.ORDER_FUNCTION_CALL])},Blockly.Blocks.math_single={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[[(0,i.localize)("square root"),"ROOT"],[(0,i.localize)("absolute"),"ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Operations on a given number"),category:Blockly.Categories.Mathematical}),meta:()=>({display_name:(0,i.localize)("Operations on a given number"),description:(0,i.localize)("This block performs the selected operations to a given number.")}),getRequiredValueInputs:()=>({NUM:null})},Blockly.JavaScript.math_single=e=>{const t=e.getFieldValue("OP");let o,i;return"NEG"===t?(i=Blockly.JavaScript.valueToCode(e,"NUM",Blockly.JavaScript.ORDER_UNARY_NEGATION)||"0","-"===i[0]&&(i=` ${i}`),o=`-${i}`,[o,Blockly.JavaScript.ORDER_UNARY_NEGATION]):(i=["SIN","COS","TAN"].includes(t)?Blockly.JavaScript.valueToCode(e,"NUM",Blockly.JavaScript.ORDER_DIVISION)||"0":Blockly.JavaScript.valueToCode(e,"NUM",Blockly.JavaScript.ORDER_NONE)||"0","ABS"===t?o=`Math.abs(${i})`:"ROOT"===t?o=`Math.sqrt(${i})`:"LN"===t?o=`Math.log(${i})`:"EXP"===t?o=`Math.pow(Math.E, ${i})`:"POW10"===t?o=`Math.pow(10, ${i})`:"ROUND"===t?o=`Math.round(${i})`:"ROUNDUP"===t?o=`Math.ceil(${i})`:"ROUNDDOWN"===t?o=`Math.floor(${i})`:"SIN"===t?o=`Math.sin(${i} / 180 * Math.PI)`:"COS"===t?o=`Math.cos(${i} / 180 * Math.PI)`:"TAN"===t&&(o=`Math.tan(${i} / 180 * Math.PI)`),o?[o,Blockly.JavaScript.ORDER_FUNCTION_CALL]:("LOG10"===t?o=`Math.log(${i}) / Math.log(10)`:"ASIN"===t?o=`Math.asin(${i}) / Math.PI * 180`:"ACOS"===t?o=`Math.acos(${i}) / Math.PI * 180`:"ATAN"===t&&(o=`Math.atan(${i}) / Math.PI * 180`),[o,Blockly.JavaScript.ORDER_DIVISION]))},Blockly.Blocks.math_trig={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["sin","SIN"],["cos","COS"],["tan","TAN"],["asin","ASIN"],["acos","ACOS"],["atan","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Trigonometric functions"),category:Blockly.Categories.Mathematical}),meta:()=>({display_name:(0,i.localize)("Trigonometric functions"),description:(0,i.localize)("This block performs trigonometric functions.")}),getRequiredValueInputs:()=>({NUM:null})},Blockly.JavaScript.math_trig=Blockly.JavaScript.math_single,Blockly.Blocks.text={init(){this.jsonInit(this.definition())},definition:()=>({message0:"%1",args0:[{type:"field_input",name:"TEXT"}],output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Enter some text here"),category:Blockly.Categories.Text}),meta:()=>({display_name:(0,i.localize)("Text"),description:(0,i.localize)("A  block that can contain text.")})},Blockly.JavaScript.text=e=>[Blockly.JavaScript.quote_(e.getFieldValue("TEXT")),Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.text_join={protected_statements:["STACK"],allowed_children:["text_statement"],init(){const e=new Blockly.FieldImage(n.M8,25,25,"",this.onIconClick.bind(this));this.jsonInit(this.definition()),this.appendDummyInput("ADD_ICON").appendField(e),this.moveInputBefore("ADD_ICON","STACK")},definition:()=>({message0:(0,i.localize)("set {{ variable }} to create text with",{variable:"%1"}),message1:"%1",args0:[{type:"field_variable",name:"VARIABLE",variable:(0,i.localize)("text")}],args1:[{type:"input_statement",name:"STACK"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Text join"),category:Blockly.Categories.Text}),meta:()=>({display_name:(0,i.localize)("Text join"),description:(0,i.localize)("Creates a single text string from combining the text value of each attached item, without spaces in between. The number of items can be added accordingly.")}),onIconClick(){this.workspace.options.readOnly||this.isInFlyout||(0,r.UR)(!1,(()=>{const e=this.workspace.newBlock("text_statement");e.required_parent_id=this.id,e.setMovable(!0),e.initSvg(),e.render();const t=this.workspace.newBlock("text");t.setShadow(!0),t.setFieldValue("","TEXT"),t.initSvg(),t.render(),e.getInput("TEXT").connection.connect(t.outputConnection),this.getLastConnectionInStatement("STACK").connect(e.previousConnection)}))},onchange:Blockly.Blocks.lists_create_with.onchange},Blockly.JavaScript.text_join=e=>`${Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VARIABLE"),Blockly.Variables.NAME_TYPE)} = [${e.getBlocksInStatement("STACK").map((e=>{const t=Blockly.JavaScript[e.type](e);return Array.isArray(t)?t[0]:t}))}].join(" ");\n`,Blockly.Blocks.text_statement={required_parent_type:"text_join",init(){this.required_parent_id="";const e=new Blockly.FieldImage(n.fK,25,25,"",this.onIconClick.bind(this));this.jsonInit(this.definition()),this.appendDummyInput("REMOVE_ICON").appendField(e)},definition:()=>({message0:"%1",args0:[{type:"input_value",name:"TEXT"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,category:Blockly.Categories.Text}),meta:()=>({display_name:(0,i.localize)("Text Statement"),description:""}),onchange(e){if(!this.workspace||this.isInFlyout||this.workspace.isDragging())return;const t=this.getSurroundParent();if(e.type===Blockly.Events.BLOCK_CREATE&&(this.setMovable(!0),this.required_parent_id||(null==t?void 0:t.type)!==this.required_parent_type||(this.required_parent_id=t.id)),e.type===Blockly.Events.END_DRAG){const o=Blockly.getMainWorkspace().getBlockById(e.blockId);if(this.required_parent_id&&(!t||t.id!==this.required_parent_id)){const e=Blockly.getMainWorkspace().getBlockById(this.required_parent_id);if(e)if(e.getInputTargetBlock("STACK")){const t=e.getLastConnectionInStatement("STACK");(0,r.$9)((()=>{t.connect(this.previousConnection)}))}else(0,r.$9)((()=>{e.getInput("STACK").connection.connect(o.previousConnection)}))}}},onIconClick:Blockly.Blocks.lists_statement.onIconClick},Blockly.JavaScript.text_statement=e=>[`String(${Blockly.JavaScript.valueToCode(e,"TEXT",Blockly.JavaScript.ORDER_ATOMIC)})`,Blockly.JavaScript.ORDER_ATOMIC],Blockly.Blocks.text_append={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("to {{ variable }} append text {{ input_text }}",{variable:"%1",input_text:"%2"}),args0:[{type:"field_variable",name:"VAR",variable:(0,i.localize)("text")},{type:"input_value",name:"TEXT"}],colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Appends a given text to a variable"),category:Blockly.Categories.Text}),meta:()=>({display_name:(0,i.localize)("Text Append"),description:(0,i.localize)("Appends a given text to a variable.")}),getRequiredValueInputs:()=>({TEXT:r.cM})},Blockly.JavaScript.text_append=e=>{return`${Blockly.JavaScript.variableDB_.getName(e.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE)} += ${t=Blockly.JavaScript.valueToCode(e,"TEXT",Blockly.JavaScript.ORDER_NONE)||"''",/^\s*'([^']|\\')*'\s*$/.test(t)?t:`String(${t})`};\n`;var t},Blockly.Blocks.text_length={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("length of {{ input_text }}",{input_text:"%1"}),args0:[{type:"input_value",name:"VALUE"}],output:"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Text String Length"),category:Blockly.Categories.Text}),meta:()=>({display_name:(0,i.localize)("Text String Length"),description:(0,i.localize)("Returns the number of characters of a given string of text, including numbers, spaces, punctuation marks, and symbols.")}),getRequiredValueInputs:()=>({VALUE:r.cM})},Blockly.JavaScript.text_length=e=>[`${Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_FUNCTION_CALL)||"''"}.length`,Blockly.JavaScript.ORDER_MEMBER],Blockly.Blocks.text_isEmpty={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("text {{ input_text }} is empty",{input_text:"%1"}),args0:[{type:"input_value",name:"VALUE",check:["String"]}],output:"Boolean",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Tests if a given text string is empty"),category:Blockly.Categories.Text}),meta:()=>({display_name:(0,i.localize)("Text Is empty"),description:(0,i.localize)("Tests whether a string of text is empty. Returns a boolean value (true or false).")}),getRequiredValueInputs:()=>({VALUE:r.cM})},Blockly.JavaScript.text_isEmpty=e=>{const t=Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"''";return[-1!==e.workspace.getAllVariables().findIndex((e=>e.name===t))?`!${t} || !${t}.length`:`!${t}.length`,Blockly.JavaScript.ORDER_LOGICAL_NOT]},Blockly.Blocks.text_indexOf={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("in text {{ input_text1 }} find {{ first_or_last }} occurence of text {{ input_text2 }}",{input_text1:"%1",first_or_last:"%2",input_text2:"%3"}),args0:[{type:"input_value",name:"VALUE"},{type:"field_dropdown",name:"END",options:[[(0,i.localize)("first"),"FIRST"],[(0,i.localize)("last"),"LAST"]]},{type:"input_value",name:"FIND"}],output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Search for a given string"),cateogry:Blockly.Categories.Text}),meta:()=>({display_name:(0,i.localize)("Search for string"),description:(0,i.localize)("Searches through a string of text for a specific occurrence of a given character or word, and returns the position.")}),getRequiredValueInputs:()=>({VALUE:r.cM,FIND:r.cM})},Blockly.JavaScript.text_indexOf=e=>{const t="FIRST"===e.getFieldValue("END")?"indexOf":"lastIndexOf",o=Blockly.JavaScript.valueToCode(e,"FIND",Blockly.JavaScript.ORDER_NONE)||"''",i=`${Blockly.JavaScript.valueToCode(e,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"''"}.${t}(${o})`;return e.workspace.options.oneBasedIndex?[`${i} + 1`,Blockly.JavaScript.ORDER_ADDITION]:[i,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.text_charAt={init(){this.jsonInit(this.definition()),this.getField("WHERE").setValidator((e=>{const t=["FROM_START","FROM_END"].includes(e);if(t!==this.isAt)return this.updateAt(t),this.setFieldValue(e,"WHERE"),null})),this.updateAt(!0)},definition:()=>({message0:(0,i.localize)("in text %1 get %2"),args0:[{type:"input_value",name:"VALUE"},{type:"field_dropdown",name:"WHERE",options:[[(0,i.localize)("letter #"),"FROM_START"],[(0,i.localize)("letter # from end"),"FROM_END"],[(0,i.localize)("first letter"),"FIRST"],[(0,i.localize)("last letter"),"LAST"],[(0,i.localize)("random letter"),"RANDOM"]]}],output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns a specific character from a given string"),category:Blockly.Categories.Text}),meta:()=>({display_name:(0,i.localize)("Get character"),description:(0,i.localize)("Returns the specific character from a given string of text according to the selected option. ")}),mutationToDom(){const e=document.createElement("mutation");return e.setAttribute("at",!!this.isAt),e},domToMutation(e){const t="false"!==e.getAttribute("at");this.updateAt(t)},updateAt(e){this.removeInput("AT",!0),e&&this.appendValueInput("AT").setCheck("Number"),this.isAt=e,this.initSvg(),this.render(!1)},getRequiredValueInputs:()=>({VALUE:r.cM,AT:r.cM})},Blockly.JavaScript.text_charAt=e=>{const t=e.getFieldValue("WHERE")||"FROM_START",o="RANDOM"===t?Blockly.JavaScript.ORDER_NONE:Blockly.JavaScript.ORDER_MEMBER,i=Blockly.JavaScript.valueToCode(e,"VALUE",o)||"''";let n;return"FROM_START"===t?n=`${i}.charAt(${Blockly.JavaScript.getAdjusted(e,"AT")})`:"FROM_END"===t?n=`${i}.slice(${Blockly.JavaScript.getAdjusted(e,"AT",1,!0)}).charAt(0)`:"FIRST"===t?n=`${i}.charAt(0)`:"LAST"===t?n=`${i}.slice(-1)`:"RANDOM"===t&&(n=`${Blockly.JavaScript.provideFunction_("textRandomLetter",[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(text) {\n                var x = Math.floor(Math.random() * text.length);\n                return text[x];\n            }`])}(${i})`),[n,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.text_getSubstring={init(){this.WHERE_OPTIONS_1=[[(0,i.localize)("letter #"),"FROM_START"],[(0,i.localize)("letter # from end"),"FROM_END"],[(0,i.localize)("first"),"FIRST"]],this.WHERE_OPTIONS_2=[[(0,i.localize)("letter #"),"FROM_START"],[(0,i.localize)("letter # from end"),"FROM_END"],[(0,i.localize)("last"),"LAST"]],this.jsonInit(this.definition()),this.updateAt(1,!0),this.updateAt(2,!0)},definition(){return{message0:(0,i.localize)("in text {{ input_text }} get substring from {{ position1 }} {{ index1 }} to {{ position2 }} {{ index2 }}",{input_text:"%1",position1:"%2",index1:"%3",position2:"%4",index2:"%5"}),args0:[{type:"input_value",name:"STRING"},{type:"field_dropdown",name:"WHERE1",options:this.WHERE_OPTIONS_1},{type:"input_dummy",name:"AT1"},{type:"field_dropdown",name:"WHERE2",options:this.WHERE_OPTIONS_2},{type:"input_dummy",name:"AT2"}],output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Returns a specific portion of a given string of text."),category:Blockly.Categories.Text}},meta:()=>({display_name:(0,i.localize)("Get substring"),description:(0,i.localize)("Returns a specific portion of a given string of text.")}),mutationToDom(){const e=document.createElement("mutation"),t=this.getInput("AT1").type===Blockly.INPUT_VALUE,o=this.getInput("AT2").type===Blockly.INPUT_VALUE;return e.setAttribute("at1",t),e.setAttribute("at2",o),e},domToMutation(e){const t="true"===e.getAttribute("at1"),o="true"===e.getAttribute("at2");this.updateAt(1,t),this.updateAt(2,o)},updateAt(e,t){const o=this.getInput(`AT${e}`);let i;o&&(o.fieldRow.some((e=>{e instanceof Blockly.FieldLabel&&(i=e.text_)})),this.removeInput(`AT${e}`));const n=t?this.appendValueInput(`AT${e}`).setCheck("Number"):this.appendDummyInput(`AT${e}`);i&&n.insertFieldAt(0,new Blockly.FieldLabel(i));const r=new Blockly.FieldDropdown(this[`WHERE_OPTIONS_${e}`],(o=>{const i=["FROM_START","FROM_END"].includes(o);if(i!==t)return this.updateAt(e,i),this.setFieldValue(o,`WHERE${e}`),null}));this.getInput(`AT${e}`).appendField(r,`WHERE${e}`),1===e&&this.moveInputBefore("AT1","AT2"),this.initSvg(),this.render(!1)},getRequiredValueInputs(){const e=e=>{var t;return(null===(t=this.getInput(e))||void 0===t?void 0:t.type)===Blockly.INPUT_VALUE};return m(m({STRING:r.cM},e("AT1")?{AT1:r.cM}:{}),e("AT2")?{AT2:r.cM}:{})}},Blockly.JavaScript.text_getSubstring=e=>{const t=Blockly.JavaScript.valueToCode(e,"STRING",Blockly.JavaScript.ORDER_FUNCTION_CALL)||"''",o=e.getFieldValue("WHERE1"),i=e.getFieldValue("WHERE2");let n,r,a;if("FIRST"===o&&"LAST"===i)a=t;else if(t.match(/^'?\w+'?$/)||"FROM_END"!==o&&"LAST"!==o&&"FROM_END"!==i&&"LAST"!==i){switch(o){case"FROM_START":n=Blockly.JavaScript.getAdjusted(e,"AT1");break;case"FROM_END":n=Blockly.JavaScript.getAdjusted(e,"AT1",1,!1,Blockly.JavaScript.ORDER_SUBTRACTION),n=`${t}.length - ${n}`;break;case"FIRST":n="0"}switch(i){case"FROM_START":r=Blockly.JavaScript.getAdjusted(e,"AT2",1);break;case"FROM_END":r=Blockly.JavaScript.getAdjusted(e,"AT2",0,!1,Blockly.JavaScript.ORDER_SUBTRACTION),r=`${t}.length - ${r}`;break;case"LAST":r=`${t}.length`}a=`${t}.slice(${n}, ${r})`}else{n=Blockly.JavaScript.getAdjusted(e,"AT1"),r=Blockly.JavaScript.getAdjusted(e,"AT2");const l=(e,t,o)=>"FIRST"===t?"0":"FROM_END"===t?`${e}.length - 1 - ${o}`:"LAST"===t?`${e}.length - 1`:o,s={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};a=`${Blockly.JavaScript.provideFunction_(`subsequence${s[o]}${s[i]}`,[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(\n                    sequence\n                    ${"FROM_END"===o||"FROM_START"===o?", at1":""}\n                    ${"FROM_END"===i||"FROM_START"===i?", at2":""}\n                ) {\n                    var start = ${l("sequence",o,"at1")};\n                    var end   = ${l("sequence",i,"at2")} + 1;\n                    \n                    return sequence.slice(start, end);\n                }`])}(\n            ${t}\n            ${"FROM_END"===o||"FROM_START"===o?`, ${n}`:""}\n            ${"FROM_END"===i||"FROM_START"===i?`, ${r}`:""}\n        )`}return[a,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.text_changeCase={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("Transform {{ input_text }} to {{ transform_type }}",{input_text:"%1",transform_type:"%2"}),args0:[{type:"input_value",name:"TEXT"},{type:"field_dropdown",name:"CASE",options:[[(0,i.localize)("UPPER CASE"),"UPPERCASE"],[(0,i.localize)("lower case"),"LOWERCASE"],[(0,i.localize)("Title Case"),"TITLECASE"]]}],output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Changes text case accordingly"),category:Blockly.Categories.Text}),meta:()=>({display_name:(0,i.localize)("Change text case"),description:(0,i.localize)("Changes the capitalisation of a string of text to Upper case, Lower case, Title case.")}),getRequiredValueInputs:()=>({TEXT:r.cM})},Blockly.JavaScript.text_changeCase=e=>{const t={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[e.getFieldValue("CASE")],o=t?Blockly.JavaScript.ORDER_MEMBER:Blockly.JavaScript.ORDER_NONE,i=Blockly.JavaScript.valueToCode(e,"TEXT",o)||"''";let n;return n=t?`${i}${t}`:`${Blockly.JavaScript.provideFunction_("textToTitleCase",[`function ${Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_}(str) {\n                return str.toLowerCase().split(' ').map(function(word) {\n                    return word.replace(word[0], word[0].toUpperCase());\n                }).join(' ');\n            }`])}(${i})`,[n,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.text_trim={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("trim spaces from {{ side }} of {{ input_text }}",{side:"%1",input_text:"%2"}),args0:[{type:"field_dropdown",name:"MODE",options:[[(0,i.localize)("both sides"),"BOTH"],[(0,i.localize)("left side"),"LEFT"],[(0,i.localize)("right side"),"RIGHT"]]},{type:"input_value",name:"TEXT"}],output:"String",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Base.colour,colourSecondary:Blockly.Colours.Base.colourSecondary,colourTertiary:Blockly.Colours.Base.colourTertiary,tooltip:(0,i.localize)("Trims spaces"),category:Blockly.Categories.Text}),meta:()=>({display_name:(0,i.localize)("Trim spaces"),description:(0,i.localize)("Trims the spaces within a given string or text.")}),getRequiredValueInputs:()=>({TEXT:r.cM})},Blockly.JavaScript.text_trim=e=>{const t={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[e.getFieldValue("MODE")];return[`${Blockly.JavaScript.valueToCode(e,"TEXT",Blockly.JavaScript.ORDER_MEMBER)||"''"}${t}`,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.Blocks.text_print={init(){this.jsonInit(this.definition())},definition:()=>({message0:(0,i.localize)("print {{ input_text }}",{input_text:"%1"}),args0:[{type:"input_value",name:"TEXT"}],colour:Blockly.Colours.Special3.colour,colourSecondary:Blockly.Colours.Special3.colourSecondary,colourTertiary:Blockly.Colours.Special3.colourTertiary,previousStatement:null,nextStatement:null,tooltip:(0,i.localize)("Displays a dialog window with a message"),category:Blockly.Categories.Text}),meta:()=>({display_name:(0,i.localize)("Print"),description:(0,i.localize)('This block displays a dialog box with a customised message. When the dialog box is displayed, your strategy is paused and will only resume after you click "OK".')}),getRequiredValueInputs:()=>({TEXT:r.cM})},Blockly.JavaScript.text_print=e=>`window.alert(${Blockly.JavaScript.valueToCode(e,"TEXT",Blockly.JavaScript.ORDER_NONE)||"''"});\n`,Blockly.Blocks.text_prompt_ext={init(){this.jsonInit(this.definition()),this.getField("TYPE").setValidator((e=>{"TEXT"===e?this.setOutput(!0,"String"):"NUMBER"===e&&this.setOutput(!0,"Number"),this.initSvg(),this.render(!1)}))},definition(){return{message0:(0,i.localize)("prompt for {{ string_or_number }} with message {{ input_text }}",{string_or_number:"%1",input_text:"%2"}),args0:[{type:"field_dropdown",name:"TYPE",options:[[(0,i.localize)("string"),"TEXT"],[(0,i.localize)("number"),"NUMBER"]]},{type:"input_value",name:"TEXT"}],output:"function"==typeof this.getFieldValue&&"TEXT"===this.getFieldValue("TYPE")?"String":"Number",outputShape:Blockly.OUTPUT_SHAPE_ROUND,colour:Blockly.Colours.Special3.colour,colourSecondary:Blockly.Colours.Special3.colourSecondary,colourTertiary:Blockly.Colours.Special3.colourTertiary,tooltip:(0,i.localize)("Request an input"),category:Blockly.Categories.Text}},meta:()=>({display_name:(0,i.localize)("Request an input"),description:(0,i.localize)('This block displays a dialog box that uses a customised message to prompt for an input. The input can be either a string of text or a number and can be assigned to a variable. When the dialog box is displayed, your strategy is paused and will only resume after you enter a response and click "OK".')}),getRequiredValueInputs:()=>({TEXT:r.cM})},Blockly.JavaScript.text_prompt_ext=e=>{let t,o;return t=e.getField("TEXT")?Blockly.JavaScript.quote_(e.getFieldValue("TEXT")):Blockly.JavaScript.valueToCode(e,"TEXT",Blockly.JavaScript.ORDER_NONE)||"''",o="NUMBER"===e.getFieldValue("TYPE")?`parseFloat(window.prompt(${t}))`:`window.prompt(${t})`,[o,Blockly.JavaScript.ORDER_FUNCTION_CALL]}},282:(e,t,o)=>{"use strict";o.d(t,{Z:()=>n});class i extends class{constructor(){this.handleFileChange=()=>{throw Error("handleFileChange has not been implemented.")},this.toggleStrategyModal=()=>{throw Error("handleFileChange has not been implemented.")}}}{constructor(e){super(),this.is_mobile=e.is_mobile||!1,this.is_dark_mode_on=e.is_dark_mode_on||!1,this.client=e.client,this.flyout=e.flyout,this.toolbar=e.toolbar,this.toolbox=e.toolbox,this.save_modal=e.save_modal,this.toggleStrategyModal=e.toggleStrategyModal,this.handleFileChange=e.handleFileChange,this.startLoading=e.startLoading,this.endLoading=e.endLoading}static setInstance(e){return this.singleton=new i(e),this.instance}static get instance(){return this.singleton}}i.singleton=null;const n=i},129:()=>{Blockly.BlockSvg.MIN_BLOCK_X_WITH_STATEMENT=100*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.START_HAT_PATH=`m 0,${Blockly.BlockSvg.CORNER_RADIUS} A ${Blockly.BlockSvg.CORNER_RADIUS}, ${Blockly.BlockSvg.CORNER_RADIUS} 0 0,1 ${Blockly.BlockSvg.CORNER_RADIUS},0`,Blockly.BlockSvg.EXTRA_STATEMENT_ROW_Y=10*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.EDITABLE_FIELD_PADDING=16,Blockly.BlockSvg.prototype.updateColour=function(){let e=this.getColourTertiary();const t=this.isShadow()&&!Blockly.scratchBlocksUtils.isShadowArgumentReporter(this);t&&this.parentBlock_&&(e=this.parentBlock_.getColourTertiary(),this.inputList[0]&&this.inputList[0].fieldRow[0]&&(this.inputList[0].fieldRow[0]instanceof Blockly.FieldColour||this.inputList[0].fieldRow[0]instanceof Blockly.FieldColourSlider)&&(e=Blockly.Colours.colourPickerStroke)),this.svgPath_.setAttribute("stroke",e);let o=this.getColour();(this.isGlowingBlock_||t)&&(o=this.getShadowColour()?this.getShadowColour():this.getColourSecondary()),this.svgPath_.setAttribute("fill",o),this.svgPath_.setAttribute("fill-opacity",this.getOpacity());for(let e,t=0;e=this.inputList[t];t++)e.outlinePath&&e.outlinePath.setAttribute("fill",this.getColourTertiary());const i=this.getIcons();for(let e=0;e<i.length;e++)i[e].updateColour();for(let e,t=0;e=this.inputList[t];t++)for(let t,o=0;t=e.fieldRow[o];o++)t.setText(null);this.inputList.forEach((e=>{e.outlinePath&&(e.outlinePath.setAttribute("fill","#fff"),e.outlinePath.setAttribute("stroke","#6d7278"),e.outlinePath.setAttribute("stroke-width","0.3px"))}))},Blockly.BlockSvg.prototype.computeOutputPadding_=function(e){if(!this.getOutputShape()||!this.outputConnection||this.isShadow()&&!Blockly.scratchBlocksUtils.isShadowArgumentReporter(this))return;if(e.length>1)return;const t=e[0],o=this.getOutputShape();t.paddingStart=0,t.paddingEnd=0;const i=t[0];let n;if(i.fieldRow[0])n=0;else{const e=i.connection;if(!e)return;if(n=e.targetConnection?e.targetConnection.getSourceBlock().getOutputShape():e.getOutputShape(),o===Blockly.OUTPUT_SHAPE_HEXAGONAL&&n!==Blockly.OUTPUT_SHAPE_HEXAGONAL){const e=i.renderHeight-Blockly.BlockSvg.MIN_BLOCK_Y_REPORTER;t.paddingStart+=e/2}}t.paddingStart+=Blockly.BlockSvg.SHAPE_IN_SHAPE_PADDING[o][n];const r=t[t.length-1];if(r.connection){const e=r.connection;if(n=e.targetConnection?e.targetConnection.getSourceBlock().getOutputShape():e.getOutputShape(),o===Blockly.OUTPUT_SHAPE_HEXAGONAL&&n!==Blockly.OUTPUT_SHAPE_HEXAGONAL){const e=r.renderHeight-Blockly.BlockSvg.MIN_BLOCK_Y_REPORTER;t.paddingEnd+=e/2}}else n=0;t.paddingEnd+=Blockly.BlockSvg.SHAPE_IN_SHAPE_PADDING[o][n]}},2646:()=>{Blockly.Colours.RootBlock={colour:"#064e72",colourSecondary:"#064e72",colourTertiary:"#6d7278"},Blockly.Colours.Base={colour:"#e5e5e5",colourSecondary:"#ffffff",colourTertiary:"#6d7278"},Blockly.Colours.Special1={colour:"#e5e5e5",colourSecondary:"#ffffff",colourTertiary:"#6d7278"},Blockly.Colours.Special2={colour:"#e5e5e5",colourSecondary:"#ffffff",colourTertiary:"#6d7278"},Blockly.Colours.Special3={colour:"#e5e5e5",colourSecondary:"#ffffff",colourTertiary:"#6d7278"}},7779:()=>{Blockly.Connection.prototype.getOutputShape=function(){return Blockly.OUTPUT_SHAPE_ROUND}},1863:()=>{Blockly.Categories={Trade_Definition:"trade_parameters",Before_Purchase:"purchase_conditions",During_Purchase:"sell_conditions",After_Purchase:"trade_results",Mathematical:"math",Logic:"logic",Text:"text",Variables:"variables",Functions:"custom_functions",List:"lists",Indicators:"indicators",Time:"time",Tick_Analysis:"technical_analysis",Candle:"candle",Miscellaneous:"miscellaneous",Loop:"loops"},Blockly.DRAG_RADIUS=3,Blockly.FLYOUT_DRAG_RADIUS=1},119:()=>{Blockly.Css.CONTENT=["@keyframes blinkEffect {","0% {","stroke: var(--status-danger);","stroke-width: 5px;","}","50% {","stroke: var(--status-warning);","stroke-width: 8px;","}","100% {","stroke: var(--status-danger);","stroke-width: 5px;","}","}",".block--error-highlighted > .blocklyPath {","stroke: var(--status-danger);","stroke-width: 5px;","}","@keyframes fade-in-out {","0%{","stroke-opacity: 0;","}","50%{","stroke-opacity: 1;","stroke-width: 6px;","}","100%{","stroke-opacity: 0;","}}",".block--execution-highlighted > .blocklyPath {","stroke: #89B2AF;","animation: fade-in-out 1.5s","}",".block--blink > .blocklyPath {","animation: blinkEffect 1s infinite;","}",".blocklySvg {","outline: none;","overflow: hidden;","position: absolute;","display: block;","}",".blocklyRelativeWrapper {","position: relative;","width: 100%;","height: 100%;","}",".blocklyWidgetDiv {","display: none;","position: absolute;","z-index: 99999;","}",".injectionDiv {","height: 100%;","position: relative;","overflow: hidden;","touch-action: none","}",".blocklyNonSelectable {","user-select: none;","-moz-user-select: none;","-webkit-user-select: none;","-ms-user-select: none;","}",".blocklyWidgetDiv.fieldTextInput {","overflow: hidden;","border: 1px solid;","box-sizing: border-box;","transform-origin: 0 0;","-ms-transform-origin: 0 0;","-moz-transform-origin: 0 0;","-webkit-transform-origin: 0 0;","}",".blocklyWidgetDiv.fieldTextInput.removableTextInput {","overflow: visible;","}",".blocklyTextDropDownArrow {","position: absolute;","}",".blocklyTextRemoveIcon {","position: absolute;","width: 24px;","height: 24px;","top: -40px;","left: 50%;","margin-left: -12px;","cursor: pointer;","}",".blocklyNonSelectable {","user-select: none;","-moz-user-select: none;","-webkit-user-select: none;","-ms-user-select: none;","}",".blocklyWsDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","}",".blocklyWsDragSurface.blocklyOverflowVisible {","overflow: visible;","}",".blocklyBlockDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","right: 0;","bottom: 0;","overflow: visible !important;","z-index: 50;","}",".blocklyTooltipDiv {","min-height: 34px;","background-color: #d6dadb;","border-radius: 4px;","color: var(--text-prominent);","padding: 8px;","font-size: 12px;",'font-family: "IBM Plex Sans";',"line-height: 1.5;","letter-spacing: normal;","position: absolute;","z-index: 100000;","}",".blocklyDropDownDiv {","position: fixed;","left: 0;","top: 0;","z-index: 1000;","display: none;","border: 1px solid;","border-radius: 4px;",`box-shadow: 0px 0px 8px 1px ${Blockly.Colours.dropDownShadow};`,"padding: 4px;","-webkit-user-select: none;","min-height: 15px","}",".blocklyDropDownContent {","max-height: 300px;","overflow: auto;","}",".blocklyDropDownArrow {","position: absolute;","left: 0;","top: 0;","width: 16px;","height: 16px;","z-index: -1;","background-color: inherit;","border-color: inherit;","}",".blocklyDropDownButton {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","border-radius: 4px;","outline: none;","border: 1px solid;","transition: box-shadow .1s;","cursor: pointer;","}",".blocklyDropDownButtonHover {",`box-shadow: 0px 0px 0px 4px ${Blockly.Colours.fieldShadow};`,"}",".blocklyDropDownButton:active {",`box-shadow: 0px 0px 0px 6px ${Blockly.Colours.fieldShadow};`,"}",".blocklyDropDownButton > img {","width: 80%;","height: 80%;","margin-top: 5%","}",".blocklyDropDownPlaceholder {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","}",".blocklyNumPadButton {","display: inline-block;","float: left;","padding: 0;","width: 48px;","height: 48px;","margin: 4px;","border-radius: 4px;","background: $colour_numPadBackground;","color: $colour_numPadText;","outline: none;","border: 1px solid $colour_numPadBorder;","cursor: pointer;","font-weight: 600;","font-size: 12pt;","-webkit-tap-highlight-color: rgba(0,0,0,0);","}",".blocklyNumPadButton > img {","margin-top: 10%;","width: 80%;","height: 80%;","}",".blocklyNumPadButton:active {","background: $colour_numPadActiveBackground;","-webkit-tap-highlight-color: rgba(0,0,0,0);","}",".arrowTop {","border-top: 1px solid;","border-left: 1px solid;","border-top-left-radius: 4px;","border-color: inherit;","}",".arrowBottom {","border-bottom: 1px solid;","border-right: 1px solid;","border-bottom-right-radius: 4px;","border-color: inherit;","}",".valueReportBox {","min-width: 50px;","max-width: 300px;","max-height: 200px;","overflow: auto;","word-wrap: break-word;","text-align: center;","font-size: .8em;","}",".blocklyResizeSE {","cursor: se-resize;","fill: #aaa;","}",".blocklyResizeSW {","cursor: sw-resize;","fill: #aaa;","}",".blocklyResizeLine {","stroke: #888;","stroke-width: 1;","}",".blocklyHighlightedConnectionPath {","fill: none;","stroke: #fc3;","stroke-width: 4px;","}",".blocklyPath {","stroke-width: 0.3px;","}",".blocklySelected>.blocklyPath {","stroke: #ffc358;","stroke-width: 3px;","}",".blocklySelected>.blocklyPathLight {","display: none;","}",".blocklyDraggable {",'cursor: url("<<<PATH>>>/handopen.cur"), auto;',"cursor: grab;","cursor: -webkit-grab;","cursor: -moz-grab;","}",".blocklyDragging {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","cursor: -moz-grabbing;","}",".blocklyDraggable:active {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","cursor: -moz-grabbing;","}",".blocklyBlockDragSurface .blocklyDraggable {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","cursor: -moz-grabbing;","}",".blocklyDragging.blocklyDraggingDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyDragging.blocklyDraggingMouseThrough {","pointer-events: none;","}",".blocklyToolboxDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyToolboxGrab {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDragging>.blocklyPath,",".blocklyDragging>.blocklyPathLight {","fill-opacity: 1.0;","stroke-opacity: 1.0;","}",".blocklyDragging>.blocklyPath {","}",".blocklyDisabled>.blocklyPath {","fill-opacity: .5;","stroke-opacity: .5;","}",".blocklyInsertionMarker>.blocklyPath {","stroke: none;","}",".blocklyText {","fill: var(--text-general);","font-family: inherit;","font-size: var(--text-size-s);","font-weight: normal;","font-stretch: normal;","font-style: normal;","line-height: 1.5;","letter-spacing: normal;","}",".blocklyTextTruncated {","font-size: 11pt;","}",".blocklyNonEditableText>text {","pointer-events: none;","}",".blocklyNonEditableText>text,",".blocklyEditableText>text {","}",".blocklyEditableText>.blocklyEditableLabel {","fill: var(--text-general);","}",".blocklyDropdownText {","fill: var(--text-general) !important;","}",".blocklyBubbleText {","fill: $colour_text;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklyFlyoutButton {","fill: none;","pointer-events: all;","}",".blocklyFlyoutButtonBackground {","stroke: #c6c6c6;","}",".blocklyFlyoutButton .blocklyText {","fill: $colour_text;","}",".blocklyFlyoutButtonShadow {","fill: transparent;","}",".blocklyFlyoutButton:hover {","fill: white;","cursor: pointer;","}",".blocklyFlyoutLabel {","cursor: default;","}",".blocklyFlyoutLabelBackground {","opacity: 0;","}",".blocklyFlyoutLabelText {","font-size: 14pt;","fill: #575E75;","font-weight: bold;","}",".blocklySvg text, .blocklyBlockDragSurface text, .blocklyFlyout text, .blocklyToolboxDiv text {","user-select: none;","-moz-user-select: none;","-webkit-user-select: none;","cursor: inherit;","}",".blocklyHidden {","display: none;","}",".blocklyFieldDropdown:not(.blocklyHidden) {","display: block;","}",".blocklyIconGroup {","cursor: default;","}",".blocklyIconGroup:not(:hover),",".blocklyIconGroupReadonly {","opacity: .6;","}",".blocklyIconShape {","fill: #00f;","stroke: #fff;","stroke-width: 1px;","}",".blocklyIconSymbol {","fill: #fff;","}",".blocklyMinimalBody {","margin: 0;","padding: 0;","}",".blocklyCommentForeignObject {","position: relative;","z-index: 0;","}",".blocklyCommentRect {","fill: #E7DE8E;","stroke: #bcA903;","stroke-width: 1px","}",".blocklyCommentTarget {","fill: transparent;","stroke: #bcA903;","}",".blocklyCommentTargetFocused {","fill: none;","}",".blocklyCommentHandleTarget {","fill: none;","}",".blocklyCommentHandleTargetFocused {","fill: transparent;","}",".blocklyFocused>.blocklyCommentRect {","fill: #B9B272;","stroke: #B9B272;","}",".blocklySelected>.blocklyCommentTarget {","stroke: #fc3;","stroke-width: 3px;","}",".blocklyCommentTextarea {","background-color: #fef49c;","border: 0;","outline: 0;","margin: 0;","padding: 3px;","resize: none;","display: block;","overflow: hidden;","}",".blocklyCommentDeleteIcon {","cursor: pointer;","fill: #000;","display: none","}",".blocklySelected > .blocklyCommentDeleteIcon {","display: block","}",".blocklyDeleteIconShape {","fill: #000;","stroke: #000;","stroke-width: 1px;","}",".blocklyDeleteIconShape.blocklyDeleteIconHighlighted {","stroke: #fc3;","}",".scratchCommentForeignObject {","position: relative;","}",".scratchCommentBody {","background-color: #fef49c;","border-radius: 4px;","}",".scratchCommentRect {","fill: #fef49c;","}",".scratchCommentTarget {","fill: transparent;","}",".scratchWorkspaceCommentBorder {","stroke: #bcA903;","stroke-width: 1px;","}",".scratchCommentTargetFocused {","fill: none;","}",".scratchCommentTopBar {","fill: #000000;","fill-opacity: 0.1","}",".scratchCommentText {","font-size: 12pt;","font-weight: 400;","}",".scratchCommentTextarea {","background-color: #fef49c;","border: 0;","outline: 0;","padding: 0;","resize: none;","overflow: hidden;","}",".scratchCommentResizeSE {","cursor: se-resize;","fill: transparent;","}",".scratchCommentResizeSW {","cursor: sw-resize;","fill: transparent;","}",".blocklyHtmlInput {","border: none;","font-size: 12pt;","height: 100%;","margin: 0;","outline: none;","box-sizing: border-box;","width: 100%;","text-align: center;","color: $colour_text;","font-weight: 500;","}",".blocklyMainBackground {","stroke-width: 0;","}",".blocklyMutatorBackground {","fill: #fff;","stroke: #ddd;","stroke-width: 1;","}",".blocklyFlyoutBackground {","fill: $colour_flyout;","fill-opacity: .8;","}",".blocklyMainWorkspaceScrollbar {","z-index: 20;","}",".blocklyFlyoutScrollbar {","z-index: 30;","}",".blocklyScrollbarHorizontal, .blocklyScrollbarVertical {","position: absolute;","outline: none;","}",".blocklyScrollbarBackground {","opacity: 0;","}",".blocklyScrollbarHandle {","fill: $colour_scrollbar;","}",".blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyScrollbarHandle:hover {","fill: $colour_scrollbarHover;","}",".blocklyZoom>image {","opacity: 1;","}",".blocklyFlyout .blocklyScrollbarHandle {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyFlyout .blocklyScrollbarHandle:hover {","fill: #aaa;","}",".blocklyInvalidInput {","background: #faa;","}",".blocklyAngleCircle {",`stroke: ${Blockly.Colours.motion.tertiary};`,"stroke-width: 1;",`fill: ${Blockly.Colours.motion.secondary};`,"}",".blocklyAngleCenterPoint {","stroke: #fff;","stroke-width: 1;","fill: #fff;","}",".blocklyAngleDragHandle {","stroke: #fff;","stroke-width: 5;","stroke-opacity: 0.25;","fill: #fff;","cursor: pointer;","}",".blocklyAngleDragArrow {","pointer-events: none","}",".blocklyAngleMarks {","stroke: #fff;","stroke-width: 1;","stroke-opacity: 0.5;","}",".blocklyAngleGauge {","fill: #fff;","fill-opacity: 0.20;","}",".blocklyAngleLine {","stroke: #fff;","stroke-width: 1;","stroke-linecap: round;","pointer-events: none;","}",".blocklyContextMenu {","border-radius: 4px;","max-height: 100%;","}",".blocklyDropdownMenu {","padding: 0 !important;","}",".blocklyDropDownNumPad {","background-color: $colour_numPadBackground;","}",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-icon {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px !important;","}",".blocklyToolboxDiv {","background-color: $colour_toolbox;","color: $colour_toolboxText;","overflow-x: visible;","overflow-y: auto;","position: absolute;","z-index: 40;","-webkit-tap-highlight-color: transparent;","}",".blocklyTreeRoot {","padding: 4px 0;","}",".blocklyTreeRoot:focus {","outline: none;","}",".blocklyTreeRow {","height: 22px;","line-height: 22px;","margin-bottom: 3px;","padding-right: 8px;","white-space: nowrap;","}",".blocklyHorizontalTree {","float: left;","margin: 1px 5px 8px 0;","}",".blocklyHorizontalTreeRtl {","float: right;","margin: 1px 0 8px 5px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {',"margin-left: 8px;","}",".blocklyTreeRow:not(.blocklyTreeSelected):hover {","background-color: #e4e4e4;","}",".blocklyTreeSeparator {","border-bottom: solid #e5e5e5 1px;","height: 0;","margin: 5px 0;","}",".blocklyTreeSeparatorHorizontal {","border-right: solid #e5e5e5 1px;","width: 0;","padding: 5px 0;","margin: 0 5px;","}",".blocklyTreeIcon {","background-image: url(<<<PATH>>>/sprites.png);","height: 16px;","vertical-align: middle;","width: 16px;","}",".blocklyTreeIconClosedLtr {","background-position: -32px -1px;","}",".blocklyTreeIconClosedRtl {","background-position: 0px -1px;","}",".blocklyTreeIconOpen {","background-position: -16px -1px;","}",".blocklyTreeSelected>.blocklyTreeIconClosedLtr {","background-position: -32px -17px;","}",".blocklyTreeSelected>.blocklyTreeIconClosedRtl {","background-position: 0px -17px;","}",".blocklyTreeSelected>.blocklyTreeIconOpen {","background-position: -16px -17px;","}",".blocklyTreeIconNone,",".blocklyTreeSelected>.blocklyTreeIconNone {","background-position: -48px -1px;","}",".blocklyTreeLabel {","cursor: default;","font-size: 16px;","padding: 0 3px;","vertical-align: middle;","}",".blocklyToolboxDelete .blocklyTreeLabel {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyTreeSelected .blocklyTreeLabel {","color: #fff;","}",".blocklyDropDownDiv .goog-slider-horizontal {","margin: 8px;","height: 22px;","width: 150px;","position: relative;","outline: none;","border-radius: 11px;","margin-bottom: 20px;","}",".blocklyDropDownDiv .goog-slider-horizontal .goog-slider-thumb {","width: 26px;","height: 26px;","top: -1px;","position: absolute;","background-color: white;","border-radius: 100%;","-webkit-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);","-moz-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);","box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);","}",".scratchEyedropper {","background: none;","outline: none;","border: none;","width: 100%;","text-align: center;","border-top: 1px solid #ddd;","padding-top: 5px;","cursor: pointer;","}",".scratchColourPickerLabel {","font-size: 0.65rem;","color: $colour_toolboxText;","margin: 8px;","}",".scratchColourPickerLabelText {","font-weight: bold;","}",".scratchColourPickerReadout {","margin-left: 10px;","}",".scratchMatrixButtonDiv {","width: 50%;","text-align: center;","float: left;","}",".scratchNotePickerKeyLabel {","font-size: 0.75rem;","fill: $colour_text;","pointer-events: none;","}",".blocklyWidgetDiv .goog-menu {","background: #fff;","border-color: #ccc #666 #666 #ccc;","border-style: solid;","border-width: 1px;","cursor: default;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"margin: 0;","outline: none;","padding: 4px 0;","position: absolute;","overflow-y: auto;","overflow-x: hidden;","z-index: 20000;","}",".blocklyDropDownDiv .goog-menu {","cursor: default;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"outline: none;","z-index: 20000;","}",".blocklyWidgetDiv .goog-menuitem {","color: #000;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"list-style: none;","margin: 0;","padding: 4px 7em 4px 28px;","white-space: nowrap;","}",".blocklyDropDownDiv .goog-menuitem {","color: var(--text-general);",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"font-weight: bold;","list-style: none;","margin: 0;","min-height: 24px;","padding: 4px 7em 4px 28px;","white-space: nowrap;","}",".blocklyWidgetDiv .goog-menuitem.goog-menuitem-rtl, ",".blocklyDropDownDiv .goog-menuitem.goog-menuitem-rtl {","padding-left: 7em;","padding-right: 28px;","}",".blocklyWidgetDiv .goog-menu-nocheckbox .goog-menuitem,",".blocklyWidgetDiv .goog-menu-noicon .goog-menuitem, ",".blocklyDropDownDiv .goog-menu-nocheckbox .goog-menuitem,",".blocklyDropDownDiv .goog-menu-noicon .goog-menuitem { ","padding-left: 12px;","}",".blocklyWidgetDiv .goog-menu-noaccel .goog-menuitem, ",".blocklyDropDownDiv .goog-menu-noaccel .goog-menuitem {","padding-right: 20px;","}",".blocklyWidgetDiv .goog-menuitem-content ",".blocklyDropDownDiv .goog-menuitem-content {","color: #000;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"}",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-accel,",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-content, ",".blocklyDropDownDiv .goog-menuitem-disabled .goog-menuitem-accel,",".blocklyDropDownDiv .goog-menuitem-disabled .goog-menuitem-content {","color: #ccc !important;","}",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-icon, ",".blocklyDropDownDiv .goog-menuitem-disabled .goog-menuitem-icon {","opacity: 0.3;","-moz-opacity: 0.3;","filter: alpha(opacity=30);","}",".blocklyWidgetDiv .goog-menuitem-highlight,",".blocklyWidgetDiv .goog-menuitem-hover {","background-color: #d6e9f8;","border-color: #d6e9f8;","border-style: dotted;","border-width: 1px 0;","padding-bottom: 3px;","padding-top: 3px;","}",".blocklyDropDownDiv .goog-menuitem-highlight,",".blocklyDropDownDiv .goog-menuitem-hover {","background-color: rgba(0, 0, 0, 0.2);","}",".blocklyWidgetDiv .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-icon, ",".blocklyDropDownDiv .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-menuitem-icon {","background-repeat: no-repeat;","height: 16px;","left: 6px;","position: absolute;","right: auto;","vertical-align: middle;","width: 16px;","}",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-icon,",".blocklyDropDownDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-option-selected .goog-menuitem-icon {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px !important;","position: static;","float: left;","margin-left: -24px;","}",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-icon,",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-icon {","float: right;","margin-right: -24px;","}",".blocklyWidgetDiv .goog-menuitem-accel, ",".blocklyDropDownDiv .goog-menuitem-accel {","color: #999;","direction: ltr;","left: auto;","padding: 0 6px;","position: absolute;","right: 0;","text-align: right;","}",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-accel, ",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-accel {","left: 0;","right: auto;","text-align: left;","}",".blocklyWidgetDiv .goog-menuitem-mnemonic-hint, ",".blocklyDropDownDiv .goog-menuitem-mnemonic-hint {","text-decoration: underline;","}",".blocklyWidgetDiv .goog-menuitem-mnemonic-separator, ",".blocklyDropDownDiv .goog-menuitem-mnemonic-separator {","color: #999;","font-size: 12px;","padding-left: 4px;","}",".blocklyWidgetDiv .goog-menuseparator, ",".blocklyDropDownDiv .goog-menuseparator {","border-top: 1px solid #ccc;","margin: 4px 0;","padding: 0;","}",".blocklyFlyoutCheckbox {","fill: white;","stroke: #c8c8c8;","}",".blocklyFlyoutCheckbox.checked {",`fill: ${Blockly.Colours.motion.primary};`,`stroke: ${Blockly.Colours.motion.tertiary};`,"}",".blocklyFlyoutCheckboxPath {","stroke: white;","stroke-width: 3;","stroke-linecap: round;","stroke-linejoin: round;","}",".scratchCategoryMenu {","width: 60px;","background: $colour_toolbox;","color: $colour_toolboxText;","font-size: .7rem;","user-select: none;","-webkit-user-select: none;","-moz-user-select: none;","-ms-user-select: none;","}",".scratchCategoryMenuHorizontal {","width: 100%;","height: 50px;","background: $colour_toolbox;","color: $colour_toolboxText;","font-size: .7em;","user-select: none;","-webkit-user-select: none;","-moz-user-select: none;","-ms-user-select: none;","}",".scratchCategoryMenuHorizontal .scratchCategoryMenuRow {","float: left;","margin: 3px;","}",".scratchCategoryMenuRow {","}",".scratchCategoryMenuItem {","padding: 0.375rem 0px;","cursor: pointer;","text-align: center;","}",".scratchCategoryMenuHorizontal .scratchCategoryMenuItem {","padding: 6px 5px;","}",".scratchCategoryMenuItem.categorySelected {","background: $colour_toolboxSelected;","}",".scratchCategoryItemBubble {","width: 1.25rem;","height: 1.25rem;","border: 1px solid;","border-radius: 100%;","margin: 0 auto 0.125rem;","}",".scratchCategoryItemIcon {","width: 1.25rem;","height: 1.25rem;","margin: 0 auto 0.125rem;","background-size: 100%;","}",".scratchCategoryMenuItem:hover {","color: $colour_toolboxHover !important;","}",""]},4128:()=>{Blockly.FieldImage=function(e,t,o,i,n,r){this.sourceBlock_=null,this.height_=Number(o),this.width_=Number(t),this.size_=new goog.math.Size(this.width_,this.height_),this.flipRtl_=r,this.tooltip_="",this.setValue(e),this.setText(i),"function"==typeof n&&(this.clickHandler_=n)},goog.inherits(Blockly.FieldImage,Blockly.Field),Blockly.FieldImage.fromJson=function(e){const t=Blockly.utils.replaceMessageReferences(e.src),o=Number(Blockly.utils.replaceMessageReferences(e.width)),i=Number(Blockly.utils.replaceMessageReferences(e.height)),n=Blockly.utils.replaceMessageReferences(e.alt),r=!!e.flipRtl;return new Blockly.FieldImage(t,o,i,n,null,r)},Blockly.FieldImage.prototype.EDITABLE=!1,Blockly.FieldImage.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=Blockly.utils.createSvgElement("g",{},null),this.visible_||(this.fieldGroup_.style.display="none"),this.imageElement_=Blockly.utils.createSvgElement("image",{height:`${this.height_}px`,width:`${this.width_}px`},this.fieldGroup_),this.setValue(this.src_),this.setText(this.text_),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.tooltip_?this.imageElement_.tooltip=this.tooltip_:this.setTooltip(this.sourceBlock_),Blockly.Tooltip.bindMouseEvents(this.imageElement_),this.maybeAddClickHandler_())},Blockly.FieldImage.prototype.dispose=function(){goog.dom.removeNode(this.fieldGroup_),this.fieldGroup_=null,this.imageElement_=null},Blockly.FieldImage.prototype.maybeAddClickHandler_=function(){!this.clickHandler_||this.sourceBlock_.workspace.options.readOnly||this.sourceBlock_.isInFlyout||(this.mouseDownWrapper_=Blockly.bindEventWithChecks_(this.fieldGroup_,"mousedown",this,this.clickHandler_),this.fieldGroup_.style.cursor="pointer")},Blockly.FieldImage.prototype.setTooltip=function(e){this.tooltip_=e,this.imageElement_&&(this.imageElement_.tooltip=e)},Blockly.FieldImage.prototype.getValue=function(){return this.src_},Blockly.FieldImage.prototype.setValue=function(e){null!==e&&(this.src_=e,this.imageElement_&&this.imageElement_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e||""))},Blockly.FieldImage.prototype.getFlipRtl=function(){return this.flipRtl_},Blockly.FieldImage.prototype.setText=function(e){null!==e&&(this.text_=e,this.imageElement_&&this.imageElement_.setAttribute("alt",e||""))},Blockly.FieldImage.prototype.render_=function(){},Blockly.FieldImage.prototype.forceRerender=function(){},Blockly.FieldImage.prototype.updateWidth=function(){},Blockly.FieldImage.prototype.showEditor_=function(){this.clickHandler_&&this.clickHandler_(this)},Blockly.Field.register("field_image",Blockly.FieldImage)},1874:()=>{Blockly.FieldTextInput.prototype.init=function(){if(this.fieldGroup_)return;const e=!this.sourceBlock_.isShadow();e&&(this.className_+=" blocklyEditableLabel"),this.maxDisplayLength=17,Blockly.FieldTextInput.superClass_.init.call(this),e&&(this.box_=Blockly.utils.createSvgElement("rect",{rx:4*Blockly.BlockSvg.CORNER_RADIUS,ry:4*Blockly.BlockSvg.CORNER_RADIUS,x:0,y:0,width:this.size_.width,height:this.size_.height,fill:this.sourceBlock_.getColourSecondary(),stroke:this.sourceBlock_.getColourTertiary(),"stroke-width":"0.3px"}),this.fieldGroup_.insertBefore(this.box_,this.textElement_))}},2038:()=>{Blockly.Gesture.prototype.updateIsDraggingFromFlyout_=function(){return!(this.targetBlock_.disabled||this.flyout_.isScrollable()&&!this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)||(this.startWorkspace_=this.flyout_.targetWorkspace_,this.startWorkspace_.updateScreenCalculationsIfScrolled(),Blockly.Events.getGroup()||Blockly.Events.setGroup(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.mostRecentEvent_,this.targetBlock_),this.targetBlock_.select(),0))}},3696:()=>{Blockly.Icon.prototype.renderIcon=function(e){if(this.collapseHidden&&this.block_.isCollapsed())return this.iconGroup_.setAttribute("display","none"),e;this.iconGroup_.setAttribute("display","block");let t=e;const o=this.SIZE;return this.block_.RTL&&(t-=o),this.iconGroup_.setAttribute("transform",`localize(${t},9)`),this.computeIconLocation(),this.block_.RTL?t-=Blockly.BlockSvg.SEP_SPACE_X:t+=o+Blockly.BlockSvg.SEP_SPACE_X,t}},4730:(e,t,o)=>{"use strict";o.r(t);var i=o(9789);Blockly.Block.Dimensions={},Blockly.Block.prototype.getDisplayName=function(){if(this.meta){const e=this.meta();return e&&e.display_name}return this.type},Blockly.Block.prototype.getSiblings=function(){const e=[this];return["getPreviousBlock","getNextBlock"].forEach((t=>{let o=this[t]();for(;null!==o;){const i=this.getParent();if(i&&i.id===o.id)break;e.push(o),o=o[t]()}})),e},Blockly.Block.prototype.getChildByType=function(e){return this.getDescendants().find((t=>t.type===e))},Blockly.Block.prototype.getChildFieldValue=function(e,t){const o=this.getChildByType(e);return o?o.getFieldValue(t):null},Blockly.Block.prototype.childValueToCode=function(e,t){const o=this.getChildByType(e);return o&&Blockly.JavaScript.valueToCode(o,t,Blockly.JavaScript.ORDER_ATOMIC)},Blockly.Block.prototype.getBlocksInStatement=function(e){const t=this.getInputTargetBlock(e);return t?t.getSiblings():[]},Blockly.Block.prototype.getLastConnectionInStatement=function(e){const t=this.getInputTargetBlock(e);return t?t.lastConnectionInStack():this.getInput(e).connection},Blockly.Block.prototype.isEnabled=function(){return!this.disabled},Blockly.Block.prototype.isDescendantOf=function(e){let t=this.getParent();for(;null!==t;){if(t.type===e)return!0;t=t.getParent()}return!1},Blockly.Block.prototype.getTopParent=function(){let e=this.getParent();for(;null!==e;){const t=e.getParent();if(!t)return e;e=t}return null},Blockly.Block.getDimensions=function(e){const t=Object.keys(Blockly.Block.Dimensions).find((t=>e.outerHTML===t));if(t)return Blockly.Block.Dimensions[t];const i=new Blockly.Options({media:`${o.p}media/`}),n=document.createElement("div"),r=Blockly.createDom_(n,i),a=Blockly.createMainWorkspace_(r,i,!1,!1),l=Blockly.Xml.domToBlock(e,a).getHeightWidth();return a.dispose(),Blockly.Block.Dimensions[e.outerHTML]=l,l},Blockly.Block.prototype.isMainBlock=function(){return i.v.mainBlocks.includes(this.type)},Blockly.Block.prototype.isIndependentBlock=function(){return i.v.INDEPEDENT_BLOCKS.includes(this.type)},Blockly.Block.prototype.getRootInputTargetBlock=function(){let e,t=this.getParent();for(;t;){const o=this.getRootBlock().getInputWithBlock(t);o&&o.name&&(e=o.name),t=t.getParent()}return e},Blockly.Block.prototype.hasErrorHighlightedDescendant=function(){const e=t=>t.some((t=>{const o=t.is_error_highlighted,i=e(t.getChildren());return o||i}));return e(this.getChildren())},Blockly.Block.isDynamic=function(e){return/^((procedures_)|(variables_)|(math_change$))/.test(e)},o(129);var n=o(8429),r=o(282),a=o(6132);Blockly.BlockSvg.prototype.addSelect=function(){if(!this.isInFlyout){const{flyout:e}=r.Z.instance;e&&e.setVisibility(!1),Blockly.utils.addClass(this.svgGroup_,"blocklySelected")}},Blockly.BlockSvg.prototype.setDisabled=function(e){this.disabled!==e&&(Blockly.BlockSvg.superClass_.setDisabled.call(this,e),this.rendered&&this.updateDisabled())},Blockly.BlockSvg.prototype.updateDisabled=function(){if(this.disabled||this.getInheritedDisabled()){Blockly.utils.addClass(this.svgGroup_,"blocklyDisabled");const e=`url(#${this.workspace.options.disabledPatternId})`;this.svgPath_.getAttribute("fill")!==e&&this.svgPath_.setAttribute("fill",e)}else Blockly.utils.removeClass(this.svgGroup_,"blocklyDisabled")&&this.updateColour();this.getChildren(!1).forEach((e=>e.updateDisabled()))},Blockly.BlockSvg.prototype.showContextMenu_=function(e){if(this.workspace.options.readOnly||!this.contextMenu)return;const t=this,o=[];if(this.isDeletable()&&this.isMovable()&&!t.isInFlyout)o.push(Blockly.ContextMenu.blockDuplicateOption(t,e)),o.push(Blockly.ContextMenu.blockDetachOption(t,e)),this.isEditable()&&this.workspace.options.comments&&o.push(Blockly.ContextMenu.blockCommentOption(t)),o.push(Blockly.ContextMenu.blockDeleteOption(t));else if(this.parentBlock_&&this.isShadow_)return void this.parentBlock_.showContextMenu_(e);if(this.workspace.options.collapse)if(this.collapsed_){const e={enabled:!0};e.text=(0,n.localize)("Expand Block"),e.callback=()=>t.setCollapsed(!1),o.push(e)}else{const e={enabled:!0};e.text=(0,n.localize)("Collapse Block"),e.callback=()=>t.setCollapsed(!0),o.push(e)}if(this.workspace.options.disable){const e=t.restricted_parents||[],i=this.type.includes("trade_definition_")&&!this.isMovable(),r={text:this.disabled?(0,n.localize)("Enable Block"):(0,n.localize)("Disable Block"),enabled:!i&&(!this.disabled||0===e.length||e.some((e=>t.isDescendantOf(e)))),callback:()=>{const e=Blockly.Events.getGroup();e||Blockly.Events.setGroup(!0),t.setDisabled(!t.disabled),e||Blockly.Events.setGroup(!1)}};o.push(r)}if(this.isMovable()){const e=t.nextConnection&&t.nextConnection.isConnected(),i=e=>{const o=Blockly.Xml.textToDom("<xml/>"),i=Blockly.Xml.blockToDom(t),r=e?t.type:`${t.type}_${(0,n.localize)("stack")}`;e&&Blockly.Xml.deleteNext(i),o.appendChild(i),(0,a.a1)(r,!0,o)};o.push({text:(0,n.localize)("Download block"),enabled:!0,callback:()=>i(!0)}),e&&o.push({text:(0,n.localize)("Download stack"),enabled:!0,callback:()=>i(!1)})}this.customContextMenu&&this.customContextMenu(o),Blockly.ContextMenu.show(e,o,this.RTL),Blockly.ContextMenu.currentBlock=this},Blockly.BlockSvg.prototype.setErrorHighlighted=function(e,t=(0,n.localize)('The block(s) highlighted in red are missing input values. Please update them and click "Run bot".')){if(this.is_error_highlighted===e)return;const o="block--error-highlighted";e?Blockly.utils.addClass(this.svgGroup_,o):Blockly.utils.removeClass(this.svgGroup_,o),this.is_error_highlighted=e,this.error_message=t},Blockly.BlockSvg.prototype.highlightExecutedBlock=function(){const e="block--execution-highlighted";Blockly.utils.hasClass(this.svgGroup_,e)||(Blockly.utils.addClass(this.svgGroup_,e),setTimeout((()=>{this.svgGroup_&&Blockly.utils.removeClass(this.svgGroup_,e)}),1505))},Blockly.BlockSvg.prototype.blink=function(){const e="block--blink";Blockly.utils.addClass(this.svgGroup_,e),setTimeout((()=>{Blockly.utils.removeClass(this.svgGroup_,e)}),2e3)},Blockly.BlockSvg.prototype.setCollapsed=function(e){if(this.collapsed_===e)return;navigator.userAgent.search("Firefox")>0&&setTimeout((()=>{this.workspace.getAllFields().forEach((e=>e.forceRerender()))}),0);const t=[],o="_TEMP_COLLAPSED_INPUT";if(this.inputList.forEach((o=>{t.push(...o.setVisible(!e)),e&&1===o.type&&!o.connection.targetConnection&&o.outlinePath&&(o.outlinePath.style.visibility="hidden")})),e){this.getIcons().filter((e=>!(e instanceof Blockly.ScratchBlockComment))).forEach((e=>e.setVisible(!1)));let e=null;this.inputList.some((t=>t.fieldRow.some((t=>!!t.class_&&(e=t.class_,!0)))));const t=this.workspace.options.pathToMedia+((0,a.YQ)(this.getColour())?"dropdown-arrow.svg":"dropdown-arrow-dark.svg"),i=new Blockly.FieldImage(t,16,16,(0,n.localize)("Expand"),(()=>this.setCollapsed(!1)));if("procedures_defreturn"===this.type||"procedures_defnoreturn"===this.type){const t=this.getFieldValue("NAME"),r=` (${this.arguments.join(", ")})`;this.appendDummyInput(o).appendField(new Blockly.FieldLabel((0,n.localize)("function"),e)).appendField(new Blockly.FieldLabel(t+r,"header__title")).appendField(i).init()}else{const t=this.toString(Blockly.COLLAPSE_CHARS),n=new Blockly.FieldLabel(t,e);this.appendDummyInput(o).appendField(n).appendField(i).init()}}else this.removeInput(o),this.setWarningText(null);Blockly.BlockSvg.superClass_.setCollapsed.call(this,e),t.length||t.push(this),this.rendered&&t.forEach((e=>e.render())),this.setErrorHighlighted(e&&this.hasErrorHighlightedDescendant())},Blockly.BlockSvg.prototype.initSvg=function(){if(goog.asserts.assert(this.workspace.rendered,"Workspace is headless."),!this.isInsertionMarker()){for(let e,t=0;e=this.inputList[t];t++)e.init(),e.initOutlinePath(this.svgGroup_);const e=this.getIcons();for(let t=0;t<e.length;t++)e[t].createIcon()}this.updateColour(),this.updateMovable(),this.workspace.options.readOnly||this.eventsInit_||Blockly.bindEventWithChecks_(this.getSvgRoot(),"mousedown",this,this.onMouseDown_),this.eventsInit_=!0,!this.getSvgRoot().parentNode&&this.workspace.getCanvas()&&this.workspace.getCanvas().appendChild(this.getSvgRoot())},o(2646),o(7779),o(1863),Blockly.ContextMenu.blockDuplicateOption=function(e){return{callback(){Blockly.duplicate_(e)},enabled:!i.v.single_instance_blocks.includes(e.type),text:(0,n.localize)("Duplicate")}},Blockly.ContextMenu.wsCleanupOption=function(e,t){return{text:(0,n.localize)("Rearrange Vertically"),enabled:t>1,callback:e.cleanUp.bind(e)}},Blockly.ContextMenu.wsCollapseOption=function(e,t){return{enabled:e,text:(0,n.localize)("Collapse All Blocks"),callback(){Blockly.ContextMenu.toggleCollapseFn_(t,!0)}}},Blockly.ContextMenu.wsExpandOption=function(e,t){return{enabled:e,text:(0,n.localize)("Expand All Blocks"),callback(){Blockly.ContextMenu.toggleCollapseFn_(t,!1)}}},Blockly.ContextMenu.toggleCollapseFn_=function(e,t){e.forEach((e=>e.setCollapsed(t)))},Blockly.ContextMenu.wsDeleteOption=function(e,t){const o=Blockly.WorkspaceSvg.buildDeleteList_(t),i=o.filter((e=>!e.isShadow())).length,r=Blockly.utils.genUid(),a=()=>{Blockly.Events.setGroup(r);const e=o.shift();e&&(e.workspace?(e.dispose(!1,!0),setTimeout(a,10)):a()),Blockly.Events.setGroup(!1)};return{text:1===i?(0,n.localize)("Delete Block"):(0,n.localize)("Delete {{ delete_count }} Blocks",{delete_count:i}),enabled:i>0,callback(){if(e.currentGesture_&&e.currentGesture_.cancel(),i<2)a();else{const e=(0,n.localize)("Delete all {{ delete_count }} blocks?",{delete_count:i});Blockly.confirm(e,(e=>{e&&a()}))}}}},Blockly.ContextMenu.blockCommentOption=function(e){const t={enabled:!goog.userAgent.IE};return e.comment?(t.text=(0,n.localize)("Remove comment"),t.callback=()=>{e.setCommentText(null)}):(t.text=(0,n.localize)("Add comment"),t.callback=()=>{const t=e.collapsed_;t&&e.setCollapsed(!1),e.setCommentText(""),e.collapsed_!==t&&e.setCollapsed(t)}),t},Blockly.ContextMenu.blockDetachOption=function(e){const t=e.getConnections_().some((e=>{var t;return e.isConnected()&&!(null!==(t=e.targetConnection)&&void 0!==t&&t.sourceBlock_.isShadow_)}));return{callback(){e.unplug(!0),e.moveBy(250,100)},enabled:e.parentBlock_&&t,text:(0,n.localize)("Detach Block")}},o(119),Blockly.DataCategory=function(e){const t=e.getVariablesOfType("");let o=[];return Blockly.DataCategory.addCreateVariable(o,e),o=o.concat(Blockly.DataCategory.search(t,["variables_set","variables_get","math_change"])),o},Blockly.DataCategory.search=function(e){const t=[];if(e.length>0){const o=e=>`<field name="VAR" id="${e.getId()}" variabletype="${goog.string.htmlEscape(e.type)}">${goog.string.htmlEscape(e.name)}</field>`,i=e[0];if(Blockly.Blocks.variables_set){const e=`<xml><block type="variables_set" gap="${Blockly.Blocks.math_change?8:24}">${o(i)}</block></xml>`,n=Blockly.Xml.textToDom(e).firstChild;t.push(n)}Blockly.Blocks.variables_get&&(e.sort(((t,o)=>e.indexOf(o)-e.indexOf(t))),e.forEach((e=>{const i=`<xml><block type="variables_get">${o(e)}</block></xml>`,n=Blockly.Xml.textToDom(i).firstChild;t.push(n)})))}return t},Blockly.DataCategory.addCreateVariable=function(e,t){const o=goog.dom.createDom("button"),i=goog.dom.createDom("input"),a=(0,n.localize)("Create"),l="CREATE_VARIABLE",s=(0,n.localize)("New variable name");o.setAttribute("text",a),o.setAttribute("className","flyout__button-new"),o.setAttribute("callbackKey",l),i.setAttribute("className","flyout__input"),i.setAttribute("name","variable"),i.setAttribute("type","text"),i.setAttribute("placeholder",s),t.registerButtonCallback(l,(function(e){const t=document.querySelector(".flyout__input").firstChild;e.getTargetWorkspace().createVariable(t.value,""),t.value="";const{flyout:o}=r.Z.instance;o.refreshCategory()})),e.push(i),e.push(o)},Blockly.FieldDropdown.prototype.updateOptions=function(e,t={}){Blockly.DropDownDiv.isVisible()&&Blockly.DropDownDiv.hideWithoutAnimation(),this.menuGenerator_=e;let o=this.getValue();t.should_pretend_empty&&(o="");const i=-1!==e.findIndex((e=>e[1]===t.default_value));if((0,a.zJ)((()=>{this.setValue(""),i?this.setValue(t.default_value):e.length>0?this.setValue(this.menuGenerator_[0][1]):this.setValue(o)})),!t.should_trigger_event||!0===t.should_trigger_event){const e=new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,o,this.getValue());e.recordUndo=!1,e.group=t.event_group,Blockly.Events.fire(e)}},Blockly.FieldDropdown.prototype.init=function(){if(this.fieldGroup_)return;this.arrowSize_=12,this.arrowX_=0,this.arrowY_=11,this.arrow_=Blockly.utils.createSvgElement("image",{height:`${this.arrowSize_}px`,width:`${this.arrowSize_}px`}),this.arrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",`${Blockly.mainWorkspace.options.pathToMedia}dropdown-arrow-dark.svg`),this.className_+=" blocklyDropdownText",this.disableColourChange_=!0,Blockly.FieldDropdown.superClass_.init.call(this),this.sourceBlock_.isShadow()||(this.box_=Blockly.utils.createSvgElement("rect",{rx:4*Blockly.BlockSvg.CORNER_RADIUS,ry:4*Blockly.BlockSvg.CORNER_RADIUS,x:0,y:0,width:this.size_.width,height:this.size_.height,stroke:this.sourceBlock_.getColourTertiary(),"stroke-width":"0.3px",fill:this.sourceBlock_.getColourSecondary(),"fill-opacity":1},null),this.fieldGroup_.insertBefore(this.box_,this.textElement_));const e=this.text_;this.text_=null,this.setText(e)},Blockly.FieldDropdown.prototype.isEmpty=function(){return 0===this.menuGenerator_.length||!this.menuGenerator_[0][1]};const l=()=>{const e=e=>e?(0,n.localize)("Y"):(0,n.localize)("N"),t=new Blockly.FieldImage(!0,16,16,e(!0),(function(){this.sourceBlock_.workspace.options.readOnly||this.sourceBlock_.isInFlyout||(this.is_checked=!this.is_checked,this.setValue(this.is_checked),this.setText(e(this.is_checked)))}));return t.fromJson=()=>l(),t.setValue=function(e){const t=!0===e||"TRUE"===e,o=this.getValue();this.src_=t?"TRUE":"FALSE";const i=this.fieldGroup_;i&&(Array.from(i.children).forEach((e=>i.removeChild(e))),Blockly.utils.createSvgElement("rect",{fill:this.sourceBlock_.getColourSecondary(),"fill-rule":"nonzero",height:this.height_,width:this.width_,rx:2,stroke:this.sourceBlock_.getColourTertiary()},i),t&&Blockly.utils.createSvgElement("path",{fill:"var(--text-general)",d:"M6 10.086L3.707 7.793a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l7-7a1 1 0 10-1.414-1.414L6 10.086z"},i)),this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,o,this.getValue()))},t};Blockly.Field.register("field_image_checkbox",l()),o(4128),Blockly.Flyout.prototype.createBlock=function(e,t){Blockly.Events.disable();const o=this.targetWorkspace_,n=o.getAllVariables();o.setResizesEnabled(!1);let a=null;try{a=this.placeNewBlock_(e,t),Blockly.hideChaff()}finally{Blockly.Events.enable()}const l=Blockly.Variables.getAddedVariables(o,n);Blockly.Events.isEnabled()&&(Blockly.Events.setGroup(!0),i.v.single_instance_blocks.includes(a.type)&&o.getAllBlocks().forEach((e=>{e.type===a.type&&e.id!==a.id&&e.dispose()})),l.forEach((e=>{Blockly.Events.fire(new Blockly.Events.VarCreate(e))})),Blockly.Events.fire(new Blockly.Events.Create(a))),this.autoClose&&this.hide();const{flyout:s}=r.Z.instance;return s.setIsSearchFlyout(!1),s.setVisibility(!1),a.isInFlyout=!1,a},Blockly.Flyout.prototype.placeNewBlock_=function(e,t){const o=this.targetWorkspace_;if(!t.getSvgRoot())throw new Error("old_block is not rendered.");const i=Blockly.Xml.blockToDom(t,!0);o.setResizesEnabled(!1);const n=Blockly.Xml.domToBlock(i,o);if(!n.getSvgRoot())throw new Error("block is not rendered.");if(e){const t=o.getOriginOffsetInPixels(),i=56,r=48,a=new goog.math.Coordinate(e.clientX,e.clientY-i-r),l=goog.math.Coordinate.difference(a,t).scale(1/o.scale);n.moveBy(l.x,l.y)}return n},o(2038),o(884),o(3696),o(9379),Blockly.Procedures.flyoutCategory=function(e){let t=[];if(Blockly.Blocks.procedures_defnoreturn){const e=document.createElement("block");e.setAttribute("type","procedures_defnoreturn"),e.setAttribute("gap",16);const o=document.createElement("field");o.setAttribute("name","NAME"),o.appendChild(document.createTextNode((0,n.localize)("do something"))),e.appendChild(o),t.push(e)}if(Blockly.Blocks.procedures_defreturn){const e=document.createElement("block");e.setAttribute("type","procedures_defreturn"),e.setAttribute("gap",16);const o=document.createElement("field");o.setAttribute("name","NAME"),o.appendChild(document.createTextNode((0,n.localize)("do something"))),e.appendChild(o),t.push(e)}if(Blockly.Blocks.procedures_ifreturn){const e=document.createElement("block");e.setAttribute("type","procedures_ifreturn"),e.setAttribute("gap",16),t.push(e)}t.length&&t[t.length-1].setAttribute("gap",24);const o=Blockly.Procedures.allProcedures(e);return t=t.concat(Blockly.Procedures.populateDynamicProcedures(o)),t},Blockly.Procedures.populateDynamicProcedures=function(e){let t=[];const o=(e,t)=>{const o=[];if(!e)return o;for(let i=0;i<e.length;i++){const n=e[i][0],r=e[i][1],a=document.createElement("block");a.setAttribute("type",t),a.setAttribute("gap",16);const l=document.createElement("mutation");l.setAttribute("name",n),a.appendChild(l),r.forEach((e=>{const t=document.createElement("arg");t.setAttribute("name",e),l.appendChild(t)})),o.push(a)}return o};return t=t.concat(o(e[0],"procedures_callnoreturn")),t=t.concat(o(e[1],"procedures_callreturn")),t},Blockly.Procedures.getDefinition=function(e,t){const o=t.getTopBlocks(!1);for(let t=0;t<o.length;t++)if(o[t].getProcedureDef){const i=o[t].getProcedureDef();if(i&&Blockly.Names.equals(i[0],e))return o[t]}return null},Blockly.Procedures.isNameUsed=function(e,t,o){return t.getAllBlocks(!1).some((t=>{if(t!==o&&t.getProcedureDef){const o=t.getProcedureDef();return Blockly.Names.equals(o[0],e)}return!1}))},Blockly.WorkspaceDragger.prototype.drag=function(e){if(this.workspace_.isFlyout)return;const t=this.startDragMetrics_,o=goog.math.Coordinate.sum(this.startScrollXY_,e);let i=Math.min(o.x,-t.contentLeft),n=Math.min(o.y,-t.contentTop);i=Math.max(i,t.viewWidth-t.contentLeft-t.contentWidth),n=Math.max(n,t.viewHeight-t.contentTop-t.contentHeight),i=-i-t.contentLeft,n=-n-t.contentTop,this.updateScroll_(i,n)},o(7850),o(5651),o(7058);var s=o(6715);Blockly.Workspace.prototype.wait_events=[],Blockly.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0,this.redoStack_.length=0;const{toolbar:e}=r.Z.instance;e.setHasRedoStack(),e.setHasUndoStack(),Blockly.Events.clearPendingUndo()},Blockly.Workspace.prototype.fireChangeListener=function(e){if(e.recordUndo){this.undoStack_.push(e),this.redoStack_.length=0,this.undoStack_.length>this.MAX_UNDO&&this.undoStack_.unshift();const{toolbar:t}=r.Z.instance;t.setHasRedoStack(),t.setHasUndoStack()}this.listeners_.slice().forEach((t=>{t(e)}))},Blockly.Workspace.prototype.getTradeDefinitionBlock=function(){return this.getAllBlocks(!0).find((e=>"trade_definition"===e.type))},Blockly.Workspace.prototype.waitForBlockEvent=function(e,t=null){const o=new s.Z;return this.wait_events.some((o=>o.blockId===e&&o.type===t))||this.wait_events.push({blockId:e,promise:o,type:t}),o},Blockly.Workspace.prototype.waitForBlockEvent=function(e){const{block_type:t,event_type:o,timeout:i}=e,n=new s.Z;return this.wait_events.push({block_type:t,event_type:o,promise:n}),i&&setTimeout((()=>{n.isPending&&n.reject()}),i),n},Blockly.Workspace.prototype.dispatchBlockEventEffects=function(e){this.wait_events.forEach(((t,o)=>{if(!e.blockId)return;const i=this.getBlockById(e.blockId);if(i){const n=t.block_type===i.type,r=null===t.event_type||t.event_type===e.type;n&&r&&setTimeout((()=>{t.promise.resolve(),this.wait_events.splice(o,1)}),500)}}))},Blockly.Workspace.prototype.getAllFields=function(e){return this.getAllBlocks(e).reduce(((e,t)=>(t.inputList.forEach((t=>e.push(...t.fieldRow))),e)),[])},o(8993);var c=o(2620);Blockly.WorkspaceSvg.prototype.onMouseDown_=function(e){e instanceof MouseEvent&&Blockly.derivWorkspace.cachedParentSvg_.dispatchEvent(new e.constructor(e.type,e));const t=this.getGesture(e);t&&t.handleWsStart(e,this)},Blockly.WorkspaceSvg.prototype.centerOnBlock=function(e,t=!0){if(!this.scrollbar)return void console.warn("Tried to scroll a non-scrollable workspace.");const o=this.getBlockById(e);if(!o)return;const i=o.getRelativeToSurfaceXY(),n=o.getHeightWidth(),r=i.y+n.height/2,a=this.RTL?-1:1,l=i.x+a*n.width/2,s=this.scale,c=l*s,u=r*s,p=this.getMetrics(),d=c-p.contentLeft,y=u-p.contentTop,m=d-p.viewWidth/2,h=y-p.viewHeight/2;t&&Blockly.hideChaff(),this.scrollbar.set(m,h)},Blockly.WorkspaceSvg.prototype.addBlockNode=function(e){const{flyout:t}=r.Z.instance,o=Blockly.Xml.domToBlock(e,t.getFlyout().workspace_),i=this.getTopBlocks(!0),n=t.getFlyout().createBlock(!1,o);if(i.length){const e=i[i.length-1],t=e.getRelativeToSurfaceXY(),o=e.startHat_?Blockly.BlockSvg.START_HAT_HEIGHT:0,r=t.y+e.getHeightWidth().height+o+30;n.moveBy(t.x,r)}Blockly.svgResize(n.workspace),this.centerOnBlock(n.id,!1)},Blockly.WorkspaceSvg.prototype.cleanUp=function(e=0,t=0,o=[]){this.setResizesEnabled(!1),Blockly.Events.setGroup(Blockly.Events.getGroup()||!0);const n=0!==o.length,r=n?o:this.getTopBlocks(!0),a=r.filter((e=>e.isMainBlock())).sort(((e,t)=>{const o=e=>i.v.mainBlocks.findIndex((t=>t===e.type));return o(e)-o(t)})),l=Math.ceil(a.length/2);let s=t;if(a.length){let o=0;a.forEach(((i,r)=>{r===(o+1)*l&&(s=t,o++);const c=i.getRelativeToSurfaceXY(),u=n?e:-c.x,p=s-(n?0:c.y);if(0===o)i.moveBy(u,p);else{const e=(o-1)*l,t=a.slice(e,e+l).reduce(((e,t)=>e.getHeightWidth().width>t.getHeightWidth().width?e:t));let r=u+t.getHeightWidth().width+Blockly.BlockSvg.MIN_BLOCK_X;n||(r+=t.getRelativeToSurfaceXY().x),i.moveBy(r,p)}i.snapToGrid(),s=i.getRelativeToSurfaceXY().y+i.getHeightWidth().height+Blockly.BlockSvg.MIN_BLOCK_Y}));const i=a.reduce(((e,t)=>e.getRelativeToSurfaceXY().y+e.getHeightWidth().height>t.getRelativeToSurfaceXY().y+t.getHeightWidth().height?e:t));s=i.getRelativeToSurfaceXY().y+i.getHeightWidth().height+Blockly.BlockSvg.MIN_BLOCK_Y}r.filter((e=>!e.isMainBlock())).forEach((t=>{const o=t.getRelativeToSurfaceXY(),i=n?e:-o.x,r=s-(n?0:o.y);t.moveBy(i,r),t.snapToGrid(),s=t.getRelativeToSurfaceXY().y+t.getHeightWidth().height+Blockly.BlockSvg.MIN_BLOCK_Y})),Blockly.Events.setGroup(!1),this.setResizesEnabled(!0)},Blockly.WorkspaceSvg.getTopLevelWorkspaceMetrics_=function(){const e=Blockly.WorkspaceSvg.getDimensionsPx_(this.toolbox_),t=Blockly.WorkspaceSvg.getDimensionsPx_(this.flyout_),o=Blockly.svgSize(this.getParentSvg());this.toolbox_&&(this.toolboxPosition===Blockly.TOOLBOX_AT_TOP||this.toolboxPosition===Blockly.TOOLBOX_AT_BOTTOM?o.height-=e.height:this.toolboxPosition!==Blockly.TOOLBOX_AT_LEFT&&this.toolboxPosition!==Blockly.TOOLBOX_AT_RIGHT||(o.width-=e.width));const i=Blockly.WorkspaceSvg.getContentDimensions_(this,o);let n=0,r=0;return this.toolbox_&&this.toolboxPosition===Blockly.TOOLBOX_AT_LEFT&&(r=50,n=e.width),this.toolbox_&&this.toolboxPosition===Blockly.TOOLBOX_AT_TOP&&(r=e.height+50),{contentHeight:i.height,contentWidth:i.width,contentTop:i.top,contentLeft:i.left,viewHeight:o.height,viewWidth:o.width,viewTop:-this.scrollY,viewLeft:-this.scrollX,absoluteTop:r,absoluteLeft:n,toolboxWidth:e.width,toolboxHeight:e.height,flyoutWidth:t.width,flyoutHeight:t.height,toolboxPosition:this.toolboxPosition}},Blockly.WorkspaceSvg.prototype.paste=function(e){this.rendered&&(this.currentGesture_&&this.currentGesture_.cancel(),"comment"===e.tagName.toLowerCase()?this.pasteWorkspaceComment_(e):((0,c.kH)(this,e.getAttribute("type")),this.pasteBlock_(e)))},Blockly.WorkspaceSvg.prototype.showContextMenu_=function(e){if(this.options.readOnly||this.isFlyout)return;const t=[],o=this.getTopBlocks(!0),i=this.getAllBlocks(!0);if(t.push(Blockly.ContextMenu.wsUndoOption(this)),t.push(Blockly.ContextMenu.wsRedoOption(this)),this.scrollbar&&t.push(Blockly.ContextMenu.wsCleanupOption(this,o.length)),this.options.collapse){const e=i.some((e=>e.isCollapsed())),o=i.some((e=>!e.isCollapsed()));t.push(Blockly.ContextMenu.wsExpandOption(e,i)),t.push(Blockly.ContextMenu.wsCollapseOption(o,i))}this.options.comments&&t.push(Blockly.ContextMenu.workspaceCommentOption(this,e)),t.push(Blockly.ContextMenu.wsDeleteOption(this,o)),Blockly.ContextMenu.show(e,t,this.RTL)},Blockly.WorkspaceSvg.prototype.dispose=function(e=!1){const t=()=>{this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),Blockly.WorkspaceSvg.superClass_.dispose.call(this),this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.svgBlockCanvas_=null,this.svgBubbleCanvas_=null,this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout_&&(this.flyout_.dispose(),this.flyout_=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&(this.zoomControls_.dispose(),this.zoomControls_=null),this.audioManager_&&(this.audioManager_.dispose(),this.audioManager_=null),this.grid_&&(this.grid_.dispose(),this.grid_=null),this.toolboxCategoryCallbacks_&&(this.toolboxCategoryCallbacks_=null),this.flyoutButtonCallbacks_&&(this.flyoutButtonCallbacks_=null),this.options.parentWorkspace||goog.dom.removeNode(this.getParentSvg().parentNode),this.resizeHandlerWrapper_&&(Blockly.unbindEvent_(this.resizeHandlerWrapper_),this.resizeHandlerWrapper_=null)};if(e){const{startLoading:e,endLoading:o}=r.Z.instance;e(),setTimeout((()=>{t(),o()}),50)}else t()},Blockly.WorkspaceSvg.prototype.asyncClear=function(){const{startLoading:e,endLoading:t}=r.Z.instance;return e(),new Promise((e=>{this.clear(),t(),e()}))},o(5338),o(1874),o(839);var u=o(3751);Blockly.Tooltip.HOVER_MS=50,Blockly.Tooltip.show_=()=>{let e;if(Blockly.Tooltip.DIV=(Blockly.Tooltip.poisonedElement_=Blockly.Tooltip.element_,Blockly.Tooltip.DIV),!Blockly.Tooltip.blocked_){for(Blockly.Tooltip.DIV.innerHTML="",e=Blockly.Tooltip.element_.tooltip;"function"==typeof e;)e=e();e=Blockly.utils.string.wrap(e,Blockly.Tooltip.LIMIT),e=e.split("\n"),e.forEach(((e,t)=>{const o=document.createElement("div"),i=document.createElement("span");if(i.appendChild(document.createTextNode(e)),i.style.verticalAlign="middle",Blockly.Tooltip.DIV.appendChild(o),t)i.style.paddingLeft="24px";else{const e=document.createElement("img"),t=document.createElement("span");e.src=u.xY,e.style.paddingRight="8px",e.style.verticalAlign="middle",o.appendChild(t),t.appendChild(e)}o.appendChild(i)}));const t=Blockly.Tooltip.element_.RTL,o=document.documentElement.clientWidth,i=document.documentElement.clientHeight;Blockly.Tooltip.DIV&&(Blockly.Tooltip.DIV.style.direction=t?"rtl":"ltr"),Blockly.Tooltip.DIV.style.display="block",Blockly.Tooltip.visible=!0;let n=Blockly.Tooltip.lastX_;n=t?n-(Blockly.Tooltip.OFFSET_X+Blockly.Tooltip.DIV.offsetWidth):n+Blockly.Tooltip.OFFSET_X;let r=Blockly.Tooltip.lastY_+Blockly.Tooltip.OFFSET_Y;r+Blockly.Tooltip.DIV.offsetHeight>i+window.scrollY&&(r-=Blockly.Tooltip.DIV.offsetHeight+2*Blockly.Tooltip.OFFSET_Y),t&&(n=Math.max(Blockly.Tooltip.MARGINS-window.scrollX,n)),n+Blockly.Tooltip.DIV.offsetWidth>o+window.scrollX-2*Blockly.Tooltip.MARGINS&&(n=o-Blockly.Tooltip.DIV.offsetWidth-2*Blockly.Tooltip.MARGINS),Blockly.Tooltip.DIV.style.top=`${r}px`,Blockly.Tooltip.DIV.style.left=`${n}px`}},Blockly.Tooltip.hide=()=>{var e;Blockly.Tooltip.visible&&Blockly.Tooltip.DIV&&(Blockly.Tooltip.visible=!1,setTimeout((()=>Blockly.Tooltip.DIV.style.display="none"),Blockly.Tooltip.HOVER_MS)),Blockly.Tooltip.showPid_&&clearTimeout(Blockly.Tooltip.showPid_),null!==(e=Blockly.Tooltip.DIV)&&void 0!==e&&e.style.direction||(Blockly.Tooltip.visible=!1,Blockly.Tooltip.DIV.style.display="none")}},9379:()=>{Blockly.createVirtualWorkspace_=function(e,t,o,i){t.parentWorkspace=null;const n=new Blockly.WorkspaceSvg(t,o,i);return n.scale=t.zoomOptions.startScale,e.appendChild(n.createDom("blocklyMainBackground")),n}},839:()=>{Blockly.ScratchBlockComment.prototype.updateColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.getColour())}},7850:()=>{Blockly.Trashcan.prototype.MARGIN_BOTTOM_=68,Blockly.Trashcan.prototype.MARGIN_SIDE_=16,Blockly.Trashcan.prototype.click=function(){}},884:()=>{Blockly.utils.string={wrap:Blockly.utils.wrap}},5651:()=>{Blockly.VariableMap.prototype.createVariable=function(e,t,o,i,n){let r=this.getVariable(e,t);if(r)return r;if(o&&(r=this.getVariableById(o),r))return r;const a=o||Blockly.utils.genUid(),l=t||"";return r=new Blockly.VariableModel(this.workspace,e,l,a,i,n),this.variableMap_[l]?this.variableMap_[l].push(r):this.variableMap_[l]=[r],r}},7058:()=>{Blockly.Variables.allUsedVarModels=function(e){const t=e.getAllBlocks(!1),o=Object.create(null);t.forEach((e=>{const t=e.getVarModels();t&&t.forEach((e=>{const t=e.getId();t&&(o[t]=e)}))}));const i=[];return Object.keys(o).forEach((e=>{i.push(o[e])})),i},Blockly.Variables.generateVariableFieldDom=function(e){const t=document.createElement("field");t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.type);const o=document.createTextNode(e.name);return t.appendChild(o),t}},8993:()=>{Blockly.WorkspaceAudio.prototype.preload=function(){}},5338:()=>{Blockly.Xml.NODE_BLOCK="BLOCK",Blockly.Xml.NODE_BUTTON="BUTTON",Blockly.Xml.NODE_LABEL="LABEL",Blockly.Xml.NODE_SHADOW="SHADOW",Blockly.Xml.NODE_INPUT="INPUT"},1319:(e,t,o)=>{"use strict";o.d(t,{p:()=>a,M:()=>l});var i=o(6782),n=o.n(i),r=o(9789);const a=({data:e,filename:t,type:o})=>{const i=new Blob([e],{type:o});n().saveAs(i,t)},l=(e,t)=>{const o=r.v.opposites[t.toUpperCase()];if(!o)return r.v.NOT_AVAILABLE_DROPDOWN_OPTIONS;const i=o.map((e=>Object.entries(e)[0].reverse()));return"both"!==e?i.filter((t=>t[1]===e)):i}},6132:(e,t,o)=>{"use strict";o.d(t,{cM:()=>w,tp:()=>v,nf:()=>E,YQ:()=>A,zD:()=>h,oG:()=>f,UR:()=>T,zJ:()=>O,$9:()=>S,a1:()=>m,yW:()=>B,P_:()=>C,Hh:()=>y});var i=o(8429),n=o(1319),r=o(9789),a=o(9633);class l{constructor(){this.blocks_pending_reconnect={},this.workspace=this.createWorkspace(),this.workspace_variables={}}getConversions(){const e=(e,t,o,i)=>{const n=this.workspace.newBlock(t),r=Array.from(e.children),a=r.find((e=>"mutation"===e.tagName.toLowerCase()));if(a){const e=parseInt(a.getAttribute("items"))||0;if(e>0){for(let t=0;t<e;t++)n.onIconClick();r.filter((e=>"value"===e.tagName.toLowerCase())).forEach((e=>{const t=e.getAttribute("name"),o=parseInt(t.replace(/[^0-9]+/g,""));Array.from(e.children).forEach((e=>{const t=this.convertBlockNode(e,n);n.getBlocksInStatement("STACK").find(((e,t)=>o===t)).getInput(i).connection.connect(t.outputConnection)})),e.parentNode.removeChild(e)}))}}const l=this.generateUniqueVariable(o),s=this.workspace.newBlock("variables_get");return s.setFieldValue(l.getId(),"VAR"),n.setFieldValue(l.getId(),"VARIABLE"),{block_to_attach:s,statement_blocks:[n]}},t=(e,t,o)=>{const i=this.workspace.newBlock(t),n={input_list:[{old:"INPUT",new:"INPUT_LIST"}],period:[{old:"PERIOD",new:"PERIOD"}],fast_ema_period:[{old:"FAST_EMA_PERIOD",new:"FAST_EMA_PERIOD"}],signal_ema_period:[{old:"SMA_PERIOD",new:"SIGNAL_EMA_PERIOD"},{old:"SIGNAL_EMA_PERIOD",new:"SIGNAL_EMA_PERIOD"}],slow_ema_period:[{old:"SLOW_EMA_PERIOD",new:"SLOW_EMA_PERIOD"}],std_dev_multiplier_up:[{old:"UPMULTIPLIER",new:"UPMULTIPLIER"}],std_dev_multiplier_down:[{old:"DOWNMULTIPLIER",new:"DOWNMULTIPLIER"}]};switch(t){case"bb_statement":case"bba_statement":{const t=i.getField("BBRESULT_LIST");t&&t.setValue(this.getFieldValue(e,"BBRESULT_LIST"));break}case"macda_statement":{const t=i.getField("MACDFIELDS_LIST");t&&t.setValue(this.getFieldValue(e,"MACDFIELDS_LIST"));break}}(i.required_child_blocks||[]).forEach((e=>{const t=this.workspace.newBlock(e);i.getLastConnectionInStatement("STATEMENT").connect(t.previousConnection)})),i.getBlocksInStatement("STATEMENT").forEach((t=>{const o=n[t.type];o&&o.forEach((o=>{const n=e.querySelector(`value[name="${o.old}"]`);if(n){const e=t.getInput(o.new);Array.from(n.children).forEach((t=>{const o=this.convertBlockNode(t,i);"shadow"===t.tagName.toLowerCase()&&o.setShadow(!0),e.connection.connect(o.outputConnection)})),n.parentNode.removeChild(n)}}))}));const r=this.generateUniqueVariable(o),a=this.workspace.newBlock("variables_get");return a.setFieldValue(r.getId(),"VAR"),i.setFieldValue(r.getId(),"VARIABLE"),{block_to_attach:a,statement_blocks:[i]}},o=(e,t=!1)=>{const o=this.workspace.newBlock("trade_definition_tradeoptions"),i=e;if(t)return!1;const n=Array.from(i.children);let r=0,a=!1;return n.filter((e=>"value"===e.tagName.toLowerCase())).forEach((e=>{const t=e.getAttribute("name");"BARRIEROFFSET"===t||"SECONDBARRIEROFFSET"===t?r++:"PREDICTION"===t&&(a=!0)})),r>0&&o.createBarrierInputs({allow_both_types:!0,values:[1,-1]}),a&&o.createPredictionInput([0]),["DURATIONTYPE_LIST","CURRENCY_LIST","BARRIEROFFSETTYPE_LIST","SECONDBARRIEROFFSETTYPE_LIST"].forEach((e=>{const t=o.getField(e);t&&t.setValue(this.getFieldValue(i,e))})),{block_to_attach:o}};return{bb:e=>t(e,"bb_statement","bb"),bba:e=>t(e,"bba_statement","bba"),ema:e=>t(e,"ema_statement","ema"),emaa:e=>t(e,"emaa_statement","emaa"),lists_create_with:t=>e(t,"lists_create_with",(0,i.localize)("list"),"VALUE"),macda:e=>t(e,"macda_statement","macda"),market:e=>o(e),rsi:e=>t(e,"rsi_statement","rsi"),rsia:e=>t(e,"rsia_statement","rsia"),sma:e=>t(e,"sma_statement","sma"),smaa:e=>t(e,"smaa_statement","smaa"),text_join:t=>e(t,"text_join",(0,i.localize)("text"),"TEXT"),trade:e=>{const t=this.workspace.newBlock("trade_definition"),o={trade_definition_market:["MARKET_LIST","SUBMARKET_LIST","SYMBOL_LIST"],trade_definition_tradetype:["TRADETYPECAT_LIST","TRADETYPE_LIST"],trade_definition_contracttype:["TYPE_LIST"],trade_definition_candleinterval:["CANDLEINTERVAL_LIST"],trade_definition_restartbuysell:["TIME_MACHINE_ENABLED"],trade_definition_restartonerror:["RESTARTONERROR"]},i={};return Object.keys(o).forEach((t=>{const n=this.workspace.newBlock(t);o[t].forEach((t=>{n.setFieldValue(this.getFieldValue(e,t),t)})),i[t]=n})),Object.values(i).forEach((e=>{t.getLastConnectionInStatement("TRADE_OPTIONS").connect(e.previousConnection)})),{block_to_attach:t}},tradeOptions:o}}getIllegalBlocks(){const e=[],{active_symbols:t}=a.Z.instance.active_symbols,{opposites:o}=r.v;return t.forEach((t=>{const o=t.symbol.toLowerCase();e.includes(o)||e.push(o)})),Object.keys(o).forEach((t=>e.push(t))),e}createWorkspace(){const e=new Blockly.Options({media:`${o.p}media/`}),t=new DocumentFragment;return Blockly.createVirtualWorkspace_(t,e,!1,!1)}getFieldValue(e,t){const o=e.querySelector(`field[name="${t}"]`);return o?o.textContent:""}getFirstBlockInStack(e){let t=e.previousConnection,o=e.getPreviousBlock();if(!t)return e;for(;o&&o!==e.getSurroundParent();)t=o.previousConnection,o=o.getPreviousBlock();return t.sourceBlock_}updateRenamedFields(e){const t={MARKET_LIST:{volidx:"synthetic_index"},TRADETYPECAT_LIST:{endsinout:"inout",staysinout:"inout",callputequal:"callput"},TRADETYPE_LIST:{risefall:"callput",risefallequals:"callputequal"}};return Object.keys(t).forEach((o=>{const i=e.querySelector(`field[name="${o}"]`);if(i){const e=i.innerText;Object.keys(t[o]).forEach((n=>{e===n&&(i.innerText=t[o][n])}))}})),e}naivelyFixLegacyStrategyAfterConversion(){const e=this.workspace.getTradeDefinitionBlock();e&&e.getBlocksInStatement("SUBMARKET").forEach((t=>{if("trade_definition_tradeoptions"!==t.type){const o=e.getLastConnectionInStatement("INITIALIZATION");t.unplug(!0),o.connect(t.previousConnection)}}))}generateUniqueVariable(e){let t=e,o=0;for(;Object.values(this.workspace_variables).includes(t);)o++,t=e+o;const i=Blockly.Variables.getOrCreateVariablePackage(this.workspace,"",t,"");return this.workspace_variables[i.id_]=t,i}convertStrategy(e,t){Blockly.Events.disable();const o=this.updateRenamedFields(e);if(e.hasAttribute("is_dbot")&&"true"===e.getAttribute("is_dbot"))return Blockly.Events.enable(),o;if(this.getIllegalBlocks().some((e=>!!o.querySelector(`block[type="${e}"]`))))return t&&t(),Blockly.Events.enable(),Blockly.Xml.textToDom("<xml />");const i=[],n=[];Array.from(o.children).forEach((e=>{switch(e.nodeName.toLowerCase()){case"block":case"shadow":n.push(e);break;case"variables":i.push(...e.children)}}));const r=e=>{e.forEach((e=>{const t=e.getAttribute("id"),o=e.textContent;if(!this.workspace_variables[t]){const e=Blockly.Variables.getOrCreateVariablePackage(this.workspace,t,o,"");this.workspace_variables[e.id_]=e.name}}))};r(i),r(o.querySelectorAll('field[name="VAR"]')),n.forEach((e=>this.convertBlockNode(e))),Object.keys(this.blocks_pending_reconnect).forEach((e=>{const t=this.workspace.getBlockById(e),o=this.blocks_pending_reconnect[e],i=t.previousConnection;if(i){const e=i.targetConnection;let n=i;if(o.reverse().forEach((e=>{n.connect(e.nextConnection),n=e.previousConnection})),e){let o=t.previousConnection,i=t.getPreviousBlock();for(;i&&i!==i.getSurroundParent();)o=i.previousConnection,i=i.getPreviousBlock();e.connect(o)}}})),this.naivelyFixLegacyStrategyAfterConversion(),this.workspace.getAllBlocks(!0).forEach((e=>{e.initSvg(),e.render()})),this.workspace.cleanUp();const a=Blockly.Xml.workspaceToDom(this.workspace);return e.hasAttribute("collection")&&"true"===e.getAttribute("collection")&&a.setAttribute("collection","true"),a.setAttribute("is_dbot","true"),this.workspace=null,Blockly.Events.enable(),a}convertBlockNode(e,t=null){const o=this.getConversions(),i=e.getAttribute("type"),n=Object.keys(o).includes(i);let r=null;const a=e.getAttribute("collapsed")&&"true"===e.getAttribute("collapsed"),l=e.getAttribute("movable")&&"false"===e.getAttribute("movable"),s=e.getAttribute("deletable")&&"false"===e.getAttribute("deletable"),c=e.getAttribute("disabled")&&"true"===e.getAttribute("disabled"),u=e=>{e.setCollapsed(a),e.setMovable(!l),e.setDeletable(!s),e.setDisabled(c)};if(n){const n=o[i](e);n.block_to_attach&&(r=n.block_to_attach,u(r)),t&&n.statement_blocks&&n.statement_blocks.forEach((e=>{u(e);const o=this.getClosestLegalPreviousConnection(t);if(o){const t=o.sourceBlock_;this.blocks_pending_reconnect[t.id]||(this.blocks_pending_reconnect[t.id]=[]),this.blocks_pending_reconnect[t.id].push(e)}}))}else if(Object.keys(Blockly.Blocks).includes(i)&&(r=this.workspace.newBlock(i),u(r),r)){const t=Array.from(e.children).find((e=>"mutation"===e.tagName.toLowerCase()));t&&r.domToMutation&&r.domToMutation(t)}return r?(t&&(r.conversion_parent=t),Array.from(e.children).forEach((e=>{switch(e.tagName.toLowerCase()){case"field":{const t=e.getAttribute("name"),o=r.getField(t);if(o)if(o instanceof Blockly.FieldVariable){const t=e.getAttribute("id"),i=e.innerText.trim(),n=Blockly.Variables.getOrCreateVariablePackage(this.workspace,t,i,"");this.workspace_variables[n.id_]=i,o.setValue(n.id_)}else o.setValue(e.innerText);break}case"value":this.processValueInputs(r,e);break;case"statement":{const t=e.getAttribute("name");this.processStatementInputs(r,t,e);break}case"next":{const t=e.closest("statement");if(t){const o=t.getAttribute("name");this.processStatementInputs(r,o,e,r.conversion_parent)}else r.nextConnection&&Array.from(e.children).forEach((e=>{const t=this.convertBlockNode(e);r.nextConnection.connect(t.previousConnection)}));break}case"comment":{const t="true"!==e.getAttribute("pinned"),o=e.innerText;r.comment=new Blockly.ScratchBlockComment(r,o,null,0,0,t),r.comment.iconXY_={x:0,y:0},r.comment.setVisible(!0);break}}})),r):(console.warn("Unrecognised block found.",i),!1)}processValueInputs(e,t){const o=t.getAttribute("name"),i=e.getInput(o);if(!i)return console.warn("Unrecognised value input",o),!1;Array.from(t.children).forEach((t=>{const o=this.convertBlockNode(t,e);if(!o)return console.warn("Illegal child.",t.getAttribute("type")),!1;"shadow"===t.tagName.toLowerCase()&&o.setShadow(!0),i.connection.connect(o.outputConnection)}))}processStatementInputs(e,t,o,i=null){const n=i||e;if(!n.getInput(t))return console.warn("Unrecognised statement input",t),!1;Array.from(o.children).forEach((e=>{const o=this.convertBlockNode(e,n);if(!o)return console.warn("Unrecognised child in statement",e.getAttribute("type")),!1;const i=n.getInput(t);i&&o.previousConnection&&i.connection.connect(o.previousConnection)}))}getClosestLegalPreviousConnection(e){if(r.v.procedureDefinitionBlocks.includes(e.type)){if(0===e.getBlocksInStatement("STACK").length){const t=e.getInput("STACK"),o=this.workspace.newBlock("useless_block");return t.connection.connect(o.previousConnection),o.previousConnection}return e.getInputTargetBlock("STACK").previousConnection}let t=this.getFirstBlockInStack(e),o=this.isConnectedToProtectedStatementInput(t);for(;o;){const e=t.getParent();e&&(t=e,o=this.isConnectedToProtectedStatementInput(t))}return t.previousConnection?t.previousConnection:!!e.conversion_parent&&this.getClosestLegalPreviousConnection(e.conversion_parent)}isConnectedToProtectedStatementInput(e){const t=this.getFirstBlockInStack(e).previousConnection;if(t){const e=t.targetConnection;if(e){const t=e.sourceBlock_,o=t.getInputWithConnection(e),i=t.protected_statements||[];if(o&&i.includes(o.name))return!0}}return!1}}var s=o(8421),c=o(2620),u=o(2626),p=o(282),d=o(7103);const y=()=>{var e;const{save_modal:t}=p.Z.instance,o=null!==(e=t.bot_name)&&void 0!==e?e:r.v.default_file_name;if(document.title.indexOf("-")>-1){const e=document.title.substr(document.title.indexOf("-")),t=document.title.replace(e,`- ${o}`);document.title=t}else document.title+=` - ${o}`},m=(e="@deriv/bot",t=!1,o)=>{o.setAttribute("is_dbot","true"),o.setAttribute("collection",t?"true":"false");const i=Blockly.Xml.domToPrettyText(o);(0,n.p)({data:i,type:"text/xml;charset=utf-8",filename:`${e}.xml`})},h=({block_string:e,drop_event:t,file_name:o,strategy_id:n,from:r,workspace:a,showIncompatibleStrategyDialog:y})=>{const{startLoading:m,endLoading:h}=p.Z.instance;m(),setTimeout((async()=>{const m=()=>{h();const e=(0,i.localize)("XML file contains unsupported elements. Please check or modify file.");s.P.emit("ui.log.error",e)};try{if((new DOMParser).parseFromString(e,"application/xml").getElementsByTagName("parsererror").length)return m()}catch(e){return m()}let f;try{f=Blockly.Xml.textToDom(e)}catch(e){return m()}f=(new l).convertStrategy(f,y);const b=f.querySelectorAll("block");if(!b.length)return m();if(Array.from(b).some((e=>{const t=e.getAttribute("type");return!Object.keys(Blockly.Blocks).includes(t)})))return m();try{const e=f.hasAttribute("collection")&&"true"===f.getAttribute("collection"),i=e?`load_collection${Date.now()}`:`dbot-load${Date.now()}`;if(Blockly.Events.setGroup(i),(0,c.kH)(a,Array.from(b).map((e=>e.getAttribute("type")))),e)_(f,t,i,a);else if(await g(f,i,a),a===Blockly.derivWorkspace){const{save_modal:e}=p.Z.instance;e.updateBotName(o),a.clearUndo(),a.current_strategy_id=n||Blockly.utils.genUid(),await(0,u.l5)(f,r)}a.getAllBlocks().forEach((e=>{e.disabled&&(e.is_user_disabled_state=!0)})),a===Blockly.derivWorkspace&&s.P.emit("ui.log.success",{log_type:d.F$.LOAD_BLOCK})}catch(e){return console.error(e),m()}finally{h()}return!0}),500)},_=(e,t,o,i)=>{Blockly.Events.setGroup(o);const n=Blockly.Xml.domToWorkspace(e,i).map((e=>i.getBlockById(e)));t&&0!==Object.keys(t).length?((e,t,o)=>{const{clientX:i=0,clientY:n=0}=t||{},r=o.getMetrics(),a=1/o.scale,l=r.absoluteLeft-r.viewLeft,s=document.body.offsetHeight-r.viewHeight-r.viewTop,c=i?(i-l)*a:0,u=n?(n-s-76)*a:0;o.cleanUp(c,u,e)})(n,t,i):i.cleanUp()},g=async(e,t,o)=>{Blockly.Events.setGroup(t),await o.asyncClear(),Blockly.Xml.domToWorkspace(e,o)},f=e=>new Promise(((t,o)=>{let n=e.getFieldValue("URL");-1===n.indexOf("http")&&(n=`http://${n}`);const r="/"===n.slice(-1)[0];if(!n.match(/[^/]*\.[a-zA-Z]{3}$/)&&!r)return o((0,i.localize)("Target must be an XML file"));if(r&&(n+="index.xml"),e.isKnownUrl(n))return e.setDisabled(!0),o((0,i.localize)("This URL is already loaded"));const a=()=>o((0,i.localize)("An error occured while trying to load the URL"));fetch(n).then((o=>{o.ok?o.text().then((o=>{((e,t)=>new Promise(((o,n)=>{let r;try{r=Blockly.Xml.textToDom(e)}catch(e){return n((0,i.localize)("Unrecognized file format"))}try{r.hasAttribute("collection")&&"true"===r.getAttribute("collection")||n((0,i.localize)("Remote blocks to load must be a collection.")),b(r).then((()=>{Array.from(r.children).forEach((e=>k(e,t))),o()})).catch((()=>{n()}))}catch(e){n((0,i.localize)("Unable to load the block file."))}})))(o,e).then((()=>t(e))).catch(a)})):a()})).catch(a)})),b=e=>new Promise(((t,o)=>{const i=[];Array.from(e.children).forEach((e=>{if("loader"===e.getAttribute("type")){e.remove();const t=Blockly.Xml.domToBlock(e,Blockly.derivWorkspace);i.push(f(t))}})),i.length?Promise.all(i).then(t,o):t([])})),k=(e,t=null)=>{if("variables"===e.tagName.toLowerCase())return Blockly.Xml.domToVariables(e,Blockly.derivWorkspace);const o=e.getAttribute("type"),i=new l,n=Blockly.Xml.blockToDom(i.convertBlockNode(e));Array.from(n.getElementsByTagName("arg")).forEach((e=>{e.hasAttribute("varid")&&e.setAttribute("varId",e.getAttribute("varid"))})),(0,c.kH)(Blockly.derivWorkspace,o);const r=Blockly.Xml.domToBlock(n,Blockly.derivWorkspace);return t&&t.blocks_added_by_me.push(r),r},v=e=>{const t=e.getAllBlocks(),{mandatoryMainBlocks:o}=r.v,i=["trade_definition_tradeoptions",...o],n=t.map((e=>e.type));return i.every((e=>n.includes(e)))},E=e=>{const t=e.getAllBlocks().filter((e=>e.disabled)),{mandatoryMainBlocks:o}=r.v,i=["trade_definition_tradeoptions",...o];return!t.map((e=>e.type)).some((e=>i.includes(e)))},B=(e,t,o,i)=>{const n=e.getMetrics();let r=n.viewLeft-n.contentLeft,a=n.viewTop-n.contentTop;o?(r+=i?t:-t,a+=-20):(r+=-20,a+=i?t:-t),e.scrollbar.set(r,a)},T=(e,t,o)=>{const i=e&&Blockly.Events.getGroup()||o||!0;Blockly.Events.setGroup(i),t(),e||Blockly.Events.setGroup(!1)},S=e=>{const{recordUndo:t}=Blockly.Events;Blockly.Events.recordUndo=!1,e(),Blockly.Events.recordUndo=t},O=e=>{Blockly.Events.disable(),e(),Blockly.Events.enable()},C=(e,t)=>{t.type===Blockly.Events.END_DRAG&&e.getAllBlocks().forEach((e=>{if(!e.getParent()||e.is_user_disabled_state)return;const o=e.restricted_parents||[];if(0===o.length)return;const i=!o.some((t=>e.isDescendantOf(t)));T(!0,(()=>{e.setDisabled(i)}),t.group),Blockly.Events.setGroup(!1)}))},w=e=>!e||"''"===e,A=e=>{const t=e.substring(1),o=parseInt(t,16);return.2126*(o>>16&255)+.7152*(o>>8&255)+.0722*(o>>0&255)<160}},5401:(e,t,o)=>{"use strict";o.d(t,{Z:()=>a});var i=o(8429),n=o(6715),r=o(9789);class a{constructor(e,t){this.sortDropdownOptions=(e,t)=>{const o=[...e];return o.sort(((e,o)=>{const i=t.call(this,e[1]),n=t.call(this,o[1]);return i&&!n?1:i===n?0:-1})),o},this.active_symbols=[],this.disabled_markets=[],this.disabled_symbols=["frxGBPNOK","frxUSDNOK","frxUSDNEK","frxUSDSEK"],this.disabled_submarkets=["energy","step_index","crash_index"],this.init_promise=new n.Z,this.is_initialised=!1,this.processed_symbols={},this.trading_times=t,this.ws=e}async retrieveActiveSymbols(e=!1){if(await this.trading_times.initialise(),!e&&this.is_initialised)return await this.init_promise,this.active_symbols;this.is_initialised=!0;const{active_symbols:t}=await this.ws.authorized.activeSymbols();return this.active_symbols=t,this.processed_symbols=this.processActiveSymbols(),this.trading_times.onMarketOpenCloseChanged=e=>{Object.keys(e).forEach((t=>{const o=this.active_symbols[t];o&&(o.exchange_is_open=e[t])})),this.changes=e,this.processActiveSymbols()},this.init_promise.resolve(),this.active_symbols}processActiveSymbols(){return this.active_symbols.reduce(((e,t)=>{if(this.disabled_markets.includes(t.market)||this.disabled_symbols.includes(t.symbol)||this.disabled_submarkets.includes(t.submarket))return e;const o=(e,o)=>-1!==Object.keys(e).findIndex((e=>e===t[o]));o(e,"market")||(e[t.market]={display_name:t.market_display_name,submarkets:{}});const{submarkets:i}=e[t.market];o(i,"submarket")||(i[t.submarket]={display_name:t.submarket_display_name,symbols:{}});const{symbols:n}=i[t.submarket];return o(n,"symbol")||(n[t.symbol]={display_name:t.display_name,pip_size:`${t.pip}`.length-2,is_active:!t.is_trading_suspended&&t.exchange_is_open}),e}),{})}getAllSymbols(e=!1){const t=[];return Object.keys(this.processed_symbols).forEach((o=>{if(e&&this.isMarketClosed(o))return;const i=this.processed_symbols[o],{submarkets:n}=i;Object.keys(n).forEach((e=>{const r=n[e],{symbols:a}=r;Object.keys(a).forEach((n=>{const l=a[n];t.push({market:o,market_display:i.display_name,submarket:e,submarket_display:r.display_name,symbol:n,symbol_display:l.display_name})}))}))})),t}getMarketDropdownOptions(){const e=[];if(Object.keys(this.processed_symbols).forEach((t=>{const{display_name:o}=this.processed_symbols[t],n=o+(this.isMarketClosed(t)?` ${(0,i.localize)("(Closed)")}`:"");e.push([n,t])})),0===e.length)return r.v.NOT_AVAILABLE_DROPDOWN_OPTIONS;if(e.sort((e=>"synthetic_index"===e[1]?-1:1)),e.some((e=>this.isMarketClosed(e[1])))){const t=this.sortDropdownOptions(e,this.isMarketClosed);return this.isMarketClosed("forex")?t.sort((e=>"synthetic_index"===e[1]?-1:1)):t}return e}getSubmarketDropdownOptions(e){const t=[],o=this.processed_symbols[e];if(o){const{submarkets:e}=o;Object.keys(e).forEach((o=>{const{display_name:n}=e[o],r=n+(this.isSubmarketClosed(o)?` ${(0,i.localize)("(Closed)")}`:"");t.push([r,o])}))}return 0===t.length?r.v.NOT_AVAILABLE_DROPDOWN_OPTIONS:("synthetic_index"===e&&t.sort((e=>"random_index"===e[1]?-1:1)),this.sortDropdownOptions(t,this.isSubmarketClosed))}getSymbolDropdownOptions(e){const t=Object.keys(this.processed_symbols).reduce(((t,o)=>{const{submarkets:n}=this.processed_symbols[o];return Object.keys(n).forEach((o=>{if(o===e){const{symbols:e}=n[o];Object.keys(e).forEach((o=>{const{display_name:n}=e[o],r=n+(this.isSymbolClosed(o)?` ${(0,i.localize)("(Closed)")}`:"");t.push([r,o])}))}})),t}),[]);return 0===t.length?r.v.NOT_AVAILABLE_DROPDOWN_OPTIONS:this.sortDropdownOptions(t,this.isSymbolClosed)}isMarketClosed(e){const t=this.processed_symbols[e];return!t||Object.keys(t.submarkets).every((e=>this.isSubmarketClosed(e)))}isSubmarketClosed(e){const t=Object.keys(this.processed_symbols).find((t=>{const o=this.processed_symbols[t];return Object.keys(o.submarkets).includes(e)}));if(!t)return!0;const o=this.processed_symbols[t].submarkets[e];if(!o)return!0;const{symbols:i}=o;return Object.keys(i).every((e=>this.isSymbolClosed(e)))}isSymbolClosed(e){return this.active_symbols.some((t=>t.symbol===e&&(!t.exchange_is_open||t.is_trading_suspended)))}}},9633:(e,t,o)=>{"use strict";o.d(t,{Z:()=>s});var i=o(4227),n=o(1408),r=o(5401);class a{constructor(e){this.ws=e.ws}getStakePayoutLimits(e="AUD",t="svg",o){return this.ws.send({landing_company_details:t}).then((t=>{var i;const n=null==t||null===(i=t.landing_company_details)||void 0===i?void 0:i.currency_config[o];return n?n[e]:{}}))}}class l{constructor(e){this.trading_times=new i.Z(e),this.contracts_for=new n.Z(e),this.active_symbols=new r.Z(e.ws,this.trading_times),this.account_limits=new a(e)}static setInstance(e){return this.singleton||(this.singleton=new l(e)),this.instance}static get instance(){return this.singleton}}l.singleton=null;const s=l},1408:(e,t,o)=>{"use strict";o.d(t,{Z:()=>r});var i=o(9789),n=o(6715);class r{constructor({ws:e,server_time:t}){this.cache_age_in_min=10,this.contracts_for={},this.ws=e,this.server_time=t,this.disabled_options=[{submarket:"smart_fx",trade_type:"higherlower"},{submarket:"minor_pairs",trade_type:"higherlower"},{submarket:"metals",trade_type:"callputequal"},{market:"indices",trade_type:"callputequal"},{symbol:"OTC_AS51",trade_type_category:"inout"},{trade_type_category:"lookback"},{trade_type_category:"callputspread"}],this.retrieving_contracts_for={}}async getBarriers(e,t,o,n){const r={values:[]};if(!i.v.BARRIER_TRADE_TYPES.includes(t))return r;const a=["high_barrier","low_barrier"],l=await this.getContractsByTradeType(e,t),s=await this.getDurations(e,t,!1),c=new RegExp("^[-|+]([0-9]+.[0-9]+)$"),u=e=>e&&c.test(e.toString());let p=!0;return l.length>0&&(n.forEach(((e,d)=>{const y=["+","-"].includes(e),m=this.getContractCategoryByTradeType(t);let h=l.find((e=>{const{BARRIER_CATEGORIES:n}=i.v,r=Object.keys(n).find((e=>n[e].includes(t))),l=e.contract_category===m,c=-1!==s.findIndex((e=>e.unit===o)),p=e.barrier_category===r,h=y&&u(e.barrier||e[a[d]])||!y&&!u(e.barrier||e[a[d]]);return l&&c&&p&&h}));if(h||(h=l.filter((e=>e.barrier||e.high_barrier)).sort(((e,t)=>{const o=e.barrier||e.high_barrier,i=t.barrier||t.high_barrier;return parseFloat(o)-parseFloat(i)})).shift(),h&&!y&&(p=!1)),h){const t=1===h.barriers?"barrier":a[d];if(h[t]){const e=`${h[t]}`.match(c);r.values[d]=e?e[1]:h[t]}Object.assign(r,{allow_both_types:["intraday","tick"].includes(h.expiry_type)&&u(h[t]),allow_absolute_type:"absolute"===e&&!u(h[t])}),1===h.barriers&&n.splice(d+1,1)}})),p?2===r.values.length&&n.every((e=>e===n[0]))&&r.values.every((e=>e===r.values[0]))&&(r.values[1]=(.95*r.values[0]).toFixed(1)):r.values=r.values.map((()=>!1))),r}getContractCategoryByTradeType(e){const{TRADE_TYPE_TO_CONTRACT_CATEGORY_MAPPING:t}=i.v;return Object.keys(t).find((o=>t[o].includes(e)))||e}getTradeTypeCategoryByTradeType(e){const{TRADE_TYPE_CATEGORIES:t}=i.v;return Object.keys(t).find((o=>t[o].includes(e)))||e}getTradeTypeCategoryNameByTradeType(e){const{TRADE_TYPE_CATEGORY_NAMES:t}=i.v;return t[this.getTradeTypeCategoryByTradeType(e)]}getBarrierCategoryByTradeType(e){const{BARRIER_CATEGORIES:t}=i.v;return Object.keys(t).find((o=>t[o].includes(e)))}async getContractsByTradeType(e,t){const o=await this.getContractsFor(e),i=this.getContractCategoryByTradeType(t),n=this.getBarrierCategoryByTradeType(t);return o.filter((e=>{const t=e.contract_category===i,o=e.barrier_category===n;return t&&o}))}async getContractsFor(e){if(!e||"na"===e)return[];const t=async()=>{if(this.retrieving_contracts_for[e])return await this.retrieving_contracts_for[e],this.contracts_for[e].contracts;this.retrieving_contracts_for[e]=new n.Z;const t=await this.ws.send({contracts_for:e});if(t.error)return[];const{contracts_for:{available:o}}=t,i=o.filter((e=>"forward"!==e.start_type));return this.contracts_for[e]={contracts:i,timestamp:this.server_time.unix()},this.retrieving_contracts_for[e].resolve(),delete this.retrieving_contracts_for[e],i};if(this.contracts_for[e]){const{contracts:o,timestamp:i}=this.contracts_for[e];return this.server_time.unix()-i>60*this.cache_age_in_min&&t(),o}return t()}async getDurations(e,t,o=!0){const n=await this.getContractsFor(e),{NOT_AVAILABLE_DURATIONS:r,DEFAULT_DURATION_DROPDOWN_OPTIONS:a}=i.v;if(0===n.length)return r;const l=await this.getContractsByTradeType(e,t),s=[],c=e=>a.findIndex((t=>t[1]===e.replace(/\d+/g,""))),u=(e,t)=>{const o=e.replace(/\D/g,""),i=c(e),n=a.findIndex((e=>e[1]===t));let r=parseInt(o);return a.slice(n+1,i+1).reverse().forEach((e=>{switch(e[1]){case"m":case"h":r*=60;break;case"d":r*=24}})),r};if(l.forEach((e=>{if(!e.min_contract_duration||!e.max_contract_duration)return;const t=c(e.min_contract_duration),i=c("1d"===e.max_contract_duration&&o?"24h":e.max_contract_duration);a.slice(t,i+1).forEach(((t,o)=>{-1!==s.findIndex((e=>e.unit===t[1]))||s.push({display:t[0],unit:t[1],min:0===o?parseInt(e.min_contract_duration.replace(/\D/g,"")):1,max:u(e.max_contract_duration,t[1])})}))})),l.every((e=>"intraday"===e.expiry_type))){const e=s.findIndex((e=>"d"===e[1]));-1!==e&&s.splice(e,1)}return 0===s.length?r:s.sort(((e,t)=>c(e.unit)-c(t.unit)))}async getPredictionRange(e,t){const o=await this.getContractsByTradeType(e,t),n=this.getContractCategoryByTradeType(t),r=[],{DIGIT_CATEGORIES:a,opposites:l}=i.v;if(a.includes(n)&&"evenodd"!==t){const e=o.find((e=>Object.keys(l).some((t=>l[t].map((e=>Object.keys(e)[0])).includes(e.contract_type)))));e&&e.last_digit_range?r.push(...e.last_digit_range):r.push(1,2,3,4,5,6,7,8)}return r}async getMarketBySymbol(e){const t=await this.getContractsFor(e);return t.length?t[0].market:"na"}async getSubmarketBySymbol(e){const t=await this.getContractsFor(e);return t.length?t[0].submarket:"na"}async getGroupedTradeTypes(e){const t=await this.getContractsFor(e),o={};for(let i=0;i<t.length;i++){const n=t[i].market,r=t[i].submarket,a=this.getTradeTypeCategoryByTradeType(t[i].contract_category),l=this.getTradeTypeCategoryNameByTradeType(t[i].contract_category),s=await this.getTradeTypeByTradeCategory(n,r,e,a);l&&(this.isDisabledOption({market:n,submarket:r,symbol:e,trade_type_category:a})||(o[l]=s))}return o}async getTradeTypeByTradeCategory(e,t,o,n){const{NOT_AVAILABLE_DURATIONS:r,TRADE_TYPE_CATEGORIES:a,opposites:l}=i.v,s=a[n],c=[];if(s&&s.length)for(let i=0;i<s.length;i++){const a=s[i],u=await this.getDurations(o,a),p=JSON.stringify(u)!==JSON.stringify(r);if(!this.isDisabledOption({market:e,submarket:t,symbol:o,trade_type_category:n,trade_type:a})&&p){const e=l[a.toUpperCase()];c.push({name:e.map((e=>e[Object.keys(e)[0]])).join("/"),value:a,icon:[Object.keys(e[0])[0],Object.keys(e[1])[0]]})}}return c}async getTradeTypeCategories(e,t,o){const{TRADE_TYPE_CATEGORY_NAMES:n,NOT_AVAILABLE_DROPDOWN_OPTIONS:r}=i.v,a=await this.getContractsFor(o),l=[];if(a.forEach((i=>{const n=this.getTradeTypeCategoryByTradeType(i.contract_category),r=this.getTradeTypeCategoryNameByTradeType(i.contract_category);r&&(this.isDisabledOption({market:e,submarket:t,symbol:o,trade_type_category:n})||-1!==l.findIndex((e=>e[1]===n))||l.push([r,n]))})),l.length>0){const e=Object.keys(n);return l.sort(((t,o)=>e.findIndex((e=>e===t[1]))-e.findIndex((e=>e===o[1]))))}return r}async getTradeTypes(e,t,o,n){const{NOT_AVAILABLE_DURATIONS:r,TRADE_TYPE_CATEGORIES:a,opposites:l}=i.v,s=[],c=a[n];if(c)for(let i=0;i<c.length;i++){const a=c[i],u=await this.getDurations(o,a),p=JSON.stringify(u)!==JSON.stringify(r);if(!this.isDisabledOption({market:e,submarket:t,symbol:o,trade_type_category:n,trade_type:a})&&p){const e=l[a.toUpperCase()];s.push([e.map((e=>e[Object.keys(e)[0]])).join("/"),a])}}return s.length>0?s:i.v.NOT_AVAILABLE_DROPDOWN_OPTIONS}isDisabledOption(e){return this.disabled_options.some((t=>Object.keys(t).every((o=>e[o]===t[o]))))}disposeCache(){this.contracts_for={}}}},4227:(e,t,o)=>{"use strict";o.d(t,{Z:()=>n});var i=o(6715);class n{constructor({ws:e,server_time:t}){this.init_promise=new i.Z,this.is_initialised=!1,this.trading_times={},this.ws=e,this.server_time=t.clone()}async initialise(){if(this.is_initialised)return this.init_promise;if(this.is_initialised=!0,this.last_update_moment=this.server_time.local(),!Object.keys(this.trading_times).length){await this.updateTradingTimes(),this.init_promise.resolve();const e=async()=>{const t=this.updateMarketOpenClosed();Object.keys(t).length>0&&this.onMarketOpenCloseChanged&&this.onMarketOpenCloseChanged(t);let o=this.nextUpdateDate();if(!o){const e=this.server_time.local(),t=this.last_update_moment.clone().add(1,"days");e.isAfter(t)?this.last_update_moment=e.clone():this.last_update_moment=t.clone();const i={};Object.keys(this.trading_times).forEach((e=>{i[e]=this.trading_times[e].is_opened})),await this.updateTradingTimes(),Object.keys(this.trading_times).forEach((e=>{this.trading_times[e].is_opened=i[e]})),t.set({hour:0,minute:0,second:0}),o=t.toDate()}const i=o-this.server_time.local().toDate();this.update_timer=setTimeout(e,i)};await e()}return this.init_promise}async updateTradingTimes(){const e=this.last_update_moment.format("YYYY-MM-DD"),t=await this.ws.tradingTimes(e);if(t.error)return;this.trading_times={};const o=this.server_time.local().toDate().toISOString().substring(0,11),i=e=>new Date(`${o}${e}Z`),{trading_times:{markets:n}}=t;n&&n.forEach((e=>{const{submarkets:t}=e;t.forEach((e=>{const{symbols:t}=e;t.forEach((e=>{const{times:t,symbol:o}=e,{open:n,close:r}=t,a=1===n.length&&"00:00:00"===n[0]&&"23:59:59"===r[0],l=1===n.length&&"--"===n[0]&&"--"===r[0];let s;a||l||(s=n.map(((e,t)=>({open:i(e),close:i(r[t])})))),this.trading_times[o]={is_open_all_day:a,is_closed_all_day:l,times:s}}))}))}))}updateMarketOpenClosed(){const e={};return Object.keys(this.trading_times).forEach((t=>{const o=this.calcIsMarketOpened(t),i=this.trading_times[t];i.is_opened!==o&&(i.is_opened=o,e[t]=o)})),e}calcIsMarketOpened(e){const t=this.server_time.local().unix(),{times:o,is_open_all_day:i,is_closed_all_day:n}=this.trading_times[e];return!n&&(!!i||o.some((e=>{const{open:o,close:i}=e;return t>=o&&t<i})))}nextUpdateDate(){const e=this.server_time.local().toDate();let t;return Object.keys(this.trading_times).forEach((o=>{const{times:i,is_open_all_day:n,is_closed_all_day:r}=this.trading_times[o];n||r||i.forEach((o=>{const{open:i,close:n}=o;i>e&&(!t||i<t)&&(t=i),n>e&&(!t||n<t)&&(t=n)}))})),t}isMarketOpened(e){const t=Object.keys(this.trading_times);return!(!t.length||!t.includes(e))&&this.trading_times[e].is_opened}}},2626:(e,t,o)=>{"use strict";o.d(t,{l5:()=>c,WN:()=>u,lY:()=>p});var i=o(6954),n=o.n(i),r=o(5486),a=o.n(r),l=o(282),s=o(7929);const c=async(e,t=s.R.UNSAVED)=>{e.setAttribute("is_dbot",!0);const{save_modal:o}=l.Z.instance,i=Blockly.derivWorkspace.current_strategy_id||Blockly.utils.genUid(),r=await u(),c=Blockly.Xml.domToText(e),p=Date.now(),d=r.findIndex((e=>e.id===i));if(d>=0){const e=r[d];e.xml=c,e.name=o.bot_name,e.timestamp=p,e.save_type=t}else r.push({id:i,timestamp:p,name:o.bot_name,xml:c,save_type:t});r.sort(((e,t)=>new Date(e.timestamp)-new Date(t.timestamp))).reverse(),r.length>10&&r.pop(),a().setItem("saved_workspaces",n().compress(JSON.stringify(r)))},u=async()=>{try{return JSON.parse(n().decompress(await a().getItem("saved_workspaces")))||[]}catch(e){return[]}},p=async e=>{const t=await u(),o=t.findIndex((t=>t.id===e));o>=0&&t.splice(o,1),await a().setItem("saved_workspaces",n().compress(JSON.stringify(t)))}},8421:(e,t,o)=>{"use strict";o.d(t,{Z:()=>l,P:()=>s});var i=o(6670);function n(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function r(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class l{constructor(){this.eam=new i.Map}register(e,t,o,n,r){r&&this.unregisterAll(e);const a=e=>{e.type===n.type&&(this.unregister("api.error",a),n.unregister.forEach((e=>{e instanceof Array?this.unregister(...e):this.unregisterAll(e)})))};n&&this.register("api.error",a);const l=(...i)=>{o&&this.unregister(e,t),n&&this.unregister("api.error",a),t(...i)},s=this.eam.get(e);this.eam=s?this.eam.set(e,s.push({action:l,searchBy:t})):this.eam.set(e,(new i.List).push({action:l,searchBy:t}))}unregister(e,t){this.eam=this.eam.set(e,this.eam.get(e).filter((e=>e.searchBy!==t)))}isRegistered(e){return this.eam.has(e)}unregisterAll(e){this.eam=this.eam.delete(e)}emit(e,t){this.eam.has(e)&&this.eam.get(e).forEach((e=>e.action(t)))}setState(e={}){this.state=r(r({},this.state),e)}getState(e){var t;return null===(t=this.state)||void 0===t?void 0:t[e]}}const s=new l},6715:(e,t,o)=>{"use strict";function i(){let e,t;const o=new Promise(((o,i)=>{e=o,t=i}));return o.isPending=!0,o.resolve=t=>{o.isPending=!1,e(t)},o.reject=e=>{o.isPending=!1,t(e)},o}o.d(t,{Z:()=>i})},2620:(e,t,o)=>{"use strict";o.d(t,{N0:()=>n,kH:()=>r});var i=o(9789);const n=()=>{const e=Blockly.derivWorkspace;if(e){e.getAllFields().forEach((e=>e.forceRerender()));const t=document.getElementById("scratch_div");t&&(t.style.width="100vw",t.style.height="var(--bot-content-height)",Blockly.svgResize(e))}},r=(e,t)=>{(Array.isArray(t)?t:[t]).forEach((t=>{i.v.single_instance_blocks.includes(t)&&e.getAllBlocks().forEach((e=>{e.type===t&&e.dispose()}))}))}},4783:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>Ks});var i,n=o(3496),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=window.location;return/^\/(br_)/.test(t.pathname)?"/".concat(t.pathname.split("/")[1]).concat(/^\//.test(e)?e:"/".concat(e)):e};i=r("/"),o.p=i,(0,n.setSmartChartsPublicPath)(r("/js/smartcharts/"));var a=o(9297),l=o(8124),s=o(6585);const c=function(){return a.createElement(a.Fragment,null,a.createElement("audio",{id:"announcement",src:"".concat(o.p,"media/announcement.ogg"),autostart:"false"}),a.createElement("audio",{id:"earned-money",src:"".concat(o.p,"media/coins.ogg"),autostart:"false"}),a.createElement("audio",{id:"job-done",src:"".concat(o.p,"media/job-done.ogg"),autostart:"false"}),a.createElement("audio",{id:"error",src:"".concat(o.p,"media/out-of-bounds.ogg"),autostart:"false"}),a.createElement("audio",{id:"severe-error",src:"".concat(o.p,"media/i-am-being-serious.ogg"),autostart:"false"}))};var u=o(3980),p=o.n(u),d=o(9877);function y(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function m(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?y(Object(o),!0).forEach((function(t){h(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):y(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function h(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var _=a.createContext(null),g=function(e){var t=e.store,o=e.children;return a.createElement(_.Provider,{value:m(m({},t),t.core)},o)},f=function(e){return function(t){return function(e,t){var o=function(o){var i=a.useContext(_),n=t;return function(e){return!("function"!=typeof e||!e.prototype||!e.prototype.isReactComponent)}(t)&&(n=function(e){return a.createElement(t,e)}),(0,d.useObserver)((function(){return n(m(m({},o),e(i,o)))}))};return o.displayName=t.name,o}(e,t)}},b=function(e){var t=e.is_loading;return a.createElement(a.Fragment,null,t&&a.createElement("div",{className:"bot__loading"},a.createElement(l.Loading,null)))};b.propTypes={is_loading:p().bool};const k=f((function(e){return{is_loading:e.blockly_store.is_loading}}))(b);var v=o(4058),E=o.n(v),B=o(8429),T=Object.freeze({WORKSPACE:"Workspace",CHART:"Chart"}),S=function(){return a.createElement(l.Popover,{alignment:"top",message:(0,B.localize)("Security and privacy")},a.createElement(l.StaticUrl,{className:"footer__link",href:"tnc/security-and-privacy.pdf",is_document:!0},a.createElement(l.Icon,{icon:"IcSecurityAndPrivacy"})))},O=function(e){var t=e.active_tab,o=e.populateFooterExtensions,i=e.setActiveTab;a.useEffect((function(){return r()})),a.useEffect((function(){return function(){return o([])}}),[]);var n=function(){return a.createElement("div",{className:"bot-footer-extensions"},Object.keys(T).map((function(e){var o=T[e];return a.createElement("span",{key:e,className:E()("bot-footer-extensions__button",{"bot-footer-extensions__button--active":t===o}),onClick:function(){return i(o)}},o===T.WORKSPACE&&a.createElement(B.Localize,{i18n_default_text:"Workspace"}),o===T.CHART&&a.createElement(B.Localize,{i18n_default_text:"Chart"}))})))},r=function(){o([{position:"left",Component:n},{position:"right",Component:S,has_right_separator:!0}])};return null};O.propTypes={active_tab:p().string,populateFooterExtensions:p().func,setActiveTab:p().func};const C=f((function(e){var t=e.ui,o=e.main_content;return{active_tab:o.active_tab,populateFooterExtensions:t.populateFooterExtensions,setActiveTab:o.setActiveTab}}))(O);var w=function(e){var t=e.is_drawer_open,o=e.Notifications;return a.createElement("div",{className:E()("notifications-container",{"notifications-container--is-panel-open":t})},a.createElement(o,null))};w.propTypes={is_drawer_open:u.PropTypes.bool,notifications_length:u.PropTypes.number};const A=f((function(e){var t=e.core;return{is_drawer_open:e.run_panel.is_drawer_open,Notifications:t.ui.notification_messages_ui}}))(w);var I=function(e){var t=e.updateChartType,o=e.updateGranularity;return a.createElement(n.ToolbarWidget,null,a.createElement(n.ChartMode,{portalNodeId:"modal_root",onChartType:t,onGranularity:o}),a.createElement(n.StudyLegend,{portalNodeId:"modal_root",searchInputClassName:"data-hj-whitelist"}),a.createElement(n.DrawTools,{portalNodeId:"modal_root"}),a.createElement(n.Views,{portalNodeId:"modal_root",searchInputClassName:"data-hj-whitelist"}),a.createElement(n.Share,{portalNodeId:"modal_root"}))};I.propTypes={updateChartType:p().func,updateGranularity:p().func};const R=I;var D=function(e){var t=e.chart_type,o=e.granularity,i=e.is_mobile,r=e.is_socket_opened,l=e.onSymbolChange,s=e.setChartStatus,c=e.settings,u=e.show_digits_stats,p=e.symbol,d=e.updateChartType,y=e.updateGranularity,m=e.wsForget,h=e.wsForgetStream,_=e.wsSendRequest,g=e.wsSubscribe;return a.createElement(n.SmartChart,{id:"dbot",barriers:[],showLastDigitStats:u,chartControlsWidgets:null,enabledChartFooter:!1,chartStatusListener:function(e){return s(!e)},toolbarWidget:function(){return a.createElement(R,{updateChartType:d,updateGranularity:y})},chartType:t,isMobile:i,granularity:o,requestAPI:_,requestForget:m,requestForgetStream:h,requestSubscribe:g,settings:c,symbol:p,topWidgets:function(){return a.createElement(n.ChartTitle,{onChange:l})},isConnectionOpened:r})};D.PropTypes={chart_type:u.PropTypes.string,granularity:u.PropTypes.number,is_mobile:u.PropTypes.bool,is_socket_opened:u.PropTypes.bool,onSymbolChange:u.PropTypes.func,setChartStatus:u.PropTypes.func,settings:u.PropTypes.object,show_digits_stats:u.PropTypes.bool,symbol:u.PropTypes.object,updateChartType:u.PropTypes.func,updateGranularity:u.PropTypes.func,wsForget:u.PropTypes.func,wsForgetStream:u.PropTypes.func,wsSendRequest:u.PropTypes.func,wsSubscribe:u.PropTypes.func};const N=f((function(e){var t=e.chart_store,o=e.common,i=e.ui;return{is_mobile:i.is_mobile,is_socket_opened:o.is_socket_opened,updateChartType:t.updateChartType,updateGranularity:t.updateGranularity,granularity:t.granularity,chart_type:t.chart_type,onSymbolChange:t.onSymbolChange,settings:{assetInformation:!1,countdown:!0,isHighestLowestMarkerEnabled:!1,language:o.current_language.toLowerCase(),position:i.is_chart_layout_default?"bottom":"left",theme:"light"},last_contract:{is_digit_contract:!1},symbol:t.symbol,setChartStatus:t.setChartStatus,wsForget:t.wsForget,wsForgetStream:t.wsForgetStream,wsSendRequest:t.wsSendRequest,wsSubscribe:t.wsSubscribe}}))(D);var x=o(4782);const P=function(){return a.createElement(x.ZP,{height:153,width:334,speed:3},a.createElement("rect",{x:"12",y:"15",rx:"0",ry:"0",width:"41",height:"25"}),a.createElement("rect",{x:"61",y:"24",rx:"0",ry:"0",width:"91",height:"8"}),a.createElement("rect",{x:"180",y:"15",rx:"0",ry:"0",width:"41",height:"25"}),a.createElement("rect",{x:"229",y:"24",rx:"0",ry:"0",width:"91",height:"8"}),a.createElement("rect",{x:"12",y:"48",rx:"0",ry:"0",width:"60",height:"8"}),a.createElement("rect",{x:"12",y:"64",rx:"0",ry:"0",width:"308",height:"8"}),a.createElement("rect",{x:"12",y:"80",rx:"0",ry:"0",width:"308",height:"1"}),a.createElement("rect",{x:"12",y:"89",rx:"0",ry:"0",width:"140",height:"8"}),a.createElement("rect",{x:"12",y:"105",rx:"0",ry:"0",width:"60",height:"8"}),a.createElement("rect",{x:"12",y:"121",rx:"0",ry:"0",width:"140",height:"8"}),a.createElement("rect",{x:"12",y:"137",rx:"0",ry:"0",width:"60",height:"8"}),a.createElement("rect",{x:"180",y:"89",rx:"0",ry:"0",width:"140",height:"8"}),a.createElement("rect",{x:"180",y:"105",rx:"0",ry:"0",width:"60",height:"8"}),a.createElement("rect",{x:"180",y:"121",rx:"0",ry:"0",width:"140",height:"8"}),a.createElement("rect",{x:"180",y:"137",rx:"0",ry:"0",width:"60",height:"8"}))};var z=function(e){var t=e.profit>=0;return a.createElement("div",{className:E()("db-contract-card__result",e.className,{"db-contract-card__result--won":t,"db-contract-card__result--lost":!t})},a.createElement(l.Text,{weight:"bold",className:"db-contract-card__result-caption"},t?a.createElement(a.Fragment,null,(0,B.localize)("Won"),a.createElement(l.Icon,{icon:"IcCheckmarkCircle",className:"db-contract-card__result-icon",color:"green"})):a.createElement(a.Fragment,null,(0,B.localize)("Lost"),a.createElement(l.Icon,{icon:"IcCrossCircle",className:"db-contract-card__result-icon",color:"red"}))))};z.propTypes={profit:p().number};const L=z;var M=function(e){var t,o,i=e.tab,n=e.onClickDownloadTransaction,r=e.onClickDownloadJournal,s=e.is_clear_stat_disabled;return"transactions"===i?(t=n,o=(0,B.localize)("Download your transaction history.")):"journal"===i&&(t=r,o=(0,B.localize)("Download your journal.")),a.createElement(l.Popover,{className:"run-panel__info",classNameBubble:"run-panel__info--bubble",alignment:"bottom",message:o,zIndex:5},a.createElement(l.Button,{id:"download-button",is_disabled:s,className:"download__button",icon:a.createElement(l.Icon,{icon:"IcDownload",color:s&&"disabled",className:"download__icon"}),onClick:t}))};M.propTypes={onClickDownloadTransaction:p().func,onClickDownloadJournal:p().func,tab:p().string,is_clear_stat_disabled:p().bool};const F=f((function(e){var t=e.download,o=e.run_panel;return{onClickDownloadTransaction:t.onClickDownloadTransaction,onClickDownloadJournal:t.onClickDownloadJournal,is_clear_stat_disabled:o.is_clear_stat_disabled}}))(M);var U=function(e){var t=e.initBlockWorkspace,o=e.block_node,i=e.should_center_block,n=e.should_hide_display_name,r=a.useRef();return a.useEffect((function(){t(r,o,i)}),[]),a.createElement("div",{ref:function(e){return r=e},className:E()({"flyout__block-workspace--center":n,"flyout__block-workspace--top":!n})})};U.propTypes={block_node:p().any,initBlockWorkspace:p().func,should_center_block:p().bool,should_hide_display_name:p().bool};const j=f((function(e){return{initBlockWorkspace:e.flyout.initBlockWorkspace}}))(U);var V=function(e){var t=e.onInfoClick,o=e.block_node,i=e.is_active,n=e.should_hide_display_name,r=o.getAttribute("type"),s=Blockly.Blocks[r].meta(),c="variables_get"===r,u="variables_set"===r,p=s.display_name,d=s.description,y=function(){return a.createElement("div",{className:"flyout__item-buttons"},a.createElement(l.Button,{id:"db-flyout__add--".concat(r),className:"flyout__button-add flyout__button-add--hide",has_effect:!0,is_plus:!0,onClick:function(){return Blockly.derivWorkspace.addBlockNode(o)},type:"button"}))};return a.createElement(a.Fragment,null,u&&a.createElement("div",{className:"flyout__hr"}),a.createElement("div",{className:E()("flyout__item",{"flyout__item--active":i})},!n&&a.createElement(a.Fragment,null,a.createElement("div",{className:"flyout__item-header"},a.createElement(l.Text,{size:c?"xs":"xsm",line_height:c?void 0:"xl",weight:c?void 0:"bold"},p),!c&&a.createElement(y,null)),a.createElement("div",{className:"flyout__item-description"},d,t&&a.createElement("a",{id:p.replace(/\s/gi,"-"),className:"flyout__item-info",onClick:t},a.createElement(B.Localize,{i18n_default_text:"Learn more"})))),a.createElement("div",{className:"flyout__block-workspace__header"},a.createElement(j,{should_center_block:!0,block_node:o,should_hide_display_name:!0}),c&&a.createElement(y,null))))};V.propTypes={block_nodes:u.PropTypes.array,onInfoClick:u.PropTypes.func};const J=V;var H=function(e){return a.createElement("div",{className:"flyout__item"},a.createElement("iframe",{className:"flyout__video",src:e.url,frameBorder:"0",allow:"accelerometer; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,width:"100%"}))};H.propTypes={url:u.PropTypes.string};const $=H;var G=function(e){var t=e.text;return a.createElement(l.Text,{as:"p",size:"xs",styles:{lineHeight:"1.3em"}},(0,B.localize)(t))};G.propTypes={text:u.PropTypes.string};const W=G;var Y=function(e){var t=e.width,o=e.url,i={width:t};return a.createElement("div",{className:"flyout__item"},a.createElement("img",{src:o,className:"flyout__image",style:i}))};Y.propTypes={url:u.PropTypes.string};const q=Y;var K=function(e){var t=e.block_node,i=e.block_type,n=e.help_string,r=e.is_search_flyout,c=e.onBackClick,u=e.onSequenceClick,p=e.should_next_disable,d=e.should_previous_disable,y=e.title,m=n&&(0,s.help_content_config)(o.p)[i],h=0;return a.createElement(a.Fragment,null,a.createElement("div",{className:"flyout__help-header"},a.createElement("button",{className:"dc-btn flyout__button-back",onClick:c},a.createElement(l.Icon,{icon:"IcArrowLeft"})),a.createElement(l.Text,{weight:"bold",className:"flyout__help-title"},y),a.createElement("div",{className:"flyout__item-buttons"},a.createElement(l.Button,{className:"flyout__button-add",has_effect:!0,id:"db-flyout-help__add--".concat(i),onClick:function(){return Blockly.derivWorkspace.addBlockNode(t)},primary:!0,text:(0,B.localize)("Add"),type:"button"}))),a.createElement("div",{className:"flyout__help-content"},m&&m.map((function(e,o){var r=e.type,l=e.width,c=e.url,u=n.text;switch(r){case s.help_content_types.TEXT:return h<u.length?a.createElement(W,{key:"".concat(i,"_").concat(o),text:u[h++]}):null;case s.help_content_types.VIDEO:return a.createElement($,{key:"".concat(i,"_").concat(o),url:c});case s.help_content_types.IMAGE:return a.createElement(q,{key:"".concat(i,"_").concat(o),width:l,url:c});case s.help_content_types.BLOCK:return a.createElement(j,{key:"".concat(i,"_").concat(o),should_center_block:!0,block_node:t});default:return null}}))),!r&&!(d&&p)&&a.createElement("div",{className:"flyout__help-footer"},a.createElement(l.Button,{className:"flyout__button-previous",secondary:!0,onClick:function(){return u(!1)},text:(0,B.localize)("Previous"),type:"button",is_disabled:d,renderText:function(e){return d&&a.createElement(l.Text,{size:"xs",weight:"bold",align:"center",color:"disabled"},e)}}),a.createElement(l.Button,{className:"flyout__button-next",secondary:!0,onClick:function(){return u(!0)},text:(0,B.localize)("Next"),type:"button",is_disabled:p,renderText:function(e){return p&&a.createElement(l.Text,{size:"xs",weight:"bold",align:"center",color:"disabled"},e)}})))};K.propTypes={block_node:p().object,block_type:p().string,help_string:p().object,is_search_flyout:p().bool,onBackClick:p().func,onSequenceClick:p().func,should_next_disable:p().bool,should_previous_disable:p().bool,title:p().string};const X=f((function(e){var t=e.flyout,o=e.flyout_help;return{block_node:o.block_node,block_type:o.block_type,help_string:o.help_string,is_search_flyout:t.is_search_flyout,onBackClick:o.onBackClick,onSequenceClick:o.onSequenceClick,should_next_disable:o.should_next_disable,should_previous_disable:o.should_previous_disable,title:o.title}}))(K);function Z(){return(Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e}).apply(this,arguments)}var Q=function(e){var t=e.search_term,o=e.total_result;return a.createElement("div",{className:"flyout__search-header"},a.createElement(l.Text,{weight:"bold",className:"flyout__search-header-text"},(0,B.localize)('Results for "{{ search_term }}"',{search_term:t,interpolation:{escapeValue:!1}})),a.createElement(l.Text,{weight:"bold",color:"profit-success",className:"flyout__search-header-text"},"".concat(o," ").concat(o>1?(0,B.localize)("results"):(0,B.localize)("result"))))},ee=function(e){var t=a.createRef(),i=e.flyout_content,n=e.active_helper,r=e.setHelpContent,c=e.initFlyoutHelp,u=e.is_empty,p=e.is_search_flyout,d=e.selected_category,y=e.first_get_variable_block_index;return a.useEffect((function(){t.current.scrollTop=0}),[d]),a.useEffect((function(){var e=t.current.querySelector(".flyout__item--active");e&&e.scrollIntoView({behavior:"smooth",block:"start"})}),[n]),a.createElement("div",{ref:t,className:E()("flyout__content",{"flyout__normal-content":!p})},a.createElement(l.ThemedScrollbars,{className:"flyout__content-scrollbar"},"indicators"===(null==d?void 0:d.getAttribute("id"))&&a.createElement("div",{className:"flyout__content-disclaimer"},a.createElement("span",{className:"flyout__content-disclaimer-icon"},a.createElement(l.Icon,{icon:"IcBlackWarning",custom_color:"#000000",className:"flyout__content-disclaimer__warning-icon"})),a.createElement("span",{className:"flyout__content-disclaimer-text"},(0,B.localize)("Indicators on the chart tab are for indicative purposes only and may vary slightly from the ones on the DBot workspace."))),u?a.createElement("div",{className:"flyout__search-empty"},a.createElement(l.Text,{as:"h2",weight:"bold",line_height:"xxs"},(0,B.localize)("No results found"))):i.map((function(e,t){switch(e.tagName.toUpperCase()){case Blockly.Xml.NODE_BLOCK:var i=e.getAttribute("type");return a.createElement(J,{key:"".concat(e.getAttribute("type")).concat(Blockly.utils.genUid()),id:"flyout__item-workspace--".concat(t),block_node:e,should_hide_display_name:"variables_get"===i&&t!==y,onInfoClick:(0,s.help_content_config)(o.p)[i]&&(p?function(){return r(e)}:function(){return c(e,i)}),is_active:n===i});case Blockly.Xml.NODE_LABEL:return a.createElement("div",{key:"".concat(e.getAttribute("text")).concat(t),className:"flyout__item-label-bold"},e.getAttribute("text"));case Blockly.Xml.NODE_INPUT:return a.createElement(l.Input,{key:"".concat(e.getAttribute("name")).concat(t),className:"".concat(e.getAttribute("className")),type:"".concat(e.getAttribute("type")),name:"".concat(e.getAttribute("name")),placeholder:"".concat(e.getAttribute("placeholder")),autoComplete:"off"});case Blockly.Xml.NODE_BUTTON:var u=e.getAttribute("callbackKey"),d=e.getAttribute("id");return a.createElement("button",{id:d,key:"".concat(u).concat(t),className:E()("dc-btn","dc-btn-effect","dc-btn--primary","".concat(e.getAttribute("className"))),onClick:function(e){var t=Blockly.derivWorkspace,o=t.getButtonCallback(u)||function(){};e.targetWorkspace_=t,e.getTargetWorkspace=function(){return e.targetWorkspace_},o(e)}},e.getAttribute("text"));default:return null}}))))},te=function(e){var t=e.flyout_content,o=e.flyout_width,i=e.is_help_content,n=e.is_search_flyout,r=e.is_visible,l=e.onMount,s=e.onUnmount,c=e.pushDataLayer,u=e.search_term;a.useEffect((function(){return l(),function(){return s()}}),[l,s]),r&&n&&c({event:"dbot_search_results",value:!0});var p=Object.keys(t).length,d=0===p;return r&&a.createElement("div",{id:"gtm-search-results","gtm-search-term":u,className:E()("flyout",{flyout__search:n,flyout__help:i,flyout__normal:!i&&!n}),style:{width:"".concat(o,"px")}},n&&!i&&a.createElement(Q,{search_term:u,total_result:p}),i?a.createElement(X,null):a.createElement(ee,Z({is_empty:d},e)))};te.propTypes={active_helper:p().string,flyout_content:p().any,flyout_width:p().number,initFlyoutHelp:p().func,is_help_content:p().bool,is_search_flyout:p().bool,is_visible:p().bool,onMount:p().func,onUnmount:p().func,setActiveHelper:p().func,search_term:p().string,setHelpContent:p().func,selected_category:p().object,first_get_variable_block_index:p().number};const oe=f((function(e){var t=e.flyout,o=e.flyout_help,i=e.gtm;return{active_helper:o.active_helper,pushDataLayer:i.pushDataLayer,flyout_content:t.flyout_content,flyout_width:t.flyout_width,initFlyoutHelp:o.initFlyoutHelp,is_help_content:t.is_help_content,is_search_flyout:t.is_search_flyout,is_visible:t.is_visible,onMount:t.onMount,onUnmount:t.onUnmount,setActiveHelper:o.setActiveHelper,search_term:t.search_term,setHelpContent:o.setHelpContent,selected_category:t.selected_category,first_get_variable_block_index:t.first_get_variable_block_index}}))(te);var ie=o(5049),ne=o(3140),re=o(7103),ae=Object.freeze({NOT_RUNNING:0,STARTING:1,PURCHASE_SENT:2,PURCHASE_RECEIVED:3,IS_STOPPING:4,CONTRACT_CLOSED:5}),le=function(e){var t=e.logType,o=e.className,i=e.extra;return a.createElement("div",{className:E()("journal__text",o)},function(){switch(t){case re.F$.LOAD_BLOCK:return(0,B.localize)("Blocks are loaded successfully");case re.F$.NOT_OFFERED:return(0,B.localize)("Resale of this contract is not offered.");case re.F$.PURCHASE:var e=i.longcode,o=i.transaction_id;return a.createElement(B.Localize,{i18n_default_text:"<0>Bought</0>: {{longcode}} (ID: {{transaction_id}})",values:{longcode:e,transaction_id:o},components:[a.createElement(l.Text,{key:0,size:"xxs",styles:{color:"var(--status-info)"}})],options:{interpolation:{escapeValue:!1}}});case re.F$.SELL:var n=i.sold_for;return a.createElement(B.Localize,{i18n_default_text:"<0>Sold for</0>: {{sold_for}}",values:{sold_for:n},components:[a.createElement(l.Text,{key:0,size:"xxs",styles:{color:"var(--status-warning)"}})]});case re.F$.PROFIT:var r=i.currency,s=i.profit;return a.createElement(B.Localize,{i18n_default_text:"Profit amount: <0>{{profit}}</0>",values:{profit:"".concat((0,ne.formatMoney)(r,s,!0)," ").concat((0,ne.getCurrencyDisplayCode)(r))},components:[a.createElement(l.Text,{key:0,size:"xxs",styles:{color:"var(--status-success)"}})]});case re.F$.LOST:var c=i.currency,u=i.profit;return a.createElement(B.Localize,{i18n_default_text:"Loss amount: <0>{{profit}}</0>",values:{profit:"".concat((0,ne.formatMoney)(c,u,!0)," ").concat((0,ne.getCurrencyDisplayCode)(c))},components:[a.createElement(l.Text,{key:0,size:"xxs",styles:{color:"var(--status-danger)"}})]});case re.F$.WELCOME_BACK:return a.createElement(B.Localize,{i18n_default_text:"Welcome back! Your messages have been restored."});default:return null}}())},se=function(e){var t=e.wrapper_ref,o=e.checked_filters,i=e.filters,n=e.filterMessage,r=e.className,s=e.classNameLabel;return a.createElement("div",{ref:t,className:r},i.map((function(e){return a.createElement(l.Checkbox,{key:e.id,classNameLabel:s,value:o.includes(e.id),defaultChecked:o.includes(e.id),label:e.label,onChange:function(){return n(!o.includes(e.id),e.id)}})})))},ce=function(e){var t=e.toggle_ref,o=e.checked_filters,i=e.filters,n=e.filterMessage,r=e.is_filter_dialog_visible,s=e.toggleFilterDialog,c=a.useRef();return(0,l.useOnClickOutside)(c,s,(function(e){return r&&!t.current.contains(e.target)})),a.createElement(se,{wrapper_ref:c,checked_filters:o,filters:i,filterMessage:n,className:"filter-dialog"})},ue=function(e){var t=e.checked_filters,o=e.filters,i=e.filterMessage,n=e.is_filter_dialog_visible,r=e.toggleFilterDialog,s=a.useRef();return a.createElement(a.Fragment,null,a.createElement("div",{className:"journal-tools__container"},a.createElement(l.DesktopWrapper,null,a.createElement(F,{tab:"journal"})),a.createElement("div",{ref:s,className:"journal-tools__container-filter",onClick:r},a.createElement(l.Text,{size:"xs",className:"journal-tools__container-filter--label"},a.createElement(B.Localize,{i18n_default_text:"Filters"})),a.createElement(l.Icon,{icon:"IcFilter",size:16}))),a.createElement(ie.Z,{in:n,classNames:{enter:"filter-dialog--enter",enterDone:"filter-dialog--enter-done",exit:"filter-dialog--exit"},timeout:150,unmountOnExit:!0},a.createElement(ce,{toggle_ref:s,checked_filters:t,filters:o,filterMessage:i,is_filter_dialog_visible:n,toggleFilterDialog:r})))},pe=function(e){var t=e.is_mobile;return a.createElement(x.ZP,{className:E()("journal__loader",{"journal__loader--mobile":t}),speed:3,width:350,height:92,primaryColor:"var(--general-section-1)",secondaryColor:"var(--general-hover)"},a.createElement("rect",{x:"15",y:"15",rx:"5",ry:"5",width:"320",height:"40"}),a.createElement("rect",{x:"15",y:"60",rx:"5",ry:"5",width:"180",height:"7"}))},de=function(e){var t=e.row,o=e.is_new_row,i=e.measure,n=(0,ne.useNewRowTransition)(o).in_prop,r=t.date,l=t.time,c=t.message,u=t.message_type,p=t.className,d=t.extra,y=function(e){var t=e.date,o=e.time;return a.createElement(a.Fragment,null,a.createElement("span",{className:"journal__text-date"},t)," | ",a.createElement("span",{className:"journal__text-time"},o))}({date:r,time:l});return a.createElement(ie.Z,{in:n,timeout:500,classNames:"list__animation"},a.createElement("div",{className:"journal__item"},a.createElement("div",{className:"journal__item-content"},function(e,t,o,i,n){switch(t){case s.message_types.SUCCESS:return a.createElement(le,{logType:e,extra:i,className:o});case s.message_types.NOTIFY:return"function"==typeof e?a.createElement("div",{className:E()("journal__text",o)},e(n)):a.createElement("div",{className:E()("journal__text",o)},e);case s.message_types.ERROR:return a.createElement("div",{className:"journal__text--error journal__text"},e);default:return null}}(c,u,p,d,i)),a.createElement("div",{className:"journal__text-datetime"},y)))},ye=function(e){var t=e.contract_stage,o=e.filtered_messages,i=(e.is_drawer_open,e.is_mobile),n=e.is_stop_button_visible,r=e.unfiltered_messages,s=function(e,t){if(null==e)return{};var o,i,n=function(e,t){if(null==e)return{};var o,i,n={},r=Object.keys(e);for(i=0;i<r.length;i++)o=r[i],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)o=r[i],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}(e,["contract_stage","filtered_messages","is_drawer_open","is_mobile","is_stop_button_visible","unfiltered_messages"]);return a.createElement("div",{className:E()("journal run-panel-tab__content--no-stat",{"run-panel-tab__content":!i})},a.createElement(ue,s),a.createElement("div",{className:"journal__item-list"},o.length?a.createElement(l.DataList,{className:"journal",data_source:o,rowRenderer:function(e){return a.createElement(de,e)},keyMapper:function(e){return e.unique_id}}):a.createElement(a.Fragment,null,t>=ae.STARTING&&s.checked_filters.length&&!r.length&&n?a.createElement(pe,{is_mobile:i}):a.createElement("div",{className:"journal-empty"},a.createElement(l.Icon,{icon:"IcBox",className:"journal-empty__icon",size:64,color:"secondary"}),a.createElement(l.Text,{as:"h4",size:"xs",weight:"bold",align:"center",color:"less-prominent",line_height:"xxs",className:"journal-empty__header"},(0,B.localize)("There are no messages to display")),a.createElement("div",{className:"journal-empty__message"},a.createElement(l.Text,{size:"xxs",color:"less-prominent"},(0,B.localize)("Here are the possible reasons:")),a.createElement("ul",{className:"journal-empty__list"},a.createElement("li",null,a.createElement(l.Text,{size:"xxs",color:"less-prominent"},(0,B.localize)("The bot is not running"))),a.createElement("li",null,a.createElement(l.Text,{size:"xxs",color:"less-prominent"},(0,B.localize)("The stats are cleared"))),a.createElement("li",null,a.createElement(l.Text,{size:"xxs",color:"less-prominent"},(0,B.localize)("All messages are filtered out")))))))))};ye.propTypes={checked_filters:p().array,contract_stage:p().object,filtered_messages:p().array,filterMessage:p().func,filters:p().array,is_mobile:p().bool,is_stop_button_visible:p().bool,is_filter_dialog_visible:p().bool,toggleFilterDialog:p().func,unfiltered_messages:p().array};const me=f((function(e){var t=e.journal,o=e.run_panel,i=e.ui;return{checked_filters:t.checked_filters,contract_stage:o.contract_stage,filterMessage:t.filterMessage,filters:t.filters,filtered_messages:t.filtered_messages,is_mobile:i.is_mobile,is_filter_dialog_visible:t.is_filter_dialog_visible,is_stop_button_visible:o.is_stop_button_visible,toggleFilterDialog:t.toggleFilterDialog,unfiltered_messages:t.unfiltered_messages}}))(ye);var he=Object.freeze({TAB_LOCAL:"local_tab",TAB_GOOGLE:"google_tab",TAB_RECENT:"recent_tab"}),_e=function(e){var t=e.is_authorised,o=e.is_open_button_loading,i=e.onDriveConnect,n=e.onDriveOpen,r=e.is_mobile;return a.createElement("div",{className:"load-strategy__container"},a.createElement("div",{className:"load-strategy__google-drive"},a.createElement(l.Icon,{icon:"IcGoogleDrive",className:E()("load-strategy__google-drive-icon",{"load-strategy__google-drive-icon--disabled":!t}),size:r?96:128}),a.createElement("div",{className:"load-strategy__google-drive-text"},t?a.createElement(B.Localize,{i18n_default_text:"You are connected to Google Drive"}):"Google Drive"),t?a.createElement(l.Button.Group,null,a.createElement(l.Button,{text:(0,B.localize)("Disconnect"),onClick:i,has_effect:!0,secondary:!0,large:!0}),a.createElement(l.Button,{text:(0,B.localize)("Open"),onClick:n,is_loading:o,has_effect:!0,primary:!0,large:!0})):a.createElement(a.Fragment,null,a.createElement(l.Button,{text:(0,B.localize)("Connect"),onClick:i,has_effect:!0,primary:!0,large:!0}),a.createElement("div",{className:"load-strategy__google-drive-terms"},a.createElement(B.Localize,{i18n_default_text:"Find out how this app handles your data by reviewing Deriv's <0>Privacy policy</0>, which is part of Deriv's <1>Terms and conditions</2>.",components:[a.createElement(l.StaticUrl,{key:0,className:"link",href:"tnc/security-and-privacy.pdf",is_document:!0}),a.createElement(l.StaticUrl,{key:1,className:"link",href:"terms-and-conditions"})]})))))};_e.propTypes={is_authorised:u.PropTypes.bool,is_mobile:u.PropTypes.bool,is_open_button_loading:u.PropTypes.bool,onDriveConnect:u.PropTypes.func,onDriveOpen:u.PropTypes.func};const ge=f((function(e){var t=e.load_modal,o=e.ui;return{is_authorised:e.google_drive.is_authorised,is_mobile:o.is_mobile,is_open_button_loading:t.is_open_button_loading,onDriveConnect:t.onDriveConnect,onDriveOpen:t.onDriveOpen}}))(_e);var fe=function(e){var t=e.is_mobile,o=e.is_open_button_loading,i=e.loadFileFromLocal,n=e.setLoadedLocalFile,r=t?l.Button.Group:a.Fragment;return a.createElement(r,null,t&&a.createElement(l.Button,{text:(0,B.localize)("Cancel"),onClick:function(){return n(null)},has_effect:!0,secondary:!0,large:!0}),a.createElement(l.Button,{text:(0,B.localize)("Open"),onClick:i,is_loading:o,has_effect:!0,primary:!0,large:!0}))};fe.propTypes={is_mobile:u.PropTypes.bool,is_open_button_loading:u.PropTypes.bool,loadFileFromLocal:u.PropTypes.func,setLoadedLocalFile:u.PropTypes.bool};const be=f((function(e){var t=e.load_modal;return{is_mobile:e.ui.is_mobile,is_open_button_loading:t.is_open_button_loading,loadFileFromLocal:t.loadFileFromLocal,setLoadedLocalFile:t.setLoadedLocalFile}}))(fe);var ke=function(e){var t=e.onZoomInOutClick;return a.createElement("div",{className:"load-strategy__preview-workspace-controls"},a.createElement(l.Icon,{icon:"IcAddRounded",className:"load-strategy__preview-workspace-icon",onClick:function(){return t(!0)}}),a.createElement(l.Icon,{icon:"IcMinusRounded",className:"load-strategy__preview-workspace-icon",onClick:function(){return t(!1)}}))};ke.propTypes={onZoomInOutClick:u.PropTypes.func};const ve=f((function(e){return{onZoomInOutClick:e.load_modal.onZoomInOutClick}}))(ke);function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,i=new Array(t);o<t;o++)i[o]=e[o];return i}var Be=function(e){var t,o=e.handleFileChange,i=e.is_mobile,n=e.loaded_local_file,r=e.setLoadedLocalFile,s=a.useRef(null),c=(2,function(e){if(Array.isArray(e))return e}(t=a.useState(!0))||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var o=[],i=!0,n=!1,r=void 0;try{for(var a,l=e[Symbol.iterator]();!(i=(a=l.next()).done)&&(o.push(a.value),2!==o.length);i=!0);}catch(e){n=!0,r=e}finally{try{i||null==l.return||l.return()}finally{if(n)throw r}}return o}}(t)||function(e,t){if(e){if("string"==typeof e)return Ee(e,2);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Ee(e,2):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=c[0],p=c[1];return n&&u?a.createElement("div",{className:"load-strategy__container load-strategy__container--has-footer"},a.createElement("div",{className:"load-strategy__local-preview"},a.createElement("div",{className:"load-strategy__title"},a.createElement(B.Localize,{i18n_default_text:"Preview"})),a.createElement("div",{className:"load-strategy__preview-workspace"},a.createElement("div",{id:"load-strategy__blockly-container",style:{height:"100%"}},!i&&a.createElement("div",{className:"load-strategy__local-preview-close"},a.createElement(l.Icon,{icon:"IcCross",onClick:function(){return r(null)}})),a.createElement(ve,null)))),i&&a.createElement("div",{className:"load-strategy__local-footer"},a.createElement(be,null))):a.createElement("div",{className:"load-strategy__container"},a.createElement("div",{className:"load-strategy__local-dropzone"},a.createElement("input",{type:"file",ref:s,accept:".xml",style:{display:"none"},onChange:function(e){return p(o(e,!1))}}),a.createElement("div",{className:"load-strategy__local-dropzone-area",onDrop:function(e){o(e,!1)}},i?a.createElement(l.Icon,{icon:"IcMobile",className:"load-strategy__local-icon",size:i?96:128}):a.createElement(a.Fragment,null,a.createElement(l.Icon,{icon:"IcPc",className:"load-strategy__local-icon",size:i?96:128}),a.createElement("div",{className:"load-strategy__local-title"},a.createElement(B.Localize,{i18n_default_text:"Drag your XML file here"})),a.createElement("div",{className:"load-strategy__local-description"},a.createElement(B.Localize,{i18n_default_text:"or, if you prefer..."}))),a.createElement(l.Button,{text:u?(0,B.localize)("Select an XML file from your device"):(0,B.localize)("Please upload an XML file"),onClick:function(){return s.current.click()},has_effect:!0,primary:!0,large:!0}))))};Be.propTypes={handleFileChange:u.PropTypes.func,is_mobile:u.PropTypes.bool,is_open_button_loading:u.PropTypes.bool,loaded_local_file:u.PropTypes.string,setLoadedLocalFile:u.PropTypes.func};var Te=f((function(e){var t=e.load_modal,o=e.ui;return{handleFileChange:t.handleFileChange,is_mobile:o.is_mobile,is_open_button_loading:t.is_open_button_loading,loaded_local_file:t.loaded_local_file,setLoadedLocalFile:t.setLoadedLocalFile}}))(Be);Te.Footer=be;const Se=Te;var Oe=function(e){var t=e.is_open_button_loading,o=e.loadFileFromRecent;return a.createElement(l.Button,{text:(0,B.localize)("Open"),onClick:o,is_loading:t,has_effect:!0,primary:!0,large:!0})};Oe.propTypes={is_open_button_loading:d.PropTypes.bool,loadFileFromRecent:d.PropTypes.func};const Ce=f((function(e){var t=e.load_modal;return{is_open_button_loading:t.is_open_button_loading,loadFileFromRecent:t.loadFileFromRecent}}))(Oe);var we=o(7929),Ae=function(e){var t=e.getRecentFileIcon,o=e.getSaveType,i=e.previewRecentStrategy,n=e.selected_strategy_id,r=e.workspace;return a.createElement("div",{className:E()("load-strategy__recent-item",{"load-strategy__recent-item--selected":n===r.id}),key:r.id,onClick:n===r.id?void 0:function(){return i(r.id)}},a.createElement("div",{className:"load-strategy__recent-item-text"},a.createElement("div",{className:"load-strategy__recent-item-title"},r.name),a.createElement("div",{className:"load-strategy__recent-item-time"},(0,s.timeSince)(r.timestamp))),a.createElement("div",{className:"load-strategy__recent-item-location"},a.createElement(l.Icon,{icon:t(r.save_type),className:E()({"load-strategy__recent-icon--active":!0})}),a.createElement("div",{className:"load-strategy__recent-item-saved"},o(r.save_type))))};Ae.propTypes={getRecentFileIcon:u.PropTypes.func,getSaveType:u.PropTypes.func,previewRecentStrategy:u.PropTypes.func,selected_strategy_id:u.PropTypes.string};const Ie=f((function(e){var t=e.load_modal;return{getRecentFileIcon:t.getRecentFileIcon,getSaveType:t.getSaveType,previewRecentStrategy:t.previewRecentStrategy,selected_strategy_id:t.selected_strategy_id}}))(Ae);var Re=function(e){var t=e.is_explanation_expand,o=e.recent_strategies,i=e.toggleExplanationExpand;return o.length?a.createElement("div",{className:"load-strategy__container load-strategy__container--has-footer"},a.createElement("div",{className:"load-strategy__recent"},a.createElement("div",{className:"load-strategy__recent-files"},a.createElement("div",{className:"load-strategy__title"},a.createElement(B.Localize,{i18n_default_text:"Recent"})),a.createElement("div",{className:"load-strategy__recent-files-list"},o.map((function(e){return a.createElement(Ie,{key:e.id,workspace:e})})))),a.createElement("div",{className:"load-strategy__recent-preview"},a.createElement("div",{className:"load-strategy__title load-strategy__recent-preview-title"},a.createElement(B.Localize,{i18n_default_text:"Preview"})),a.createElement("div",{className:"load-strategy__preview-workspace"},a.createElement("div",{id:"load-strategy__blockly-container",style:{height:"100%"}},a.createElement(ve,null)))))):a.createElement("div",{className:"load-strategy__container"},a.createElement("div",{className:"load-strategy__recent-empty"},a.createElement(l.Icon,{icon:"IcEmptyFolder",className:"load-strategy__recent-empty-icon",size:128}),a.createElement("div",{className:"load-strategy__recent-empty-title"},a.createElement(B.Localize,{i18n_default_text:"You do not have any recent bots"})),a.createElement("div",{className:"load-strategy__recent-empty-description"},a.createElement(B.Localize,{i18n_default_text:"Create one or upload one from your local drive or Google Drive."})),a.createElement("div",{className:"load-strategy__recent-empty-expand",onClick:i},a.createElement(B.Localize,{i18n_default_text:"Why can't I see my recent bots?"})),a.createElement("div",{className:E()("load-strategy__recent-empty-explanation",{"load-strategy__recent-empty-explanation--show":t})},a.createElement("div",null,a.createElement(B.Localize,{i18n_default_text:"If you've recently used bots but don't see them in this list, it may be because you:"})),a.createElement("ol",{className:"load-strategy__recent-empty-explanation-list"},a.createElement("li",null,a.createElement(B.Localize,{i18n_default_text:"1. Logged in from a different device"})),a.createElement("li",null,a.createElement(B.Localize,{i18n_default_text:"2. Logged in from a different browser"})),a.createElement("li",null,a.createElement(B.Localize,{i18n_default_text:"3. Cleared your browser cache"}))))))};Re.propTypes={is_explanation_expand:u.PropTypes.bool,recent_strategies:u.PropTypes.array,toggleExplanationExpand:u.PropTypes.bool};var De=f((function(e){var t=e.load_modal;return{is_explanation_expand:t.is_explanation_expand,recent_strategies:t.recent_strategies,toggleExplanationExpand:t.toggleExplanationExpand}}))(Re);De.Footer=Ce,De.Workspace=Ie;const Ne=De;var xe=function(e){var t=e.active_index,o=e.is_load_modal_open,i=e.is_mobile,n=e.loaded_local_file,r=e.onEntered,s=e.recent_strategies,c=e.setActiveTabIndex,u=e.tab_name,p=e.toggleLoadModal,d=(0,B.localize)("Load strategy");return i?a.createElement(l.MobileFullPageModal,{is_modal_open:o,className:"load-strategy__wrapper",header:(0,B.localize)("Load strategy"),onClickClose:p,height_offset:"80px",page_overlay:!0},a.createElement(l.Tabs,{active_index:t,onTabItemClick:c,top:!0},a.createElement("div",{label:(0,B.localize)("Local")},a.createElement(Se,null)),a.createElement("div",{label:"Google Drive"},a.createElement(ge,null)))):a.createElement(l.Modal,{title:d,className:"load-strategy",width:"1000px",height:"80vh",is_open:o,toggleModal:p,onEntered:r,elements_to_ignore:[document.querySelector(".injectionDiv")]},a.createElement(l.Modal.Body,null,a.createElement(l.Tabs,{active_index:t,onTabItemClick:c,top:!0,header_fit_content:!0},a.createElement("div",{label:(0,B.localize)("Recent")},a.createElement(Ne,null)),a.createElement("div",{label:(0,B.localize)("Local")},a.createElement(Se,null)),a.createElement("div",{label:"Google Drive"},a.createElement(ge,null)))),n&&u===he.TAB_LOCAL&&a.createElement(l.Modal.Footer,{has_separator:!0},a.createElement(Se.Footer,null)),s.length>0&&u===he.TAB_RECENT&&a.createElement(l.Modal.Footer,{has_separator:!0},a.createElement(Ne.Footer,null)))};xe.propTypes={active_index:p().number,is_load_modal_open:p().bool,is_mobile:p().bool,loaded_local_file:p().string,onEntered:p().func,recent_strategies:p().array,setActiveTabIndex:p().func,toggleLoadModal:p().func};const Pe=f((function(e){var t=e.load_modal,o=e.ui;return{active_index:t.active_index,is_load_modal_open:t.is_load_modal_open,is_mobile:o.is_mobile,loaded_local_file:t.loaded_local_file,onEntered:t.onEntered,recent_strategies:t.recent_strategies,setActiveTabIndex:t.setActiveTabIndex,tab_name:t.tab_name,toggleLoadModal:t.toggleLoadModal}}))(xe);var ze=o(7717),Le=o(8090);function Me(){return(Me=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e}).apply(this,arguments)}var Fe=function(e){var t=Me({},e);return a.createElement("block",t)},Ue=function(e){var t=Me({},e);return a.createElement("category",t)},je=function(e){var t=Me({},e);return a.createElement("field",t)},Ve=function(e){var t=Me({},e);return a.createElement("mutation",t)},Je=function(e){var t=Me({},e);return a.createElement("next",t)},He=function(e){var t=Me({},e);return a.createElement("shadow",t)},$e=function(e){var t=Me({},e);return a.createElement("statement",t)},Ge=function(e){var t=Me({},e);return a.createElement("value",t)},We=o.n(Le)().renderToStaticMarkup(a.createElement((function(e){var t=Me({},e);return a.createElement("xml",t)}),{xmlns:"http://www.w3.org/1999/xhtml",id:"toolbox"},a.createElement(Ue,{id:"trade_parameters",name:(0,B.localize)("Set up your trade")},a.createElement(Fe,{type:"trade_definition"},a.createElement($e,{name:"TRADE_OPTIONS"},a.createElement(Fe,{type:"trade_definition_market",deletable:"false",movable:"false"},a.createElement(je,{name:"MARKET_LIST"}),a.createElement(je,{name:"SUBMARKET_LIST"}),a.createElement(je,{name:"SYMBOL_LIST"}),a.createElement(Je,null,a.createElement(Fe,{type:"trade_definition_tradetype",deletable:"false",movable:"false"},a.createElement(je,{name:"TRADETYPECAT_LIST"}),a.createElement(je,{name:"TRADETYPE_LIST"}),a.createElement(Je,null,a.createElement(Fe,{type:"trade_definition_contracttype",deletable:"false",movable:"false"},a.createElement(je,{name:"TYPE_LIST"}),a.createElement(Je,null,a.createElement(Fe,{type:"trade_definition_candleinterval",deletable:"false",movable:"false"},a.createElement(je,{name:"CANDLEINTERVAL_LIST"},"60"),a.createElement(Je,null,a.createElement(Fe,{type:"trade_definition_restartbuysell",deletable:"false",movable:"false"},a.createElement(je,{name:"TIME_MACHINE_ENABLED"},"FALSE"),a.createElement(Je,null,a.createElement(Fe,{type:"trade_definition_restartonerror",deletable:"false",movable:"false"},a.createElement(je,{name:"RESTARTONERROR"},"TRUE")))))))))))))),a.createElement(Fe,{type:"trade_definition_tradeoptions"},a.createElement(Ve,{has_first_barrier:"false",has_second_barrier:"false",has_prediction:"false"}),a.createElement(je,{name:"DURATIONTYPE_LIST"}),a.createElement(je,{name:"CURRENCY_LIST"},"USD"),a.createElement(Ge,{name:"DURATION"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"1"))),a.createElement(Ge,{name:"AMOUNT"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"1"))),a.createElement(je,{name:"AMOUNT_LIMITS"}))),a.createElement(Ue,{id:"purchase_conditions",name:(0,B.localize)("Purchase contract")},a.createElement(Fe,{type:"before_purchase"}),a.createElement(Fe,{type:"purchase"})),a.createElement(Ue,{id:"sell_conditions",name:(0,B.localize)("Sell contract (optional)")},a.createElement(Fe,{type:"during_purchase"}),a.createElement(Fe,{type:"sell_at_market"})),a.createElement(Ue,{id:"trade_results",name:(0,B.localize)("Trade again")},a.createElement(Fe,{type:"after_purchase"}),a.createElement(Fe,{type:"trade_again"})),a.createElement(Ue,{id:"analysis",name:(0,B.localize)("Analysis")},a.createElement(Ue,{id:"indicators",name:(0,B.localize)("Indicators")},a.createElement(Fe,{type:"sma_statement"},a.createElement($e,{name:"STATEMENT"},a.createElement(Fe,{type:"input_list",deletable:"false",movable:"false"},a.createElement(Ge,{name:"INPUT_LIST"}),a.createElement(Je,null,a.createElement(Fe,{type:"period",deletable:"false",movable:"false"},a.createElement(Ge,{name:"PERIOD"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"10")))))))),a.createElement(Fe,{type:"smaa_statement"},a.createElement($e,{name:"STATEMENT"},a.createElement(Fe,{type:"input_list",deletable:"false",movable:"false"},a.createElement(Ge,{name:"INPUT_LIST"}),a.createElement(Je,null,a.createElement(Fe,{type:"period",deletable:"false",movable:"false"},a.createElement(Ge,{name:"PERIOD"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"10")))))))),a.createElement(Fe,{type:"bb_statement"},a.createElement(je,{name:"BBRESULT_LIST"},"0"),a.createElement($e,{name:"STATEMENT"},a.createElement(Fe,{type:"input_list",deletable:"false",movable:"false"},a.createElement(Ge,{name:"INPUT_LIST"}),a.createElement(Je,null,a.createElement(Fe,{type:"period",deletable:"false",movable:"false"},a.createElement(Ge,{name:"PERIOD"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"10"))),a.createElement(Je,null,a.createElement(Fe,{type:"std_dev_multiplier_up",deletable:"false",movable:"false"},a.createElement(Ge,{name:"UPMULTIPLIER"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"5"))),a.createElement(Je,null,a.createElement(Fe,{type:"std_dev_multiplier_down"},a.createElement(Ge,{name:"DOWNMULTIPLIER"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"5")))))))))))),a.createElement(Fe,{type:"bba_statement"},a.createElement(je,{name:"BBRESULT_LIST"},"0"),a.createElement($e,{name:"STATEMENT"},a.createElement(Fe,{type:"input_list",deletable:"false",movable:"false"},a.createElement(Ge,{name:"INPUT_LIST"}),a.createElement(Je,null,a.createElement(Fe,{type:"period",deletable:"false",movable:"false"},a.createElement(Ge,{name:"PERIOD"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"10"))),a.createElement(Je,null,a.createElement(Fe,{type:"std_dev_multiplier_up",deletable:"false",movable:"false"},a.createElement(Ge,{name:"UPMULTIPLIER"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"5"))),a.createElement(Je,null,a.createElement(Fe,{type:"std_dev_multiplier_down"},a.createElement(Ge,{name:"DOWNMULTIPLIER"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"5")))))))))))),a.createElement(Fe,{type:"ema_statement"},a.createElement($e,{name:"STATEMENT"},a.createElement(Fe,{type:"input_list",deletable:"false",movable:"false"},a.createElement(Ge,{name:"INPUT_LIST"}),a.createElement(Je,null,a.createElement(Fe,{type:"period",deletable:"false",movable:"false"},a.createElement(Ge,{name:"PERIOD"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"10")))))))),a.createElement(Fe,{type:"emaa_statement"},a.createElement($e,{name:"STATEMENT"},a.createElement(Fe,{type:"input_list",deletable:"false",movable:"false"},a.createElement(Ge,{name:"INPUT_LIST"}),a.createElement(Je,null,a.createElement(Fe,{type:"period",deletable:"false",movable:"false"},a.createElement(Ge,{name:"PERIOD"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"10")))))))),a.createElement(Fe,{type:"rsi_statement"},a.createElement($e,{name:"STATEMENT"},a.createElement(Fe,{type:"input_list",deletable:"false",movable:"false"},a.createElement(Je,null,a.createElement(Fe,{type:"period",deletable:"false",movable:"false"},a.createElement(Ge,{name:"PERIOD"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"10")))))))),a.createElement(Fe,{type:"rsia_statement"},a.createElement($e,{name:"STATEMENT"},a.createElement(Fe,{type:"input_list",deletable:"false",movable:"false"},a.createElement(Ge,{name:"INPUT_LIST"}),a.createElement(Je,null,a.createElement(Fe,{type:"period",deletable:"false",movable:"false"},a.createElement(Ge,{name:"PERIOD"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"10")))))))),a.createElement(Fe,{type:"macda_statement"},a.createElement(je,{name:"MACDFIELDS_LIST"},"1"),a.createElement($e,{name:"STATEMENT"},a.createElement(Fe,{type:"input_list",deletable:"false",movable:"false"},a.createElement(Ge,{name:"INPUT_LIST"}),a.createElement(Je,null,a.createElement(Fe,{type:"fast_ema_period",deletable:"false",movable:"false"},a.createElement(Ge,{name:"FAST_EMA_PERIOD"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"12"))),a.createElement(Je,null,a.createElement(Fe,{type:"slow_ema_period",deletable:"false",movable:"false"},a.createElement(Ge,{name:"SLOW_EMA_PERIOD"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"26"))),a.createElement(Je,null,a.createElement(Fe,{type:"signal_ema_period",deletable:"false",movable:"false"},a.createElement(Ge,{name:"SIGNAL_EMA_PERIOD"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"9"))))))))))))),a.createElement(Ue,{name:(0,B.localize)("Tick and candle analysis"),id:"tick_analysis"},a.createElement(Fe,{type:"tick_analysis"}),a.createElement(Fe,{type:"tick"}),a.createElement(Fe,{type:"last_digit"}),a.createElement(Fe,{type:"ticks"}),a.createElement(Fe,{type:"lastDigitList"}),a.createElement(Fe,{type:"check_direction"}),a.createElement(Fe,{type:"is_candle_black"}),a.createElement(Fe,{type:"read_ohlc"},a.createElement(je,{name:"OHLCFIELD_LIST"},"open"),a.createElement(je,{name:"CANDLEINTERVAL_LIST"},"default"),a.createElement(Ge,{name:"CANDLEINDEX"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"1")))),a.createElement(Fe,{type:"read_ohlc_obj"}),a.createElement(Fe,{type:"ohlc_values"}),a.createElement(Fe,{type:"ohlc_values_in_list"}),a.createElement(Fe,{type:"get_ohlc"},a.createElement(je,{name:"CANDLEINTERVAL_LIST"},"default"),a.createElement(Ge,{name:"CANDLEINDEX"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"1")))),a.createElement(Fe,{type:"ohlc"})),a.createElement(Ue,{name:(0,B.localize)("Contract"),id:"contract_details"},a.createElement(Fe,{type:"contract_check_result"}),a.createElement(Fe,{type:"read_details"}),a.createElement(Fe,{type:"sell_price"}),a.createElement(Fe,{type:"check_sell"}),a.createElement(Fe,{type:"payout"}),a.createElement(Fe,{type:"ask_price"})),a.createElement(Ue,{name:(0,B.localize)("Stats"),id:"stats"},a.createElement(Fe,{type:"balance"}),a.createElement(Fe,{type:"total_profit"}),a.createElement(Fe,{type:"total_runs"}))),a.createElement(Ue,{id:"utility",name:(0,B.localize)("Utility")},a.createElement(Ue,{name:(0,B.localize)("Custom functions"),id:"custom_functions",dynamic:"PROCEDURE"}),a.createElement(Ue,{name:(0,B.localize)("Variables"),id:"variables",dynamic:"VARIABLE"}),a.createElement(Ue,{name:(0,B.localize)("Notifications"),id:"notifications"},a.createElement(Fe,{type:"text_print"},a.createElement(Ge,{name:"TEXT"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"},"abc")))),a.createElement(Fe,{type:"text_prompt_ext"},a.createElement(je,{name:"TYPE"},"TEXT"),a.createElement(Ge,{name:"TEXT"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"},"abc")))),a.createElement(Fe,{type:"notify"},a.createElement(je,{name:"NOTIFICATION_TYPE"},"success"),a.createElement(Ge,{name:"MESSAGE"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"},"abc")))),a.createElement(Fe,{type:"notify_telegram"},a.createElement(Ge,{name:"TELEGRAM_ACCESS_TOKEN"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"}))),a.createElement(Ge,{name:"TELEGRAM_CHAT_ID"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"}))),a.createElement(Ge,{name:"TELEGRAM_MESSAGE"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"},"abc"))))),a.createElement(Ue,{name:(0,B.localize)("Time"),id:"time"},a.createElement(Fe,{type:"epoch"}),a.createElement(Fe,{type:"timeout"}),a.createElement(Fe,{type:"totimestamp"},a.createElement(Ge,{name:"DATETIME"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"},"yyyy-mm-dd hh:mm:ss")))),a.createElement(Fe,{type:"todatetime"},a.createElement(Ge,{name:"TIMESTAMP"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"0"))))),a.createElement(Ue,{name:(0,B.localize)("Math"),id:"math"},a.createElement(Fe,{type:"math_number"}),a.createElement(Fe,{type:"math_arithmetic"},a.createElement(je,{name:"OP"},"ADD"),a.createElement(Ge,{name:"A"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"1"))),a.createElement(Ge,{name:"B"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"1")))),a.createElement(Fe,{type:"math_single"},a.createElement(je,{name:"OP"},"ROOT"),a.createElement(Ge,{name:"NUM"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"9")))),a.createElement(Fe,{type:"math_trig"},a.createElement(je,{name:"OP"},"SIN"),a.createElement(Ge,{name:"NUM"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"45")))),a.createElement(Fe,{type:"math_constant"}),a.createElement(Fe,{type:"math_number_property"},a.createElement(Ve,{divisor_input:"false"}),a.createElement(je,{name:"PROPERTY"},"EVEN"),a.createElement(Ge,{name:"NUMBER_TO_CHECK"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"0")))),a.createElement(Fe,{type:"math_change"},a.createElement(je,{name:"VAR",variabletype:""},"item"),a.createElement(Ge,{name:"DELTA"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"1")))),a.createElement(Fe,{type:"math_on_list"}),a.createElement(Fe,{type:"math_round"},a.createElement(je,{name:"OP"},"ROUND"),a.createElement(Ge,{name:"NUM"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"3.1")))),a.createElement(Fe,{type:"math_modulo"},a.createElement(Ge,{name:"DIVIDEND"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"64"))),a.createElement(Ge,{name:"DIVISOR"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"10")))),a.createElement(Fe,{type:"math_constrain"},a.createElement(Ge,{name:"Value"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"50"))),a.createElement(Ge,{name:"LOW"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"1"))),a.createElement(Ge,{name:"HIGH"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"100")))),a.createElement(Fe,{type:"math_random_int"},a.createElement(Ge,{name:"FROM"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"1"))),a.createElement(Ge,{name:"TO"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"100")))),a.createElement(Fe,{type:"math_random_float"})),a.createElement(Ue,{name:(0,B.localize)("Text"),id:"text"},a.createElement(Fe,{type:"text"},a.createElement(je,{name:"TEXT"},"abc")),a.createElement(Fe,{type:"text_join"},a.createElement(je,{name:"VARIABLE",variabletype:""},"text"),a.createElement($e,{name:"STACK"},a.createElement(Fe,{type:"text_statement",movable:"false"},a.createElement(Ge,{name:"TEXT"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"},"abc")))))),a.createElement(Fe,{type:"text_append"},a.createElement(je,{name:"VAR",variabletype:""},"text"),a.createElement(Ge,{name:"TEXT"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"},"abc")))),a.createElement(Fe,{type:"text_length"},a.createElement(Ge,{name:"Value"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"},"abc")))),a.createElement(Fe,{type:"text_isEmpty"},a.createElement(Ge,{name:"Value"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"})))),a.createElement(Fe,{type:"text_indexOf"},a.createElement(je,{name:"END"},"FIRST"),a.createElement(Ge,{name:"Value"},a.createElement(Fe,{type:"variables_get"},a.createElement(je,{name:"VAR",variabletype:""},"text"))),a.createElement(Ge,{name:"FIND"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"},"abc")))),a.createElement(Fe,{type:"text_charAt"},a.createElement(Ve,{at:"true"}),a.createElement(je,{name:"WHERE"},"FROM_START"),a.createElement(Ge,{name:"Value"},a.createElement(Fe,{type:"variables_get"},a.createElement(je,{name:"VAR",variabletype:""},"item"))),a.createElement(Ge,{name:"AT"},a.createElement(He,{type:"math_number_positive"},a.createElement(je,{name:"NUM"},"1")))),a.createElement(Fe,{type:"text_getSubstring"},a.createElement(Ve,{at1:"true",at2:"true"}),a.createElement(je,{name:"WHERE1"},"FROM_START"),a.createElement(je,{name:"WHERE2"},"FROM_START"),a.createElement(Ge,{name:"STRING"},a.createElement(Fe,{type:"variables_get"},a.createElement(je,{name:"VAR",variabletype:""},"text"))),a.createElement(Ge,{name:"AT1"},a.createElement(He,{type:"math_number_positive"},a.createElement(je,{name:"NUM"},"0"))),a.createElement(Ge,{name:"AT2"},a.createElement(He,{type:"math_number_positive"},a.createElement(je,{name:"NUM"},"2")))),a.createElement(Fe,{type:"text_changeCase"},a.createElement(je,{name:"CASE"},"UPPERCASE"),a.createElement(Ge,{name:"TEXT"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"},"abc")))),a.createElement(Fe,{type:"text_trim"},a.createElement(je,{name:"MODE"},"BOTH"),a.createElement(Ge,{name:"TEXT"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"},"abc"))))),a.createElement(Ue,{name:(0,B.localize)("Logic"),id:"logic"},a.createElement(Fe,{type:"controls_if"}),a.createElement(Fe,{type:"logic_compare"}),a.createElement(Fe,{type:"logic_operation"}),a.createElement(Fe,{type:"logic_negate"}),a.createElement(Fe,{type:"logic_boolean"}),a.createElement(Fe,{type:"logic_null"}),a.createElement(Fe,{type:"logic_ternary"})),a.createElement(Ue,{name:(0,B.localize)("Lists"),id:"lists"},a.createElement(Fe,{type:"lists_create_with"},a.createElement(je,{name:"VARIABLE",variabletype:""},"list"),a.createElement($e,{name:"STACK"},a.createElement(Fe,{type:"lists_statement",movable:"false"},a.createElement(Je,null,a.createElement(Fe,{type:"lists_statement",movable:"false"}))))),a.createElement(Fe,{type:"lists_repeat"},a.createElement(Ge,{name:"NUM"},a.createElement(He,{type:"math_number"},a.createElement(je,{name:"NUM"},"5")))),a.createElement(Fe,{type:"lists_length"}),a.createElement(Fe,{type:"lists_isEmpty"}),a.createElement(Fe,{type:"lists_indexOf"}),a.createElement(Fe,{type:"lists_getIndex"}),a.createElement(Fe,{type:"lists_setIndex"}),a.createElement(Fe,{type:"lists_getSublist"}),a.createElement(Fe,{type:"lists_split"},a.createElement(Ve,{mode:"SPLIT"}),a.createElement(je,{name:"MODE"},"SPLIT"),a.createElement(Ge,{name:"DELIM"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"},",")))),a.createElement(Fe,{type:"lists_sort"})),a.createElement(Ue,{name:(0,B.localize)("Loops"),id:"loops"},a.createElement(Fe,{type:"controls_repeat"}),a.createElement(Fe,{type:"controls_repeat_ext"}),a.createElement(Fe,{type:"controls_whileUntil"}),a.createElement(Fe,{type:"controls_for"}),a.createElement(Fe,{type:"controls_forEach"}),a.createElement(Fe,{type:"controls_flow_statements"})),a.createElement(Ue,{name:(0,B.localize)("Miscellaneous"),id:"misc"},a.createElement(Fe,{type:"loader"}),a.createElement(Fe,{type:"block_holder"}),a.createElement(Fe,{type:"console"},a.createElement(Ge,{name:"MESSAGE"},a.createElement(He,{type:"text"},a.createElement(je,{name:"TEXT"},"abc")))))))),Ye=Object.freeze({QUICK_STRATEGY:99999,TOOLBAR:5,TRANSACTION:10,SUMMARY_TOOLTIPS:5,RUN_PANEL:1});function qe(){return(qe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e}).apply(this,arguments)}var Ke=function(e){var t=e.is_search_loading,o=e.onSearch,i=e.onSearchBlur,n=e.onSearchClear,r=e.onSearchKeyUp;return a.createElement("div",{className:"db-toolbox__search"},a.createElement(ze.Formik,{initialValues:{search:""},onSubmit:o},(function(e){var o=e.submitForm,s=e.values.search,c=e.setFieldValue;return a.createElement(ze.Form,null,a.createElement(ze.Field,{name:"search"},(function(e){var u=e.field;return a.createElement(l.Input,qe({},u,{className:"db-toolbox__search-field",type:"text",name:"search",placeholder:(0,B.localize)("Search"),onKeyUp:function(){return r(o)},onFocus:o,onBlur:i,leading_icon:s&&(t?a.createElement("div",{className:"loader"}):a.createElement(l.Icon,{icon:"IcCloseCircle",onClick:function(){return n(c)},color:"secondary"}))||!s&&a.createElement(l.Icon,{icon:"IcSearch"})}))})))})))},Xe=function(e){var t=e.onMount,o=e.onUnmount,i=e.hasSubCategory,n=e.is_mobile,r=e.is_search_loading,s=e.is_toolbox_open,c=e.onSearch,u=e.onSearchBlur,p=e.onSearchClear,d=e.onSearchKeyUp,y=e.onToolboxItemClick,m=e.onToolboxItemExpand,h=e.sub_category_index,_=e.toggleDrawer,g=e.toolbox_dom,f=a.useRef(We);return a.useEffect((function(){return t(f),function(){return o()}}),[t,o]),n?null:a.createElement(l.Drawer,{anchor:"left",className:"db-toolbox",is_open:s,toggleDrawer:_,width:256,zIndex:Ye.RUN_PANEL},a.createElement("div",{id:"gtm-toolbox",className:"db-toolbox__content"},a.createElement("div",{className:"db-toolbox__header"},a.createElement("div",{className:"db-toolbox__title"},(0,B.localize)("Blocks menu"))),a.createElement(Ke,{is_search_loading:r,onSearch:c,onSearchBlur:u,onSearchClear:p,onSearchKeyUp:d}),a.createElement("div",{className:"db-toolbox__category-menu"},g&&Array.from(g.childNodes).map((function(e,t){if("CATEGORY"===e.tagName.toUpperCase()){var o=i(e.children),n=h.includes(t);return a.createElement("div",{key:"db-toolbox__row--".concat(e.getAttribute("id")),className:"db-toolbox__row"},a.createElement("div",{className:"db-toolbox__item",onClick:function(){o?m(t):y(e)}},a.createElement("div",{className:"db-toolbox__category-text"},a.createElement("div",{className:"db-toolbox__label"},(0,B.localize)(e.getAttribute("name"))),o&&a.createElement("div",{className:E()("db-toolbox__category-arrow",{"db-toolbox__category-arrow--active":n})},a.createElement(l.Icon,{icon:"IcChevronDownBold"})))),o&&n&&Array.from(e.childNodes).map((function(e){return a.createElement("div",{key:"db-toolbox__sub-category-row--".concat(e.getAttribute("id")),className:"db-toolbox__sub-category-row",onClick:function(){y(e)}},a.createElement(l.Text,{size:"xxs",line_height:"m"},(0,B.localize)(e.getAttribute("name"))))})))}})))))};Xe.PropTypes={hasSubCategory:p().func,is_mobile:p().bool,is_search_loading:p().bool,is_toolbox_open:p().bool,onMount:p().func,onSearch:p().func,onSearchBlur:p().func,onSearchClear:p().func,onSearchKeyUp:p().func,onToolboxItemClick:p().func,onToolboxItemExpand:p().func,onUnmount:p().func,sub_category_index:p().array,toggleDrawer:p().func,toolbox_dom:p().arrayOf(NodeList)};const Ze=f((function(e){var t=e.toolbox,o=e.ui;return{hasSubCategory:t.hasSubCategory,is_mobile:o.is_mobile,is_search_loading:t.is_search_loading,is_toolbox_open:t.is_toolbox_open,onMount:t.onMount,onSearch:t.onSearch,onSearchBlur:t.onSearchBlur,onSearchClear:t.onSearchClear,onSearchKeyUp:t.onSearchKeyUp,onToolboxItemClick:t.onToolboxItemClick,onToolboxItemExpand:t.onToolboxItemExpand,onUnmount:t.onUnmount,sub_category_index:t.sub_category_index,toggleDrawer:t.toggleDrawer,toolbox_dom:t.toolbox_dom}}))(Xe);var Qe=function(e){var t=e.active_tab;return e.is_loading?null:a.createElement(a.Fragment,null,Blockly.derivWorkspace&&a.createElement(a.Fragment,null,t===T.WORKSPACE&&a.createElement(a.Fragment,null,a.createElement(Ze,null),a.createElement(oe,null)),t===T.CHART&&a.createElement("div",{className:"bot__chart-container-wrapper"},a.createElement("div",{className:"bot__chart-container",style:{width:"var(--bot-content-width)",height:"var(--bot-content-height)"}},a.createElement(N,null)))))},et=function(e){var t=e.active_tab,o=e.is_loading,i=e.onMount,n=e.onUnmount;return a.useEffect((function(){return i(),function(){return n()}}),[i,n]),a.createElement("div",{id:"scratch_div",style:{width:"100vw",height:"var(--bot-content-height)"}},a.createElement(Qe,{active_tab:t,is_loading:o}))};et.propTypes={active_tab:p().string,is_loading:p().bool,onMount:p().func,onUnmount:p().func};const tt=f((function(e){var t=e.blockly_store,o=e.main_content;return{active_tab:o.active_tab,is_loading:t.is_loading,onMount:o.onMount,onUnmount:o.onUnmount}}))(et);var ot=function(e){switch(e){case"error":return"IcAlertDanger";case"warn":return"IcAlertWarning";case"info":return"IcAlertInfo";default:return"IcAlertWarning"}};function it(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function nt(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?it(Object(o),!0).forEach((function(t){rt(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):it(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function rt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function at(){return(at=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e}).apply(this,arguments)}var lt=function(e){var t=e.active_index,o=e.createStrategy,i=e.duration_unit_dropdown,n=e.getSizeDesc,r=e.getSizeText,s=e.initial_errors,c=e.initial_values,u=e.is_onscreen_keyboard_active,p=e.is_stop_button_visible,d=e.onChangeDropdownItem,y=e.onChangeInputValue,m=e.onHideDropdownList,h=e.onScrollStopDropdownList,_=e.symbol_dropdown,g=e.trade_type_dropdown,f=e.validateQuickStrategy,b=e.is_mobile,k=e.selected_symbol,v=e.selected_trade_type,T=e.selected_duration_unit,S=e.description,O=e.setCurrentFocus;return a.createElement(ze.Formik,{initialValues:c,validate:f,onSubmit:o,enableReinitialize:!0},(function(e){var o=e.errors,c=e.handleChange,C=e.values,w=e.isSubmitting,A=e.setFieldValue,I=e.touched,R=e.submitForm,D=f(C),N=0===Object.keys(D).length,x=!w&&N;return a.createElement(ze.Form,{className:E()("quick-strategy__form",{"quick-strategy__form--active-keyboard":u})},a.createElement(l.ThemedScrollbars,{height:"430px",autohide:!0,is_bypassed:b},a.createElement("div",{className:E()("quick-strategy__form-content",{"quick-strategy__form-content--active-keyboard":u,"quick-strategy__form-content--safari-fix":(0,ne.isSafari)()})},a.createElement("div",{className:"quick-strategy__description"},S),a.createElement("div",{className:"quick-strategy__form-row"},a.createElement(ze.Field,{name:"quick-strategy__symbol"},(function(e){var t=e.field;return a.createElement(a.Fragment,null,b?a.createElement(l.SelectNative,{list_items:_,value:k.value,label:(0,B.localize)("Asset"),should_show_empty_option:!1,onChange:function(e){d("symbol",e.target.value,A)}}):a.createElement(l.Autocomplete,at({},t,{autoComplete:"off",className:"quick-strategy__dropdown quick-strategy__leading",type:"text",label:(0,B.localize)("Asset"),list_items:_,onHideDropdownList:function(){m("symbol",C[t.name],A)},onItemSelection:function(e){var t=e.value;d("symbol",t,A)},onScrollStop:function(){return h("symbol")},leading_icon:k.value&&a.createElement(l.Icon,{icon:"IcUnderlying".concat(k.value),size:24})})))}))),a.createElement("div",{className:"quick-strategy__form-row"},a.createElement(ze.Field,{name:"quick-strategy__trade-type"},(function(e){var t=e.field;return a.createElement(a.Fragment,null,b?a.createElement(l.SelectNative,{list_items:g,value:v.value,label:(0,B.localize)("Trade type"),should_show_empty_option:!1,onChange:function(e){d("trade-type",e.target.value,A)}}):a.createElement(l.Autocomplete,at({},t,{autoComplete:"off",className:"quick-strategy__dropdown quick-strategy__leading",type:"text",label:(0,B.localize)("Trade type"),list_items:g,onHideDropdownList:function(){m("trade-type",C[t.name],A)},onItemSelection:function(e){var t=e.value;d("trade-type",t,A)},onScrollStop:function(){return h("trade-type")},leading_icon:v.icon&&a.createElement(l.Text,null,a.createElement(l.IconTradeTypes,{type:v.icon[0]}),a.createElement(l.IconTradeTypes,{type:v.icon[1]}))})))}))),a.createElement("div",{className:E()("quick-strategy__form-row",{"quick-strategy__form-row--multiple":!b})},a.createElement(ze.Field,{name:"quick-strategy__duration-unit"},(function(e){var t=e.field;return a.createElement(a.Fragment,null,b?a.createElement(l.SelectNative,{list_items:i,value:T.value,label:(0,B.localize)("Duration unit"),should_show_empty_option:!1,onChange:function(e){d("duration-unit",e.target.value,A)}}):a.createElement(l.Autocomplete,at({},t,{autoComplete:"off",type:"text",label:(0,B.localize)("Duration unit"),list_items:i,disabled:1===i.length,onHideDropdownList:function(){m("duration-unit",C[t.name],A)},onItemSelection:function(e){var t=e.value;d("duration-unit",t,A)},onScrollStop:function(){return h("duration-unit")}})))})),a.createElement(ze.Field,{name:"quick-strategy__duration-value"},(function(e){var t=e.field;return a.createElement(l.Input,at({},t,{className:"quick-strategy__input",label_className:"quick-strategy__input-label",field_className:"quick-strategy__input-field",type:"text",error:s[t.name]||I[t.name]&&o[t.name],label:(0,B.localize)("Duration value"),onChange:function(e){c(e),y("input_duration_value",e)},onFocus:function(e){return O(e.currentTarget.name)},onBlur:function(){return O(null)},placeholder:"5",trailing_icon:a.createElement(l.Popover,{alignment:b?"top":"bottom",message:(0,B.localize)("The trade length of your purchased contract."),zIndex:Ye.QUICK_STRATEGY},a.createElement(l.Icon,{icon:"IcInfoOutline"}))}))}))),a.createElement("div",{className:E()("quick-strategy__form-row",{"quick-strategy__form-row--multiple":!b})},a.createElement(ze.Field,{name:"quick-strategy__stake"},(function(e){var t=e.field;return a.createElement(l.Input,at({},t,{className:"quick-strategy__input",label_className:"quick-strategy__input-label",field_className:"quick-strategy__input-field",type:"text",error:s[t.name]||I[t.name]&&o[t.name],label:(0,B.localize)("Initial stake"),onChange:function(e){c(e),y("input_stake",e)},onFocus:function(e){return O(e.currentTarget.name)},onBlur:function(){return O(null)},placeholder:"10",trailing_icon:a.createElement(l.Popover,{alignment:b?"top":"bottom",message:(0,B.localize)("The amount that you pay to enter a trade."),zIndex:Ye.QUICK_STRATEGY},a.createElement(l.Icon,{icon:"IcInfoOutline"}))}))})),a.createElement(ze.Field,{name:"quick-strategy__loss"},(function(e){var t=e.field;return a.createElement(l.Input,at({},t,{className:"quick-strategy__input",label_className:"quick-strategy__input-label",field_className:"quick-strategy__input-field",type:"text",error:s[t.name]||I[t.name]&&o[t.name],label:(0,B.localize)("Loss threshold"),onChange:function(e){c(e),y("input_loss",e)},onFocus:function(e){return O(e.currentTarget.name)},onBlur:function(){return O(null)},placeholder:"5000",trailing_icon:a.createElement(l.Popover,{alignment:b?"top":"bottom",message:(0,B.localize)("The bot will stop trading if your total loss exceeds this amount."),zIndex:Ye.QUICK_STRATEGY},a.createElement(l.Icon,{icon:"IcInfoOutline"}))}))}))),a.createElement("div",{className:E()("quick-strategy__form-row",{"quick-strategy__form-row--multiple":!b})},a.createElement(ze.Field,{name:"quick-strategy__size"},(function(e){var i=e.field;return a.createElement(l.Input,at({},i,{className:"quick-strategy__input",label_className:"quick-strategy__input-label",field_className:"quick-strategy__input-field",type:"text",error:s[i.name]||I[i.name]&&o[i.name],label:r(t),onChange:function(e){c(e),y("input_size",e)},onFocus:function(e){return O(e.currentTarget.name)},onBlur:function(){return O(null)},placeholder:"2",trailing_icon:a.createElement(l.Popover,{alignment:b?"top":"bottom",message:n(t),zIndex:Ye.QUICK_STRATEGY},a.createElement(l.Icon,{icon:"IcInfoOutline"}))}))})),a.createElement(ze.Field,{name:"quick-strategy__profit"},(function(e){var t=e.field;return a.createElement(l.Input,at({},t,{className:"quick-strategy__input",label_className:"quick-strategy__input-label",field_className:"quick-strategy__input-field",type:"text",error:s[t.name]||I[t.name]&&o[t.name],label:(0,B.localize)("Profit threshold"),onChange:function(e){c(e),y("input_profit",e)},onFocus:function(e){return O(e.currentTarget.name)},onBlur:function(){return O(null)},placeholder:"5000",trailing_icon:a.createElement(l.Popover,{alignment:b?"top":"bottom",message:(0,B.localize)("The bot will stop trading if your total profit exceeds this amount."),zIndex:Ye.QUICK_STRATEGY},a.createElement(l.Icon,{icon:"IcInfoOutline"}))}))}))))),a.createElement("div",{className:E()("quick-strategy__form-footer",{"quick-strategy__form-footer--active-keyboard":u})},a.createElement(l.Button.Group,null,!b&&a.createElement(l.Button,{type:"button",id:"db-quick-strategy__button-edit",text:(0,B.localize)("Create and edit"),is_disabled:!x,secondary:!0,large:!0,onClick:function(){A("button","edit"),R()}}),a.createElement(l.Button,{type:"button",id:"db-quick-strategy__button-run",text:(0,B.localize)("Run"),is_disabled:!x||p,primary:!0,large:!0,onClick:function(){A("button","run"),R()}}))))}))},st=function(e){var t=e.symbol;return a.createElement("div",{key:t.value,className:"quick-strategy__option"},a.createElement(l.Icon,{icon:"IcUnderlying".concat(t.value),size:32}),a.createElement(l.Text,{className:"quick-strategy__symbol",size:"xs",color:"prominent"},t.text))},ct=function(e){var t=e.trade_type;return a.createElement("div",{key:t.value,className:"quick-strategy__option"},a.createElement(l.IconTradeTypes,{type:t.icon[0],className:"quick-strategy__icon"}),a.createElement(l.IconTradeTypes,{type:t.icon[1],className:"quick-strategy__icon"}),a.createElement(l.Text,{className:"quick-strategy__symbol",size:"xs",color:"prominent"},t.text))},ut=function(e){var t=s.config.strategies,o=e.setActiveTabIndex,i=e.symbol_dropdown,n=e.trade_type_dropdown,r=e.active_index,c=e.createStrategy,u=e.duration_unit_dropdown,p=e.getSizeDesc,d=e.getSizeText,y=e.initial_errors,m=e.initial_values,h=e.is_onscreen_keyboard_active,_=e.is_mobile,g=e.is_stop_button_visible,f=e.onChangeDropdownItem,b=e.onChangeInputValue,k=e.onHideDropdownList,v=e.onScrollStopDropdownList,E=e.validateQuickStrategy,B=e.selected_symbol,T=e.selected_trade_type,S=e.setCurrentFocus,O=e.selected_duration_unit,C=i.map((function(e){return nt({component:a.createElement(st,{symbol:e})},e)})).filter((function(e){return"Cryptocurrencies"!==e.group&&"Jump Indices"!==e.group})),w=n.map((function(e){return nt({component:a.createElement(ct,{trade_type:e})},e)}));return a.createElement(l.Tabs,{active_index:r,onTabItemClick:o,top:!0},Object.keys(t).map((function(e){var o=t[e],i=o.index,n=o.label,l=o.description;return a.createElement("div",{key:i,label:n},a.createElement(lt,{active_index:r,createStrategy:c,duration_unit_dropdown:u,getSizeDesc:p,getSizeText:d,initial_errors:y,initial_values:m,is_onscreen_keyboard_active:h,is_stop_button_visible:g,onChangeDropdownItem:f,onChangeInputValue:b,onHideDropdownList:k,onScrollStopDropdownList:v,validateQuickStrategy:E,symbol_dropdown:C,trade_type_dropdown:w,is_mobile:_,selected_symbol:B,selected_trade_type:T,selected_duration_unit:O,description:l,setCurrentFocus:S}))})))},pt=function(e){var t=e.is_strategy_modal_open,o=e.is_mobile,i=e.toggleStrategyModal;return a.createElement(a.Fragment,null,o?a.createElement(l.MobileFullPageModal,{is_modal_open:t,className:"quick-strategy__wrapper",header:(0,B.localize)("Quick Strategy"),onClickClose:i,height_offset:"80px",page_overlay:!0},a.createElement(ut,e)):a.createElement(l.Modal,{title:(0,B.localize)("Quick strategy"),className:"modal--strategy",is_open:t,toggleModal:i,width:"540px"},a.createElement("div",{className:"modal__content"},a.createElement(ut,e))))};pt.propTypes={active_index:p().number,createStrategy:p().func,duration_unit_dropdown:p().array,getSizeDesc:p().func,getSizeText:p().func,initial_errors:p().object,initial_values:p().object,is_mobile:p().bool,is_stop_button_visible:p().bool,is_strategy_modal_open:p().bool,onChangeDropdownItem:p().func,onChangeInputValue:p().func,onChangeSymbolInput:p().func,onHideDropdownList:p().func,onScrollStopDropdownList:p().func,setActiveTabIndex:p().func,setCurrentFocus:p().func,selected_symbol:p().oneOfType([p().string,p().object]),selected_trade_type:p().oneOfType([p().string,p().object]),selected_duration_unit:p().oneOfType([p().string,p().object]),symbol_dropdown:p().array,toggleStrategyModal:p().func,trade_type_dropdown:p().array,validateQuickStrategy:p().func};const dt=f((function(e){var t=e.run_panel,o=e.quick_strategy,i=e.ui;return{active_index:o.active_index,createStrategy:o.createStrategy,duration_unit_dropdown:o.duration_unit_dropdown,getSizeDesc:o.getSizeDesc,getSizeText:o.getSizeText,initial_errors:o.initial_errors,initial_values:o.initial_values,is_onscreen_keyboard_active:i.is_onscreen_keyboard_active,is_mobile:i.is_mobile,is_stop_button_visible:t.is_stop_button_visible,is_strategy_modal_open:o.is_strategy_modal_open,onChangeDropdownItem:o.onChangeDropdownItem,onChangeInputValue:o.onChangeInputValue,onChangeSymbolInput:o.onChangeSymbolInput,onHideDropdownList:o.onHideDropdownList,onScrollStopDropdownList:o.onScrollStopDropdownList,setActiveTabIndex:o.setActiveTabIndex,selected_symbol:o.selected_symbol,selected_trade_type:o.selected_trade_type,selected_duration_unit:o.selected_duration_unit,symbol_dropdown:o.symbol_dropdown,toggleStrategyModal:o.toggleStrategyModal,trade_type_dropdown:o.trade_type_dropdown,validateQuickStrategy:o.validateQuickStrategy,setCurrentFocus:i.setCurrentFocus}}))(pt),yt=f((function(e){var t=e.route_prompt_dialog;return{continueRoute:t.continueRoute,should_show:t.should_show,is_confirmed:t.is_confirmed,last_location:t.last_location,onCancel:t.onCancel,onConfirm:t.onConfirm}}))((function(e){var t=e.continueRoute,o=e.is_confirmed,i=e.last_location,n=e.should_show,r=e.onCancel,s=e.onConfirm;return a.useEffect(t,[o,i]),a.createElement(l.Dialog,{title:(0,B.localize)("Leaving already?"),confirm_button_text:(0,B.localize)("Yes, I'll come back later"),cancel_button_text:(0,B.localize)("No, I'll stay"),onConfirm:s,onCancel:r,is_visible:n},a.createElement(B.Localize,{i18n_default_text:"If you leave, your current contract will be completed, but your bot will stop running immediately."}))}));function mt(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function ht(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var _t=function(){return{APPLY:(0,B.localize)("Apply"),STAKE:(0,B.localize)("Stake:"),CLOSE:(0,B.localize)("Close"),CANCEL:(0,B.localize)("Cancel"),CURRENT_STAKE:(0,B.localize)("Current stake:"),DEAL_CANCEL_FEE:(0,B.localize)("Deal cancel. fee:"),TAKE_PROFIT:(0,B.localize)("Take profit:"),BUY_PRICE:(0,B.localize)("Buy price:"),STOP_LOSS:(0,B.localize)("Stop loss:"),TOTAL_PROFIT_LOSS:(0,B.localize)("Total profit/loss:"),PROFIT_LOSS:(0,B.localize)("Profit/Loss:"),POTENTIAL_PROFIT_LOSS:(0,B.localize)("Potential profit/loss:"),INDICATIVE_PRICE:(0,B.localize)("Indicative price:"),PAYOUT:(0,B.localize)("Sell Price:"),PURCHASE_PRICE:(0,B.localize)("Buy price:"),POTENTIAL_PAYOUT:(0,B.localize)("Payout limit:"),TICK:(0,B.localize)("Tick "),WON:(0,B.localize)("Won"),LOST:(0,B.localize)("Lost"),DAYS:(0,B.localize)("Days"),DAY:(0,B.localize)("Day"),SELL:(0,B.localize)("Sell"),INCREMENT_VALUE:(0,B.localize)("Increment value"),DECREMENT_VALUE:(0,B.localize)("Decrement value"),TAKE_PROFIT_LOSS_NOT_AVAILABLE:(0,B.localize)("Take profit and/or stop loss are not available while deal cancellation is active."),DONT_SHOW_THIS_AGAIN:(0,B.localize)("Don't show this again"),RESALE_NOT_OFFERED:(0,B.localize)("Resale not offered"),NOT_AVAILABLE:(0,B.localize)("N/A")}},gt=function(e){return function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(o),!0).forEach((function(t){ht(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):mt(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({},function(e){return{ASIANU:{name:(0,B.localize)("Asian Up"),position:"top"},ASIAND:{name:(0,B.localize)("Asian Down"),position:"bottom"},CALL:{name:e?(0,B.localize)("Higher"):(0,B.localize)("Rise"),position:"top"},PUT:{name:e?(0,B.localize)("Lower"):(0,B.localize)("Fall"),position:"bottom"},CALLE:{name:(0,B.localize)("Rise"),position:"top"},PUTE:{name:(0,B.localize)("Fall"),position:"bottom"},CALLSPREAD:{name:(0,B.localize)("Spread Up"),position:"top"},PUTSPREAD:{name:(0,B.localize)("Spread Down"),position:"bottom"},DIGITMATCH:{name:(0,B.localize)("Matches"),position:"top"},DIGITDIFF:{name:(0,B.localize)("Differs"),position:"bottom"},DIGITEVEN:{name:(0,B.localize)("Even"),position:"top"},DIGITODD:{name:(0,B.localize)("Odd"),position:"bottom"},DIGITOVER:{name:(0,B.localize)("Over"),position:"top"},DIGITUNDER:{name:(0,B.localize)("Under"),position:"bottom"},EXPIRYMISS:{name:(0,B.localize)("Ends Outside"),position:"top"},EXPIRYRANGE:{name:(0,B.localize)("Ends Between"),position:"bottom"},LBFLOATCALL:{name:(0,B.localize)("Close-to-Low"),position:"top"},LBFLOATPUT:{name:(0,B.localize)("High-to-Close"),position:"top"},LBHIGHLOW:{name:(0,B.localize)("High-to-Low"),position:"top"},MULTUP:{name:(0,B.localize)("Up"),position:"top"},MULTDOWN:{name:(0,B.localize)("Down"),position:"bottom"},ONETOUCH:{name:(0,B.localize)("Touch"),position:"top"},NOTOUCH:{name:(0,B.localize)("No Touch"),position:"bottom"},RANGE:{name:(0,B.localize)("Stays Between"),position:"top"},UPORDOWN:{name:(0,B.localize)("Goes Outside"),position:"bottom"},RESETCALL:{name:(0,B.localize)("Reset Call"),position:"top"},RESETPUT:{name:(0,B.localize)("Reset Put"),position:"bottom"},RUNHIGH:{name:(0,B.localize)("Only Ups"),position:"top"},RUNLOW:{name:(0,B.localize)("Only Downs"),position:"bottom"},TICKHIGH:{name:(0,B.localize)("High Tick"),position:"top"},TICKLOW:{name:(0,B.localize)("Low Tick"),position:"bottom"}}}(e))},ft=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return gt(t)[e]?gt(t)[e.toUpperCase()].name:""},bt=function(e){var t=e.contract,o=e.is_contract_completed,i=e.is_contract_loading,n=e.is_contract_inactive,r=e.is_mobile,s=e.onClickSell,c=e.is_sell_requested,u=e.server_time,p=a.createElement(l.ContractCard.Header,{contract_info:t,getCardLabels:_t,getContractTypeDisplay:ft,has_progress_slider:!0,is_mobile:r,is_sold:o,server_time:u}),d=a.createElement(l.ContractCard.Body,{contract_info:t,currency:t&&t.currency,getCardLabels:_t,is_mobile:r,is_sold:o,server_time:u}),y=a.createElement(l.ContractCard.Footer,{contract_info:t,getCardLabels:_t,is_sell_requested:c,onClickSell:s}),m=a.createElement(a.Fragment,null,p,d,y);return a.createElement("div",{className:E()("db-summary-card",{"db-summary-card--mobile":r,"db-summary-card--inactive":n,"db-summary-card--is-loading":i,"db-summary-card--completed":o,"db-summary-card--completed-mobile":o&&r})},i&&a.createElement(P,{speed:2}),!i&&t&&a.createElement(l.ContractCard,{contract_info:t,getCardLabels:_t,profit_loss:t.profit,should_show_result_overlay:!0},a.createElement("div",{className:E()("dc-contract-card",{"dc-contract-card--green":t.profit>0,"dc-contract-card--red":t.profit<0})},m)),!i&&!t&&a.createElement(a.Fragment,null,(0,B.localize)("Build a bot from the start menu then hit the run button to run the bot.")))};bt.propTypes={contract:p().object,is_contract_completed:p().bool,is_contract_inactive:p().bool,is_contract_loading:p().bool,is_mobile:p().bool,server_time:p().object};const kt=f((function(e){var t=e.summary_card,o=e.common,i=e.run_panel,n=e.ui;return{contract:t.contract,is_contract_completed:t.is_contract_completed,is_contract_inactive:t.is_contract_inactive,is_contract_loading:t.is_contract_loading,is_mobile:n.is_mobile,onClickSell:i.onClickSell,is_sell_requested:i.is_sell_requested,server_time:o.server_time}}))(bt);var vt=function(e){var t=e.is_mobile,o=e.is_drawer_open;return a.createElement("div",{className:E()("summary",{"run-panel-tab__content":!t,"run-panel-tab__content--mobile":t&&o})},a.createElement(l.ThemedScrollbars,null,a.createElement(kt,null)))};vt.propTypes={is_mobile:p().bool};const Et=f((function(e){return{is_mobile:e.ui.is_mobile}}))(vt);var Bt=Object.freeze({CONTRACT:"contract",DIVIDER:"divider"}),Tt=function(e){var t=e.icon,o=e.title,i=e.message,n=e.className;return a.createElement(a.Fragment,null,a.createElement(l.Popover,{className:E()(n,"transactions__icon"),alignment:"left",message:o,zIndex:Ye.TRANSACTION},t),i)},St=function(){return a.createElement(x.ZP,{className:"transactions__loader-text",height:10,width:80,speed:3,primaryColor:"var(--general-section-1)",secondaryColor:"var(--general-hover)"},a.createElement("rect",{x:"0",y:"0",rx:"0",ry:"0",width:"100",height:"12"}))},Ot=function(){return a.createElement(x.ZP,{className:"transactions__loader-icon",speed:3,width:24,height:24,primaryColor:"var(--general-section-1)",secondaryColor:"var(--general-hover)"},a.createElement("rect",{x:"0",y:"0",rx:"5",ry:"5",width:"24",height:"24"}))},Ct=function(e){var t=e.icon,o=e.title,i=e.children;return a.createElement("div",{className:"transactions__popover-item"},t&&a.createElement("div",{className:"transaction__popover-icon"},t),a.createElement("div",{className:"transactions__popover-details"},a.createElement("div",{className:"transactions__popover-title"},o),i))},wt=function(e){var t=e.contract;return a.createElement("div",{className:"transactions__popover-content"},t.transaction_ids&&a.createElement(Ct,{title:(0,B.localize)("Reference IDs")},t.transaction_ids.buy&&a.createElement("div",{className:"transactions__popover-value"},"".concat(t.transaction_ids.buy," ").concat((0,B.localize)("(Buy)"))),t.transaction_ids.sell&&a.createElement("div",{className:"transactions__popover-value"},"".concat(t.transaction_ids.sell," ").concat((0,B.localize)("(Sell)")))),t.tick_count&&a.createElement(Ct,{title:(0,B.localize)("Duration")},a.createElement("div",{className:"transactions__popover-value"},"".concat(t.tick_count," ").concat((0,B.localize)("ticks")))),t.barrier&&a.createElement(Ct,{title:(0,B.localize)("Barrier")},a.createElement("div",{className:"transactions__popover-value"},t.barrier))||t.high_barrier&&t.low_barrier&&a.createElement(Ct,{title:(0,B.localize)("Barriers")},a.createElement("div",{className:"transactions__popover-value"},"".concat(t.high_barrier," ").concat((0,B.localize)("(High)"))),a.createElement("div",{className:"transactions__popover-value"},"".concat(t.low_barrier," ").concat((0,B.localize)("(Low)")))),t.date_start&&a.createElement(Ct,{title:(0,B.localize)("Start time")},a.createElement("div",{className:"transactions__popover-value"},(0,ne.convertDateFormat)(t.date_start,"YYYY-M-D HH:mm:ss [GMT]","YYYY-MM-DD HH:mm:ss [GMT]"))),t.entry_tick&&a.createElement(Ct,{title:(0,B.localize)("Entry spot")},a.createElement("div",{className:"transactions__popover-value"},t.entry_tick),t.entry_tick_time&&a.createElement("div",{className:"transactions__popover-value"},(0,ne.convertDateFormat)(t.entry_tick_time,"YYYY-M-D HH:mm:ss [GMT]","YYYY-MM-DD HH:mm:ss [GMT]"))),t.exit_tick&&t.exit_tick_time&&a.createElement(Ct,{title:(0,B.localize)("Exit spot")},a.createElement("div",{className:"transactions__popover-value"},t.exit_tick),a.createElement("div",{className:"transactions__popover-value"},(0,ne.convertDateFormat)(t.exit_tick_time,"YYYY-M-D HH:mm:ss [GMT]","YYYY-MM-DD HH:mm:ss [GMT]")))||t.exit_tick&&a.createElement(Ct,{title:(0,B.localize)("Exit time")},a.createElement("div",{className:"transactions__popover-value"},t.exit_tick)))},At=function(e){var t=e.active_transaction_id,o=e.contract,i=e.setActiveTransactionId;return a.createElement(l.Popover,{zIndex:Ye.TRANSACTION,alignment:"left",className:"transactions__item-wrapper",is_open:o&&t===o.transaction_ids.buy,message:o&&a.createElement(wt,{contract:o})},a.createElement("div",{className:"transactions__item",onClick:o&&function(){return i(o.transaction_ids.buy)}},a.createElement("div",{className:"transactions__cell transactions__trade-type"},a.createElement("div",{className:"transactions__loader-container"},o?a.createElement(Tt,{icon:a.createElement(l.Icon,{icon:"IcUnderlying".concat(o.underlying),size:16}),title:o.display_name}):a.createElement(Ot,null)),a.createElement("div",{className:"transactions__loader-container"},o?a.createElement(Tt,{icon:a.createElement(l.IconTradeTypes,{type:o.contract_type,size:16}),title:(0,s.getContractTypeName)(o)}):a.createElement(Ot,null))),a.createElement("div",{className:"transactions__cell transactions__entry-spot"},a.createElement(Tt,{icon:a.createElement(l.Icon,{icon:"IcContractEntrySpot"}),title:(0,B.localize)("Entry spot"),message:o&&o.entry_tick||a.createElement(St,null)})),a.createElement("div",{className:"transactions__cell transactions__exit-spot"},a.createElement(Tt,{icon:a.createElement(l.Icon,{icon:"IcContractExitSpot"}),title:(0,B.localize)("Exit spot"),message:o&&o.exit_tick||a.createElement(St,null)})),a.createElement("div",{className:"transactions__cell transactions__stake"},o?a.createElement(l.Money,{amount:o.buy_price,currency:o.currency,show_currency:!0}):a.createElement(St,null)),a.createElement("div",{className:"transactions__cell transactions__profit"},o&&o.profit?a.createElement("div",{className:E()({"transactions__profit--win":o.profit>0,"transactions__profit--loss":o.profit<0})},a.createElement(l.Money,{amount:Math.abs(o.profit),currency:o.currency,show_currency:!0})):a.createElement(St,null))))};At.propTypes={active_transaction_id:p().number,contract:p().object,setActiveTransactionId:p().func};const It=f((function(e){var t=e.transactions;return{active_transaction_id:t.active_transaction_id,setActiveTransactionId:t.setActiveTransactionId}}))(At);var Rt=function(e){var t=e.row,o=e.is_new_row,i=(0,ne.useNewRowTransition)(o).in_prop;switch(t.type){case Bt.CONTRACT:var n=t.data;return a.createElement(ie.Z,{in:i,timeout:500,classNames:"list__animation"},a.createElement(It,{contract:n}));case Bt.DIVIDER:return a.createElement("div",{className:"transactions__divider"},a.createElement("div",{className:"transactions__divider-line"}));default:return null}},Dt=function(e){var t=e.contract_stage,o=e.elements,i=e.is_drawer_open,n=e.is_mobile,r=e.onMount,s=e.onUnmount;return a.useEffect((function(){return r(),function(){return s()}}),[r,s]),a.createElement("div",{className:E()("transactions",{"run-panel-tab__content":!n,"run-panel-tab__content--mobile":n&&i})},a.createElement(l.DesktopWrapper,null,a.createElement("div",{className:"download__container"},a.createElement(F,{tab:"transactions"}))),a.createElement("div",{className:"transactions__header"},a.createElement("span",{className:"transactions__header-column transactions__header-type"},(0,B.localize)("Type")),a.createElement("span",{className:"transactions__header-column transactions__header-spot"},(0,B.localize)("Entry/Exit spot")),a.createElement("span",{className:"transactions__header-column transactions__header-profit"},(0,B.localize)("Buy price and P/L"))),a.createElement("div",{className:E()({transactions__content:!n,"transactions__content--mobile":n})},a.createElement("div",{className:"transactions__scrollbar"},o.length?a.createElement(l.DataList,{className:"transactions",data_source:o,rowRenderer:function(e){return a.createElement(Rt,e)},keyMapper:function(e){switch(e.type){case Bt.CONTRACT:return e.data.transaction_ids.buy;case Bt.DIVIDER:return e.data;default:return null}},getRowSize:function(e){var t=e.index;switch(o[t].type){case Bt.CONTRACT:return 50;case Bt.DIVIDER:return 21;default:return 0}}}):a.createElement(a.Fragment,null,t>=ae.STARTING?a.createElement(It,{contract:null}):a.createElement(l.ThemedScrollbars,null,a.createElement("div",{className:"transactions-empty-box"},a.createElement("div",{className:"transactions-empty"},a.createElement("div",{className:"transactions-empty__icon-box"},a.createElement(l.Icon,{icon:"IcBox",className:"transactions-empty__icon",size:64,color:"secondary"})),a.createElement(l.Text,{as:"h4",size:"xs",weight:"bold",align:"center",color:"less-prominent",line_height:"xxs",className:"transactions-empty__header"},(0,B.localize)("There are no transactions to display")),a.createElement("div",{className:"transactions-empty__message"},a.createElement(l.Text,{size:"xxs",color:"less-prominent"},(0,B.localize)("Here are the possible reasons:")),a.createElement("ul",{className:"transactions-empty__list"},a.createElement("li",null,(0,B.localize)("The bot is not running")),a.createElement("li",null,(0,B.localize)("The stats are cleared")))))))))))};Dt.propTypes={contract_stage:u.PropTypes.number,elements:u.PropTypes.array,is_drawer_open:u.PropTypes.bool,is_mobile:u.PropTypes.bool,onMount:u.PropTypes.func,onUnmount:u.PropTypes.func};const Nt=f((function(e){var t=e.transactions,o=e.run_panel,i=e.ui;return{contract_stage:o.contract_stage,elements:t.elements,is_mobile:i.is_mobile,onMount:t.onMount,onUnmount:t.onUnmount}}))(Dt);function xt(){return(xt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e}).apply(this,arguments)}function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,i=new Array(t);o<t;o++)i[o]=e[o];return i}var zt=function(e){var t=e.className;return a.createElement("div",{className:E()("circular-wrapper",t)},a.createElement("span",{className:"static-circle"}),a.createElement("span",{className:"dynamic-circle"}))},Lt=function(e){var t=e.toggleAnimationInfoModal;return a.createElement("div",{className:"animation__info",onClick:t},a.createElement(l.Icon,{icon:"IcInfoOutline",id:"db-animation__clear-stat"}))},Mt=function(e){var t=e.is_mobile,o=e.is_animation_info_modal_open,i=e.toggleAnimationInfoModal;return a.createElement(l.Modal,{className:E()("animation__modal",{"animation__modal--mobile":t}),title:(0,B.localize)("Stopping the bot is risky"),is_open:o,toggleModal:i,width:"440px"},a.createElement(l.Modal.Body,null,a.createElement("div",{className:E()({"animation__modal-body--mobile":t})},a.createElement(l.Text,{as:"p"},(0,B.localize)("Stopping the bot will prevent further trades. Any ongoing trades will be completed by our system.")),a.createElement(l.Text,{as:"p",className:"animation__modal-body--content"},(0,B.localize)("Please be aware that some completed transactions may not be displayed in the transaction table if the bot is stopped while placing trades.")),a.createElement(l.Text,{as:"p",className:"animation__modal-body--content"},(0,B.localize)("You may refer to the statement page for details of all completed transactions.")))))},Ft=function(e){switch(e.contract_stage){case ae.NOT_RUNNING:default:return a.createElement(B.Localize,{i18n_default_text:"Bot is not running"});case ae.STARTING:return a.createElement(B.Localize,{i18n_default_text:"Bot is starting"});case ae.PURCHASE_SENT:return a.createElement(B.Localize,{i18n_default_text:"Buying contract"});case ae.PURCHASE_RECEIVED:return a.createElement(B.Localize,{i18n_default_text:"Contract bought"});case ae.IS_STOPPING:return a.createElement(B.Localize,{i18n_default_text:"Bot is stopping"});case ae.CONTRACT_CLOSED:return a.createElement(B.Localize,{i18n_default_text:"Contract closed"})}},Ut=function(e){var t=e.className,o=e.contract_stage,i=e.is_animation_info_modal_open,n=e.is_contract_completed,r=e.is_mobile,s=e.is_stop_button_visible,c=e.is_stop_button_disabled,u=e.profit,p=e.should_show_overlay,d=e.onRunButtonClick,y=e.onStopButtonClick,m=e.info_direction,h=e.toggleAnimationInfoModal,_=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var o=[],i=!0,n=!1,r=void 0;try{for(var a,l=e[Symbol.iterator]();!(i=(a=l.next()).done)&&(o.push(a.value),2!==o.length);i=!0);}catch(e){n=!0,r=e}finally{try{i||null==l.return||l.return()}finally{if(n)throw r}}return o}}(e)||function(e,t){if(e){if("string"==typeof e)return Pt(e,2);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Pt(e,2):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(a.useState(!1)),g=_[0],f=_[1];a.useEffect((function(){g&&setTimeout((function(){f(!1)}),1e3)}),[g]);var b=["","",""],k=o-(o===ae.PURCHASE_SENT||o===ae.PURCHASE_RECEIVED?2:3);if(k>=0){k<b.length&&(b[k]="active"),n&&(k+=1);for(var v=0;v<k;v++)b[v]="completed"}return a.createElement("div",{className:E()("animation__wrapper",t)},"left"===m&&a.createElement(Lt,{toggleAnimationInfoModal:h}),a.createElement(l.Button,xt({is_disabled:c||g,className:"animation__button",id:s?"db-animation__stop-button":"db-animation__run-button",text:s?(0,B.localize)("Stop"):(0,B.localize)("Run"),icon:a.createElement(l.Icon,{icon:s?"IcPause":"IcPlay",color:"active"}),onClick:function(){f(!0),s?y():d()},has_effect:!0},s?{primary:!0}:{green:!0})),a.createElement("div",{className:E()("animation__container",t,{"animation--running":o>0,"animation--completed":p&&n})},p&&n&&a.createElement(L,{profit:u}),a.createElement("span",{className:"animation__text"},a.createElement(Ft,{contract_stage:o})),a.createElement("div",{className:"animation__progress"},a.createElement("div",{className:"animation__progress-line"},a.createElement("div",{className:"animation__progress-bar animation__progress-".concat(o)})),b.map((function(e,t){return a.createElement(zt,{key:t,className:e})})))),"right"===m&&a.createElement(Lt,{toggleAnimationInfoModal:h}),a.createElement(Mt,{is_mobile:r,is_animation_info_modal_open:i,toggleAnimationInfoModal:h}))};Ut.propTypes={className:p().string,contract_stage:p().number,is_animation_info_modal_open:p().bool,is_contract_completed:p().bool,is_stop_button_visible:p().bool,is_stop_button_disabled:p().bool,onRunButtonClick:p().func,onStopButtonClick:p().func,profit:p().number,should_show_overlay:p().bool};const jt=f((function(e){var t=e.summary_card,o=e.run_panel,i=e.toolbar,n=e.ui;return{contract_stage:o.contract_stage,is_animation_info_modal_open:i.is_animation_info_modal_open,is_contract_completed:t.is_contract_completed,is_mobile:n.is_mobile,is_stop_button_visible:o.is_stop_button_visible,is_stop_button_disabled:o.is_stop_button_disabled,onRunButtonClick:o.onRunButtonClick,onStopButtonClick:o.onStopButtonClick,profit:t.profit,should_show_overlay:o.should_show_overlay,toggleAnimationInfoModal:i.toggleAnimationInfoModal}}))(Ut);function Vt(){return(Vt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e}).apply(this,arguments)}function Jt(e,t,o,i,n,r,a){try{var l=e[r](a),s=l.value}catch(e){return void o(e)}l.done?t(s):Promise.resolve(s).then(i,n)}function Ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,i=new Array(t);o<t;o++)i[o]=e[o];return i}var $t=function(e){var t,o=(2,function(e){if(Array.isArray(e))return e}(t=a.useState(""))||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var o=[],i=!0,n=!1,r=void 0;try{for(var a,l=e[Symbol.iterator]();!(i=(a=l.next()).done)&&(o.push(a.value),2!==o.length);i=!0);}catch(e){n=!0,r=e}finally{try{i||null==l.return||l.return()}finally{if(n)throw r}}return o}}(t)||function(e,t){if(e){if("string"==typeof e)return Ht(e,2);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Ht(e,2):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],n=o[1],r=e.is_mobile,s=e.is_onscreen_keyboard_active,c=e.is_logged_in,u=e.initial_values,p=e.api_max_losses,d=e.onRunButtonClick,y=e.resetSelfExclusion,m=e.updateSelfExclusion,h=e.setRunLimit,_=e.reality_check_is_visible;a.useEffect((function(){!_&&c||y()}));var g=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.form_max_losses===p){e.next=7;break}return e.next=3,m({max_losses:t.form_max_losses});case 3:if(null==(o=e.sent)||!o.error){e.next=7;break}return n((0,B.localize)(o.error.message)),e.abrupt("return");case 7:h(t.run_limit),d();case 9:case"end":return e.stop()}}),e)})),function(){var t=this,o=arguments;return new Promise((function(i,n){var r=e.apply(t,o);function a(e){Jt(r,i,n,a,l,"next",e)}function l(e){Jt(r,i,n,a,l,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();return a.createElement("div",{className:"db-self-exclusion"},a.createElement("div",{className:"db-self-exclusion__content"},a.createElement("div",{className:"db-self-exclusion__info"},(0,B.localize)("Enter limits to stop your bot from trading when any of these conditions are met.")),a.createElement(ze.Formik,{initialValues:u,validate:function(e){var t={},o=/^\d+(\.\d+)?$/,i=/^\d+$/,r=(0,B.localize)("This field is required."),a=(0,B.localize)("Should be a valid number"),l=(0,B.localize)("Reached maximum number of digits"),s=(0,B.localize)("Reached maximum number of decimals"),c=(0,B.localize)("Please enter a number between 0 and {{api_max_losses}}.",{api_max_losses:p});return["run_limit","form_max_losses"].forEach((function(o){e[o]||(t[o]=r)})),["run_limit","form_max_losses"].forEach((function(i){e[i]&&(o.test(e[i])?+e[i]>9999999999999&&(t[i]=l):t[i]=a)})),["run_limit"].forEach((function(o){e[o]&&(i.test(e[o])||(t[o]=a))})),["form_max_losses"].forEach((function(o){var i=e[o].toString().split(".")[1];(i&&i.length||0)>2&&(t[o]=s)})),["form_max_losses"].forEach((function(o){0!==p&&p!==e[o]&&p<e[o]?t[o]=c:n("")})),t},onSubmit:g},(function(e){var t=e.values,o=e.touched,n=e.errors,c=e.isValid,u=e.handleChange;return a.createElement(ze.Form,null,a.createElement("div",{className:"db-self-exclusion__form-group"},a.createElement(ze.Field,{name:"form_max_losses"},(function(e){var r=e.field;return a.createElement(l.Input,Vt({},r,{className:"db-self-exclusion__input",type:"text",label:(0,B.localize)("Daily loss limit"),value:t.form_max_losses,onChange:u,error:i||o[r.name]&&n[r.name],hint:(0,B.localize)("Limits your potential losses for the day across all Deriv platforms.")}))}))),a.createElement("div",{className:"db-self-exclusion__form-group"},a.createElement(ze.Field,{name:"run_limit"},(function(e){var i=e.field;return a.createElement(l.Input,Vt({},i,{className:"db-self-exclusion__input",type:"text",label:(0,B.localize)("Maximum consecutive trades"),value:t.run_limit,onChange:u,error:o[i.name]&&n.run_limit,hint:(0,B.localize)("Maximum number of trades your bot will execute for this run.")}))}))),a.createElement("div",{className:E()("db-self-exclusion__footer",{"db-self-exclusion__footer--relative":r&&s})},a.createElement("div",{className:"db-self-exclusion__footer-btn-group"},a.createElement(l.Button,{large:!0,text:(0,B.localize)("Cancel"),onClick:y,secondary:!0,type:"button"}),a.createElement(l.Button,{type:"submit",large:!0,text:(0,B.localize)("Apply and run"),is_disabled:!c||!t.run_limit||!t.form_max_losses||""!==i,primary:!0}))))}))))},Gt=function(e){var t=e.is_restricted,o=e.resetSelfExclusion,i=e.is_mobile;return a.createElement(a.Fragment,null,i?a.createElement(l.FadeWrapper,{is_visible:t,className:"limits__wrapper",keyname:"limitis__wrapper"},a.createElement(l.PageOverlay,{header:(0,B.localize)("Limits"),onClickClose:o},a.createElement(l.MobileWrapper,null,a.createElement(l.Div100vhContainer,{className:"limits__wrapper--is-mobile"},a.createElement($t,e))))):a.createElement(l.Modal,{is_open:t,has_close_icon:!0,width:"440px",height:"374px",toggleModal:o,className:"db-self-exclusion__modal",title:(0,B.localize)("Limits")},a.createElement($t,e)))};Gt.propTypes={is_onscreen_keyboard_active:p().bool,is_mobile:p().bool,is_logged_in:p().bool,is_restricted:p().bool,initial_values:p().object,api_max_losses:p().number,run_limit:p().PropTypes.number,resetSelfExclusion:p().func,reality_check_is_visible:p().bool,setRunLimit:p().func,updateSelfExclusion:p().func,virtual_account_loginid:p().string};const Wt=f((function(e){var t=e.client,o=e.self_exclusion,i=e.ui;return{initial_values:o.initial_values,is_onscreen_keyboard_active:i.is_onscreen_keyboard_active,is_mobile:i.is_mobile,is_logged_in:t.is_logged_in,is_restricted:o.is_restricted,api_max_losses:o.api_max_losses,run_limit:o.run_limit,resetSelfExclusion:o.resetSelfExclusion,reality_check_is_visible:t.is_reality_check_visible,setRunLimit:o.setRunLimit,updateSelfExclusion:t.updateSelfExclusion,virtual_account_loginid:t.virtual_account_loginid}}))(Gt);var Yt=function(e){var t=e.content,o=e.contentClassName,i=e.title;return a.createElement("div",{className:"run-panel__tile"},a.createElement("div",{className:"run-panel__tile-title"},i),a.createElement("div",{className:E()("run-panel__tile-content",o)},t))},qt=function(e){var t=e.currency,o=e.is_mobile,i=e.lost_contracts,n=e.number_of_runs,r=e.total_stake,s=e.total_payout,c=e.toggleStatisticsInfoModal,u=e.total_profit,p=e.won_contracts;return a.createElement("div",{className:E()("run-panel__stat",{"run-panel__stat--mobile":o})},a.createElement("div",{className:"run-panel__stat--info",onClick:c},a.createElement("div",{className:"run-panel__stat--info-item"},a.createElement(B.Localize,{i18n_default_text:"What's this?"}))),a.createElement("div",{className:"run-panel__stat--tiles"},a.createElement(Yt,{title:(0,B.localize)("Total stake"),alignment:"top",content:a.createElement(l.Money,{amount:r,currency:t,show_currency:!0})}),a.createElement(Yt,{title:(0,B.localize)("Total payout"),alignment:"top",content:a.createElement(l.Money,{amount:s,currency:t,show_currency:!0})}),a.createElement(Yt,{title:(0,B.localize)("No. of runs"),alignment:"top",content:n}),a.createElement(Yt,{title:(0,B.localize)("Contracts lost"),alignment:"bottom",content:i}),a.createElement(Yt,{title:(0,B.localize)("Contracts won"),alignment:"bottom",content:p}),a.createElement(Yt,{title:(0,B.localize)("Profit/loss"),content:a.createElement(l.Money,{amount:u,currency:t,has_sign:!0,show_currency:!0}),alignment:"bottom",contentClassName:E()("run-panel__stat-amount",{"run-panel__stat-amount--positive":u>0,"run-panel__stat-amount--negative":u<0})})))},Kt=function(e){var t=e.is_clear_stat_disabled,o=e.is_mobile,i=e.is_drawer_open,n=e.onClearStatClick;return o&&i&&a.createElement(l.Button,{id:"db-run-panel__clear-button",className:"run-panel__clear-button",is_disabled:t,text:(0,B.localize)("Reset"),onClick:n,secondary:!0})},Xt=function(e){var t=e.active_index,o=e.is_drawer_open,i=e.setActiveTabIndex,n=function(e,t){if(null==e)return{};var o,i,n=function(e,t){if(null==e)return{};var o,i,n={},r=Object.keys(e);for(i=0;i<r.length;i++)o=r[i],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)o=r[i],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}(e,["active_index","is_drawer_open","setActiveTabIndex"]);return a.createElement(a.Fragment,null,a.createElement(l.Tabs,{active_index:t,onTabItemClick:i,top:!0},a.createElement("div",{id:"db-run-panel-tab__summary",label:(0,B.localize)("Summary")},a.createElement(Et,{is_drawer_open:o})),a.createElement("div",{id:"db-run-panel-tab__transactions",label:(0,B.localize)("Transactions")},a.createElement(Nt,{is_drawer_open:o})),a.createElement("div",{id:"db-run-panel-tab__journal",label:(0,B.localize)("Journal")},a.createElement(me,{is_drawer_open:o}))),o&&2!==t&&a.createElement(qt,n))},Zt=function(e){var t=e.is_clear_stat_disabled,o=e.onClearStatClick;return a.createElement("div",{className:"run-panel__footer"},a.createElement(l.Button,{id:"db-run-panel__clear-button",className:"run-panel__footer-button",is_disabled:t,text:(0,B.localize)("Reset"),onClick:o,has_effect:!0,secondary:!0}))},Qt=function(){return a.createElement("div",{className:"controls__section"},a.createElement("div",{className:"controls__buttons"},a.createElement(jt,{className:"controls__animation",should_show_overlay:!0,info_direction:"right"})))},eo=function(e){var t=e.is_mobile,o=e.is_statistics_info_modal_open,i=e.toggleStatisticsInfoModal;return a.createElement(l.Modal,{className:E()("statistics__modal",{"statistics__modal--mobile":t}),title:(0,B.localize)("What's this?"),is_open:o,toggleModal:i,width:"440px"},a.createElement(l.Modal.Body,null,a.createElement("div",{className:E()("statistics__modal-body",{"statistics__modal-body--mobile":t})},a.createElement(l.ThemedScrollbars,{className:"statistics__modal-scrollbar"},a.createElement(l.Text,{as:"p",weight:"bold",className:"statistics__modal-body--content no-margin"},(0,B.localize)("Total stake")),a.createElement(l.Text,{as:"p"},(0,B.localize)("Total stake since you last cleared your stats.")),a.createElement(l.Text,{as:"p",weight:"bold",className:"statistics__modal-body--content"},(0,B.localize)("Total payout")),a.createElement(l.Text,{as:"p"},(0,B.localize)("Total payout since you last cleared your stats.")),a.createElement(l.Text,{as:"p",weight:"bold",className:"statistics__modal-body--content"},(0,B.localize)("No. of runs")),a.createElement(l.Text,{as:"p"},(0,B.localize)("The number of times your bot has run since you last cleared your stats. Each run includes the execution of all the root blocks.")),a.createElement(l.Text,{as:"p",weight:"bold",className:"statistics__modal-body--content"},(0,B.localize)("Contracts lost")),a.createElement(l.Text,{as:"p"},(0,B.localize)("The number of contracts you have lost since you last cleared your stats.")),a.createElement(l.Text,{as:"p",weight:"bold",className:"statistics__modal-body--content"},(0,B.localize)("Contracts won")),a.createElement(l.Text,{as:"p"},(0,B.localize)("The number of contracts you have won since you last cleared your stats.")),a.createElement(l.Text,{as:"p",weight:"bold",className:"statistics__modal-body--content"},(0,B.localize)("Profit/loss")),a.createElement(l.Text,{as:"p"},(0,B.localize)("Your total profit/loss since you last cleared your stats. It is the difference between your total payout and your total stake."))))))},to=function(e){var t=e.active_index,o=e.currency,i=e.dialog_options,n=e.is_clear_stat_disabled,r=e.is_dialog_open,s=e.is_drawer_open,c=e.is_mobile,u=e.is_statistics_info_modal_open,p=e.lost_contracts,d=e.number_of_runs,y=e.onCancelButtonClick,m=e.onClearStatClick,h=e.onCloseDialog,_=e.onMount,g=e.onOkButtonClick,f=e.onRunButtonClick,b=e.onUnmount,k=e.setActiveTabIndex,v=e.toggleDrawer,E=e.toggleStatisticsInfoModal,T=e.total_payout,S=e.total_profit,O=e.total_stake,C=e.won_contracts;a.useEffect((function(){return _(),function(){return b()}}),[_,b]);var w=a.createElement(Xt,{active_index:t,currency:o,is_drawer_open:s,is_mobile:c,lost_contracts:p,number_of_runs:d,setActiveTabIndex:k,toggleStatisticsInfoModal:E,total_payout:T,total_profit:S,total_stake:O,won_contracts:C}),A=a.createElement(Zt,{is_clear_stat_disabled:n,onClearStatClick:m}),I=a.createElement(Kt,{is_clear_stat_disabled:n,is_mobile:c,is_drawer_open:s,onClearStatClick:m});return a.createElement(a.Fragment,null,a.createElement("div",{className:c&&s?"run-panel__container--mobile":void 0},a.createElement(l.Drawer,{anchor:"right",className:c?void 0:"run-panel__container",contentClassName:"run-panel__content",header:I,footer:!c&&A,is_open:s,toggleDrawer:v,width:366,zIndex:Ye.RUN_PANEL},w),c&&a.createElement(Qt,null)),a.createElement(l.Dialog,{title:i.title,is_visible:r,cancel_button_text:i.cancel_button_text||(0,B.localize)("Cancel"),onCancel:y,confirm_button_text:i.ok_button_text||(0,B.localize)("OK"),onConfirm:g||h,is_mobile_full_width:!1,className:"dc-dialog__wrapper--fixed",has_close_icon:!0},i.message),a.createElement(Wt,{onRunButtonClick:f}),a.createElement(eo,{is_mobile:c,is_statistics_info_modal_open:u,toggleStatisticsInfoModal:E}))};to.propTypes={active_index:p().number,currency:p().string,dialog_options:p().object,is_clear_stat_disabled:p().bool,is_dialog_open:p().bool,is_drawer_open:p().bool,is_mobile:p().bool,is_statistics_info_modal_open:p().bool,lost_contracts:p().number,number_of_runs:p().number,onCancelButtonClick:p().func,onClearStatClick:p().func,onCloseDialog:p().func,onMount:p().func,onOkButtonClick:p().func,onRunButtonClick:p().func,onUnmount:p().func,setActiveTabIndex:p().func,toggleDrawer:p().func,toggleStatisticsInfoModal:p().func,total_payout:p().number,total_profit:p().number,total_stake:p().number,won_contracts:p().number};const oo=f((function(e){var t=e.run_panel,o=e.core,i=e.ui;return{active_index:t.active_index,currency:o.client.currency,dialog_options:t.dialog_options,is_clear_stat_disabled:t.is_clear_stat_disabled,is_dialog_open:t.is_dialog_open,is_drawer_open:t.is_drawer_open,is_mobile:i.is_mobile,is_statistics_info_modal_open:t.is_statistics_info_modal_open,lost_contracts:t.statistics.lost_contracts,number_of_runs:t.statistics.number_of_runs,onCancelButtonClick:t.onCancelButtonClick,onClearStatClick:t.onClearStatClick,onCloseDialog:t.onCloseDialog,onMount:t.onMount,onOkButtonClick:t.onOkButtonClick,onRunButtonClick:t.onRunButtonClick,onUnmount:t.onUnmount,setActiveTabIndex:t.setActiveTabIndex,toggleDrawer:t.toggleDrawer,toggleStatisticsInfoModal:t.toggleStatisticsInfoModal,total_payout:t.statistics.total_payout,total_profit:t.statistics.total_profit,total_stake:t.statistics.total_stake,won_contracts:t.statistics.won_contracts}}))(to);function io(){return(io=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e}).apply(this,arguments)}var no=function(e){var t=e.bot_name,o=e.button_status,i=e.is_authorised,n=e.onConfirmSave,r=e.onDriveConnect,c=e.validateBotName,u=e.toggleSaveModal,p=e.is_mobile,d=e.is_onscreen_keyboard_active,y=e.setCurrentFocus;return a.createElement(ze.Formik,{initialValues:{is_local:!0,save_as_collection:!1,bot_name:t===s.config.default_file_name?"":t},validate:c,onSubmit:n},(function(e){var t=e.values,n=t.is_local,c=t.save_as_collection,m=e.setFieldValue,h=e.touched,_=e.errors,g=p?"calc(100%)":"500px";return a.createElement(l.ThemedScrollbars,{height:g,autohide:!0},a.createElement(ze.Form,{className:E()({"form--active-keyboard":d})},a.createElement("div",{className:"modal__content"},a.createElement("div",{className:"modal__content-row"},a.createElement(ze.Field,{name:"bot_name"},(function(e){var t=e.field;return a.createElement(l.Input,io({},t,{className:"save-type__input",type:"text",placeholder:(0,B.localize)("Untitled Strategy"),error:h[t.name]&&_[t.name],label:(0,B.localize)("Strategy name"),onFocus:function(e){return y(e.currentTarget.name)},onBlur:function(){return y(null)}}))}))),a.createElement("div",{className:"modal__content-row"},a.createElement(l.RadioGroup,{className:"radio-group__save-type",name:"is_local",selected:i?n?s.save_types.LOCAL:s.save_types.GOOGLE_DRIVE:s.save_types.LOCAL,onToggle:function(){return m("is_local",!n)}},a.createElement(l.RadioGroup.Item,{id:"local",label:a.createElement(ao,{text:(0,B.localize)("Local"),icon:a.createElement(l.Icon,{icon:p?"IcMobile":"IcDesktop",size:48})}),value:s.save_types.LOCAL}),a.createElement(l.RadioGroup.Item,{id:"drive",label:a.createElement(ao,{text:"Google Drive",icon:a.createElement(l.Icon,{icon:"IcGoogleDrive",size:48}),google_drive_connected:i,onDriveConnect:r}),value:s.save_types.GOOGLE_DRIVE,disabled:!i,className:E()({"dc-radio-group__item-disabled":!i})}))),a.createElement(a.Fragment,null,a.createElement(ze.Field,{name:"save_as_collection"},(function(e){var t=e.field;return a.createElement(l.Checkbox,io({},t,{onChange:function(){return m("save_as_collection",!c)},defaultChecked:c,label:a.createElement(l.Text,{color:"general",size:"xs",line_height:"s",weight:"bold"},a.createElement(B.Localize,{i18n_default_text:"Save as collection"})),classNameLabel:"save-type__checkbox-text"}))})),a.createElement("div",{className:"save-type__checkbox-description"},(0,B.localize)("Enabling this allows you to save your blocks as one collection which can be easily integrated into other bots.")))),a.createElement("div",{className:E()("modal__footer",{"modal__footer--active-keyboard":d})},a.createElement(l.Button,{type:"button",className:"modal__footer--button",text:(0,B.localize)("Cancel"),onClick:u,secondary:!0}),a.createElement(l.Button,{className:"modal__footer--button",type:"submit",is_loading:1===o,is_submit_success:2===o,text:(0,B.localize)("Continue"),primary:!0}))))}))},ro=function(e){var t=e.bot_name,o=e.button_status,i=e.is_authorised,n=e.is_save_modal_open,r=e.onConfirmSave,s=e.onDriveConnect,c=e.toggleSaveModal,u=e.validateBotName,p=e.is_mobile,d=e.setCurrentFocus,y=e.is_onscreen_keyboard_active;return p?a.createElement(l.MobileFullPageModal,{is_modal_open:n,className:"save-modal__wrapper",header:(0,B.localize)("Save strategy"),onClickClose:c,height_offset:"80px",page_overlay:!0},a.createElement(no,{bot_name:t,button_status:o,is_authorised:i,onConfirmSave:r,onDriveConnect:s,validateBotName:u,toggleSaveModal:c,is_mobile:p,is_onscreen_keyboard_active:y,setCurrentFocus:d})):a.createElement(l.Modal,{title:(0,B.localize)("Save Strategy"),className:"modal--save",width:"328px",height:"500px",is_open:n,toggleModal:c},a.createElement(no,{bot_name:t,button_status:o,is_authorised:i,onConfirmSave:r,onDriveConnect:s,validateBotName:u,toggleSaveModal:c,setCurrentFocus:d}))},ao=function(e){var t=e.icon,o=e.text,i=e.google_drive_connected,n=e.onDriveConnect,r="Google Drive"===o;return a.createElement("div",{className:"save-type__container"},a.createElement("div",{className:"save-type__radio"},t&&a.cloneElement(t,{className:E()("save-type__icon",{"save-type__icon--active":r&&i,"save-type__icon--disabled":r&&!i},t.props.className)}),a.createElement(l.Text,{as:"p",align:"center",size:"xxs",color:r&&!i?"disabled":"prominent",line_height:"s",className:"save-type__radio-text"},(0,B.localize)(o))),r&&a.createElement(l.Text,{as:"p",align:"center",size:"xs",weight:"bold",styles:{color:"var(--brand-red-coral)"},className:"save-type__drive-status",onClick:n},(0,B.localize)(i?(0,B.localize)("Disconnect"):(0,B.localize)("Connect"))))};ro.propTypes={button_status:p().number,is_authorised:p().bool,is_mobile:p().bool,is_save_modal_open:p().bool,onConfirmSave:p().func,onDriveConnect:p().func,toggleSaveModal:p().func,bot_name:p().string,setCurrentFocus:p().func};const lo=f((function(e){var t=e.save_modal,o=e.google_drive,i=e.ui;return{button_status:t.button_status,is_authorised:o.is_authorised,is_mobile:i.is_mobile,is_save_modal_open:t.is_save_modal_open,is_onscreen_keyboard_active:i.is_onscreen_keyboard_active,onConfirmSave:t.onConfirmSave,onDriveConnect:t.onDriveConnect,toggleSaveModal:t.toggleSaveModal,validateBotName:t.validateBotName,bot_name:t.bot_name,setCurrentFocus:i.setCurrentFocus}}))(ro);function so(){return(so=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e}).apply(this,arguments)}var co=function(e){var t=e.popover_message,o=e.icon,i=e.icon_id,n=e.icon_color,r=e.iconOnClick;return a.createElement(l.Popover,{alignment:"bottom",message:t,zIndex:Ye.TOOLBAR,should_disable_pointer_events:!0},a.createElement(l.Icon,so({icon:o,id:i,className:"toolbar__icon",onClick:r},n?{color:n}:null)))},uo=function(e){var t=e.popover_message,o=e.button_id,i=e.button_classname,n=e.buttonOnClick,r=e.icon,s=e.button_text;return a.createElement(l.Popover,{alignment:"bottom",message:t,should_disable_pointer_events:!0},a.createElement(l.Button,{id:o,className:i,has_effect:!0,onClick:n,icon:r,green:!0},s))},po=function(e){var t=e.has_redo_stack,o=e.has_undo_stack,i=e.onResetClick,n=e.onSortClick,r=e.onUndoClick,l=e.onZoomInOutClick,s=e.toggleLoadModal,c=e.toggleSaveModal;return a.createElement("div",{className:"toolbar__group toolbar__group-btn"},a.createElement(co,{popover_message:(0,B.localize)("Reset"),icon:"IcReset",icon_id:"db-toolbar__reset-button",iconOnClick:i}),a.createElement(co,{popover_message:(0,B.localize)("Import"),icon:"IcFolderOpen",icon_id:"db-toolbar__import-button",iconOnClick:s}),a.createElement(co,{popover_message:(0,B.localize)("Save"),icon:"IcSave",icon_id:"db-toolbar__save-button",iconOnClick:c}),a.createElement("div",{className:"vertical-divider"}),a.createElement(co,{popover_message:(0,B.localize)("Undo"),icon:"IcUndo",icon_id:"db-toolbar__undo-button",icon_color:o?void 0:"disabled",iconOnClick:function(){return r(!1)}}),a.createElement(co,{popover_message:(0,B.localize)("Redo"),icon:"IcRedo",icon_id:"db-toolbar__redo-button",icon_color:t?void 0:"disabled",iconOnClick:function(){return r(!0)}}),a.createElement(co,{popover_message:(0,B.localize)("Sort"),icon:"IcSort",icon_id:"db-toolbar__sort-button",iconOnClick:n}),a.createElement(co,{popover_message:(0,B.localize)("Zoom in"),icon:"IcZoomIn",icon_id:"db-toolbar__zoom-in-button",iconOnClick:function(){return l(!0)}}),a.createElement(co,{popover_message:(0,B.localize)("Zoom out"),icon:"IcZoomOut",icon_id:"db-toolbar__zoom-out",iconOnClick:function(){return l(!1)}}))},yo=function(e){e.onMount,e.onUnmount;var t=function(e,t){if(null==e)return{};var o,i,n=function(e,t){if(null==e)return{};var o,i,n={},r=Object.keys(e);for(i=0;i<r.length;i++)o=r[i],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)o=r[i],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}(e,["onMount","onUnmount"]),o=t.is_mobile,i=t.is_running,n=t.active_tab,r=t.is_dialog_open,s=t.onOkButtonClick,c=t.closeResetDialog,u=t.toggleStrategyModal,p=t.toggleLoadModal,d=t.toggleSaveModal;return a.createElement(a.Fragment,null,o?a.createElement("div",{className:"toolbar"},a.createElement("div",{className:"toolbar__section"},a.createElement(uo,{button_id:"db-toolbar__import-button--mobile",button_classname:"toolbar__btn--icon",buttonOnClick:p,icon:a.createElement(l.Icon,{icon:"IcFolderOpenFilled",color:"active",size:16}),button_text:(0,B.localize)("Load")}),a.createElement(uo,{button_id:"db-toolbar__quick-strategy-button--mobile",button_classname:"toolbar__btn--icon",buttonOnClick:u,icon:a.createElement(l.Icon,{icon:"IcPuzzle",color:"active",size:16}),button_text:(0,B.localize)("Quick")}),a.createElement(uo,{button_id:"db-toolbar__save-button--mobile",button_classname:"toolbar__btn--icon",buttonOnClick:d,icon:a.createElement(l.Icon,{icon:"IcSaveFilled",color:"active",size:16}),button_text:(0,B.localize)("Save")}))):a.createElement(l.ThemedScrollbars,{height:"56px",is_only_horizontal:!0,width:"100%"},a.createElement("div",{className:"toolbar"},a.createElement("div",{className:"toolbar__section"},a.createElement(uo,{popover_message:(0,B.localize)("Click here to start building your DBot."),button_id:"db-toolbar__get-started-button",button_classname:"toolbar__btn toolbar__btn--icon toolbar__btn--start",buttonOnClick:u,icon:a.createElement(l.Icon,{icon:"IcPuzzle",color:"active"}),button_text:(0,B.localize)("Quick strategy")}),n===T.WORKSPACE&&a.createElement(po,t)),a.createElement("div",{className:"toolbar__section"},a.createElement(jt,{className:"toolbar__animation",should_show_overlay:!0,info_direction:"left"})))),a.createElement(lo,null),a.createElement(Pe,null),a.createElement(l.Dialog,{title:(0,B.localize)("Are you sure?"),is_visible:r,confirm_button_text:i?(0,B.localize)("Yes"):(0,B.localize)("OK"),onConfirm:s,cancel_button_text:i?(0,B.localize)("No"):(0,B.localize)("Cancel"),onCancel:c,is_mobile_full_width:!1,className:"toolbar__dialog dc-dialog__wrapper--fixed",has_close_icon:!0},i?a.createElement(B.Localize,{i18n_default_text:"DBot will not proceed with any new trades. Any ongoing trades will be completed by our system. Any unsaved changes will be lost.<0>Note: Please check your statement to view completed transactions.</0>",components:[a.createElement("div",{key:0,className:"toolbar__dialog-text--second"})]}):(0,B.localize)("Any unsaved changes will be lost.")))};yo.propTypes={active_tab:p().string,file_name:p().string,has_redo_stack:p().bool,has_undo_stack:p().bool,is_dialog_open:p().bool,is_drawer_open:p().bool,is_running:p().bool,is_search_loading:p().bool,is_stop_button_disabled:p().bool,is_stop_button_visible:p().bool,closeResetDialog:p().func,onGoogleDriveClick:p().func,onMount:p().func,onOkButtonClick:p().func,onResetClick:p().func,onRunButtonClick:p().func,onSortClick:p().func,onStopButtonClick:p().func,onUndoClick:p().func,onUnmount:p().func,onZoomInOutClick:p().func,toggleSaveLoadModal:p().func};const mo=f((function(e){var t=e.main_content,o=e.run_panel,i=e.save_modal,n=e.load_modal,r=e.toolbar,a=e.ui,l=e.quick_strategy;return{active_tab:t.active_tab,file_name:r.file_name,has_redo_stack:r.has_redo_stack,has_undo_stack:r.has_undo_stack,is_dialog_open:r.is_dialog_open,is_drawer_open:o.is_drawer_open,is_mobile:a.is_mobile,is_running:o.is_running,is_search_loading:r.is_search_loading,is_stop_button_disabled:o.is_stop_button_disabled,is_stop_button_visible:o.is_stop_button_visible,closeResetDialog:r.closeResetDialog,onGoogleDriveClick:r.onGoogleDriveClick,onMount:r.onMount,onOkButtonClick:r.onResetOkButtonClick,onResetClick:r.onResetClick,onRunButtonClick:o.onRunButtonClick,onSortClick:r.onSortClick,onStopButtonClick:o.onStopButtonClick,onUndoClick:r.onUndoClick,onUnmount:r.onUnmount,onZoomInOutClick:r.onZoomInOutClick,toggleLoadModal:n.toggleLoadModal,toggleSaveModal:i.toggleSaveModal,toggleStrategyModal:l.toggleStrategyModal}}))(yo);var ho,_o,go,fo,bo,ko,vo,Eo,Bo,To,So,Oo,Co=o(2965);function wo(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function Ao(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var Io,Ro,Do,No,xo,Po,zo={},Lo=(ho=Co.action.bound,_o=Co.action.bound,go=Co.action.bound,fo=Co.action.bound,bo=Co.action.bound,ko=Co.action.bound,vo=Co.action.bound,Bo=Ao((Eo=function(){function e(t){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),wo(this,"symbol",Bo,this),wo(this,"is_chart_loading",To,this),wo(this,"chart_type",So,this),wo(this,"granularity",Oo,this),this.wsSubscribe=function(e,t){if(1===e.subscribe){var o=JSON.stringify(e),i=Io.subscribeTicksHistory(e,t);zo[o]=i}},this.wsForget=function(e){var t=JSON.stringify(e);zo[t]&&(zo[t].unsubscribe(),delete zo[t])},this.wsForgetStream=function(e){Io.forgetStream(e)},this.wsSendRequest=function(e){return e.time?s.ServerTime.timePromise().then((function(){return{msg_type:"time",time:s.ServerTime.get().unix()}})):e.active_symbols?Io.activeSymbols():Io.storage.send(e)},this.root_store=t,Io=t.ws;var i=t.run_panel;(0,Co.reaction)((function(){return i.is_running}),(function(){return i.is_running?o.onStartBot():o.onStopBot()}))}var t;return(t=[{key:"is_contract_ended",get:function(){var e=this.root_store.transactions;return e.contracts.length>0&&e.contracts[0].is_ended}},{key:"onStartBot",value:function(){this.updateSymbol()}},{key:"onStopBot",value:function(){}},{key:"updateSymbol",value:function(){var e=Blockly.derivWorkspace.getAllBlocks().find((function(e){return"trade_definition_market"===e.type}));if(e&&"na"!==e){var t=e.getFieldValue("SYMBOL_LIST");this.symbol=t}}},{key:"onSymbolChange",value:function(e){this.symbol=e}},{key:"updateGranularity",value:function(e){this.granularity=e}},{key:"updateChartType",value:function(e){this.chart_type=e}},{key:"setChartStatus",value:function(e){this.is_chart_loading=e}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}()).prototype,"symbol",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),To=Ao(Eo.prototype,"is_chart_loading",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),So=Ao(Eo.prototype,"chart_type",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oo=Ao(Eo.prototype,"granularity",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ao(Eo.prototype,"is_contract_ended",[Co.computed],Object.getOwnPropertyDescriptor(Eo.prototype,"is_contract_ended"),Eo.prototype),Ao(Eo.prototype,"onStartBot",[ho],Object.getOwnPropertyDescriptor(Eo.prototype,"onStartBot"),Eo.prototype),Ao(Eo.prototype,"onStopBot",[_o],Object.getOwnPropertyDescriptor(Eo.prototype,"onStopBot"),Eo.prototype),Ao(Eo.prototype,"updateSymbol",[go],Object.getOwnPropertyDescriptor(Eo.prototype,"updateSymbol"),Eo.prototype),Ao(Eo.prototype,"onSymbolChange",[fo],Object.getOwnPropertyDescriptor(Eo.prototype,"onSymbolChange"),Eo.prototype),Ao(Eo.prototype,"updateGranularity",[bo],Object.getOwnPropertyDescriptor(Eo.prototype,"updateGranularity"),Eo.prototype),Ao(Eo.prototype,"updateChartType",[ko],Object.getOwnPropertyDescriptor(Eo.prototype,"updateChartType"),Eo.prototype),Ao(Eo.prototype,"setChartStatus",[vo],Object.getOwnPropertyDescriptor(Eo.prototype,"setChartStatus"),Eo.prototype),Eo);function Mo(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function Fo(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var Uo,jo,Vo,Jo,Ho=(Ro=Co.action.bound,Do=Co.action.bound,xo=Fo((No=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getSuccessJournalMessage=function(e,t){var o=t.profit,i=t.sold_for,n=t.longcode,r=t.transaction_id;switch(e){case s.log_types.LOAD_BLOCK:return(0,B.localize)("Blocks are loaded successfully");case s.log_types.NOT_OFFERED:return(0,B.localize)("Resale of this contract is not offered.");case s.log_types.PURCHASE:return(0,B.localize)("Bought: {{longcode}} (ID: {{transaction_id}})",{longcode:n,transaction_id:r});case s.log_types.SELL:return(0,B.localize)("Sold for: {{sold_for}}",{sold_for:i});case s.log_types.PROFIT:return(0,B.localize)("Profit amount: {{profit}}",{profit:o});case s.log_types.LOST:return(0,B.localize)("Loss amount: {{profit}}",{profit:o});case s.log_types.WELCOME_BACK:return(0,B.localize)("Welcome back! Your messages have been restored.");default:return null}},Mo(this,"onClickDownloadTransaction",xo,this),Mo(this,"onClickDownloadJournal",Po,this),this.root_store=t}).prototype,"onClickDownloadTransaction",[Ro],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=[[(0,B.localize)("Market"),(0,B.localize)("Reference ID (buy)"),(0,B.localize)("Reference ID (sell)"),(0,B.localize)("Barrier"),(0,B.localize)("Start Time"),(0,B.localize)("Entry Spot"),(0,B.localize)("Entry Spot Time"),(0,B.localize)("Exit Spot"),(0,B.localize)("Exit Spot Time"),(0,B.localize)("Buy Price"),(0,B.localize)("Profit/Loss")]];e.root_store.transactions.transactions.forEach((function(e){return t.push([e.data.display_name,e.data.transaction_ids.buy,e.data.transaction_ids.sell,e.data.barrier,e.data.date_start,e.data.entry_tick,e.data.entry_tick_time,e.data.exit_tick,e.data.exit_tick_time,e.data.buy_price,e.data.profit])}));var o="data:text/csv;charset=utf-8, ".concat(t.map((function(e){return e.join(",")})).join("\n")),i=encodeURI(o),n=document.createElement("a");n.setAttribute("href",i),n.setAttribute("download",(0,B.localize)("Transactions.csv")),document.body.appendChild(n),n.click(),n.parentNode.removeChild(n)}}}),Po=Fo(No.prototype,"onClickDownloadJournal",[Do],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=[[(0,B.localize)("Date"),(0,B.localize)("Time"),(0,B.localize)("Message")]];e.root_store.journal.filtered_messages.map((function(o){var i;i="success"!==o.message_type?JSON.stringify(o.message):e.getSuccessJournalMessage(o.message.toString(),o.extra);var n=[o.date,o.time,i.replace("&#x2F;","/")];t.push(n)}));var o="data:text/csv;charset=utf-8, ".concat(t.map((function(e){return e.join(",")})).join("\n")),i=encodeURI(o),n=document.createElement("a");n.setAttribute("href",i),n.setAttribute("download",(0,B.localize)("Journal.csv")),document.body.appendChild(n),n.click(),n.parentNode.removeChild(n)}}}),No);const $o=(Vo=function(e){try{var t="".concat(Uo.core.client.loginid,"-").concat(Uo.server_time.unix()),o={counters:"tr:".concat(e.number_of_runs,",                ts:").concat(e.total_stake,",                py:").concat(e.total_payout,",                lc:").concat(e.lost_contracts,",                wc:").concat(e.won_contracts,",                pr:").concat(e.total_profit).replace(/\s/g,""),event:"dbot_run",run_id:t};jo(o)}catch(e){console.warn("Error pushing run data to datalayer",e)}},Jo=function(e){try{var t=e.length>0&&e[0];if(t&&t.is_completed){var o={event:"dbot_run_transaction",reference_id:t.refrence_id};jo(o)}}catch(e){console.warn("Error pushing transaction to datalayer",e)}},{init:function(e){try{var t=Uo=e,o=t.run_panel,i=t.transactions,n=o.statistics;(0,Co.reaction)((function(){return o.is_running}),(function(){return o.is_running&&Vo(n)})),(0,Co.reaction)((function(){return i.contracts}),(function(){return Jo(i.contracts)}))}catch(e){console.warn("Error initializing GTM reactions ",e)}},pushDataLayer:jo=function(e){return Uo.core.gtm.pushDataLayer(e)}});var Go,Wo,Yo,qo,Ko,Xo,Zo,Qo,ei,ti,oi,ii,ni,ri,ai,li,si,ci,ui,pi,di,yi;function mi(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function hi(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var _i,gi,fi,bi,ki,vi,Ei,Bi,Ti,Si,Oi,Ci,wi,Ai,Ii,Ri=(Go=Co.action.bound,Wo=Co.action.bound,Yo=Co.action.bound,qo=Co.action.bound,Ko=Co.action.bound,Xo=Co.action.bound,Zo=Co.action.bound,Qo=Co.action.bound,ei=Co.action.bound,ti=Co.action.bound,oi=Co.action.bound,ii=Co.action.bound,ni=Co.action.bound,ai=hi((ri=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.block_listeners=[],this.block_workspaces=[],this.flyout_min_width=440,this.options={css:!1,media:"".concat(o.p,"media/"),move:{scrollbars:!1,drag:!0,wheel:!1},zoom:{startScale:s.config.workspaces.flyoutWorkspacesStartScale},sounds:!1},mi(this,"is_help_content",ai,this),mi(this,"flyout_content",li,this),mi(this,"flyout_width",si,this),mi(this,"is_visible",ci,this),mi(this,"is_search_flyout",ui,this),mi(this,"is_loading",pi,this),mi(this,"search_term",di,this),mi(this,"selected_category",yi,this),this.root_store=t}var t;return(t=[{key:"onMount",value:function(){this.initFlyout(),window.addEventListener("click",this.onClickOutsideFlyout)}},{key:"onUnmount",value:function(){window.removeEventListener("click",this.onClickOutsideFlyout)}},{key:"initFlyout",value:function(){var e=Blockly.derivWorkspace,t={parentWorkspace:e,RTL:e.RTL,horizontalLayout:e.horizontalLayout};e.horizontalLayout?this.flyout=new Blockly.HorizontalFlyout(t):this.flyout=new Blockly.VerticalFlyout(t),this.flyout.targetWorkspace_=e,this.flyout.workspace_.targetWorkspace=e,this.flyout.workspace_.getGesture=this.flyout.targetWorkspace_.getGesture.bind(this.flyout.targetWorkspace_),e.variableMap_=this.flyout.targetWorkspace_.getVariableMap(),this.flyout.workspace_.createPotentialVariableMap(),e.flyout_=this.flyout}},{key:"initBlockWorkspace",value:function(e,t){var o=this,i=Blockly.inject(e,this.options);i.isFlyout=!0,i.targetWorkspace=Blockly.derivWorkspace;var n=Blockly.Xml.domToBlock(t,i),r=n.getHeightWidth();n.isInFlyout=!0,e.style.height="".concat(Math.ceil(r.height*this.options.zoom.startScale)+1,"px"),e.style.width="".concat(Math.ceil(r.width*this.options.zoom.startScale)+1,"px"),n.moveBy(1,1);var a=n.getSvgRoot();this.block_listeners.push(Blockly.bindEventWithChecks_(a,"mousedown",null,(function(e){$o.pushDataLayer({event:"dbot_drag_block",block_type:n.type}),o.flyout.blockMouseDown_(n)(e)})),Blockly.bindEvent_(a,"mouseout",n,n.removeSelect),Blockly.bindEvent_(a,"mouseover",n,n.addSelect)),this.block_workspaces.push(i),Blockly.svgResize(i)}},{key:"getFlyout",value:function(){return this.flyout}},{key:"setContents",value:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=20,n=e;this.block_listeners.forEach((function(e){return Blockly.unbindEvent_(e)})),this.block_workspaces.forEach((function(e){return e.dispose()})),this.block_listeners=[],this.block_workspaces=[],this.is_help_content=!1,this.search_term=o.length>i?"".concat(o.substring(0,i),"..."):o,this.flyout_content=e,this.setFlyoutWidth(n),this.setVisibility(!0),setTimeout((function(){return t.setFlyoutWidth(n)}),50)}},{key:"setFlyoutWidth",value:function(e){var t=this,o=0;e.forEach((function(e){if(e.tagName.toUpperCase()===Blockly.Xml.NODE_BLOCK){var i=Blockly.Block.getDimensions(e);e.setAttribute("width",Math.ceil(i.width*t.options.zoom.startScale)),e.setAttribute("height",Math.ceil(i.height*t.options.zoom.startScale)),o=Math.max(o,Math.ceil(i.width*t.options.zoom.startScale))}})),this.flyout_width=Math.max(this.flyout_min_width,o+65)}},{key:"setVisibility",value:function(e){this.is_visible=e,e||(this.setSelectedCategory(null),this.flyout_content=[])}},{key:"setIsSearchFlyout",value:function(e){this.is_search_flyout=e}},{key:"setSelectedCategory",value:function(e){this.selected_category=e}},{key:"getSelectedCategory",value:function(){return this.selected_category}},{key:"onClickOutsideFlyout",value:function(e){if(this.is_visible&&Blockly.derivWorkspace){var t=document.getElementById("gtm-toolbox"),o=(e.path||e.composedPath&&e.composedPath()).some((function(e){return e.classList&&e.classList.contains("flyout")})),i=this.root_store.toolbox.is_search_focus;o||t.contains(e.target)||i||(this.setVisibility(!1),this.setSelectedCategory(null))}}},{key:"refreshCategory",value:function(){var e=this.getSelectedCategory(),t=this.root_store.toolbox.getCategoryContents(e);this.setContents(t)}},{key:"variables_blocks_count",get:function(){return this.flyout_content.filter((function(e){return"variables_get"===e.getAttribute("type")})).length}},{key:"first_get_variable_block_index",get:function(){return this.flyout_content.length-this.variables_blocks_count}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}()).prototype,"is_help_content",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),li=hi(ri.prototype,"flyout_content",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),si=hi(ri.prototype,"flyout_width",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.flyout_min_width}}),ci=hi(ri.prototype,"is_visible",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ui=hi(ri.prototype,"is_search_flyout",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),pi=hi(ri.prototype,"is_loading",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),di=hi(ri.prototype,"search_term",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),yi=hi(ri.prototype,"selected_category",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hi(ri.prototype,"onMount",[Go],Object.getOwnPropertyDescriptor(ri.prototype,"onMount"),ri.prototype),hi(ri.prototype,"onUnmount",[Wo],Object.getOwnPropertyDescriptor(ri.prototype,"onUnmount"),ri.prototype),hi(ri.prototype,"initFlyout",[Yo],Object.getOwnPropertyDescriptor(ri.prototype,"initFlyout"),ri.prototype),hi(ri.prototype,"initBlockWorkspace",[qo],Object.getOwnPropertyDescriptor(ri.prototype,"initBlockWorkspace"),ri.prototype),hi(ri.prototype,"getFlyout",[Ko],Object.getOwnPropertyDescriptor(ri.prototype,"getFlyout"),ri.prototype),hi(ri.prototype,"setContents",[Xo],Object.getOwnPropertyDescriptor(ri.prototype,"setContents"),ri.prototype),hi(ri.prototype,"setFlyoutWidth",[Zo],Object.getOwnPropertyDescriptor(ri.prototype,"setFlyoutWidth"),ri.prototype),hi(ri.prototype,"setVisibility",[Qo],Object.getOwnPropertyDescriptor(ri.prototype,"setVisibility"),ri.prototype),hi(ri.prototype,"setIsSearchFlyout",[ei],Object.getOwnPropertyDescriptor(ri.prototype,"setIsSearchFlyout"),ri.prototype),hi(ri.prototype,"setSelectedCategory",[ti],Object.getOwnPropertyDescriptor(ri.prototype,"setSelectedCategory"),ri.prototype),hi(ri.prototype,"getSelectedCategory",[oi],Object.getOwnPropertyDescriptor(ri.prototype,"getSelectedCategory"),ri.prototype),hi(ri.prototype,"onClickOutsideFlyout",[ii],Object.getOwnPropertyDescriptor(ri.prototype,"onClickOutsideFlyout"),ri.prototype),hi(ri.prototype,"refreshCategory",[ni],Object.getOwnPropertyDescriptor(ri.prototype,"refreshCategory"),ri.prototype),hi(ri.prototype,"variables_blocks_count",[Co.computed],Object.getOwnPropertyDescriptor(ri.prototype,"variables_blocks_count"),ri.prototype),hi(ri.prototype,"first_get_variable_block_index",[Co.computed],Object.getOwnPropertyDescriptor(ri.prototype,"first_get_variable_block_index"),ri.prototype),ri);function Di(e,t,o,i,n,r,a){try{var l=e[r](a),s=l.value}catch(e){return void o(e)}l.done?t(s):Promise.resolve(s).then(i,n)}function Ni(e){return function(){var t=this,o=arguments;return new Promise((function(i,n){var r=e.apply(t,o);function a(e){Di(r,i,n,a,l,"next",e)}function l(e){Di(r,i,n,a,l,"throw",e)}a(void 0)}))}}function xi(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function Pi(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var zi,Li,Mi,Fi,Ui,ji=(_i=Co.action.bound,gi=Co.action.bound,fi=Co.action.bound,bi=Co.action.bound,ki=Co.action.bound,vi=Co.action.bound,Bi=Pi((Ei=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={css:!1,media:"".concat(o.p,"media/"),move:{scrollbars:!1,drag:!0,wheel:!1},zoom:{startScale:s.config.workspaces.flyoutWorkspacesStartScale},sounds:!1},xi(this,"block_node",Bi,this),xi(this,"block_type",Ti,this),xi(this,"help_string",Si,this),xi(this,"title",Oi,this),xi(this,"should_next_disable",Ci,this),xi(this,"should_previous_disable",wi,this),xi(this,"active_helper",Ai,this),xi(this,"setHelpContent",Ii,this),this.getHelpContent=function(){var e=Ni(regeneratorRuntime.mark((function e(t){var n,r,a,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(o.bind(o,6585));case 2:return r=e.sent,t&&(a=i.xml_list_group[t],l=a[0].getAttribute("type"),n=r[l]),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getFilledBlocksIndex=function(){var e=Ni(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((function(e){return i.getHelpContent(e)})));case 2:return o=e.sent,e.abrupt("return",o.map((function(e,t){return e?t:null})).filter((function(e){return null!==e})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getNextHelpContentIndex=function(){var e=Ni(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.getFilledBlocksIndex(Object.keys(i.xml_list_group));case 2:return o=e.sent,e.abrupt("return",t?o[o.length-1]:o[0]);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.root_store=t}var t,i,n,r;return t=e,(i=[{key:"setActiveHelper",value:function(e){this.active_helper=e}},{key:"onBackClick",value:function(){var e=this.root_store,t=e.toolbox,o=e.flyout;if(o.is_search_flyout){var i=document.getElementsByName("search")[0].value;t.onSearch({search:i})}else o.refreshCategory()}},{key:"onSequenceClick",value:(r=Ni(regeneratorRuntime.mark((function e(t){var i,n,r,a,l,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Array.from(this.xml_list).find((function(e){return e.getAttribute("type")===s.block_type})),Object.keys(this.xml_list_group).forEach((function(e,t){i.getAttribute("type")===e&&(n=t)})),r=function(){var e=Ni(regeneratorRuntime.mark((function e(t,i,n){var a,l,c,u,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i+(n?1:-1),l=Object.keys(t).filter((function(e,t){return n?a<=t:a>=t})),e.next=4,s.getFilledBlocksIndex(l);case 4:if(c=e.sent,u=n?c[0]:c[c.length-1],p=l[u]){e.next=9;break}return e.abrupt("return",!1);case 9:return e.prev=9,e.next=12,Promise.resolve().then(o.bind(o,6585));case 12:return e.abrupt("return",p);case 15:return e.prev=15,e.t0=e.catch(9),e.abrupt("return",r(t,a,n));case 18:case"end":return e.stop()}}),e,null,[[9,15]])})));return function(t,o,i){return e.apply(this,arguments)}}(),e.next=5,r(this.xml_list_group,n,t);case 5:(a=e.sent)&&(l=this.xml_list_group[a],this.setHelpContent(l[0]));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"initFlyoutHelp",value:function(e){var t=this.root_store,o=t.flyout,i=t.toolbox;this.xml_list=i.getCategoryContents(o.selected_category),this.xml_list_group=this.groupBy(this.xml_list,!0),this.setHelpContent(e)}},{key:"updateSequenceButtons",value:(n=Ni(regeneratorRuntime.mark((function e(){var t,o,i,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.xml_list).find((function(e){return e.getAttribute("type")===r.block_type})),o=Object.keys(this.xml_list_group).findIndex((function(e){return t.getAttribute("type")===e})),e.next=4,this.getNextHelpContentIndex(!0);case 4:return i=e.sent,e.next=7,this.getNextHelpContentIndex(!1);case 7:n=e.sent,(0,Co.runInAction)((function(){r.should_previous_disable=0===o||o===n,r.should_next_disable=o===Object.keys(r.xml_list_group).length-1||o===i}));case 9:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"groupBy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Array.from(e).reduce((function(e,o){var i=o.getAttribute("type");return t&&null===i||(e[i]||(e[i]=[]),(!t||t&&null!==i)&&e[i].push(o)),e}),{})}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(t.prototype,i),e}()).prototype,"block_node",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ti=Pi(Ei.prototype,"block_type",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Si=Pi(Ei.prototype,"help_string",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Oi=Pi(Ei.prototype,"title",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ci=Pi(Ei.prototype,"should_next_disable",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),wi=Pi(Ei.prototype,"should_previous_disable",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ai=Pi(Ei.prototype,"active_helper",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ii=Pi(Ei.prototype,"setHelpContent",[_i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Ni(regeneratorRuntime.mark((function t(i){var n,r,a,l,c,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Blockly.Block.getDimensions(i),r=i.getAttribute("type"),a=Blockly.Blocks[r].meta().display_name,""!==r&&(e.active_helper=r),t.next=6,Promise.resolve().then(o.bind(o,6585));case 6:l=t.sent,c=s.config.workspaces.flyoutWorkspacesStartScale,i.setAttribute("width",n.width*c),i.setAttribute("height",n.height*c),u=e.root_store.flyout,(0,Co.runInAction)((function(){u.is_help_content=!0,e.block_node=i,e.block_type=r,e.title=a,e.help_string=l[r]})),u.is_search_flyout||e.updateSequenceButtons();case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),Pi(Ei.prototype,"setActiveHelper",[gi],Object.getOwnPropertyDescriptor(Ei.prototype,"setActiveHelper"),Ei.prototype),Pi(Ei.prototype,"onBackClick",[fi],Object.getOwnPropertyDescriptor(Ei.prototype,"onBackClick"),Ei.prototype),Pi(Ei.prototype,"onSequenceClick",[bi],Object.getOwnPropertyDescriptor(Ei.prototype,"onSequenceClick"),Ei.prototype),Pi(Ei.prototype,"initFlyoutHelp",[ki],Object.getOwnPropertyDescriptor(Ei.prototype,"initFlyoutHelp"),Ei.prototype),Pi(Ei.prototype,"updateSequenceButtons",[vi],Object.getOwnPropertyDescriptor(Ei.prototype,"updateSequenceButtons"),Ei.prototype),Ei),Vi=Object.freeze({NORMAL:0,LOADING:1,COMPLETED:2});function Ji(e,t,o,i,n,r,a){try{var l=e[r](a),s=l.value}catch(e){return void o(e)}l.done?t(s):Promise.resolve(s).then(i,n)}function Hi(e){return function(){var t=this,o=arguments;return new Promise((function(i,n){var r=e.apply(t,o);function a(e){Ji(r,i,n,a,l,"next",e)}function l(e){Ji(r,i,n,a,l,"throw",e)}a(void 0)}))}}function $i(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var Gi,Wi,Yi,qi,Ki,Xi,Zi,Qi,en,tn,on,nn,rn,an=(zi=Co.action.bound,Li=Co.action.bound,Mi=Co.action.bound,Ui=$i((Fi=function(){function e(t){var o,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Ui)&&Object.defineProperty(this,"is_authorised",{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(this):void 0}),this.setKey=function(){var e=s.config.gd,t=e.aid,o=e.cid,n=e.api;i.client_id=o,i.app_id=t,i.api_key=n},this.root_store=t,this.bot_folder_name="Binary Bot - ".concat((0,B.localize)("Strategies")),this.google_auth=null,this.setKey(),(0,s.importExternal)("https://apis.google.com/js/api.js").then((function(){return i.initialise()}))}var t,o,i,n,r;return t=e,(o=[{key:"initialise",value:function(){var e=this;gapi.load("client:auth2:picker",{callback:function(){gapi.client.init({apiKey:e.api_key,clientId:e.client_id,scope:"https://www.googleapis.com/auth/drive",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]}).then((function(){e.google_auth=gapi.auth2.getAuthInstance(),e.google_auth.isSignedIn.listen((function(t){return e.updateSigninStatus(t)})),e.updateSigninStatus(e.google_auth.isSignedIn.get())}),(function(e){console.warn(e)}))},onerror:console.warn})}},{key:"updateSigninStatus",value:function(e){this.is_authorised=e}},{key:"signIn",value:function(){return this.is_authorised?Promise.resolve():this.google_auth.signIn({prompt:"select_account"}).catch((function(e){"access_denied"===e.error&&console.error("Please grant permission to view and manage Google Drive folders created with Deriv Bot")}))}},{key:"signOut",value:function(){return this.is_authorised?this.google_auth.signOut():Promise.resolve()}},{key:"getPickerLanguage",value:function(){var e=(0,B.getLanguage)();return"zhTw"===e?"zh-TW":"zhCn"===e?"zh-CN":e}},{key:"saveFile",value:(r=Hi(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.signIn();case 2:return e.next=4,this.checkFolderExists();case 4:return e.next=6,this.createSaveFilePicker("application/vnd.google-apps.folder",(0,B.localize)("Select a folder"),t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"loadFile",value:(n=Hi(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.signIn();case 2:return e.next=4,this.createLoadFilePicker(["text/xml","application/xml"],(0,B.localize)("Select a Deriv Bot Strategy"));case 4:return t=e.sent,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"checkFolderExists",value:(i=Hi(regeneratorRuntime.mark((function e(){var t,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=gapi.client.drive.files,e.next=3,t.list({q:"trashed=false"});case 3:if(o=e.sent,i="application/vnd.google-apps.folder",!o.result.files.find((function(e){return e.mimeType===i}))){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,t.create({resource:{name:this.bot_folder_name,mimeType:i,fields:"id"}});case 10:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"createSaveFilePicker",value:function(e,t,o){var i=this,n=this.root_store.save_modal.setButtonStatus;return new Promise((function(r){i.showGoogleDriveFilePicker(!0,e,t,(function(e){if(e.action===google.picker.Action.PICKED){var t=e.docs[0].id,a=new Blob([o.content],{type:o.mimeType}),l=JSON.stringify({name:o.name,mimeType:o.mimeType,parents:[t]}),s=new FormData;s.append("metadata",new Blob([l],{type:"application/json"})),s.append("file",a);var c=new XMLHttpRequest;c.responseType="json",c.open("POST","https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart"),c.setRequestHeader("Authorization","Bearer ".concat(gapi.auth.getToken().access_token)),c.onload=function(){401===c.status&&i.signOut(),n(Vi.NORMAL),r()},c.send(s)}else e.action===google.picker.Action.CANCEL&&n(Vi.NORMAL)}))}))}},{key:"createLoadFilePicker",value:function(e,t){var o=this;return new Promise((function(i){var n=function(){var e=Hi(regeneratorRuntime.mark((function e(t){var o,n,r,a,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.action!==google.picker.Action.PICKED){e.next=9;break}return o=t.docs[0],n=o.name,r=o.id,a=gapi.client.drive.files,e.next=7,a.get({alt:"media",fileId:r,mimeType:"text/plain"});case 7:l=e.sent,i({xml_doc:l.body,file_name:n});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();o.showGoogleDriveFilePicker(!1,e,t,n)}))}},{key:"showGoogleDriveFilePicker",value:function(e,t,o,i){var n=new google.picker.DocsView;n.setIncludeFolders(!0),n.setMimeTypes(t),e&&n.setSelectFolderEnabled(!0),(new google.picker.PickerBuilder).setOrigin("".concat(window.location.protocol,"//").concat(window.location.host)).setTitle((0,B.localize)(o)).setLocale(this.getPickerLanguage()).setAppId(this.app_id).setOAuthToken(gapi.auth.getToken().access_token).addView(n).setDeveloperKey(this.api_key).setSize(1051,650).setCallback(i).build().setVisible(!0)}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(t.prototype,o),e}()).prototype,"is_authorised",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),$i(Fi.prototype,"updateSigninStatus",[zi],Object.getOwnPropertyDescriptor(Fi.prototype,"updateSigninStatus"),Fi.prototype),$i(Fi.prototype,"saveFile",[Li],Object.getOwnPropertyDescriptor(Fi.prototype,"saveFile"),Fi.prototype),$i(Fi.prototype,"loadFile",[Mi],Object.getOwnPropertyDescriptor(Fi.prototype,"loadFile"),Fi.prototype),Fi),ln=o(9789),sn=function(){return JSON.parse(localStorage.getItem("dbot_settings"))},cn=function(e){var t=sn();return t?t[e]:null},un=function(e,t){var o=sn()||{};o[e]=t,localStorage.setItem("dbot_settings",JSON.stringify(o))},pn=function(e,t,o,i){o(function(e){var t=e.unique_id,o=e.type,i=e.message,n=e.btn_text,r=e.onClick;return a.createElement(a.Fragment,null,a.createElement("div",{key:"".concat(t,"_message"),className:"notify__item-container"},a.createElement(l.Icon,{key:"".concat(t,"_icon"),icon:ot(o),size:"22"}),a.createElement("div",{key:"".concat(t,"_text"),className:"notify__item-message"},i)),a.createElement(l.Button,{key:"".concat(t,"_btn"),className:"notify__item-button",text:n,onClick:r,has_effect:!0,secondary:!0}))}({unique_id:t,type:"error",message:e,btn_text:(0,B.localize)("Go to block"),onClick:function(){i()}}))},dn=function e(t){return t.map((function(t){return{id:(new Date).getTime()*Math.random(),value:t&&Array.isArray(t)?e(t):t}}))},yn=o(6954),mn=o.n(yn),hn=function(e,t,o){return t&&_n(e,o)[t]||o},_n=function(e,t){try{var o=sessionStorage.getItem(e),i=mn().decompress(o),n=JSON.parse(i);if(n)return n}catch(e){}return t},gn=function(e,t){try{var o=mn().compress(JSON.stringify(t));sessionStorage.setItem(e,o)}catch(e){console.warn("Could not write to storage.")}};function fn(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function bn(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var kn,vn,En,Bn,Tn,Sn,On,Cn,wn,An,In,Rn,Dn,Nn,xn,Pn,zn,Ln,Mn,Fn,Un,jn,Vn,Jn,Hn=(Gi=Co.observable.shallow,Wi=Co.observable.shallow,Yi=Co.action.bound,qi=Co.action.bound,Ki=Co.action.bound,Xi=Co.action.bound,Zi=Co.action.bound,Qi=Co.action.bound,en=Co.action.bound,on=bn((tn=function(){function e(t){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.JOURNAL_CACHE="journal_cache",fn(this,"is_filter_dialog_visible",on,this),fn(this,"journal_filters",nn,this),fn(this,"unfiltered_messages",rn,this),this.playAudio=function(e){e!==ln.v.lists.NOTIFICATION_SOUND[0][1]&&document.getElementById(e).play()},this.filters=[{id:s.message_types.ERROR,label:(0,B.localize)("Errors")},{id:s.message_types.NOTIFY,label:(0,B.localize)("Notifications")},{id:s.message_types.SUCCESS,label:(0,B.localize)("System")}],this.root_store=t,this.disposeReactionsFn=this.registerReactions(),(0,Co.when)((function(){return o.unfiltered_messages}),(function(){o.unfiltered_messages.length>0&&o.welcomeBackUser()}))}var t;return(t=[{key:"getServerTime",value:function(){return this.root_store.core.common.server_time.get()}},{key:"toggleFilterDialog",value:function(){this.is_filter_dialog_visible=!this.is_filter_dialog_visible}},{key:"onLogSuccess",value:function(e){var t=e.log_type,o=e.extra;this.pushMessage(t,s.message_types.SUCCESS,"",o)}},{key:"onError",value:function(e){this.pushMessage(e,s.message_types.ERROR)}},{key:"onNotify",value:function(e){var t=this,o=this.root_store,i=o.run_panel,n=o.dbot,r=e.message,c=e.className,u=e.message_type,p=e.sound,d=e.block_id,y=e.variable_name;(function(e,t,o,i){var n,r=e.message,s=e.block_id,c=e.variable_name;if(void 0===r&&null!=c)return pn((0,B.localize)("Variable '{{variable_name}}' has no value. Please set a value for variable '{{variable_name}}' to notify.",{variable_name:c}),s,t,o),!0;if(null===r)return i("NULL"),!0;if(Object.is(r,NaN))return pn((0,B.localize)("Tried to perform an invalid operation."),s,t,o),!0;if(Array.isArray(r)){var u=r.length;return i((n={header:"null"!==c?"".concat(c,": (").concat(u,")"):(0,B.localize)("List: ({{message_length}})",{message_length:u}),content:dn(r)},function(e){return a.createElement(l.ExpansionPanel,{message:n,onResize:e})})),!0}return"boolean"==typeof r&&(i(r.toString()),!0)})({message:r,block_id:d,variable_name:y},i.showErrorMessage,(function(){return n.centerAndHighlightBlock(d,!0)}),(function(e){return t.pushMessage(e,u||s.message_types.NOTIFY,c)}))||this.pushMessage(r,u||s.message_types.NOTIFY,c),this.playAudio(p)}},{key:"pushMessage",value:function(e,t,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=(0,ne.formatDate)(this.getServerTime()),r=(0,ne.formatDate)(this.getServerTime(),"HH:mm:ss [GMT]"),a=Blockly.utils.genUid();this.unfiltered_messages.unshift({date:n,time:r,message:e,message_type:t,className:o,unique_id:a,extra:i}),this.unfiltered_messages=this.unfiltered_messages.slice()}},{key:"filtered_messages",get:function(){var e=this;return this.unfiltered_messages.filter((function(t){return e.journal_filters.length&&e.journal_filters.some((function(e){return t.message_type===e}))}))}},{key:"checked_filters",get:function(){return this.journal_filters.filter((function(e){return null!=e}))}},{key:"filterMessage",value:function(e,t){e?this.journal_filters.push(t):this.journal_filters.splice(this.journal_filters.indexOf(t),1),un("journal_filter",this.journal_filters)}},{key:"clear",value:function(){this.unfiltered_messages=this.unfiltered_messages.slice(0,0)}},{key:"welcomeBackUser",value:function(){this.pushMessage(s.log_types.WELCOME_BACK,s.message_types.SUCCESS,"journal__text--info")}},{key:"registerReactions",value:function(){var e=this,t=this.root_store.core.client,o=(0,Co.reaction)((function(){return e.unfiltered_messages}),(function(o){var i=_n(e.JOURNAL_CACHE,{});i[t.loginid]=o.slice(0,5e3).filter((function(e){return!(e.message_type===s.message_types.SUCCESS&&e.message===s.log_types.WELCOME_BACK)})),gn(e.JOURNAL_CACHE,i)})),i=(0,Co.reaction)((function(){return t.loginid}),(function(){e.unfiltered_messages=hn(e.JOURNAL_CACHE,t.loginid,[]),e.unfiltered_messages.length>0&&e.welcomeBackUser()}));return function(){o(),i()}}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}()).prototype,"is_filter_dialog_visible",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),nn=bn(tn.prototype,"journal_filters",[Gi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return cn("journal_filter")||this.filters.map((function(e){return e.id}))}}),rn=bn(tn.prototype,"unfiltered_messages",[Wi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return hn(this.JOURNAL_CACHE,this.root_store.core.client.loginid,[])}}),bn(tn.prototype,"toggleFilterDialog",[Yi],Object.getOwnPropertyDescriptor(tn.prototype,"toggleFilterDialog"),tn.prototype),bn(tn.prototype,"onLogSuccess",[qi],Object.getOwnPropertyDescriptor(tn.prototype,"onLogSuccess"),tn.prototype),bn(tn.prototype,"onError",[Ki],Object.getOwnPropertyDescriptor(tn.prototype,"onError"),tn.prototype),bn(tn.prototype,"onNotify",[Xi],Object.getOwnPropertyDescriptor(tn.prototype,"onNotify"),tn.prototype),bn(tn.prototype,"pushMessage",[Zi],Object.getOwnPropertyDescriptor(tn.prototype,"pushMessage"),tn.prototype),bn(tn.prototype,"filtered_messages",[Co.computed],Object.getOwnPropertyDescriptor(tn.prototype,"filtered_messages"),tn.prototype),bn(tn.prototype,"checked_filters",[Co.computed],Object.getOwnPropertyDescriptor(tn.prototype,"checked_filters"),tn.prototype),bn(tn.prototype,"filterMessage",[Qi],Object.getOwnPropertyDescriptor(tn.prototype,"filterMessage"),tn.prototype),bn(tn.prototype,"clear",[en],Object.getOwnPropertyDescriptor(tn.prototype,"clear"),tn.prototype),tn);function $n(e,t,o,i,n,r,a){try{var l=e[r](a),s=l.value}catch(e){return void o(e)}l.done?t(s):Promise.resolve(s).then(i,n)}function Gn(e){return function(){var t=this,o=arguments;return new Promise((function(i,n){var r=e.apply(t,o);function a(e){$n(r,i,n,a,l,"next",e)}function l(e){$n(r,i,n,a,l,"throw",e)}a(void 0)}))}}function Wn(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function Yn(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var qn,Kn,Xn,Zn,Qn,er,tr,or,ir,nr,rr,ar,lr,sr,cr,ur,pr,dr,yr,mr,hr,_r,gr,fr,br,kr,vr,Er,Br,Tr,Sr,Or,Cr,wr,Ar,Ir,Rr,Dr,Nr=(kn=Co.action.bound,vn=Co.action.bound,En=Co.action.bound,Bn=Co.action.bound,Tn=Co.action.bound,Sn=Co.action.bound,On=Co.action.bound,Cn=Co.action.bound,wn=Co.action.bound,An=Co.action.bound,In=Co.action.bound,Rn=Co.action.bound,Dn=Co.action.bound,Nn=Co.action.bound,xn=Co.action.bound,Pn=Co.action.bound,Ln=Yn((zn=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.recent_workspace=void 0,this.local_workspace=void 0,this.drop_zone=void 0,Wn(this,"active_index",Ln,this),Wn(this,"is_load_modal_open",Mn,this),Wn(this,"is_explanation_expand",Fn,this),Wn(this,"is_open_button_loading",Un,this),Wn(this,"loaded_local_file",jn,this),Wn(this,"recent_strategies",Vn,this),Wn(this,"selected_strategy_id",Jn,this),this.getRecentFileIcon=function(e){switch(e){case s.save_types.UNSAVED:return"IcReports";case s.save_types.LOCAL:return"IcDesktop";case s.save_types.GOOGLE_DRIVE:return"IcGoogleDrive";default:return"IcReports"}},this.getSaveType=function(e){switch(e){case s.save_types.UNSAVED:return(0,B.localize)("Unsaved");case s.save_types.LOCAL:return(0,B.localize)("Local");case s.save_types.GOOGLE_DRIVE:return(0,B.localize)("Google Drive");default:return(0,B.localize)("Unsaved")}},this.readFile=function(e,t,n){var r=n&&n.name.replace(/\.[^/.]+$/,""),a=new FileReader;a.onload=(0,Co.action)((function(n){var a={block_string:n.target.result,drop_event:t,from:s.save_types.LOCAL};if(e){var l=document.getElementById("load-strategy__blockly-container");i.local_workspace=Blockly.inject(l,{media:"".concat(o.p,"media/"),zoom:{wheel:!1,startScale:s.config.workspaces.previewWorkspaceStartScale},readOnly:!0,scrollbars:!0}),a.workspace=i.local_workspace}else a.workspace=Blockly.derivWorkspace,a.file_name=r;(0,s.load)(a)})),a.readAsText(n)},this.root_store=t,(0,Co.reaction)((function(){return i.active_index}),(function(){return i.onActiveIndexChange()})),(0,Co.reaction)((function(){return i.is_load_modal_open}),function(){var e=Gn(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=11;break}return e.t0=i,e.next=4,(0,s.getSavedWorkspaces)();case 4:if(e.t1=e.sent,e.t1){e.next=7;break}e.t1=[];case 7:e.t2=e.t1,e.t0.setRecentStrategies.call(e.t0,e.t2),e.next=12;break;case 11:i.onLoadModalClose();case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var t,i,n,r;return t=e,(i=[{key:"preview_workspace",get:function(){return this.tab_name===he.TAB_LOCAL?this.local_workspace:this.tab_name===he.TAB_RECENT?this.recent_workspace:null}},{key:"selected_strategy",get:function(){var e=this;return this.recent_strategies.length>0?this.recent_strategies.find((function(t){return t.id===e.selected_strategy_id}))||this.recent_strategies[0]:null}},{key:"tab_name",get:function(){if(this.root_store.ui.is_mobile){if(0===this.active_index)return he.TAB_LOCAL;if(1===this.active_index)return he.TAB_GOOGLE}return 0===this.active_index?he.TAB_RECENT:1===this.active_index?he.TAB_LOCAL:2===this.active_index?he.TAB_GOOGLE:""}},{key:"handleFileChange",value:function(e){var t,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("drop"===e.type?(e.stopPropagation(),e.preventDefault(),t=e.dataTransfer.files):t=e.target.files,t=Array.from(t),!o){if(!t[0].name.includes("xml"))return!1;this.setLoadedLocalFile(t[0])}return this.readFile(!o,e,t[0]),e.target.value="",!0}},{key:"loadFileFromRecent",value:function(){this.is_open_button_loading=!0,this.selected_strategy?((0,s.removeExistingWorkspace)(this.selected_strategy.id),(0,s.load)({block_string:this.selected_strategy.xml,strategy_id:this.selected_strategy.id,file_name:this.selected_strategy.name,workspace:Blockly.derivWorkspace}),this.is_open_button_loading=!1,this.toggleLoadModal()):this.is_open_button_loading=!1}},{key:"loadFileFromLocal",value:function(){this.is_open_button_loading=!0,this.readFile(!1,{},this.loaded_local_file),this.is_open_button_loading=!1,this.toggleLoadModal()}},{key:"onActiveIndexChange",value:function(){var e=this;this.tab_name===he.TAB_RECENT?this.selected_strategy&&this.previewRecentStrategy(this.selected_strategy_id):this.recent_workspace&&setTimeout((function(){e.recent_workspace.dispose(),e.recent_workspace=null})),this.tab_name===he.TAB_LOCAL?this.drop_zone||(this.drop_zone=document.querySelector("load-strategy__local-dropzone-area"),this.drop_zone&&this.drop_zone.addEventListener("drop",(function(t){return e.handleFileChange(t,!1)}))):this.local_workspace&&setTimeout((function(){e.local_workspace.dispose(),e.local_workspace=null,e.setLoadedLocalFile(null)})),this.tab_name!==he.TAB_LOCAL&&this.drop_zone&&this.drop_zone.removeEventListener("drop",(function(t){return e.handleFileChange(t,!1)}))}},{key:"onDriveConnect",value:(r=Gn(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.root_store.google_drive).is_authorised?t.signOut():t.signIn();case 2:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"onDriveOpen",value:(n=Gn(regeneratorRuntime.mark((function e(){var t,o,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.root_store.google_drive.loadFile,e.next=3,t();case 3:o=e.sent,i=o.xml_doc,n=o.file_name,(0,s.load)({block_string:i,file_name:n,workspace:Blockly.derivWorkspace,from:s.save_types.GOOGLE_DRIVE}),this.toggleLoadModal();case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onEntered",value:function(){this.tab_name===he.TAB_RECENT&&this.selected_strategy&&this.previewRecentStrategy(this.selected_strategy.id)}},{key:"onLoadModalClose",value:function(){this.recent_workspace&&(this.recent_workspace.dispose(),this.recent_workspace=null),this.local_workspace&&(this.local_workspace.dispose(),this.local_workspace=null),this.setActiveTabIndex(0),this.setLoadedLocalFile(null)}},{key:"onZoomInOutClick",value:function(e){this.preview_workspace&&this.preview_workspace.zoomCenter(e?1:-1)}},{key:"previewRecentStrategy",value:function(e){if(this.setSelectedStrategyId(e),this.selected_strategy){if(!this.recent_workspace||!this.recent_workspace.rendered){var t=document.getElementById("load-strategy__blockly-container");if(!t)return void console.warn("Could not find preview workspace element.");this.recent_workspace=Blockly.inject(t,{media:"".concat(o.p,"media/"),zoom:{wheel:!0,startScale:s.config.workspaces.previewWorkspaceStartScale},readOnly:!0,scrollbars:!0})}(0,s.load)({block_string:this.selected_strategy.xml,drop_event:{},workspace:this.recent_workspace})}}},{key:"setActiveTabIndex",value:function(e){this.active_index=e}},{key:"setLoadedLocalFile",value:function(e){this.loaded_local_file=e}},{key:"setRecentStrategies",value:function(e){this.recent_strategies=e}},{key:"setSelectedStrategyId",value:function(e){this.selected_strategy_id=e}},{key:"toggleExplanationExpand",value:function(){this.is_explanation_expand=!this.is_explanation_expand}},{key:"toggleLoadModal",value:function(){this.is_load_modal_open=!this.is_load_modal_open}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(t.prototype,i),e}()).prototype,"active_index",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Mn=Yn(zn.prototype,"is_load_modal_open",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Fn=Yn(zn.prototype,"is_explanation_expand",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Un=Yn(zn.prototype,"is_open_button_loading",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),jn=Yn(zn.prototype,"loaded_local_file",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Vn=Yn(zn.prototype,"recent_strategies",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Jn=Yn(zn.prototype,"selected_strategy_id",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),Yn(zn.prototype,"preview_workspace",[Co.computed],Object.getOwnPropertyDescriptor(zn.prototype,"preview_workspace"),zn.prototype),Yn(zn.prototype,"selected_strategy",[Co.computed],Object.getOwnPropertyDescriptor(zn.prototype,"selected_strategy"),zn.prototype),Yn(zn.prototype,"tab_name",[Co.computed],Object.getOwnPropertyDescriptor(zn.prototype,"tab_name"),zn.prototype),Yn(zn.prototype,"handleFileChange",[kn],Object.getOwnPropertyDescriptor(zn.prototype,"handleFileChange"),zn.prototype),Yn(zn.prototype,"loadFileFromRecent",[vn],Object.getOwnPropertyDescriptor(zn.prototype,"loadFileFromRecent"),zn.prototype),Yn(zn.prototype,"loadFileFromLocal",[En],Object.getOwnPropertyDescriptor(zn.prototype,"loadFileFromLocal"),zn.prototype),Yn(zn.prototype,"onActiveIndexChange",[Bn],Object.getOwnPropertyDescriptor(zn.prototype,"onActiveIndexChange"),zn.prototype),Yn(zn.prototype,"onDriveConnect",[Tn],Object.getOwnPropertyDescriptor(zn.prototype,"onDriveConnect"),zn.prototype),Yn(zn.prototype,"onDriveOpen",[Sn],Object.getOwnPropertyDescriptor(zn.prototype,"onDriveOpen"),zn.prototype),Yn(zn.prototype,"onEntered",[On],Object.getOwnPropertyDescriptor(zn.prototype,"onEntered"),zn.prototype),Yn(zn.prototype,"onLoadModalClose",[Cn],Object.getOwnPropertyDescriptor(zn.prototype,"onLoadModalClose"),zn.prototype),Yn(zn.prototype,"onZoomInOutClick",[wn],Object.getOwnPropertyDescriptor(zn.prototype,"onZoomInOutClick"),zn.prototype),Yn(zn.prototype,"previewRecentStrategy",[An],Object.getOwnPropertyDescriptor(zn.prototype,"previewRecentStrategy"),zn.prototype),Yn(zn.prototype,"setActiveTabIndex",[In],Object.getOwnPropertyDescriptor(zn.prototype,"setActiveTabIndex"),zn.prototype),Yn(zn.prototype,"setLoadedLocalFile",[Rn],Object.getOwnPropertyDescriptor(zn.prototype,"setLoadedLocalFile"),zn.prototype),Yn(zn.prototype,"setRecentStrategies",[Dn],Object.getOwnPropertyDescriptor(zn.prototype,"setRecentStrategies"),zn.prototype),Yn(zn.prototype,"setSelectedStrategyId",[Nn],Object.getOwnPropertyDescriptor(zn.prototype,"setSelectedStrategyId"),zn.prototype),Yn(zn.prototype,"toggleExplanationExpand",[xn],Object.getOwnPropertyDescriptor(zn.prototype,"toggleExplanationExpand"),zn.prototype),Yn(zn.prototype,"toggleLoadModal",[Pn],Object.getOwnPropertyDescriptor(zn.prototype,"toggleLoadModal"),zn.prototype),zn),xr=Object.freeze({SUMMARY:0,TRANSACTIONS:1,JOURNAL:2}),Pr={key:"bot_switch_account",header:(0,B.localize)("You have switched accounts."),message:(0,B.localize)("Our system will finish any DBot trades that are running, and DBot will not place any new trades."),type:"warning",is_persistent:!0};function zr(e,t,o,i,n,r,a){try{var l=e[r](a),s=l.value}catch(e){return void o(e)}l.done?t(s):Promise.resolve(s).then(i,n)}function Lr(e){return function(){var t=this,o=arguments;return new Promise((function(i,n){var r=e.apply(t,o);function a(e){zr(r,i,n,a,l,"next",e)}function l(e){zr(r,i,n,a,l,"throw",e)}a(void 0)}))}}function Mr(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function Fr(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var Ur,jr,Vr,Jr,Hr,$r,Gr,Wr,Yr,qr=(qn=Co.action.bound,Kn=Co.action.bound,Xn=Co.action.bound,Zn=Co.action.bound,Qn=Co.action.bound,er=Co.action.bound,tr=Co.action.bound,or=Co.action.bound,ir=Co.action.bound,nr=Co.action.bound,rr=Co.action.bound,ar=Co.action.bound,lr=Co.action.bound,sr=Co.action.bound,cr=Co.action.bound,ur=Co.action.bound,pr=Co.action.bound,dr=Co.action.bound,yr=Co.action.bound,mr=Co.action.bound,hr=Co.action.bound,_r=Co.action.bound,gr=Co.action.bound,fr=Co.action.bound,br=Co.action.bound,kr=Co.action.bound,vr=Co.action.bound,Er=Co.action.bound,Tr=Fr((Br=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Mr(this,"active_index",Tr,this),Mr(this,"contract_stage",Sr,this),Mr(this,"dialog_options",Or,this),Mr(this,"has_open_contract",Cr,this),Mr(this,"is_running",wr,this),Mr(this,"is_statistics_info_modal_open",Ar,this),Mr(this,"is_drawer_open",Ir,this),Mr(this,"is_dialog_open",Rr,this),Mr(this,"is_sell_requested",Dr,this),this.run_id="",this.error_type=void 0,this.clear=function(){s.observer.emit("statistics.clear")},this.unregisterBotListeners=function(){s.observer.unregisterAll("bot.running"),s.observer.unregisterAll("bot.stop"),s.observer.unregisterAll("bot.trade_again"),s.observer.unregisterAll("contract.status"),s.observer.unregisterAll("bot.contract"),s.observer.unregisterAll("Error")},this.root_store=t,this.dbot=this.root_store.dbot,this.disposeReactionsFn=this.registerReactions()}var t,o,i,n;return t=e,(o=[{key:"statistics",get:function(){var e=0,t=this.root_store.transactions.transactions.reduce((function(t,o){var i=o.data;return i.is_completed&&(i.profit>0?(t.won_contracts+=1,t.total_payout+=i.payout):t.lost_contracts+=1,t.total_profit+=i.profit,t.total_stake+=i.buy_price,e+=1),t}),{lost_contracts:0,number_of_runs:0,total_profit:0,total_payout:0,total_stake:0,won_contracts:0});return t.number_of_runs=e,t}},{key:"is_stop_button_visible",get:function(){return this.is_running||this.has_open_contract}},{key:"is_stop_button_disabled",get:function(){return this.contract_stage===ae.IS_STOPPING}},{key:"is_clear_stat_disabled",get:function(){var e=this.root_store,t=e.journal,o=e.transactions;return this.is_running||this.has_open_contract||0===t.unfiltered_messages.length&&0===o.elements.length}},{key:"onRunButtonClick",value:(n=Lr(regeneratorRuntime.mark((function e(){var t,o,i,n,r,a,l,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.root_store,o=t.core,i=t.summary_card,n=t.route_prompt_dialog,r=t.self_exclusion,a=o.client,l=o.ui,this.dbot.unHighlightAllBlocks(),a.is_logged_in){e.next=6;break}return this.showLoginDialog(),e.abrupt("return");case 6:return e.next=8,r.checkRestriction();case 8:if(r.should_bot_run){e.next=11;break}return r.setIsRestricted(!0),e.abrupt("return");case 11:if(r.setIsRestricted(!1),this.registerBotListeners(),this.dbot.shouldRunBot()){e.next=16;break}return this.unregisterBotListeners(),e.abrupt("return");case 16:l.setAccountSwitcherDisabledMessage((0,B.localize)("Account switching is disabled while your bot is running. Please stop your bot before switching accounts.")),(0,Co.runInAction)((function(){s.setIsRunning(!0),l.setPromptHandler(!0,n.shouldNavigateAfterPrompt),s.toggleDrawer(!0),s.run_id="run-".concat(Date.now()),i.clear(),s.setContractStage(ae.STARTING),s.dbot.runBot()}));case 18:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onStopButtonClick",value:function(){var e=this.root_store.core.ui;this.dbot.stopBot(),e.setPromptHandler(!1),this.error_type?(this.setContractStage(ae.NOT_RUNNING),e.setAccountSwitcherDisabledMessage(!1),this.setIsRunning(!1)):this.has_open_contract?this.setContractStage(ae.IS_STOPPING):(this.setContractStage(ae.NOT_RUNNING),this.unregisterBotListeners(),e.setAccountSwitcherDisabledMessage(!1),this.setIsRunning(!1)),this.error_type&&(this.error_type=void 0)}},{key:"onClearStatClick",value:function(){this.showClearStatDialog()}},{key:"clearStat",value:function(){var e=this.root_store,t=e.summary_card,o=e.journal,i=e.transactions;this.setIsRunning(!1),this.setHasOpenContract(!1),this.clear(),o.clear(),t.clear(),i.clear(),this.setContractStage(ae.NOT_RUNNING)}},{key:"toggleStatisticsInfoModal",value:function(){this.is_statistics_info_modal_open=!this.is_statistics_info_modal_open}},{key:"toggleDrawer",value:function(e){this.is_drawer_open=e}},{key:"setActiveTabIndex",value:function(e){this.active_index=e,1!==this.active_index&&this.root_store.transactions.setActiveTransactionId(null)}},{key:"onCloseDialog",value:function(){this.is_dialog_open=!1}},{key:"showLoginDialog",value:function(){this.onOkButtonClick=this.onCloseDialog,this.onCancelButtonClick=void 0,this.dialog_options={title:(0,B.localize)("Please log in"),message:(0,B.localize)("You need to log in to run the bot.")},this.is_dialog_open=!0}},{key:"showRealAccountDialog",value:function(){this.onOkButtonClick=this.onCloseDialog,this.onCancelButtonClick=void 0,this.dialog_options={title:(0,B.localize)("DBot isn't quite ready for real accounts"),message:(0,B.localize)("Please switch to your demo account to run your DBot.")},this.is_dialog_open=!0}},{key:"showClearStatDialog",value:function(){var e=this;this.onOkButtonClick=function(){e.clearStat(),e.onCloseDialog()},this.onCancelButtonClick=this.onCloseDialog,this.dialog_options={title:(0,B.localize)("Are you sure?"),message:(0,B.localize)("This will clear all data in the summary, transactions, and journal panels. All counters will be reset to zero.")},this.is_dialog_open=!0}},{key:"showIncompatibleStrategyDialog",value:function(){this.onOkButtonClick=this.onCloseDialog,this.onCancelButtonClick=void 0,this.dialog_options={title:(0,B.localize)("Import error"),message:(0,B.localize)("This strategy is currently not compatible with DBot.")},this.is_dialog_open=!0}},{key:"registerBotListeners",value:function(){var e=this.root_store,t=e.summary_card,o=e.transactions;s.observer.register("bot.running",this.onBotRunningEvent),s.observer.register("bot.sell",this.onBotSellEvent),s.observer.register("bot.stop",this.onBotStopEvent),s.observer.register("bot.click_stop",this.onStopButtonClick),s.observer.register("bot.trade_again",this.onBotTradeAgain),s.observer.register("contract.status",this.onContractStatusEvent),s.observer.register("bot.contract",this.onBotContractEvent),s.observer.register("bot.contract",t.onBotContractEvent),s.observer.register("bot.contract",o.onBotContractEvent),s.observer.register("Error",this.onError)}},{key:"registerReactions",value:function(){var e=this,t=this.root_store.core,o=t.client,i=t.common,n=t.ui,r=function(){i.is_socket_opened?e.disposeIsSocketOpenedListener=(0,Co.reaction)((function(){return o.loginid}),(function(t){t&&e.is_running&&n.addNotificationMessage(Pr),e.dbot.terminateBot(),e.unregisterBotListeners()})):"function"==typeof e.disposeLogoutListener&&e.disposeLogoutListener()};return r(),this.disposeLogoutListener=(0,Co.reaction)((function(){return i.is_socket_opened}),(function(){return r()})),this.disposeStopBotListener=(0,Co.reaction)((function(){return!e.is_running}),(function(){e.is_running||e.setContractStage(ae.NOT_RUNNING)})),function(){"function"==typeof e.disposeIsSocketOpenedListener&&e.disposeIsSocketOpenedListener(),"function"==typeof e.disposeLogoutListener&&e.disposeLogoutListener(),"function"==typeof e.disposeStopBotListener&&e.disposeStopBotListener()}}},{key:"onBotRunningEvent",value:function(){this.setHasOpenContract(!0);var e=new Event("IgnorePWAUpdate");document.dispatchEvent(e);var t=this.root_store.self_exclusion;t.should_bot_run&&-1!==t.run_limit&&(t.run_limit-=1,t.run_limit<0&&this.onStopButtonClick())}},{key:"onBotSellEvent",value:function(){this.is_sell_requested=!0}},{key:"onBotStopEvent",value:function(){var e=this,t=this.root_store.self_exclusion,o=this.root_store.core.ui,i=function(){e.error_type=void 0,e.setIsRunning(!1),e.setContractStage(ae.NOT_RUNNING),o.setAccountSwitcherDisabledMessage(!1),e.unregisterBotListeners(),t.resetSelfExclusion()};if(this.error_type===s.error_types.RECOVERABLE_ERRORS){var n=this.dbot.interpreter.bot.tradeEngine.options,r=n.shouldRestartOnError,a=n.timeMachineEnabled;r||a?(this.error_type=void 0,this.setContractStage(ae.PURCHASE_SENT)):i()}else this.error_type===s.error_types.UNRECOVERABLE_ERRORS?i():this.has_open_contract&&(this.error_type=void 0,this.setIsRunning(!1),this.is_sell_requested=!1,this.setContractStage(ae.CONTRACT_CLOSED),o.setAccountSwitcherDisabledMessage(!1),this.unregisterBotListeners(),t.resetSelfExclusion());this.setHasOpenContract(!1);var l=new Event("ListenPWAUpdate");document.dispatchEvent(l)}},{key:"onBotTradeAgain",value:function(e){e||this.onStopButtonClick()}},{key:"onContractStatusEvent",value:function(e){switch(e.id){case"contract.purchase_sent":this.setContractStage(ae.PURCHASE_SENT);break;case"contract.purchase_received":this.setContractStage(ae.PURCHASE_RECEIVED),this.root_store.transactions.setActiveTransactionId(null);var t=e.buy;this.root_store.core.client.is_virtual||this.root_store.core.gtm.pushDataLayer({event:"dbot_purchase",buy_price:t.buy_price});break;case"contract.sold":this.is_sell_requested=!1,this.setContractStage(ae.CONTRACT_CLOSED);break;default:this.setContractStage(ae.NOT_RUNNING)}}},{key:"onClickSell",value:function(){this.dbot.interpreter.bot.getBotInterface().sellAtMarket()}},{key:"onBotContractEvent",value:function(e){null!=e&&e.is_sold&&(this.is_sell_requested=!1,this.setContractStage(ae.CONTRACT_CLOSED))}},{key:"onError",value:function(e){var t=e.error||e;s.unrecoverable_errors.includes(t.code)?(this.root_store.summary_card.clear(),this.error_type=s.error_types.UNRECOVERABLE_ERRORS):this.error_type=s.error_types.RECOVERABLE_ERRORS;var o=null==t?void 0:t.message;this.showErrorMessage(o)}},{key:"showErrorMessage",value:function(e){var t,o=this.root_store,i=o.journal,n=o.ui;i.onError(e),i.journal_filters.some((function(e){return e===s.message_types.ERROR}))?(this.toggleDrawer(!0),this.setActiveTabIndex(xr.JOURNAL)):(n.addNotificationMessage((t=this.switchToJournal,{key:"bot_error",header:(0,B.localize)("The bot encountered an error while running."),action:{text:(0,B.localize)("View in Journal"),onClick:t},type:"danger",platform:[ne.platform_name.DBot],is_disposable:!0})),n.removeNotificationMessage({key:"bot_error"}))}},{key:"switchToJournal",value:function(){var e=this.root_store,t=e.journal,o=e.ui;t.journal_filters.push(s.message_types.ERROR),this.setActiveTabIndex(xr.JOURNAL),this.toggleDrawer(!0),o.toggleNotificationsModal(),o.removeNotificationByKey({key:"bot_error"})}},{key:"setContractStage",value:function(e){this.contract_stage=e}},{key:"setHasOpenContract",value:function(e){this.has_open_contract=e}},{key:"setIsRunning",value:function(e){this.is_running=e}},{key:"onMount",value:function(){var e=this.root_store.journal;s.observer.register("ui.log.error",this.showErrorMessage),s.observer.register("ui.log.notify",e.onNotify),s.observer.register("ui.log.success",e.onLogSuccess),s.observer.register("client.invalid_token",this.handleInvalidToken)}},{key:"onUnmount",value:function(){var e=this.root_store,t=e.journal,o=e.summary_card,i=e.transactions;this.unregisterBotListeners(),this.disposeReactionsFn(),t.disposeReactionsFn(),o.disposeReactionsFn(),i.disposeReactionsFn(),s.observer.unregisterAll("ui.log.error"),s.observer.unregisterAll("ui.log.notify"),s.observer.unregisterAll("ui.log.success"),s.observer.unregisterAll("client.invalid_token")}},{key:"handleInvalidToken",value:(i=Lr(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.root_store.core.client,e.next=3,t.logout();case 3:this.setActiveTabIndex(xr.SUMMARY);case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(t.prototype,o),e}()).prototype,"active_index",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Sr=Fr(Br.prototype,"contract_stage",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ae.NOT_RUNNING}}),Or=Fr(Br.prototype,"dialog_options",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Cr=Fr(Br.prototype,"has_open_contract",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),wr=Fr(Br.prototype,"is_running",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ar=Fr(Br.prototype,"is_statistics_info_modal_open",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ir=Fr(Br.prototype,"is_drawer_open",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Rr=Fr(Br.prototype,"is_dialog_open",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Dr=Fr(Br.prototype,"is_sell_requested",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Fr(Br.prototype,"statistics",[Co.computed],Object.getOwnPropertyDescriptor(Br.prototype,"statistics"),Br.prototype),Fr(Br.prototype,"is_stop_button_visible",[Co.computed],Object.getOwnPropertyDescriptor(Br.prototype,"is_stop_button_visible"),Br.prototype),Fr(Br.prototype,"is_stop_button_disabled",[Co.computed],Object.getOwnPropertyDescriptor(Br.prototype,"is_stop_button_disabled"),Br.prototype),Fr(Br.prototype,"is_clear_stat_disabled",[Co.computed],Object.getOwnPropertyDescriptor(Br.prototype,"is_clear_stat_disabled"),Br.prototype),Fr(Br.prototype,"onRunButtonClick",[qn],Object.getOwnPropertyDescriptor(Br.prototype,"onRunButtonClick"),Br.prototype),Fr(Br.prototype,"onStopButtonClick",[Kn],Object.getOwnPropertyDescriptor(Br.prototype,"onStopButtonClick"),Br.prototype),Fr(Br.prototype,"onClearStatClick",[Xn],Object.getOwnPropertyDescriptor(Br.prototype,"onClearStatClick"),Br.prototype),Fr(Br.prototype,"clearStat",[Zn],Object.getOwnPropertyDescriptor(Br.prototype,"clearStat"),Br.prototype),Fr(Br.prototype,"toggleStatisticsInfoModal",[Qn],Object.getOwnPropertyDescriptor(Br.prototype,"toggleStatisticsInfoModal"),Br.prototype),Fr(Br.prototype,"toggleDrawer",[er],Object.getOwnPropertyDescriptor(Br.prototype,"toggleDrawer"),Br.prototype),Fr(Br.prototype,"setActiveTabIndex",[tr],Object.getOwnPropertyDescriptor(Br.prototype,"setActiveTabIndex"),Br.prototype),Fr(Br.prototype,"onCloseDialog",[or],Object.getOwnPropertyDescriptor(Br.prototype,"onCloseDialog"),Br.prototype),Fr(Br.prototype,"showLoginDialog",[ir],Object.getOwnPropertyDescriptor(Br.prototype,"showLoginDialog"),Br.prototype),Fr(Br.prototype,"showRealAccountDialog",[nr],Object.getOwnPropertyDescriptor(Br.prototype,"showRealAccountDialog"),Br.prototype),Fr(Br.prototype,"showClearStatDialog",[rr],Object.getOwnPropertyDescriptor(Br.prototype,"showClearStatDialog"),Br.prototype),Fr(Br.prototype,"showIncompatibleStrategyDialog",[ar],Object.getOwnPropertyDescriptor(Br.prototype,"showIncompatibleStrategyDialog"),Br.prototype),Fr(Br.prototype,"onBotRunningEvent",[lr],Object.getOwnPropertyDescriptor(Br.prototype,"onBotRunningEvent"),Br.prototype),Fr(Br.prototype,"onBotSellEvent",[sr],Object.getOwnPropertyDescriptor(Br.prototype,"onBotSellEvent"),Br.prototype),Fr(Br.prototype,"onBotStopEvent",[cr],Object.getOwnPropertyDescriptor(Br.prototype,"onBotStopEvent"),Br.prototype),Fr(Br.prototype,"onBotTradeAgain",[ur],Object.getOwnPropertyDescriptor(Br.prototype,"onBotTradeAgain"),Br.prototype),Fr(Br.prototype,"onContractStatusEvent",[pr],Object.getOwnPropertyDescriptor(Br.prototype,"onContractStatusEvent"),Br.prototype),Fr(Br.prototype,"onClickSell",[dr],Object.getOwnPropertyDescriptor(Br.prototype,"onClickSell"),Br.prototype),Fr(Br.prototype,"onBotContractEvent",[yr],Object.getOwnPropertyDescriptor(Br.prototype,"onBotContractEvent"),Br.prototype),Fr(Br.prototype,"onError",[mr],Object.getOwnPropertyDescriptor(Br.prototype,"onError"),Br.prototype),Fr(Br.prototype,"showErrorMessage",[hr],Object.getOwnPropertyDescriptor(Br.prototype,"showErrorMessage"),Br.prototype),Fr(Br.prototype,"switchToJournal",[_r],Object.getOwnPropertyDescriptor(Br.prototype,"switchToJournal"),Br.prototype),Fr(Br.prototype,"setContractStage",[gr],Object.getOwnPropertyDescriptor(Br.prototype,"setContractStage"),Br.prototype),Fr(Br.prototype,"setHasOpenContract",[fr],Object.getOwnPropertyDescriptor(Br.prototype,"setHasOpenContract"),Br.prototype),Fr(Br.prototype,"setIsRunning",[br],Object.getOwnPropertyDescriptor(Br.prototype,"setIsRunning"),Br.prototype),Fr(Br.prototype,"onMount",[kr],Object.getOwnPropertyDescriptor(Br.prototype,"onMount"),Br.prototype),Fr(Br.prototype,"onUnmount",[vr],Object.getOwnPropertyDescriptor(Br.prototype,"onUnmount"),Br.prototype),Fr(Br.prototype,"handleInvalidToken",[Er],Object.getOwnPropertyDescriptor(Br.prototype,"handleInvalidToken"),Br.prototype),Br);function Kr(e,t,o,i,n,r,a){try{var l=e[r](a),s=l.value}catch(e){return void o(e)}l.done?t(s):Promise.resolve(s).then(i,n)}function Xr(e){return function(){var t=this,o=arguments;return new Promise((function(i,n){var r=e.apply(t,o);function a(e){Kr(r,i,n,a,l,"next",e)}function l(e){Kr(r,i,n,a,l,"throw",e)}a(void 0)}))}}function Zr(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function Qr(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var ea,ta,oa,ia,na,ra,aa=(Ur=Co.action.bound,jr=Co.action.bound,Vr=Co.action.bound,Jr=Co.action.bound,Hr=Co.action.bound,Gr=Qr(($r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Zr(this,"is_save_modal_open",Gr,this),Zr(this,"button_status",Wr,this),Zr(this,"bot_name",Yr,this),this.validateBotName=function(e){var t={};return""===e.bot_name.trim()&&(t.bot_name=(0,B.localize)("Strategy name cannot be empty")),t},this.root_store=t}var t,o,i,n;return t=e,(o=[{key:"toggleSaveModal",value:function(){this.is_save_modal_open||this.setButtonStatus(Vi.NORMAL),this.is_save_modal_open=!this.is_save_modal_open}},{key:"onConfirmSave",value:(n=Xr(regeneratorRuntime.mark((function e(t){var o,i,n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.is_local,i=t.save_as_collection,n=t.bot_name,this.setButtonStatus(Vi.LOADING),r=this.root_store.google_drive.saveFile,(a=Blockly.Xml.workspaceToDom(Blockly.derivWorkspace)).setAttribute("is_dbot","true"),a.setAttribute("collection",i?"true":"false"),!o){e.next=10;break}(0,s.save)(n,i,a),e.next=13;break;case 10:return e.next=12,r({name:n,content:Blockly.Xml.domToPrettyText(a),mimeType:"application/xml"});case 12:this.setButtonStatus(Vi.COMPLETED);case 13:this.updateBotName(n),(0,s.saveWorkspaceToRecent)(a,o?s.save_types.LOCAL:s.save_types.GOOGLE_DRIVE),this.toggleSaveModal();case 16:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateBotName",value:function(e){this.bot_name=e,(0,s.updateWorkspaceName)()}},{key:"onDriveConnect",value:(i=Xr(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.root_store.google_drive).is_authorised?t.signOut():t.signIn();case 2:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"setButtonStatus",value:function(e){this.button_status=e}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(t.prototype,o),e}()).prototype,"is_save_modal_open",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Wr=Qr($r.prototype,"button_status",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Vi.NORMAL}}),Yr=Qr($r.prototype,"bot_name",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qr($r.prototype,"toggleSaveModal",[Ur],Object.getOwnPropertyDescriptor($r.prototype,"toggleSaveModal"),$r.prototype),Qr($r.prototype,"onConfirmSave",[jr],Object.getOwnPropertyDescriptor($r.prototype,"onConfirmSave"),$r.prototype),Qr($r.prototype,"updateBotName",[Vr],Object.getOwnPropertyDescriptor($r.prototype,"updateBotName"),$r.prototype),Qr($r.prototype,"onDriveConnect",[Jr],Object.getOwnPropertyDescriptor($r.prototype,"onDriveConnect"),$r.prototype),Qr($r.prototype,"setButtonStatus",[Hr],Object.getOwnPropertyDescriptor($r.prototype,"setButtonStatus"),$r.prototype),$r),la=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.root_store=t};function sa(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function ca(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var ua,pa,da,ya,ma,ha,_a,ga,fa,ba,ka,va,Ea,Ba=(ea=Co.action.bound,ta=Co.action.bound,ia=ca((oa=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),sa(this,"contract",ia,this),sa(this,"indicative_movement",na,this),sa(this,"profit_movement",ra,this),this.contract_id=null,this.profit=0,this.indicative=0,this.root_store=t,this.disposeReactionsFn=this.registerReactions()}var t;return(t=[{key:"is_contract_completed",get:function(){return!!this.contract&&!!this.contract.is_sold&&this.root_store.run_panel.contract_stage!==ae.PURCHASE_RECEIVED}},{key:"is_contract_loading",get:function(){return this.root_store.run_panel.is_running&&null===this.contract||this.root_store.run_panel.contract_stage===ae.PURCHASE_SENT||this.root_store.run_panel.contract_stage===ae.STARTING}},{key:"is_contract_inactive",get:function(){return!this.contract&&!this.is_loading}},{key:"onBotContractEvent",value:function(e){var t=this,o=e.profit,i=(0,ne.getIndicativePrice)(e);this.contract_id!==e.id&&(this.clear(!1),this.contract_id=e.id,this.profit=o,this.indicative=i);var n={profit:o,indicative:i};Object.keys(n).forEach((function(e){n[e]!==t[e]?t["".concat(e,"_movement")]=n[e]>t[e]?"profit":"loss":""!==t["".concat(e,"_movement")]&&(t.indicative_movement=""),t[e]=n[e]})),this.contract=e}},{key:"clear",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&(this.contract=null),this.profit=0,this.profit_loss=0,this.indicative=0,this.indicative_movement="",this.profit_movement=""}},{key:"registerReactions",value:function(){var e=this,t=this.root_store.core.client;return this.disposeSwitchAcountListener=(0,Co.reaction)((function(){return t.loginid}),(function(){return e.clear()})),function(){"function"==typeof e.disposeSwitchAcountListener&&e.disposeSwitchAcountListener()}}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}()).prototype,"contract",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),na=ca(oa.prototype,"indicative_movement",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ra=ca(oa.prototype,"profit_movement",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ca(oa.prototype,"is_contract_completed",[Co.computed],Object.getOwnPropertyDescriptor(oa.prototype,"is_contract_completed"),oa.prototype),ca(oa.prototype,"is_contract_loading",[Co.computed],Object.getOwnPropertyDescriptor(oa.prototype,"is_contract_loading"),oa.prototype),ca(oa.prototype,"is_contract_inactive",[Co.computed],Object.getOwnPropertyDescriptor(oa.prototype,"is_contract_inactive"),oa.prototype),ca(oa.prototype,"onBotContractEvent",[ea],Object.getOwnPropertyDescriptor(oa.prototype,"onBotContractEvent"),oa.prototype),ca(oa.prototype,"clear",[ta],Object.getOwnPropertyDescriptor(oa.prototype,"clear"),oa.prototype),oa);function Ta(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function Sa(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var Oa,Ca,wa,Aa,Ia,Ra,Da,Na,xa,Pa,za=(ua=Co.action.bound,pa=Co.action.bound,da=Co.action.bound,ya=Co.action.bound,ma=Co.action.bound,ha=Co.action.bound,_a=Co.action.bound,fa=Sa((ga=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ta(this,"is_animation_info_modal_open",fa,this),Ta(this,"is_dialog_open",ba,this),Ta(this,"file_name",ka,this),Ta(this,"has_undo_stack",va,this),Ta(this,"has_redo_stack",Ea,this),this.onSortClick=function(){Blockly.derivWorkspace.cleanUp()},this.onZoomInOutClick=function(e){var t=Blockly.derivWorkspace,o=t.getMetrics(),i=e?1:-1;t.zoom(o.viewWidth/2,o.viewHeight/2,i)},this.root_store=t}var t;return(t=[{key:"toggleAnimationInfoModal",value:function(){this.is_animation_info_modal_open=!this.is_animation_info_modal_open}},{key:"onResetClick",value:function(){this.is_dialog_open=!0}},{key:"closeResetDialog",value:function(){this.is_dialog_open=!1}},{key:"onResetOkButtonClick",value:function(){(0,s.runGroupedEvents)(!1,(function(){var e=Blockly.derivWorkspace;e.current_strategy_id=Blockly.utils.genUid(),(0,s.load)({block_string:e.cached_xml.main,file_name:s.config.default_file_name,workspace:e})}),"reset"),this.is_dialog_open=!1,this.root_store.run_panel.is_running&&this.root_store.run_panel.onStopButtonClick()}},{key:"onUndoClick",value:function(e){Blockly.Events.setGroup("undo_clicked"),Blockly.derivWorkspace.undo(e),Blockly.svgResize(Blockly.derivWorkspace),this.setHasRedoStack(),this.setHasUndoStack(),Blockly.Events.setGroup(!1)}},{key:"setHasUndoStack",value:function(){this.has_undo_stack=Blockly.derivWorkspace.hasUndoStack()}},{key:"setHasRedoStack",value:function(){var e;this.has_redo_stack=null===(e=Blockly.derivWorkspace)||void 0===e?void 0:e.hasRedoStack()}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}()).prototype,"is_animation_info_modal_open",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ba=Sa(ga.prototype,"is_dialog_open",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ka=Sa(ga.prototype,"file_name",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return s.config.default_file_name}}),va=Sa(ga.prototype,"has_undo_stack",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ea=Sa(ga.prototype,"has_redo_stack",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Sa(ga.prototype,"toggleAnimationInfoModal",[ua],Object.getOwnPropertyDescriptor(ga.prototype,"toggleAnimationInfoModal"),ga.prototype),Sa(ga.prototype,"onResetClick",[pa],Object.getOwnPropertyDescriptor(ga.prototype,"onResetClick"),ga.prototype),Sa(ga.prototype,"closeResetDialog",[da],Object.getOwnPropertyDescriptor(ga.prototype,"closeResetDialog"),ga.prototype),Sa(ga.prototype,"onResetOkButtonClick",[ya],Object.getOwnPropertyDescriptor(ga.prototype,"onResetOkButtonClick"),ga.prototype),Sa(ga.prototype,"onUndoClick",[ma],Object.getOwnPropertyDescriptor(ga.prototype,"onUndoClick"),ga.prototype),Sa(ga.prototype,"setHasUndoStack",[ha],Object.getOwnPropertyDescriptor(ga.prototype,"setHasUndoStack"),ga.prototype),Sa(ga.prototype,"setHasRedoStack",[_a],Object.getOwnPropertyDescriptor(ga.prototype,"setHasRedoStack"),ga.prototype),ga);function La(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function Ma(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var Fa,Ua,ja,Va,Ja,Ha,$a,Ga,Wa,Ya,qa,Ka,Xa,Za,Qa,el,tl,ol,il,nl,rl,al,ll,sl,cl,ul,pl,dl,yl,ml,hl,_l,gl=(Oa=Co.action.bound,Ca=Co.action.bound,wa=Co.action.bound,Aa=Co.action.bound,Ia=Co.action.bound,Ra=Co.action.bound,Da=Co.action.bound,xa=Ma((Na=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TRANSACTION_CACHE="transaction_cache",La(this,"elements",xa,this),La(this,"active_transaction_id",Pa,this),this.root_store=t,this.disposeReactionsFn=this.registerReactions()}var t;return(t=[{key:"transactions",get:function(){return this.elements.filter((function(e){return e.type===Bt.CONTRACT}))}},{key:"onBotContractEvent",value:function(e){this.pushTransaction(e)}},{key:"pushTransaction",value:function(e){var t=(0,ne.isEnded)(e),o=this.root_store.run_panel.run_id,i={barrier:e.barrier,buy_price:e.buy_price,contract_id:e.contract_id,contract_type:e.contract_type,currency:e.currency,date_start:(0,ne.formatDate)(e.date_start,"YYYY-M-D HH:mm:ss [GMT]"),display_name:e.display_name,entry_tick:e.entry_tick_display_value,entry_tick_time:e.entry_tick_time&&(0,ne.formatDate)(e.entry_tick_time,"YYYY-M-D HH:mm:ss [GMT]"),exit_tick:e.exit_tick_display_value,exit_tick_time:e.exit_tick_time&&(0,ne.formatDate)(e.exit_tick_time,"YYYY-M-D HH:mm:ss [GMT]"),high_barrier:e.high_barrier,is_completed:t,low_barrier:e.low_barrier,payout:e.payout,profit:t&&e.profit,run_id:o,shortcode:e.shortcode,tick_count:e.tick_count,transaction_ids:e.transaction_ids,underlying:e.underlying},n=this.elements.findIndex((function(t){return t.type===Bt.CONTRACT&&t.data.transaction_ids&&t.data.transaction_ids.buy===e.transaction_ids.buy}));-1===n?(this.elements.length>0&&this.elements[0].type===Bt.CONTRACT&&i.run_id!==this.elements[0].data.run_id&&this.elements.unshift({type:Bt.DIVIDER,data:i.run_id}),this.elements.unshift({type:Bt.CONTRACT,data:i})):this.elements.splice(n,1,{type:Bt.CONTRACT,data:i}),this.elements=this.elements.slice()}},{key:"setActiveTransactionId",value:function(e){e&&this.active_transaction_id===e?this.active_transaction_id=null:this.active_transaction_id=e}},{key:"onClickOutsideTransaction",value:function(e){(e.path||e.composedPath&&e.composedPath()).some((function(e){return e.classList&&e.classList.contains("transactions__item-wrapper")}))||this.setActiveTransactionId(null)}},{key:"onMount",value:function(){window.addEventListener("click",this.onClickOutsideTransaction)}},{key:"onUnmount",value:function(){window.removeEventListener("click",this.onClickOutsideTransaction)}},{key:"clear",value:function(){this.elements=this.elements.slice(0,0)}},{key:"registerReactions",value:function(){var e=this,t=this.root_store.core.client,o=(0,Co.reaction)((function(){return e.elements}),(function(o){var i=_n(e.TRANSACTION_CACHE,{});i[t.loginid]=o.slice(0,5e3),gn(e.TRANSACTION_CACHE,i)})),i=(0,Co.reaction)((function(){return t.loginid}),(function(){return e.elements=hn(e.TRANSACTION_CACHE,t.loginid,[])})),n=(0,Co.when)((function(){return e.elements.length}),(function(){return e.recoverPendingContracts()}));return function(){o(),i(),n()}}},{key:"recoverPendingContracts",value:function(){var e=this,t=[],o=this.root_store.summary_card.contract;this.transactions.forEach((function(i){var n=i.data;n.is_completed||n.contract_id!==(null==o?void 0:o.contract_id)&&e.root_store.ws.authorized.subscribeProposalOpenContract(n.contract_id,(function(o){if(!o.error){var i=o.proposal_open_contract;if(e.onBotContractEvent(i),!t.includes(n.contract_id)&&(0,ne.isEnded)(i)){t.push(n.contract_id);var r=i.currency,a=i.profit;e.root_store.journal.onLogSuccess({log_type:a>0?s.log_types.PROFIT:s.log_types.LOST,extra:{currency:r,profit:a}})}}}))}))}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}()).prototype,"elements",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return hn(this.TRANSACTION_CACHE,this.root_store.core.client.loginid,[])}}),Pa=Ma(Na.prototype,"active_transaction_id",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ma(Na.prototype,"transactions",[Co.computed],Object.getOwnPropertyDescriptor(Na.prototype,"transactions"),Na.prototype),Ma(Na.prototype,"onBotContractEvent",[Oa],Object.getOwnPropertyDescriptor(Na.prototype,"onBotContractEvent"),Na.prototype),Ma(Na.prototype,"pushTransaction",[Ca],Object.getOwnPropertyDescriptor(Na.prototype,"pushTransaction"),Na.prototype),Ma(Na.prototype,"setActiveTransactionId",[wa],Object.getOwnPropertyDescriptor(Na.prototype,"setActiveTransactionId"),Na.prototype),Ma(Na.prototype,"onClickOutsideTransaction",[Aa],Object.getOwnPropertyDescriptor(Na.prototype,"onClickOutsideTransaction"),Na.prototype),Ma(Na.prototype,"onMount",[Ia],Object.getOwnPropertyDescriptor(Na.prototype,"onMount"),Na.prototype),Ma(Na.prototype,"onUnmount",[Ra],Object.getOwnPropertyDescriptor(Na.prototype,"onUnmount"),Na.prototype),Ma(Na.prototype,"clear",[Da],Object.getOwnPropertyDescriptor(Na.prototype,"clear"),Na.prototype),Na);function fl(e,t,o,i,n,r,a){try{var l=e[r](a),s=l.value}catch(e){return void o(e)}l.done?t(s):Promise.resolve(s).then(i,n)}function bl(e){return function(){var t=this,o=arguments;return new Promise((function(i,n){var r=e.apply(t,o);function a(e){fl(r,i,n,a,l,"next",e)}function l(e){fl(r,i,n,a,l,"throw",e)}a(void 0)}))}}function kl(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,i=new Array(t);o<t;o++)i[o]=e[o];return i}function vl(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function El(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var Bl,Tl,Sl,Ol,Cl,wl,Al,Il=(Fa=Co.action.bound,Ua=Co.action.bound,ja=Co.action.bound,Va=Co.action.bound,Ja=Co.action.bound,Ha=Co.action.bound,$a=Co.action.bound,Ga=Co.action.bound,Wa=Co.action.bound,Ya=Co.action.bound,qa=Co.action.bound,Ka=Co.action.bound,Xa=Co.action.bound,Za=Co.action.bound,Qa=Co.action.bound,el=Co.action.bound,tl=Co.action.bound,ol=Co.action.bound,nl=El((il=function(){function e(t){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),vl(this,"selected_symbol",nl,this),vl(this,"selected_trade_type",rl,this),vl(this,"selected_duration_unit",al,this),vl(this,"input_duration_value",ll,this),vl(this,"input_stake",sl,this),vl(this,"input_size",cl,this),vl(this,"input_loss",ul,this),vl(this,"input_profit",pl,this),vl(this,"is_strategy_modal_open",dl,this),vl(this,"active_index",yl,this),vl(this,"symbol_dropdown",ml,this),vl(this,"trade_type_dropdown",hl,this),vl(this,"duration_unit_dropdown",_l,this),this.onScrollStopDropdownList=function(e){$o.pushDataLayer({event:"dbot_quick_strategy_scroll_".concat(e)})},this.getSizeDesc=function(e){switch(e){case 0:return(0,B.localize)("The multiplier amount used to increase your stake if you’re losing a trade.");case 1:return(0,B.localize)("The amount that you may add to your stake if you’re losing a trade.");case 2:return(0,B.localize)("The amount that you may add to your stake after each successful trade.");default:return""}},this.getSizeText=function(e){switch(e){case 0:return(0,B.localize)("Size");case 1:case 2:return(0,B.localize)("Units");default:return""}},this.getFieldMap=function(e){return{symbol:{field_name:"quick-strategy__symbol",dropdown:o.symbol_dropdown,selected:o.selected_symbol,setSelected:o.setSelectedSymbol},"trade-type":{field_name:"quick-strategy__trade-type",dropdown:o.trade_type_dropdown,selected:o.selected_trade_type,setSelected:o.setSelectedTradeType},"duration-unit":{field_name:"quick-strategy__duration-unit",dropdown:o.duration_unit_dropdown,selected:o.selected_duration_unit,setSelected:o.setSelectedDurationUnit}}[e]},this.getFieldValue=function(e,t){var o,i,n=(Array.isArray(e)?e:(o=[]).concat.apply(o,(i=Object.values(e),function(e){if(Array.isArray(e))return kl(e)}(i)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(i)||function(e,t){if(e){if("string"==typeof e)return kl(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?kl(e,t):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))).find((function(e){var o;return"string"!=typeof e.value?e.value===t:(null===(o=e.value)||void 0===o?void 0:o.toLowerCase())===(null==t?void 0:t.toLowerCase())}));return(null==n?void 0:n.text)||""},this.root_store=t,this.qs_cache=cn("quick_strategy")||{}}var t,i,n,r,a,l,c,u;return t=e,(i=[{key:"initial_values",get:function(){var e={"quick-strategy__symbol":this.getFieldValue(this.symbol_dropdown,this.selected_symbol.value)||"","quick-strategy__trade-type":this.getFieldValue(this.trade_type_dropdown,this.selected_trade_type.value)||"","quick-strategy__duration-unit":this.getFieldValue(this.duration_unit_dropdown,this.selected_duration_unit.value)||"","quick-strategy__duration-value":this.input_duration_value||"","quick-strategy__stake":this.input_stake,"quick-strategy__size":this.input_size,"quick-strategy__loss":this.input_loss,"quick-strategy__profit":this.input_profit};return un("quick_strategy",this.qs_cache),e}},{key:"initial_errors",get:function(){return this.validateQuickStrategy(this.initial_values,!0)}},{key:"setActiveTabIndex",value:function(e){this.active_index=e}},{key:"setDurationUnitDropdown",value:function(e){this.duration_unit_dropdown=e}},{key:"setSymbolDropdown",value:function(e){this.symbol_dropdown=e}},{key:"setTradeTypeDropdown",value:function(e){this.trade_type_dropdown=e}},{key:"setSelectedDurationUnit",value:function(e){this.qs_cache.selected_duration_unit=e,this.selected_duration_unit=e}},{key:"setSelectedSymbol",value:function(e){this.qs_cache.selected_symbol=e,this.selected_symbol=e,delete this.qs_cache.selected_duration_unit,delete this.qs_cache.duration_value,delete this.qs_cache.selected_trade_type}},{key:"setSelectedTradeType",value:function(e){this.qs_cache.selected_trade_type=e,this.selected_trade_type=e,delete this.qs_cache.selected_duration_unit,delete this.qs_cache.duration_value}},{key:"setDurationInputValue",value:function(e){this.qs_cache.input_duration_value=e,this.input_duration_value=e}},{key:"onChangeDropdownItem",value:function(e,t,o){if(t){var i=this.getFieldMap(e);if("symbol"===e){this.updateTradeTypeDropdown(t,o);var n=this.symbol_dropdown.find((function(e){return e.value===t}));this.setSelectedSymbol(n),n&&o(i.field_name,n.text)}else if("trade-type"===e){this.updateDurationDropdown(this.selected_symbol.value,t,o);var r=this.trade_type_dropdown.find((function(e){return e.value===t}));this.setSelectedTradeType(r),r&&o(i.field_name,r.text)}else if("duration-unit"===e){this.updateDurationValue(t,o);var a=this.duration_unit_dropdown.find((function(e){return e.value===t}));this.setSelectedDurationUnit(a),a&&o("quick-strategy__duration-unit",a.text)}}}},{key:"onChangeInputValue",value:function(e,t){this.qs_cache[e]=t.currentTarget.value,this[e]=t.currentTarget.value,un("quick_strategy",this.qs_cache)}},{key:"onHideDropdownList",value:function(e,t,o){var i=this.getFieldMap(e),n=i.dropdown.find((function(e){return e.text.toLowerCase()===t.toLowerCase()}))||i.selected;n?(n.text!==t&&o(i.field_name,n.text),n!==i.selected&&i.setSelected(n)):o(i.field_name,"")}},{key:"toggleStrategyModal",value:(u=bl(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.root_store.flyout.setVisibility(!1),this.is_strategy_modal_open=!this.is_strategy_modal_open,!this.is_strategy_modal_open){e.next=5;break}return e.next=5,this.updateSymbolDropdown();case 5:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"createStrategy",value:(c=bl(regeneratorRuntime.mark((function e(t){var i,n,r,a,l,c,u,p,d,y,m,h,_,g,f,b,k,v,E,T,S,O,C,w,A=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.button,r=this.selected_symbol.value,a=this.selected_trade_type.value,l=this.selected_duration_unit.value,c=this.input_duration_value,u=this.input_stake,p=this.input_size,d=this.input_loss,y=this.input_profit,m=s.ApiHelpers.instance.contracts_for,e.next=12,m.getMarketBySymbol(r);case 12:return h=e.sent,e.next=15,m.getSubmarketBySymbol(r);case 15:return _=e.sent,e.next=18,m.getTradeTypeCategoryByTradeType(a);case 18:return g=e.sent,f=s.config.strategies,b=Object.keys(f).find((function(e){return f[e].index===A.active_index})),e.next=23,o(7328)("./".concat(b,".xml"));case 23:k=e.sent,v=Blockly.Xml.textToDom(k.default),E=function(e,t){v.querySelectorAll('value[strategy_value="'.concat(e,'"]')).forEach((function(e){e.innerHTML='<shadow type="math_number"><field name="NUM">'.concat(t,"</field></shadow>")}))},T=function(e,t){v.querySelectorAll('field[name="'.concat("".concat(e.toUpperCase(),"_LIST"),'"]')).forEach((function(e){e.innerHTML=t}))},S={market:h,submarket:_,symbol:r,tradetype:a,tradetypecat:g,durationtype:l,duration:c,stake:u,size:p,loss:d,profit:y},Object.keys(S).forEach((function(e){var t=S[e];isNaN(t)?"string"==typeof t&&T(e,t):E(e,t)})),O=(null==f||null===(i=f[b])||void 0===i?void 0:i.label)||(0,B.localize)("Unknown"),C=Blockly,w=C.derivWorkspace,(0,s.load)({block_string:Blockly.Xml.domToText(v),file_name:O,workspace:w,from:we.R.UNSAVED}),"run"===n&&w.waitForBlockEvent({block_type:"trade_definition",event_type:Blockly.Events.BLOCK_CREATE,timeout:5e3}).then((function(){A.root_store.run_panel.onRunButtonClick()})),this.is_strategy_modal_open&&this.toggleStrategyModal();case 34:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"updateSymbolDropdown",value:(l=bl(regeneratorRuntime.mark((function e(){var t,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.ApiHelpers.instance.active_symbols,o=t.getAllSymbols(!0),i=o.map((function(e){return{group:e.submarket_display,text:e.symbol_display,value:e.symbol}})),this.setSymbolDropdown(i),!this.selected_symbol&&i.length&&(this.selected_symbol=i[0]),e.next=7,this.updateTradeTypeDropdown(this.selected_symbol.value);case 7:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"updateTradeTypeDropdown",value:(a=bl(regeneratorRuntime.mark((function e(t,o){var i,n,r,a,l,c,u,p,d,y,m,h,_,g,f,b,k,v=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.ApiHelpers.instance.contracts_for,n=[],r=i.getMarketBySymbol(t),a=i.getSubmarketBySymbol(t),e.next=6,i.getTradeTypeCategories(r,a,t);case 6:l=e.sent,c=[],u=0;case 9:if(!(u<l.length)){e.next=20;break}return p=l[u],e.next=13,i.getTradeTypeByTradeCategory(r,a,t,p[1]);case 13:for(d=e.sent,y=0,m=0;m<d.length;m++)h=d[m],_=s.config.BARRIER_TRADE_TYPES.includes(h.value),g=s.config.PREDICTION_TRADE_TYPES.includes(h.value),(_||g)&&y++;y<d.length&&c.push(p);case 17:u++,e.next=9;break;case 20:f=regeneratorRuntime.mark((function e(o){var l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=c[o],e.next=3,i.getTradeTypeByTradeCategory(r,a,t,l[1]);case 3:e.sent.forEach((function(e){var t=s.config.BARRIER_TRADE_TYPES.includes(e.value),o=s.config.PREDICTION_TRADE_TYPES.includes(e.value);t||o||n.push({text:e.name,value:e.value,group:l[0],icon:e.icon})}));case 5:case"end":return e.stop()}}),e)})),b=0;case 22:if(!(b<c.length)){e.next=27;break}return e.delegateYield(f(b),"t0",24);case 24:b++,e.next=22;break;case 27:if(this.setTradeTypeDropdown(n),k=n[0],this.selected_trade_type&&n.some((function(e){return e.value===v.selected_trade_type.value}))?(k=this.selected_trade_type,(0,Co.runInAction)((function(){k.text=v.getFieldValue(v.trade_type_dropdown,v.selected_trade_type.value)}))):delete this.qs_cache.selected_trade_type,!k){e.next=35;break}return this.setSelectedTradeType(k),e.next=34,this.updateDurationDropdown(this.selected_symbol.value,this.selected_trade_type.value,o);case 34:o&&o("quick-strategy__trade-type",k.text);case 35:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"updateDurationDropdown",value:(r=bl(regeneratorRuntime.mark((function e(t,o,i){var n,r,a,l,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.ApiHelpers.instance.contracts_for,e.next=3,n.getDurations(t,o);case 3:r=e.sent,a=r.map((function(e){return{text:e.display,value:e.unit,min:e.min,max:e.max}})),this.setDurationUnitDropdown(a),l=a[0],this.selected_duration_unit&&a.some((function(e){return e.value===c.selected_duration_unit.value}))?(l=this.selected_duration_unit,(0,Co.runInAction)((function(){l.text=c.getFieldValue(a,c.selected_duration_unit.value)}))):delete this.qs_cache.selected_duration_unit,l&&(this.setSelectedDurationUnit(l),this.updateDurationValue(this.selected_duration_unit.value,i),i&&i("quick-strategy__duration-unit",l.text));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,o){return r.apply(this,arguments)})},{key:"updateDurationValue",value:(n=bl(regeneratorRuntime.mark((function e(t,o){var i,n,r,a,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.ApiHelpers.instance.contracts_for,e.next=3,i.getDurations(this.selected_symbol.value,this.selected_trade_type.value);case 3:n=e.sent,(r=n.find((function(e){return e.unit===t})))&&(a=r.min,(l=this.qs_cache.input_duration_value)&&l<r.max&&l>r.min?a=l:delete this.qs_cache.input_duration_value,this.setDurationInputValue(a),o&&o("quick-strategy__duration-value",a));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"validateQuickStrategy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o={},i=["quick-strategy__duration-value","quick-strategy__stake","quick-strategy__size","quick-strategy__profit","quick-strategy__loss"];Object.keys(e).forEach((function(n){var r=e[n];t&&!r||(i.includes(n)&&(isNaN(r)?o[n]=(0,B.localize)("Must be a number"):r<=0?o[n]=(0,B.localize)("Must be a number higher than 0"):/^0+(?=\d)/.test(r)&&(o[n]=(0,B.localize)("Invalid number format"))),""===r&&(o[n]=(0,B.localize)("Field cannot be empty")))}));var n=this.duration_unit_dropdown.find((function(t){return t.text===e["quick-strategy__duration-unit"]}));if(n){var r=n.min,a=n.max;e["quick-strategy__duration-value"]<r?o["quick-strategy__duration-value"]=(0,B.localize)("Minimum duration: {{ min }}",{min:r}):e["quick-strategy__duration-value"]>a&&(o["quick-strategy__duration-value"]=(0,B.localize)("Maximum duration: {{ max }}",{max:a}))}return o}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(t.prototype,i),e}()).prototype,"selected_symbol",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.selected_symbol||""}}),rl=El(il.prototype,"selected_trade_type",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.selected_trade_type||""}}),al=El(il.prototype,"selected_duration_unit",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.selected_duration_unit||""}}),ll=El(il.prototype,"input_duration_value",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.input_duration_value||""}}),sl=El(il.prototype,"input_stake",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.input_stake||""}}),cl=El(il.prototype,"input_size",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.input_size||""}}),ul=El(il.prototype,"input_loss",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.input_loss||""}}),pl=El(il.prototype,"input_profit",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.qs_cache.input_profit||""}}),dl=El(il.prototype,"is_strategy_modal_open",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),yl=El(il.prototype,"active_index",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ml=El(il.prototype,"symbol_dropdown",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),hl=El(il.prototype,"trade_type_dropdown",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_l=El(il.prototype,"duration_unit_dropdown",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),El(il.prototype,"initial_values",[Co.computed],Object.getOwnPropertyDescriptor(il.prototype,"initial_values"),il.prototype),El(il.prototype,"initial_errors",[Co.computed],Object.getOwnPropertyDescriptor(il.prototype,"initial_errors"),il.prototype),El(il.prototype,"setActiveTabIndex",[Fa],Object.getOwnPropertyDescriptor(il.prototype,"setActiveTabIndex"),il.prototype),El(il.prototype,"setDurationUnitDropdown",[Ua],Object.getOwnPropertyDescriptor(il.prototype,"setDurationUnitDropdown"),il.prototype),El(il.prototype,"setSymbolDropdown",[ja],Object.getOwnPropertyDescriptor(il.prototype,"setSymbolDropdown"),il.prototype),El(il.prototype,"setTradeTypeDropdown",[Va],Object.getOwnPropertyDescriptor(il.prototype,"setTradeTypeDropdown"),il.prototype),El(il.prototype,"setSelectedDurationUnit",[Ja],Object.getOwnPropertyDescriptor(il.prototype,"setSelectedDurationUnit"),il.prototype),El(il.prototype,"setSelectedSymbol",[Ha],Object.getOwnPropertyDescriptor(il.prototype,"setSelectedSymbol"),il.prototype),El(il.prototype,"setSelectedTradeType",[$a],Object.getOwnPropertyDescriptor(il.prototype,"setSelectedTradeType"),il.prototype),El(il.prototype,"setDurationInputValue",[Ga],Object.getOwnPropertyDescriptor(il.prototype,"setDurationInputValue"),il.prototype),El(il.prototype,"onChangeDropdownItem",[Wa],Object.getOwnPropertyDescriptor(il.prototype,"onChangeDropdownItem"),il.prototype),El(il.prototype,"onChangeInputValue",[Ya],Object.getOwnPropertyDescriptor(il.prototype,"onChangeInputValue"),il.prototype),El(il.prototype,"onHideDropdownList",[qa],Object.getOwnPropertyDescriptor(il.prototype,"onHideDropdownList"),il.prototype),El(il.prototype,"toggleStrategyModal",[Ka],Object.getOwnPropertyDescriptor(il.prototype,"toggleStrategyModal"),il.prototype),El(il.prototype,"createStrategy",[Xa],Object.getOwnPropertyDescriptor(il.prototype,"createStrategy"),il.prototype),El(il.prototype,"updateSymbolDropdown",[Za],Object.getOwnPropertyDescriptor(il.prototype,"updateSymbolDropdown"),il.prototype),El(il.prototype,"updateTradeTypeDropdown",[Qa],Object.getOwnPropertyDescriptor(il.prototype,"updateTradeTypeDropdown"),il.prototype),El(il.prototype,"updateDurationDropdown",[el],Object.getOwnPropertyDescriptor(il.prototype,"updateDurationDropdown"),il.prototype),El(il.prototype,"updateDurationValue",[tl],Object.getOwnPropertyDescriptor(il.prototype,"updateDurationValue"),il.prototype),El(il.prototype,"validateQuickStrategy",[ol],Object.getOwnPropertyDescriptor(il.prototype,"validateQuickStrategy"),il.prototype),il);function Rl(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var Dl,Nl,xl,Pl,zl,Ll,Ml,Fl,Ul=(Bl=Co.action.bound,Tl=Co.action.bound,Sl=Co.action.bound,Ol=Co.action.bound,Cl=Co.action.bound,Al=Rl((wl=function(){function e(t){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Al)&&Object.defineProperty(this,"active_tab",{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(this):void 0}),this.root_store=t}var t;return(t=[{key:"setActiveTab",value:function(e){this.active_tab=e,un("active_tab",this.active_tab)}},{key:"setContainerSize",value:function(){this.active_tab===T.WORKSPACE&&(0,s.onWorkspaceResize)()}},{key:"onMount",value:function(){window.addEventListener("resize",this.setContainerSize)}},{key:"getCachedActiveTab",value:function(){cn("active_tab")&&(this.active_tab=cn("active_tab"))}},{key:"onUnmount",value:function(){window.removeEventListener("resize",this.setContainerSize)}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}()).prototype,"active_tab",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return T.WORKSPACE}}),Rl(wl.prototype,"setActiveTab",[Bl],Object.getOwnPropertyDescriptor(wl.prototype,"setActiveTab"),wl.prototype),Rl(wl.prototype,"setContainerSize",[Tl],Object.getOwnPropertyDescriptor(wl.prototype,"setContainerSize"),wl.prototype),Rl(wl.prototype,"onMount",[Sl],Object.getOwnPropertyDescriptor(wl.prototype,"onMount"),wl.prototype),Rl(wl.prototype,"getCachedActiveTab",[Ol],Object.getOwnPropertyDescriptor(wl.prototype,"getCachedActiveTab"),wl.prototype),Rl(wl.prototype,"onUnmount",[Cl],Object.getOwnPropertyDescriptor(wl.prototype,"onUnmount"),wl.prototype),wl);function jl(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function Vl(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var Jl=(Dl=Co.action.bound,Nl=Co.action.bound,xl=Co.action.bound,Pl=Co.action.bound,Ll=Vl((zl=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),jl(this,"should_show",Ll,this),jl(this,"is_confirmed",Ml,this),jl(this,"last_location",Fl,this),this.root_store=t}var t;return(t=[{key:"shouldNavigateAfterPrompt",value:function(e){return!!this.is_confirmed||(this.last_location=e,this.should_show=!0,!1)}},{key:"onConfirm",value:function(){this.should_show=!1,this.is_confirmed=!0}},{key:"onCancel",value:function(){this.should_show=!1}},{key:"continueRoute",value:function(){this.is_confirmed&&this.last_location&&this.root_store.common.routeTo(this.last_location.pathname)}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}()).prototype,"should_show",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ml=Vl(zl.prototype,"is_confirmed",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Fl=Vl(zl.prototype,"last_location",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Vl(zl.prototype,"shouldNavigateAfterPrompt",[Dl],Object.getOwnPropertyDescriptor(zl.prototype,"shouldNavigateAfterPrompt"),zl.prototype),Vl(zl.prototype,"onConfirm",[Nl],Object.getOwnPropertyDescriptor(zl.prototype,"onConfirm"),zl.prototype),Vl(zl.prototype,"onCancel",[xl],Object.getOwnPropertyDescriptor(zl.prototype,"onCancel"),zl.prototype),Vl(zl.prototype,"continueRoute",[Pl],Object.getOwnPropertyDescriptor(zl.prototype,"continueRoute"),zl.prototype),zl),Hl=o(7108),$l=o.n(Hl);function Gl(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function Wl(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Gl(Object(o),!0).forEach((function(t){Yl(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Gl(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Yl(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function ql(e,t,o,i,n,r,a){try{var l=e[r](a),s=l.value}catch(e){return void o(e)}l.done?t(s):Promise.resolve(s).then(i,n)}function Kl(e){return function(){var t=this,o=arguments;return new Promise((function(i,n){var r=e.apply(t,o);function a(e){ql(r,i,n,a,l,"next",e)}function l(e){ql(r,i,n,a,l,"throw",e)}a(void 0)}))}}var Xl,Zl,Ql,es,ts=function(){function e(t){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.IS_PENDING=!1,this.IS_PROCESSED=!0,this.endpoint="https://dbot-conf-dot-business-intelligence-240201.df.r.appspot.com/dbotconf",this.run_id="",this.run_start=0,this.should_post_xml=!0,this.strategy_content="",this.transaction_ids={},this.cleanXmlDom=function(e){var t=["x","y","id"],o=(0,ne.cloneObject)(e);return function e(o){t.forEach((function(e){return o.removeAttribute(e)})),Array.from(o.children).forEach((function(t){return e(t)}))}(o),o},this.getHash=function(e){return btoa($l().str(e))},((0,ne.isProduction)()||/(.*?)\.binary.sx$/.test(window.location.hostname))&&(this.root_store=t,(0,Co.reaction)((function(){return o.root_store.run_panel.is_running}),(function(){return o.root_store.run_panel.is_running?o.trackRun():void 0})),(0,Co.reaction)((function(){return o.root_store.transactions.transactions}),(function(e){o.run_id&&o.trackTransaction(e)})))}var t,i,n,r;return t=e,(i=[{key:"trackRun",value:(r=Kl(regeneratorRuntime.mark((function e(){var t,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.cleanXmlDom(Blockly.Xml.workspaceToDom(s.DBot.workspace,!0)),o=Blockly.Xml.domToText(t),i=this.getHash(o),this.getHash(this.strategy_content)!==i&&(this.should_post_xml=!0,this.setStrategyContent(o)),this.setRunId(this.getHash(i+this.root_store.core.client.loginid+Math.random())),this.setRunStart(this.root_store.common.server_time.unix());case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"trackTransaction",value:(n=Kl(regeneratorRuntime.mark((function e(t){var i,n,r,a,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.e(297).then(o.t.bind(o,2845,23));case 2:if(i=e.sent,n=t[0]){e.next=6;break}return e.abrupt("return");case 6:r=n.data.transaction_ids.buy,Object.keys(this.transaction_ids).includes(r.toString())||(this.transaction_ids[r]=this.IS_PENDING,a=function(){return{body:i.gzip(l.strategy_content),headers:{"Content-Encoding":"gzip","Content-Type":"application/xml",Referer:window.location.hostname}}},fetch("".concat(this.endpoint,"/").concat(this.run_id,"/").concat(r,"/").concat(this.run_start,"/").concat(this.getHash(this.strategy_content)),Wl(Wl({},this.should_post_xml?a():{}),{},{method:"POST",mode:"cors"})).then((function(){l.should_post_xml=!1,l.transaction_ids[r]=l.IS_PROCESSED})).catch((function(){delete l.transaction_ids[r]})));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setRunId",value:function(e){this.run_id=e}},{key:"setRunStart",value:function(e){this.run_start=e}},{key:"setStrategyContent",value:function(e){this.strategy_content=e}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(t.prototype,i),e}();function os(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var is,ns,rs,as,ls,ss,cs,us,ps,ds=(Xl=Co.action.bound,Zl=Co.action.bound,es=os((Ql=function(){function e(t){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(o=es)&&Object.defineProperty(this,"is_loading",{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(this):void 0}),this.root_store=t}var t;return(t=[{key:"startLoading",value:function(){this.is_loading=!0}},{key:"endLoading",value:function(){this.is_loading=!1}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}()).prototype,"is_loading",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),os(Ql.prototype,"startLoading",[Xl],Object.getOwnPropertyDescriptor(Ql.prototype,"startLoading"),Ql.prototype),os(Ql.prototype,"endLoading",[Zl],Object.getOwnPropertyDescriptor(Ql.prototype,"endLoading"),Ql.prototype),Ql);function ys(e,t,o,i,n,r,a){try{var l=e[r](a),s=l.value}catch(e){return void o(e)}l.done?t(s):Promise.resolve(s).then(i,n)}function ms(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function hs(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var _s,gs,fs,bs,ks,vs,Es,Bs,Ts,Ss,Os,Cs,ws,As,Is,Rs,Ds,Ns,xs,Ps,zs,Ls=(is=Co.action.bound,ns=Co.action.bound,rs=Co.action.bound,as=Co.action.bound,ls=Co.action.bound,cs=hs((ss=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ms(this,"api_max_losses",cs,this),ms(this,"run_limit",us,this),ms(this,"is_restricted",ps,this),this.root_store=t}var t,o,i,n;return t=e,(o=[{key:"initial_values",get:function(){return{form_max_losses:this.api_max_losses||"",run_limit:-1!==this.run_limit?this.run_limit:""}}},{key:"should_bot_run",get:function(){var e=this.root_store.core.client;return!(e.is_eu&&!e.is_virtual&&(0===this.api_max_losses||-1===this.run_limit))}},{key:"setIsRestricted",value:function(e){this.is_restricted=e}},{key:"setApiMaxLosses",value:function(e){this.api_max_losses=e}},{key:"setRunLimit",value:function(e){this.run_limit=e}},{key:"resetSelfExclusion",value:function(){this.is_restricted=!1,this.api_max_losses=0,this.form_max_losses=0,this.run_limit=-1}},{key:"checkRestriction",value:(i=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.root_store.core.client,e.next=3,t.getSelfExclusion();case 3:t.self_exclusion.max_losses&&this.setApiMaxLosses(t.self_exclusion.max_losses);case 4:case"end":return e.stop()}}),e,this)})),n=function(){var e=this,t=arguments;return new Promise((function(o,n){var r=i.apply(e,t);function a(e){ys(r,o,n,a,l,"next",e)}function l(e){ys(r,o,n,a,l,"throw",e)}a(void 0)}))},function(){return n.apply(this,arguments)})}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(t.prototype,o),e}()).prototype,"api_max_losses",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),us=hs(ss.prototype,"run_limit",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),ps=hs(ss.prototype,"is_restricted",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),hs(ss.prototype,"initial_values",[Co.computed],Object.getOwnPropertyDescriptor(ss.prototype,"initial_values"),ss.prototype),hs(ss.prototype,"should_bot_run",[Co.computed],Object.getOwnPropertyDescriptor(ss.prototype,"should_bot_run"),ss.prototype),hs(ss.prototype,"setIsRestricted",[is],Object.getOwnPropertyDescriptor(ss.prototype,"setIsRestricted"),ss.prototype),hs(ss.prototype,"setApiMaxLosses",[ns],Object.getOwnPropertyDescriptor(ss.prototype,"setApiMaxLosses"),ss.prototype),hs(ss.prototype,"setRunLimit",[rs],Object.getOwnPropertyDescriptor(ss.prototype,"setRunLimit"),ss.prototype),hs(ss.prototype,"resetSelfExclusion",[as],Object.getOwnPropertyDescriptor(ss.prototype,"resetSelfExclusion"),ss.prototype),hs(ss.prototype,"checkRestriction",[ls],Object.getOwnPropertyDescriptor(ss.prototype,"checkRestriction"),ss.prototype),ss);function Ms(e){return function(e){if(Array.isArray(e))return Fs(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Fs(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Fs(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fs(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,i=new Array(t);o<t;o++)i[o]=e[o];return i}function Us(e,t,o,i){o&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function js(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var Vs,Js,Hs,$s=(_s=Co.action.bound,gs=Co.action.bound,fs=Co.action.bound,bs=Co.action.bound,ks=Co.action.bound,vs=Co.action.bound,Es=Co.action.bound,Bs=Co.action.bound,Ts=Co.action.bound,Ss=Co.action.bound,Os=Co.action.bound,Cs=Co.action.bound,ws=Co.action.bound,As=Co.action.bound,Is=Co.action.bound,Ds=js((Rs=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Us(this,"is_toolbox_open",Ds,this),Us(this,"is_search_loading",Ns,this),Us(this,"is_search_focus",xs,this),Us(this,"sub_category_index",Ps,this),Us(this,"toolbox_dom",zs,this),this.root_store=t}var t;return(t=[{key:"onMount",value:function(e){var t=this,o=this.root_store.core;this.adjustWorkspace(),(0,ne.isMobile)()||(this.toolbox_dom=Blockly.Xml.textToDom(null==e?void 0:e.current),this.setWorkspaceOptions(),this.disposeToolboxToggleReaction=(0,Co.reaction)((function(){return t.is_toolbox_open}),(function(e){e&&(t.adjustWorkspace(),o.gtm.pushDataLayer({event:"dbot_toolbox_visible",value:!0}))})))}},{key:"onUnmount",value:function(){"function"==typeof this.disposeToolboxToggleReaction&&this.disposeToolboxToggleReaction()}},{key:"setWorkspaceOptions",value:function(){var e,t,o,i,n,r=Blockly.derivWorkspace;r.options.readOnly?(e=null,t=!1,o=!1,i=!1,n=!1):(e=this.toolbox_dom,o=t=Boolean(e&&e.getElementsByTagName("category").length),i=t,n=t),r.options.collapse=o,r.options.comments=i,r.options.disable=n,r.options.hasCategories=t,r.options.languageTree=e}},{key:"adjustWorkspace",value:function(){var e,t,o=Blockly.derivWorkspace,i=(null===(e=document.getElementById("gtm-toolbox"))||void 0===e?void 0:e.getBoundingClientRect().width)||0,n=null===(t=o.svgBlockCanvas_)||void 0===t?void 0:t.getBoundingClientRect();if(Math.round(null==n?void 0:n.left)<=i){var r=(0,ne.isMobile)()?i-n.left+20:i-n.left+36;(0,s.scrollWorkspace)(o,r,!0,!1)}}},{key:"toggleDrawer",value:function(){this.is_toolbox_open=!this.is_toolbox_open}},{key:"onToolboxItemClick",value:function(e){var t,o=this.root_store.flyout,i=e.getAttribute("id"),n=this.getCategoryContents(e);o.setIsSearchFlyout(!1),(null===(t=o.selected_category)||void 0===t?void 0:t.getAttribute("id"))===i?o.setVisibility(!1):(o.setSelectedCategory(e),o.setContents(n))}},{key:"onToolboxItemExpand",value:function(e){if(this.sub_category_index.includes(e)){var t=this.sub_category_index.filter((function(t){return t!==e}));this.sub_category_index=t}else this.sub_category_index=[].concat(Ms(this.sub_category_index),[e])}},{key:"getCategoryContents",value:function(e){var t=Blockly.derivWorkspace,o=e.getAttribute("dynamic"),i=Array.from(e.childNodes);return"string"==typeof o&&(i=t.getToolboxCategoryCallback(o)(t)),i}},{key:"getAllCategories",value:function(){var e=this,t=[];return Array.from(this.toolbox_dom.childNodes).forEach((function(o){t.push(o),e.hasSubCategory(o.children)&&Array.from(o.children).forEach((function(e){t.push(e)}))})),t}},{key:"hasSubCategory",value:function(e){return!!Object.keys(e).filter((function(t){if("CATEGORY"===e[t].tagName.toUpperCase())return e[t]})).length}},{key:"onSearch",value:function(e){var t=e.search;this.is_search_focus=!0,this.showSearch(t)}},{key:"onSearchBlur",value:function(){this.is_search_focus=!1}},{key:"onSearchClear",value:function(e){e("search",""),this.showSearch("")}},{key:"onSearchKeyUp",value:function(e){var t=this;this.is_search_loading=!0,clearTimeout(this.typing_timer),this.typing_timer=setTimeout((0,Co.action)((function(){e(),t.is_search_loading=!1})),1e3)}},{key:"showSearch",value:function(e){var t=this,o=Blockly.derivWorkspace,i=[],n=e.replace(/\s+/g," ").trim().toUpperCase(),r=n.split(" "),a=o.getVariablesOfType(""),l=Blockly.Procedures.allProcedures(o),s=this.root_store.flyout;s.setVisibility(!1);var c=[(0,B.localize)("THE"),(0,B.localize)("OF"),(0,B.localize)("YOU"),(0,B.localize)("IS"),(0,B.localize)("THIS"),(0,B.localize)("THEN"),(0,B.localize)("A"),(0,B.localize)("AN")];if(0!==n.length){if(n.length<=1||r.every((function(e){return c.includes(e)})))return s.setIsSearchFlyout(!0),void s.setContents(i,e);var u=this.getAllCategories().filter((function(e){return!t.hasSubCategory(e.children)})).map((function(e){var o=t.getCategoryContents(e);return Array.from(o).filter((function(e){return"BLOCK"===e.tagName.toUpperCase()}))})).flat(),p=function(e,t){e.some((function(e){return e===t}))||e.push(t)};["exact_block_name","match_words","block_term","block_definitions","block_meta"].forEach((function(e){return function(e){u.forEach((function(t){var o=t.getAttribute("type"),a=Blockly.Blocks[o],l=a.meta instanceof Function&&a.meta(),s=a.definition instanceof Function&&a.definition(),c=l.display_name,u=o.toUpperCase().split("_"),d=c.toUpperCase().split(" "),y=/^((message)|(tooltip)|(category))/;switch(e){case"exact_block_name":n!==c.toUpperCase()&&n!==o.toUpperCase()||p(i,t);break;case"match_words":(r.every((function(e){return d.some((function(t){return t.includes(e)}))}))||r.every((function(e){return u.some((function(t){return t.includes(e)}))})))&&p(i,t);break;case"block_term":(u.some((function(e){return r.some((function(t){return e.includes(t)}))}))||d.some((function(e){return r.some((function(t){return e.includes(t)}))})))&&p(i,t);break;case"block_definitions":Object.keys(s).forEach((function(e){var o=s[e];y.test(e)&&r.some((function(e){return o.includes(e)}))&&p(i,t),o instanceof Array&&o.forEach((function(e){var o=JSON.stringify(e).toUpperCase();"field_dropdown"===e.type&&n.length>2&&r.some((function(e){return o.includes(e)}))&&p(i,t)}))}));break;case"block_meta":var m=Object.keys(l).filter((function(e){return"display_name"!==e})).find((function(e){var t=l[e].toUpperCase().replace(/[^\w\s]/gi,"").split(" ");return r.some((function(e){return t.some((function(t){return t.includes(e)}))}))}));m&&m.length&&p(i,t)}}))}(e)}));var d=a.filter((function(e){return e.name.toUpperCase().includes(n)})),y=Blockly.DataCategory.search(d).filter((function(e){return-1===i.indexOf(e)}));y&&y.length&&i.unshift.apply(i,Ms(y));var m={0:[],1:[]},h=l[0],_=l[1];Object.keys(h).forEach((function(e){var t=h[e];t[0].toUpperCase().includes(n)&&m[0].unshift(t)})),Object.keys(_).forEach((function(e){var t=_[e];t[0].toUpperCase().includes(n)&&m[1].unshift(t)}));var g=Blockly.Procedures.populateDynamicProcedures(m).filter((function(e){return-1===i.indexOf(e)}));g.length&&i.unshift.apply(i,Ms(g)),s.setIsSearchFlyout(!0),s.setContents(i,e)}}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}()).prototype,"is_toolbox_open",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ns=js(Rs.prototype,"is_search_loading",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xs=js(Rs.prototype,"is_search_focus",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ps=js(Rs.prototype,"sub_category_index",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),zs=js(Rs.prototype,"toolbox_dom",[Co.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),js(Rs.prototype,"onMount",[_s],Object.getOwnPropertyDescriptor(Rs.prototype,"onMount"),Rs.prototype),js(Rs.prototype,"onUnmount",[gs],Object.getOwnPropertyDescriptor(Rs.prototype,"onUnmount"),Rs.prototype),js(Rs.prototype,"setWorkspaceOptions",[fs],Object.getOwnPropertyDescriptor(Rs.prototype,"setWorkspaceOptions"),Rs.prototype),js(Rs.prototype,"adjustWorkspace",[bs],Object.getOwnPropertyDescriptor(Rs.prototype,"adjustWorkspace"),Rs.prototype),js(Rs.prototype,"toggleDrawer",[ks],Object.getOwnPropertyDescriptor(Rs.prototype,"toggleDrawer"),Rs.prototype),js(Rs.prototype,"onToolboxItemClick",[vs],Object.getOwnPropertyDescriptor(Rs.prototype,"onToolboxItemClick"),Rs.prototype),js(Rs.prototype,"onToolboxItemExpand",[Es],Object.getOwnPropertyDescriptor(Rs.prototype,"onToolboxItemExpand"),Rs.prototype),js(Rs.prototype,"getCategoryContents",[Bs],Object.getOwnPropertyDescriptor(Rs.prototype,"getCategoryContents"),Rs.prototype),js(Rs.prototype,"getAllCategories",[Ts],Object.getOwnPropertyDescriptor(Rs.prototype,"getAllCategories"),Rs.prototype),js(Rs.prototype,"hasSubCategory",[Ss],Object.getOwnPropertyDescriptor(Rs.prototype,"hasSubCategory"),Rs.prototype),js(Rs.prototype,"onSearch",[Os],Object.getOwnPropertyDescriptor(Rs.prototype,"onSearch"),Rs.prototype),js(Rs.prototype,"onSearchBlur",[Cs],Object.getOwnPropertyDescriptor(Rs.prototype,"onSearchBlur"),Rs.prototype),js(Rs.prototype,"onSearchClear",[ws],Object.getOwnPropertyDescriptor(Rs.prototype,"onSearchClear"),Rs.prototype),js(Rs.prototype,"onSearchKeyUp",[As],Object.getOwnPropertyDescriptor(Rs.prototype,"onSearchKeyUp"),Rs.prototype),js(Rs.prototype,"showSearch",[Is],Object.getOwnPropertyDescriptor(Rs.prototype,"showSearch"),Rs.prototype),Rs);function Gs(e,t,o,i,n){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=o.slice().reverse().reduce((function(o,i){return i(e,t,o)||o}),r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}var Ws=(Vs=Co.action.bound,Js=Co.action.bound,Gs((Hs=function(){function e(t){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onBeforeUnload=function(e){o.root_store.run_panel.is_stop_button_visible&&(e.returnValue=!0)},this.onClickOutsideBlockly=function(e){!(e.path||e.composedPath&&e.composedPath()).some((function(e){return e.classList&&e.classList.contains("injectionDiv")}))&&Blockly.hideChaff(!1)},this.showDigitalOptionsMaltainvestError=function(e,t){"maltainvest"===e.landing_company_shortcode||e.is_options_blocked?(0,ne.showDigitalOptionsUnavailableError)(t.showError,{text:(0,B.localize)("We’re working to have this available for you soon. If you have another account, switch to that account to continue trading. You may add a DMT5 Financial."),title:(0,B.localize)("DBot is not available for this account"),link:(0,B.localize)("Go to DMT5 dashboard")}):t.has_error&&t.setError(!1,null)},this.root_store=t,this.dbot_store=null,this.api_helpers_store=null}var t;return(t=[{key:"onMount",value:function(){var e=this.root_store,t=e.blockly_store,i=e.core,n=e.main_content,r=i.client,a=i.common,l=i.ui;this.showDigitalOptionsMaltainvestError(r,a),t.startLoading(),s.DBot.initWorkspace(o.p,this.dbot_store,this.api_helpers_store,l.is_mobile).then((function(){n.setContainerSize(),t.endLoading()})),this.registerCurrencyReaction.call(this),this.registerOnAccountSwitch.call(this),this.registerLandingCompanyChangeReaction.call(this),window.addEventListener("click",this.onClickOutsideBlockly),window.addEventListener("beforeunload",this.onBeforeUnload),n.getCachedActiveTab()}},{key:"onUnmount",value:function(){s.DBot.terminateBot(),Blockly.derivWorkspace&&(clearInterval(Blockly.derivWorkspace.save_workspace_interval),Blockly.derivWorkspace.dispose()),"function"==typeof this.disposeCurrencyReaction&&this.disposeCurrencyReaction(),"function"==typeof this.disposeSwitchAccountListener&&this.disposeSwitchAccountListener(),"function"==typeof this.disposeLandingCompanyChangeReaction&&this.disposeLandingCompanyChangeReaction(),window.removeEventListener("click",this.onClickOutsideBlockly),window.removeEventListener("beforeunload",this.onBeforeUnload);var e=this.root_store.core.ui;e.setAccountSwitcherDisabledMessage(!1),e.setPromptHandler(!1)}},{key:"registerCurrencyReaction",value:function(){var e=this;this.disposeCurrencyReaction=(0,Co.reaction)((function(){return e.root_store.core.client.currency}),(function(e){Blockly.derivWorkspace&&Blockly.derivWorkspace.getAllBlocks().filter((function(e){return"trade_definition_tradeoptions"===e.type})).forEach((function(t){return t.setCurrency(e)}))}))}},{key:"registerOnAccountSwitch",value:function(){var e=this,t=this.root_store.core,o=t.client,i=t.common;this.disposeSwitchAccountListener=(0,Co.reaction)((function(){return o.switch_broadcast}),(function(t){if(t){e.showDigitalOptionsMaltainvestError(o,i);var n=s.ApiHelpers.instance,r=n.active_symbols,a=n.contracts_for;Blockly.derivWorkspace&&r.retrieveActiveSymbols(!0).then((function(){a.disposeCache(),Blockly.derivWorkspace.getAllBlocks().filter((function(e){return"trade_definition_market"===e.type})).forEach((function(e){(0,s.runIrreversibleEvents)((function(){var t=new Blockly.Events.Create(e);Blockly.Events.fire(t)}))}))}))}}))}},{key:"registerLandingCompanyChangeReaction",value:function(){var e=this.root_store.core,t=e.client,o=e.common;this.disposeLandingCompanyChangeReaction=(0,Co.reaction)((function(){return t.landing_company_shortcode}),(function(e){("maltainvest"===e||t.is_options_blocked)&&(0,ne.showDigitalOptionsUnavailableError)(o.showError,{text:(0,B.localize)("We’re working to have this available for you soon. If you have another account, switch to that account to continue trading. You may add a DMT5 Financial."),title:(0,B.localize)("DBot is not available for this account"),link:(0,B.localize)("Go to DMT5 dashboard")})}))}},{key:"setDBotEngineStores",value:function(){var e=this.root_store,t=e.core.client,o=e.flyout,i=e.toolbar,n=e.save_modal,r=e.quick_strategy,a=e.load_modal,l=e.blockly_store,s=a.handleFileChange,c=r.toggleStrategyModal,u=l.startLoading,p=l.endLoading;this.dbot_store={is_mobile:!1,client:t,flyout:o,toolbar:i,save_modal:n,startLoading:u,endLoading:p,toggleStrategyModal:c,handleFileChange:s},this.api_helpers_store={server_time:this.root_store.server_time,ws:this.root_store.ws}}}])&&function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}()).prototype,"onMount",[Vs],Object.getOwnPropertyDescriptor(Hs.prototype,"onMount"),Hs.prototype),Gs(Hs.prototype,"onUnmount",[Js],Object.getOwnPropertyDescriptor(Hs.prototype,"onUnmount"),Hs.prototype),Hs),Ys=function e(t,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.core=t,this.ui=t.ui,this.common=t.common,this.ws=o,this.dbot=i,this.server_time=t.common.server_time,this.app=new Ws(this),this.summary_card=new Ba(this),this.blockly_store=new ds(this),this.download=new Ho(this),this.flyout=new Ri(this),this.flyout_help=new ji(this),this.google_drive=new an(this),this.journal=new Hn(this),this.load_modal=new Nr(this),this.run_panel=new qr(this),this.save_modal=new aa(this),this.summary=new la(this),this.transactions=new gl(this),this.toolbar=new za(this),this.toolbox=new $s(this),this.quick_strategy=new Il(this),this.route_prompt_dialog=new Jl(this),this.self_exclusion=new Ls(this),this.chart_store=new Lo(this),this.main_content=new Ul(this),this.data_collection_store=new ts(this)};function qs(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,i=new Array(t);o<t;o++)i[o]=e[o];return i}const Ks=function(e){var t,o=e.passthrough,i=o.root_store,n=o.WS,r=(2,function(e){if(Array.isArray(e))return e}(t=a.useState(!0))||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var o=[],i=!0,n=!1,r=void 0;try{for(var a,l=e[Symbol.iterator]();!(i=(a=l.next()).done)&&(o.push(a.value),2!==o.length);i=!0);}catch(e){n=!0,r=e}finally{try{i||null==l.return||l.return()}finally{if(n)throw r}}return o}}(t)||function(e,t){if(e){if("string"==typeof e)return qs(e,2);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?qs(e,2):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=r[0],p=r[1],d=a.useRef(new Ys(i,n,s.DBot)),y=d.current,m=y.app,h=y.common,_=m.onMount,f=m.onUnmount;return a.useEffect((function(){$o.init(d.current),s.ServerTime.init(h),m.setDBotEngineStores(d.current),s.ApiHelpers.setInstance(m.api_helpers_store);var e=s.ApiHelpers.instance.active_symbols;return p(!0),e.retrieveActiveSymbols(!0).then((function(){p(!1),_()})),function(){f()}}),[_,f]),u?a.createElement(l.Loading,null):a.createElement(g,{store:d.current},a.createElement("div",{className:"bot"},a.createElement(A,null),a.createElement(mo,null),a.createElement(tt,null),a.createElement(oo,null),a.createElement(dt,null),a.createElement(C,null),a.createElement(c,null),a.createElement(yt,null),a.createElement(k,null)))}}}]);